"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[1248],{8868:(M,u,i)=>{i.r(u),i.d(u,{CreateDishModule:()=>T});var s=i(1236),h=i(7552),t=i(4496),l=i(3480),a=i(9088),o=i(8676),m=i(1128),e=i(6504),n=i(3616),r=i(8824),p=i(4704),O=i(6684),A=i(4e3),S=i(9938),y=i(8256),D=i(1512),P=i(8212),$=i(1920),d=i(9956),f=i(1712);function g(v,N){if(1&v&&(t.I0R(0,"div",3)(1,"span",12),t.SAx(2),t.aS0(3,13),t.k70(),t.C$Y(),t.I0R(4,"a",14),t.wVc(5,"urlTo"),t.OEk(6),t.C$Y()()),2&v){const c=t.GaO();let _,E;t.yG2(4),t.E7m("routerLink",t.g7$(5,2,null==(_=c.category())?null:_.id,"menuCategory.show")),t.yG2(2),t.cNF(null==(E=c.category())?null:E.name)}}let C=(()=>{class v{constructor(){this.categoriesService=(0,t.uUt)(f.S),this.service=(0,t.uUt)(o.k),this.destroy$=(0,t.uUt)(l.UF),this.router=(0,t.uUt)(s.E5),this.route=(0,t.uUt)(s.gV),this.notifications=(0,t.uUt)(m.E),this.afterUrl=this.route.snapshot.queryParams.afterUrl,this.form=new e.WC({name:new e.Ku(null)}),this.category=(0,t.OCB)(null),this.loading=(0,t.OCB)(!1),this.submitted=!1,this.e=this.errorsFor}ngOnInit(){this.listenForEvents(this.route.queryParams),this.listenForEvents(this.route.params),this.route.parent&&this.listenForEvents(this.route.parent.params),this.route.parent?.parent&&this.listenForEvents(this.route.parent?.parent.params)}submit(){this.submitted=!0,!this.form.invalid&&(this.loading.set(!0),this.service.create(this.formData()).pipe((0,n.a)(this.destroy$),(0,r.U)(()=>this.loading.set(!1))).subscribe({next:c=>{"string"==typeof this.afterUrl&&this.afterUrl.length>0?this.router.navigateByUrl(this.afterUrl):this.router.navigate([`../dish/${c.id}`],{relativeTo:this.route}),this.notifications.fireSnackBar("Piatto creato.")},error:c=>{S.y.assignErrorsToForm(this.form,c),this.notifications.error((0,y.mk)(c)||"Qualcosa \xE8 andato storto nel salvataggio del piatto.")}}))}cancel(){this.router.navigate([this.afterUrl||".."],{relativeTo:this.route})}formData(){const c=this.form.value;return c.category_id=this.category()?.id??null,c}errorsFor(c){const _=this.form.get(c);return _&&(_.dirty||_.touched||this.submitted)?_.errors:null}loadCategory(c){this.categoriesService.show(c).pipe((0,n.a)(this.destroy$)).subscribe({next:_=>{this.category.set(_)},error:_=>{this.category.set(null),console.error(_),this.notifications.error("Ci sono stati degli errori.")}})}listenForEvents(c){c.pipe((0,n.a)(this.destroy$),(0,p.k)(_=>Number(_.category_id||_.parent_id)),(0,O.I)(_=>"number"==typeof _&&!isNaN(_)&&_>0),(0,A.a)()).subscribe({next:_=>this.loadCategory(_)})}static#t=this.\u0275fac=function(_){return new(_||v)};static#e=this.\u0275cmp=t.In1({type:v,selectors:[["ng-component"]],standalone:!0,features:[t.M5G([l.UF]),t.UHJ],decls:17,vars:5,consts:()=>{let c,_,E,I,L;return c="Crea nuovo piatto",_="Nome del piatto",E="Conferma",I="Annulla",L="Il piatto verr\xE0 creato dentro la categoria",[c,["class","mb-3"],[3,"formGroup","ngSubmit"],[1,"mb-3"],["formControlName","name"],_,[3,"errors"],[1,"flex"],["tuiButton","","type","submit","size","l",1,"me-2",3,"showLoader"],E,["tuiButton","","type","button","appearance","icon","size","l",3,"showLoader","click"],I,[1,"me-2","text-slate-400"],L,["tuiLink","",3,"routerLink"]]},template:function(_,E){1&_&&(t.I0R(0,"h1"),t.SAx(1),t.aS0(2,0),t.k70(),t.C$Y(),t.yuY(3,g,7,5,"div",1),t.I0R(4,"form",2),t.qCj("ngSubmit",function(){return E.submit()}),t.I0R(5,"div",3)(6,"app-i18n-input",4),t.SAx(7),t.aS0(8,5),t.k70(),t.C$Y(),t.wR5(9,"app-errors",6),t.C$Y(),t.I0R(10,"div",7)(11,"button",8),t.SAx(12),t.aS0(13,9),t.k70(),t.C$Y(),t.I0R(14,"button",10),t.qCj("click",function(){return E.cancel()}),t.SAx(15),t.aS0(16,11),t.k70(),t.C$Y()()()),2&_&&(t.yG2(3),t.C0Y(3,E.category()?3:-1),t.yG2(),t.E7m("formGroup",E.form),t.yG2(5),t.E7m("errors",E.e("name")),t.yG2(2),t.E7m("showLoader",E.loading()),t.yG2(3),t.E7m("showLoader",E.loading()))},dependencies:[a.S,s.ER,D.w,D.C,e.sl,e.sz,e.ue,e.u,e.uW,e.Wo,$.w,d.g,P.CI,P.Kw],encapsulation:2,changeDetection:0})}return v})(),T=(()=>{class v{static#t=this.\u0275fac=function(_){return new(_||v)};static#e=this.\u0275mod=t.a4G({type:v});static#i=this.\u0275inj=t.s3X({imports:[s.qQ.forChild([(0,h.VV)(C,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return v})()},4824:(M,u,i)=>{i.d(u,{o:()=>t});var s=i(8400),h=i(2264);class t extends s.w{constructor(a){super(a),this.name=a.name,this.description=a.description,this.status=a.status,this.other=a.other,this.translations={...a.translations},a.image&&(this.image=new h.W(a.image))}}},5891:(M,u,i)=>{i.d(u,{S:()=>o});var s=i(8400),h=i(2264),t=i(355),l=i(4824),a=i(532);class o extends s.w{constructor(e){super(e),this.name=e.name,this.description=e.description,this.status=e.status,this.price=e.price,this.translations=e.translations,this.images=e.images?e.images.map(n=>new h.W(n)):[],this.suggestions=e.suggestions?e.suggestions.map(n=>new o(n)):[],this.tags=e.tags?e.tags.map(n=>new t.E(n)):[],this.allergens=e.allergens?e.allergens.map(n=>new l.o(n)):[],this.ingredients=e.ingredients?e.ingredients.map(n=>new a.e(n)):[]}}},2264:(M,u,i)=>{i.d(u,{W:()=>h});var s=i(8400);class h extends s.w{constructor(l){super(l),this.filename=l.filename,this.status=l.status,this.key=l.key,this.original_id=l.original_id,this.tag=l.tag,this.url=l.url}}},532:(M,u,i)=>{i.d(u,{e:()=>t});var s=i(8400),h=i(2264);class t extends s.w{constructor(a){super(a),this.name=a.name,this.description=a.description,this.status=a.status,this.other=a.other,this.translations={...a.translations},a.image&&(this.image=new h.W(a.image))}}},5820:(M,u,i)=>{i.d(u,{Q:()=>l});var s=i(8400);class h extends s.w{constructor(o){super(o),this.public_visible=o.public_visible,this.public_from=o.public_from?new Date(o.public_from):void 0,this.public_to=o.public_to?new Date(o.public_to):void 0,this.private_visible=o.private_visible,this.daily_from=o.daily_from?new Date(o.daily_from):void 0,this.daily_to=o.daily_to?new Date(o.daily_to):void 0}}var t=i(2264);class l extends s.w{constructor(o){super(o),this.name=o.name,this.description=o.description,this.status=o.status,this.price=o.price,this.parent_id=o.parent_id,this.index=o.index,this.secret=o.secret,this.secret_desc=o.secret_desc,this.visibility_id=o.visibility_id,this.visibility=o.visibility?new h(o.visibility):void 0,this.parent=o.parent?new l(o.parent):void 0,this.children=o.children?o.children.map(m=>new l(m)):[],this.images=o.images?o.images.map(m=>new t.W(m)):[],this.translations=o.translations,this.public_visible=o.public_visible,this.stats=o.stats}}},355:(M,u,i)=>{i.d(u,{E:()=>t});var s=i(8400),h=i(2264);class t extends s.w{constructor(a){super(a),this.name=a.name,this.description=a.description,this.status=a.status,this.other=a.other,this.translations={...a.translations},this.color=a.color,a.image&&(this.image=new h.W(a.image))}}},9088:(M,u,i)=>{i.d(u,{S:()=>t});var s=i(4496);const h={menuCategory:{show:"/admin/menu/{itemId}",duplicate:"/admin/menu/{itemId}/duplicate",export:"/admin/menu/{itemId}/export",createChild:"/admin/menu/{itemId}/create-category",linkCategory:"/admin/menu/{itemId}/link-category",createDish:"/admin/menu/{itemId}/create-dish",linkDish:"/admin/menu/{itemId}/link-dish",private:"/menu/{itemId}",public:"/menu/{itemId}"},dish:{show:"/admin/menu/{categoryId}/dish/{itemId}"}};let t=(()=>{class l{transform(o,m){const e=h[m.split(".")[0]];if(!e)throw new Error(`Resource not found: ${m} (resouce: ${m.split(".")[0]})`);const n=m.split(".")[1];if(!e[n])throw new Error(`Action not found: ${m} (action: ${n})`);if(typeof o>"u"||null===o)return null;if("number"==typeof o&&(o=o.toString()),"object"==typeof o&&null!==o&&!Array.isArray(o)){let r=e[n];if(Object.keys(o).forEach(p=>{const O=o[p];void 0!==O&&r.includes(`{${p}}`)&&(r=r.replace(`{${p}}`,O??""))}),r.includes("{{"))throw new Error(`Unresolved interpolation: ${r}`);return r}if("string"!=typeof o)throw new Error(`Invalid itemId: ${o} (type: ${typeof o})`);return e[n].replace("{itemId}",o)}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275pipe=s.UTH({name:"urlTo",type:l,pure:!0,standalone:!0})}return l})()},8676:(M,u,i)=>{i.d(u,{k:()=>a});var s=i(6012),h=i(5891),t=i(4704),l=i(4496);let a=(()=>{class o extends s.s{constructor(){super(h.S,"admin/menu/dishes")}bulkUpdateStatus(e){return this.patch(`bulk_status/${e.status}`,{dish_ids:e.dish_ids})}relocate(e){return this.patch("relocate",e)}updatePrices(e){return(null==e.filters||null==e.filters)&&delete e.filters,this.patch("update_prices",e)}copy(e,n){return this.post(`${e}/copy`,n).pipe((0,t.k)(r=>this.mapItem(r)))}move(e,n){return this.patch(`${e}/move`,n).pipe((0,t.k)(r=>this.mapItem(r)))}moveIngredient(e,n,r){return this.patch(`${e}/ingredients/${n}/move`,{to_index:r}).pipe((0,t.k)(p=>this.mapItem(p)))}moveTag(e,n,r){return this.patch(`${e}/tags/${n}/move`,{to_index:r}).pipe((0,t.k)(p=>this.mapItem(p)))}moveAllergen(e,n,r){return this.patch(`${e}/allergens/${n}/move`,{to_index:r}).pipe((0,t.k)(p=>this.mapItem(p)))}updateStatus(e,n){return this.patch(`${e}/status/${n}`,{}).pipe((0,t.k)(r=>this.mapItem(r)))}addIngredient(e,n){return this.post(`${e}/ingredients/${n}`,{}).pipe((0,t.k)(r=>this.mapItem(r)))}removeIngredient(e,n){return this.delete(`${e}/ingredients/${n}`).pipe((0,t.k)(r=>this.mapItem(r)))}addTag(e,n){return this.post(`${e}/tags/${n}`,{}).pipe((0,t.k)(r=>this.mapItem(r)))}removeTag(e,n){return this.delete(`${e}/tags/${n}`).pipe((0,t.k)(r=>this.mapItem(r)))}addAllergen(e,n){return this.post(`${e}/allergens/${n}`,{}).pipe((0,t.k)(r=>this.mapItem(r)))}removeAllergen(e,n){return this.delete(`${e}/allergens/${n}`).pipe((0,t.k)(r=>this.mapItem(r)))}references(e){return this.get(`${e}/references`).pipe((0,t.k)(n=>n))}addSuggestion(e,n){return this.post(`${e}/suggestions/${n}`,{}).pipe((0,t.k)(r=>this.mapItem(r)))}removeSuggestion(e,n){return this.delete(`${e}/suggestions/${n}`).pipe((0,t.k)(r=>this.mapItem(r)))}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275prov=l.wxM({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})()},1712:(M,u,i)=>{i.d(u,{S:()=>a});var s=i(6012),h=i(5820),t=i(4704),l=i(4496);let a=(()=>{class o extends s.s{constructor(){super(h.Q,"admin/menu/categories")}addCategory(e,n,r={}){return this.post(`${e}/add_category/${n}`,r)}addDish(e,n){return this.post(`${e}/dishes/${n}`,{})}removeDish(e,n){return this.delete(`${e}/dishes/${n}`,{})}orderDishes(e,n){return this.patch(`${e}/order_dishes`,{field:n})}dashboardData(e){return this.get(`${e}/dashboard_data`)}updateVisibility(e,n){return this.patch(`${e}/visibility`,n).pipe((0,t.k)(r=>this.mapItem(r)))}copy(e,n){return this.post(`${e}/copy`,n).pipe((0,t.k)(r=>this.mapItem(r)))}move(e,n){return this.patch(`${e}/move/${n}`,{}).pipe((0,t.k)(r=>this.mapItem(r)))}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275prov=l.wxM({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})()},1512:(M,u,i)=>{i.d(u,{C:()=>P,w:()=>$});var s=i(4496),h=i(900),t=i(4392),l=i(4164),a=i(3480),o=i(4680),m=i(3972),e=i(5944),n=i(3412),r=i(4704),p=i(3656),O=i(1368);const A=["tuiLink",""];function S(d,f){if(1&d&&s.wR5(0,"tui-svg",3),2&d){const g=s.GaO();s.E7m("src",g.icon||"")}}function y(d,f){if(1&d&&s.wR5(0,"tui-svg",4),2&d){const g=s.GaO();s.E7m("src",g.icon||"")}}const D=["*"];let P=(()=>{class d{constructor(g,C,T){this.el=g,this.mode$=C,this.pseudo=!1,this.icon="",this.iconAlign="right",this.iconRotated=!1,this.mode=null,this.focusVisible=!1,this.focusedChange=(0,n.U)((0,h.Ax)(this.el.nativeElement,"focusin").pipe((0,r.k)(t.Ml)),(0,h.Ax)(this.el.nativeElement,"focusout").pipe((0,r.k)(t.so))),T.subscribe(v=>{this.focusVisible=v})}get nativeFocusableElement(){return this.el.nativeElement}get focused(){return(0,l.ER)(this.nativeFocusableElement)}get hasIcon(){return!!this.icon}get iconAlignLeft(){return this.hasIcon&&"left"===this.iconAlign}get iconAlignRight(){return this.hasIcon&&"right"===this.iconAlign}}return d.\u0275fac=function(g){return new(g||d)(s.GI1(s.GMv),s.GI1(e.Yx),s.GI1(a.MF))},d.\u0275cmp=s.In1({type:d,selectors:[["a","tuiLink",""],["button","tuiLink",""]],hostVars:7,hostBindings:function(g,C){1&g&&s.qCj("$.data-mode.attr",function(){return C.mode$}),2&g&&(s.e48("data-host-mode",C.mode),s.eAK("_pseudo",C.pseudo)("_icon-rotated",C.iconRotated)("_focus-visible",C.focusVisible))},inputs:{pseudo:"pseudo",icon:"icon",iconAlign:"iconAlign",iconRotated:"iconRotated",mode:"mode"},exportAs:["tuiLink"],features:[s.M5G([(0,o.NK)(d),a.MF,a.UF,m.Ir])],attrs:A,ngContentSelectors:D,decls:4,vars:2,consts:[["class","t-icon t-icon_left",3,"src",4,"ngIf"],[1,"t-content"],["class","t-icon t-icon_right",3,"src",4,"ngIf"],[1,"t-icon","t-icon_left",3,"src"],[1,"t-icon","t-icon_right",3,"src"]],template:function(g,C){1&g&&(s.kPM(),s.yuY(0,S,1,1,"tui-svg",0),s.I0R(1,"span",1),s._Xx(2),s.C$Y(),s.yuY(3,y,1,1,"tui-svg",2)),2&g&&(s.E7m("ngIf",C.iconAlignLeft),s.yG2(3),s.E7m("ngIf",C.iconAlignRight))},dependencies:[p.Wu,O.u_],styles:["[_nghost-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;border:0;background:none;font-size:inherit;line-height:inherit;text-decoration:none;transition-property:color;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;color:var(--tui-link);text-align:left;text-transform:inherit;font-weight:inherit;cursor:pointer;outline:none}[_nghost-%COMP%]:hover{color:var(--tui-link-hover)}[_nghost-%COMP%]:disabled{opacity:var(--tui-disabled-opacity);cursor:default}[data-mode=onLight][_nghost-%COMP%]{color:var(--tui-text-02)}[data-mode=onLight][_nghost-%COMP%]:hover, [data-mode=onLight]._active[_nghost-%COMP%]{color:var(--tui-text-01)}[data-mode=onLight]._pseudo[_nghost-%COMP%]{color:var(--tui-text-01)}[data-mode=onLight]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(0,0,0,.48);text-decoration-color:#0000007a}[data-mode=onLight]._pseudo[_nghost-%COMP%]:hover, [data-mode=onLight]._pseudo._active[_nghost-%COMP%]{color:var(--tui-text-03)}[data-mode=onLight][data-host-mode=negative][_nghost-%COMP%]{color:var(--tui-negative-night)}[data-mode=onLight][data-host-mode=negative][_nghost-%COMP%]:hover, [data-mode=onLight][data-host-mode=negative][_nghost-%COMP%]:active, [data-mode=onLight][data-host-mode=negative]._active[_nghost-%COMP%]{color:var(--tui-negative-night-hover)}[data-mode=onDark][_nghost-%COMP%]{color:var(--tui-text-03-night)}[data-mode=onDark][_nghost-%COMP%]:hover, [data-mode=onDark][_nghost-%COMP%]:active, [data-mode=onDark]._active[_nghost-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._pseudo[_nghost-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(255,255,255,.48);text-decoration-color:#ffffff7a}[data-mode=onDark]._pseudo[_nghost-%COMP%]:hover, [data-mode=onDark]._pseudo[_nghost-%COMP%]:active, [data-mode=onDark]._pseudo._active[_nghost-%COMP%]{color:var(--tui-text-03-night)}[data-mode=onDark][data-host-mode=positive][_nghost-%COMP%]{color:var(--tui-positive-night)}[data-mode=onDark][data-host-mode=positive][_nghost-%COMP%]:hover, [data-mode=onDark][data-host-mode=positive][_nghost-%COMP%]:active, [data-mode=onDark][data-host-mode=positive]._active[_nghost-%COMP%]{color:var(--tui-positive-night-hover)}[data-host-mode=negative][_nghost-%COMP%]{color:var(--tui-negative)}[data-host-mode=negative][_nghost-%COMP%]:hover{color:var(--tui-negative-hover)}[data-host-mode=negative]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(222,76,30,.48);text-decoration-color:#de4c1e7a}[data-host-mode=positive][_nghost-%COMP%]{color:var(--tui-positive)}[data-host-mode=positive][_nghost-%COMP%]:hover{color:var(--tui-positive-hover)}[data-host-mode=positive]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(58,169,129,.48);text-decoration-color:#3aa9817a}._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-selection)}[data-mode=onLight]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-clear);color:var(--tui-text-01)}[data-mode=onDark]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-clear-inverse);color:var(--tui-text-01-night)}[data-host-mode=positive]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-success-bg)}[data-host-mode=negative]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-error-bg)}._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{padding-bottom:.15em;-webkit-text-decoration:underline dashed rgba(51,111,238,.48);text-decoration:underline dashed rgba(51,111,238,.48);text-underline-offset:.2em;text-decoration-thickness:.7px}.t-icon[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;width:var(--tui-link-icon-size, 1.5rem);height:var(--tui-link-icon-size, 1.5rem);margin-top:-.125rem}.t-icon_left[_ngcontent-%COMP%]{margin-right:.25rem}.t-icon_right[_ngcontent-%COMP%]{margin-left:.25rem}._icon-rotated[_nghost-%COMP%]   .t-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}"],changeDetection:0}),d})(),$=(()=>{class d{}return d.\u0275fac=function(g){return new(g||d)},d.\u0275mod=s.a4G({type:d}),d.\u0275inj=s.s3X({imports:[[O.MD,p.Yt]]}),d})()}}]);