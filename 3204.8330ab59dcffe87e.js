(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[3204],{40864:(I,c,n)=>{"use strict";n.r(c),n.d(c,{LinkDishModule:()=>K});var l=n(31236),m=n(7552),t=n(54496),a=n(64436),r=n(58212),i=n(41512),u=n(6504),e=n(6096),s=n(11712),o=n(83480),g=n(1128),O=n(53616),v=n(54704),$=n(74e3),T=n(68824),D=n(38256),R=n(49088),E=n(35184);function y(h,U){1&h&&(t.I0R(0,"p"),t.aS0(1,10),t.C$Y(),t.I0R(2,"p"),t.aS0(3,11),t.C$Y())}const A=h=>({except_in_category:h});function P(h,U){if(1&h){const _=t.KQA();t.I0R(0,"form",12),t.qCj("ngSubmit",function(){t.usT(_);const d=t.GaO();return t.CGJ(d.submit())}),t.I0R(1,"app-dish-select",13),t.SAx(2),t.aS0(3,14),t.k70(),t.C$Y(),t.I0R(4,"div",0)(5,"button",15),t.SAx(6),t.aS0(7,16),t.k70(),t.C$Y(),t.I0R(8,"button",17),t.qCj("click",function(){t.usT(_);const d=t.GaO();return t.CGJ(d.cancel())}),t.SAx(9),t.aS0(10,18),t.k70(),t.C$Y()()()}if(2&h){const _=t.GaO();t.E7m("formGroup",_.form),t.yG2(),t.E7m("filters",t.S45(3,A,_.categoryId))("formControlName","dish")}}let L=(()=>{class h{constructor(){this.service=(0,t.uUt)(s.S),this.destroy$=(0,t.uUt)(o.UF),this.route=(0,t.uUt)(l.gV),this.router=(0,t.uUt)(l.E5),this.notifications=(0,t.uUt)(g.E),this.loading=(0,t.OCB)(!1),this.category=(0,t.OCB)(null),this.categoryId=null,this.form=new u.WC({dish:new u.Ku(null)})}ngOnInit(){this.route.parent?.parent?.params.pipe((0,O.a)(this.destroy$),(0,v.k)(_=>_.category_id),(0,$.a)()).subscribe({next:_=>{this.categoryId=_,this.loadCategory()}})}submit(){const _=this.categoryId,p=this.form.value?.dish?.id;_&&p?this.form.invalid||(this.loading.set(!0),this.service.addDish(_,p).pipe((0,O.a)(this.destroy$),(0,T.U)(()=>this.loading.set(!1))).subscribe({next:()=>{this.navigateBack(),this.notifications.fireSnackBar(E.$localize`Piatto aggiunto.`)},error:d=>{this.notifications.error((0,D.mk)(d)||E.$localize`Qualcosa è andato storto nell'aggiunta del piatto.`)}})):console.error("something invalid.",{categoryId:_,dishId:p})}cancel(){(this.form.touched||this.form.dirty)&&!confirm(E.$localize`Sei sicuro di voler annullare questa azione?`)||this.navigateBack()}navigateBack(){const _=this.route.snapshot.queryParams.afterUrl;_?this.router.navigateByUrl(_):this.router.navigate([".."],{relativeTo:this.route})}loadCategory(){this.category.set(null),this.categoryId&&this.service.show(this.categoryId).pipe((0,O.a)(this.destroy$)).subscribe({next:_=>{this.category.set(_)},error:_=>{this.notifications.error((0,D.mk)(_)||E.$localize`Qualcosa è andato storto nel caricamento della categoria padre.`)}})}static#t=this.\u0275fac=function(p){return new(p||h)};static#e=this.\u0275cmp=t.In1({type:h,selectors:[["app-link-dish"]],standalone:!0,features:[t.M5G([o.UF]),t.UHJ],decls:15,vars:7,consts:()=>{let _,p,d,M,f,S,N;return _=E.$localize`Associa piatto esistente`,p=E.$localize`Il piatto verrà aggiunto alla categoria`,d=E.$localize`Associare un piatto esistente ti permette di tenere lo stesso identico piatto presente in più categorie.`,M=E.$localize`Il vantaggio è che quando devi apportare una modifica al piatto, lo devi fare una volta sola.`,f=E.$localize`Piatto da associare`,S=E.$localize`Conferma`,N=E.$localize`Annulla`,[[1,"flex","items-center"],[1,"me-2"],_,[3,"content"],[1,"mb-3"],[1,"me-2","text-slate-400"],p,["tuiLink","",3,"routerLink"],["helpMsg",""],[3,"formGroup"],d,M,[3,"formGroup","ngSubmit"],[1,"block","mb-3",3,"filters","formControlName"],f,["tuiButton","","type","submit","size","l","appearance","primary",1,"me-2"],S,["tuiButton","","type","button","size","l","appearance","outline",3,"click"],N]},template:function(p,d){if(1&p&&(t.I0R(0,"span",0)(1,"h1",1),t.SAx(2),t.aS0(3,2),t.k70(),t.C$Y(),t.wR5(4,"tui-tooltip",3),t.C$Y(),t.I0R(5,"div",4)(6,"span",5),t.SAx(7),t.aS0(8,6),t.k70(),t.C$Y(),t.I0R(9,"a",7),t.wVc(10,"urlTo"),t.OEk(11),t.C$Y()(),t.yuY(12,y,4,0,"ng-template",null,8,t.gJz)(14,P,11,5,"form",9)),2&p){const M=t.Gew(13);let f,S;t.yG2(4),t.E7m("content",M),t.yG2(5),t.E7m("routerLink",t.g7$(10,4,null==(f=d.category())?null:f.id,"menuCategory.show")),t.yG2(2),t.cNF(null==(S=d.category())?null:S.name),t.yG2(3),t.C0Y(14,d.categoryId?14:-1)}},dependencies:[a.a,a.i,u.sl,u.sz,u.ue,u.u,u.uW,u.Wo,e.i,r.CI,r.Kw,i.w,i.C,l.ER,R.S],changeDetection:0})}return h})(),K=(()=>{class h{static#t=this.\u0275fac=function(p){return new(p||h)};static#e=this.\u0275mod=t.a4G({type:h});static#i=this.\u0275inj=t.s3X({imports:[l.qQ.forChild([(0,m.VV)(L,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return h})()},34824:(I,c,n)=>{"use strict";n.d(c,{o:()=>t});var l=n(58400),m=n(22264);class t extends l.w{constructor(r){super(r),this.name=r.name,this.description=r.description,this.status=r.status,this.other=r.other,this.translations={...r.translations},r.image&&(this.image=new m.W(r.image))}}},28272:(I,c,n)=>{"use strict";n.d(c,{S:()=>i});var l=n(58400),m=n(22264),t=n(70355),a=n(34824),r=n(60532);class i extends l.w{constructor(e){super(e),this.name=e.name,this.description=e.description,this.status=e.status,this.price=e.price,this.translations=e.translations,this.images=e.images?e.images.map(s=>new m.W(s)):[],this.suggestions=e.suggestions?e.suggestions.map(s=>new i(s)):[],this.tags=e.tags?e.tags.map(s=>new t.E(s)):[],this.allergens=e.allergens?e.allergens.map(s=>new a.o(s)):[],this.ingredients=e.ingredients?e.ingredients.map(s=>new r.e(s)):[]}}},22264:(I,c,n)=>{"use strict";n.d(c,{W:()=>m});var l=n(58400);class m extends l.w{constructor(a){super(a),this.filename=a.filename,this.status=a.status,this.key=a.key,this.original_id=a.original_id,this.tag=a.tag,this.url=a.url}}},60532:(I,c,n)=>{"use strict";n.d(c,{e:()=>t});var l=n(58400),m=n(22264);class t extends l.w{constructor(r){super(r),this.name=r.name,this.description=r.description,this.status=r.status,this.other=r.other,this.translations={...r.translations},r.image&&(this.image=new m.W(r.image))}}},45820:(I,c,n)=>{"use strict";n.d(c,{Q:()=>a});var l=n(58400);class m extends l.w{constructor(i){super(i),this.public_visible=i.public_visible,this.public_from=i.public_from?new Date(i.public_from):void 0,this.public_to=i.public_to?new Date(i.public_to):void 0,this.private_visible=i.private_visible,this.daily_from=i.daily_from?new Date(i.daily_from):void 0,this.daily_to=i.daily_to?new Date(i.daily_to):void 0}}var t=n(22264);class a extends l.w{constructor(i){super(i),this.name=i.name,this.description=i.description,this.status=i.status,this.price=i.price,this.parent_id=i.parent_id,this.index=i.index,this.secret=i.secret,this.secret_desc=i.secret_desc,this.visibility_id=i.visibility_id,this.visibility=i.visibility?new m(i.visibility):void 0,this.parent=i.parent?new a(i.parent):void 0,this.children=i.children?i.children.map(u=>new a(u)):[],this.images=i.images?i.images.map(u=>new t.W(u)):[],this.translations=i.translations}}},70355:(I,c,n)=>{"use strict";n.d(c,{E:()=>t});var l=n(58400),m=n(22264);class t extends l.w{constructor(r){super(r),this.name=r.name,this.description=r.description,this.status=r.status,this.other=r.other,this.translations={...r.translations},this.color=r.color,r.image&&(this.image=new m.W(r.image))}}},49088:(I,c,n)=>{"use strict";n.d(c,{S:()=>t});var l=n(54496);const m={menuCategory:{show:"/admin/menu/{itemId}",duplicate:"/admin/menu/{itemId}/duplicate",export:"/admin/menu/{itemId}/export",createChild:"/admin/menu/{itemId}/create-category",linkCategory:"/admin/menu/{itemId}/link-category",createDish:"/admin/menu/{itemId}/create-dish",linkDish:"/admin/menu/{itemId}/link-dish",private:"/menu/{itemId}",public:"/menu/{itemId}"},dish:{show:"/admin/menu/{categoryId}/dish/{itemId}"}};let t=(()=>{class a{transform(i,u){const e=m[u.split(".")[0]];if(!e)throw new Error(`Resource not found: ${u} (resouce: ${u.split(".")[0]})`);const s=u.split(".")[1];if(!e[s])throw new Error(`Action not found: ${u} (action: ${s})`);if(typeof i>"u"||null===i)return null;if("number"==typeof i&&(i=i.toString()),"object"==typeof i&&null!==i&&!Array.isArray(i)){let o=e[s];if(Object.keys(i).forEach(g=>{const O=i[g];void 0!==O&&o.includes(`{${g}}`)&&(o=o.replace(`{${g}}`,O??""))}),o.includes("{{"))throw new Error(`Unresolved interpolation: ${o}`);return o}if("string"!=typeof i)throw new Error(`Invalid itemId: ${i} (type: ${typeof i})`);return e[s].replace("{itemId}",i)}static#t=this.\u0275fac=function(u){return new(u||a)};static#e=this.\u0275pipe=l.UTH({name:"urlTo",type:a,pure:!0,standalone:!0})}return a})()},38676:(I,c,n)=>{"use strict";n.d(c,{k:()=>r});var l=n(36012),m=n(28272),t=n(54704),a=n(54496);let r=(()=>{class i extends l.s{constructor(){super(m.S,"admin/menu/dishes")}copy(e,s){return this.post(`${e}/copy`,s).pipe((0,t.k)(o=>this.mapItem(o)))}move(e,s){return this.patch(`${e}/move`,s).pipe((0,t.k)(o=>this.mapItem(o)))}moveIngredient(e,s,o){return this.patch(`${e}/ingredients/${s}/move`,{to_index:o}).pipe((0,t.k)(g=>this.mapItem(g)))}moveTag(e,s,o){return this.patch(`${e}/tags/${s}/move`,{to_index:o}).pipe((0,t.k)(g=>this.mapItem(g)))}moveAllergen(e,s,o){return this.patch(`${e}/allergens/${s}/move`,{to_index:o}).pipe((0,t.k)(g=>this.mapItem(g)))}updateStatus(e,s){return this.patch(`${e}/status/${s}`,{}).pipe((0,t.k)(o=>this.mapItem(o)))}addIngredient(e,s){return this.post(`${e}/ingredients/${s}`,{}).pipe((0,t.k)(o=>this.mapItem(o)))}removeIngredient(e,s){return this.delete(`${e}/ingredients/${s}`).pipe((0,t.k)(o=>this.mapItem(o)))}addTag(e,s){return this.post(`${e}/tags/${s}`,{}).pipe((0,t.k)(o=>this.mapItem(o)))}removeTag(e,s){return this.delete(`${e}/tags/${s}`).pipe((0,t.k)(o=>this.mapItem(o)))}addAllergen(e,s){return this.post(`${e}/allergens/${s}`,{}).pipe((0,t.k)(o=>this.mapItem(o)))}removeAllergen(e,s){return this.delete(`${e}/allergens/${s}`).pipe((0,t.k)(o=>this.mapItem(o)))}references(e){return this.get(`${e}/references`).pipe((0,t.k)(s=>s))}addSuggestion(e,s){return this.post(`${e}/suggestions/${s}`,{}).pipe((0,t.k)(o=>this.mapItem(o)))}removeSuggestion(e,s){return this.delete(`${e}/suggestions/${s}`).pipe((0,t.k)(o=>this.mapItem(o)))}static#t=this.\u0275fac=function(s){return new(s||i)};static#e=this.\u0275prov=a.wxM({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},11712:(I,c,n)=>{"use strict";n.d(c,{S:()=>r});var l=n(36012),m=n(45820),t=n(54704),a=n(54496);let r=(()=>{class i extends l.s{constructor(){super(m.Q,"admin/menu/categories")}addCategory(e,s,o={}){return this.post(`${e}/add_category/${s}`,o)}addDish(e,s){return this.post(`${e}/dishes/${s}`,{})}removeDish(e,s){return this.delete(`${e}/dishes/${s}`,{})}orderDishes(e,s){return this.patch(`${e}/order_dishes`,{field:s})}dashboardData(e){return this.get(`${e}/dashboard_data`)}updateVisibility(e,s){return this.patch(`${e}/visibility`,s).pipe((0,t.k)(o=>this.mapItem(o)))}copy(e,s){return this.post(`${e}/copy`,s).pipe((0,t.k)(o=>this.mapItem(o)))}move(e,s){return this.patch(`${e}/move/${s}`,{}).pipe((0,t.k)(o=>this.mapItem(o)))}static#t=this.\u0275fac=function(s){return new(s||i)};static#e=this.\u0275prov=a.wxM({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},35184:()=>{}}]);