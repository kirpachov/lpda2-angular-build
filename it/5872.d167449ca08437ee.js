"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[5872],{2192:(O,M,t)=>{t.d(M,{c:()=>B});var e=t(4496),E=t(1128),a=t(3480),g=t(7692),d=t(8212),s=t(1920),u=t(6504),i=t(1560),S=t(964),c=t(6380),p=t(9956),N=t(1368),D=t(5136),$=t(2516),R=t(7556),h=t(6732),n=t(466),l=t(5193),m=t(1673),T=t(6528),v=t(3616),C=t(8824),P=t(4704),G=t(9144),b=t(2700);const L=(f,y)=>y.id;function V(f,y){if(1&f){const o=e.KQA();e.I0R(0,"div",7)(1,"tui-checkbox-block",8),e.qCj("ngModelChange",function(){e.usT(o);const r=e.GaO().$implicit,A=e.GaO(2);return e.CGJ(A.triggerSelection(r.id))}),e.OEk(2),e.C$Y()()}if(2&f){const o=e.GaO().$implicit,_=e.GaO(2);e.yG2(),e.E7m("readOnly",_.disabled())("ngModel",_.selections().includes(o.id)),e.yG2(),e.oRS(" ",o.name," ")}}function K(f,y){1&f&&e.yuY(0,V,3,3,"div",6),2&f&&e.C0Y(0,y.$implicit.id?0:-1)}function x(f,y){if(1&f&&(e.I0R(0,"tr",2)(1,"td",3)(2,"p",4),e.OEk(3),e.wVc(4,"weekday"),e.C$Y()(),e.I0R(5,"td",3)(6,"div",5),e.c53(7,K,1,1,null,null,L),e.C$Y()()()),2&f){const o=y.$implicit,_=e.GaO();e.yG2(3),e.cNF(e.kDX(4,1,o)),e.yG2(4),e.oho(_.turnsPerDay()[o])}}let Y=(()=>{class f{constructor(){this.turnsService=(0,e.uUt)(R.K),this.destroy$=(0,e.uUt)(a.UF),this.date=(0,e.uUt)(N.y),this.selectionsChanges=new e._w7,this.loading=(0,e.OCB)(!1),this.selections=(0,e.OCB)([]),this.disabled=(0,e.OCB)(!1),this.allTurns=(0,e.OCB)([]),this.turnsPerDay=(0,e.S6b)(()=>{const o=this.allTurns().filter(r=>null!=r.weekday),_={};for(const r of o){if(null==r.weekday||null==r.weekday)throw new Error("Turns must have a weekday");_[r.weekday]||=[],_[r.weekday].push(r)}return _}),this.weekdays=(0,e.S6b)(()=>Object.keys(this.turnsPerDay()).map(Number))}ngOnInit(){this.searchTurns()}writeValue(o){Array.isArray(o)||(o=[o]),o=o.filter(r=>null!=r&&null!=r);const _=[];o.forEach(r=>{r instanceof D.e&&r.id?_.push(r.id):"number"==typeof r?_.push(r):"object"==typeof r&&null!=r&&Object.keys(r).includes("id")&&"number"==typeof r.id?_.push(r.id):console.warn("invalid object provided to SelectTurnsComponent",o)}),this.selections.set(_)}registerOnChange(o){this.selectionsChanges.subscribe(o)}registerOnTouched(o){this.selectionsChanges.subscribe(o)}setDisabledState(o){this.disabled.set(o)}triggerSelection(o){this.selections.update(_=>{const r=_.indexOf(o);return-1!=r?_.splice(r,1):_.push(o),_}),this.emitChanges()}searchTurns(){this.loading.set(!0),this.turnsService.search({per_page:1e3}).pipe((0,v.a)(this.destroy$),(0,C.U)(()=>this.loading.set(!1)),(0,P.k)(o=>o.items),(0,G.a)(o=>(console.error(o),(0,b.of)([])))).subscribe({next:o=>{this.allTurns.set(o)}})}emitChanges(){this.selectionsChanges.emit(this.allTurns().filter(o=>"number"==typeof o.id&&this.selections().includes(o.id)))}static#e=this.\u0275fac=function(_){return new(_||f)};static#t=this.\u0275cmp=e.In1({type:f,selectors:[["app-select-turns"]],outputs:{selectionsChanges:"selectionsChanges"},standalone:!0,features:[e.M5G([{provide:u.Y6,multi:!0,useExisting:(0,e.wd)(()=>f)},a.UF]),e.UHJ],decls:5,vars:2,consts:[["size","xl",3,"overlay","showLoader"],[1,"tui-table"],[1,"tui-table__tr","tui-table__tr_border_none"],[1,"tui-table__td"],[1,"text-xl"],[1,"flex","flex-col"],["class","flex flex-row items-center mb-5"],[1,"flex","flex-row","items-center","mb-5"],[1,"me-1",3,"readOnly","ngModel","ngModelChange"],["class","tui-table__tr tui-table__tr_border_none"]],template:function(_,r){1&_&&(e.I0R(0,"tui-loader",0)(1,"table",1)(2,"tbody"),e.c53(3,x,9,3,"tr",9,e.oxv),e.C$Y()()()),2&_&&(e.E7m("overlay",!0)("showLoader",r.loading()),e.yG2(3),e.oho(r.weekdays()))},dependencies:[$.G,T.i,T.I,u.y,u.ue,u._G,g.Sk,g.Cb,n.GE,l.ms,m.y,d.CI,h.kR],encapsulation:2,changeDetection:0})}return f})(),B=(()=>{class f{constructor(){this.notifications=(0,e.uUt)(E.E),this.onSubmit=new e._w7,this.onCancel=new e._w7,this.loading=!1,this.submitted=(0,e.OCB)(!1),this.form=new u.WC({from_date:new u.Ku(null),to_date:new u.Ku(null),message:new u.Ku(null),turns:new u.Ku([])})}set data(o){null!=o&&null!=o?this.form.patchValue({from_date:"string"==typeof o.from_date?(0,S.yc)(o.from_date):o.from_date,to_date:"string"==typeof o.to_date?(0,S.yc)(o.to_date):o.to_date,message:o.translations?.message||{},turns:o.turns}):this.form.reset()}submitForm(){this.submitted.set(!0),!this.form.invalid&&this.onSubmit.emit(this.formatOutput())}cancelForm(){this.onCancel.emit()}formatOutput(){if(this.form.invalid)throw new Error("Form is invalid");return{from_date:this.form.value.from_date||null,to_date:this.form.value.to_date||null,translations:this.form.value.message||{},turns:this.form.value.turns??[]}}static#e=this.\u0275fac=function(_){return new(_||f)};static#t=this.\u0275cmp=e.In1({type:f,selectors:[["app-reservation-turn-message-form"]],inputs:{loading:"loading",data:"data"},outputs:{onSubmit:"onSubmit",onCancel:"onCancel"},standalone:!0,features:[e.M5G([a.UF]),e.UHJ],decls:32,vars:9,consts:()=>{let o,_,r,A,U,F,w;return o="Messaggio da mostrare",_="Visibile dal giorno",r="visibile fino al giorno",A=" Il primo e l'ultimo giorno in questione sono entrambi inclusi. Quindi, se vuoi mostrare un messaggio per un solo giorno, seleziona lo stesso giorno in entrambi i campi. ",U="Per quali turni mostrare il messaggio?",F="Conferma",w="Annulla",[[1,"block","mb-3",3,"formGroup","ngSubmit"],[1,"block","mb-3"],[3,"formControl"],o,[3,"errors"],[1,"block","mb-1"],[1,"flex","items-center"],[1,"grow","me-1"],_,[1,"grow","ms-1"],r,[1,"block","mb-3","text-slate-400"],A,[1,"text-2xl"],U,["tuiButton","","type","submit",1,"inline-block"],F,["tuiButton","","type","button","appearance","icon",1,"inline-block",3,"click"],w]},template:function(_,r){1&_&&(e.I0R(0,"form",0),e.qCj("ngSubmit",function(){return r.submitForm()}),e.I0R(1,"div",1)(2,"app-i18n-input",2),e.SAx(3),e.aS0(4,3),e.k70(),e.C$Y(),e.wR5(5,"app-errors",4),e.C$Y(),e.I0R(6,"div",5)(7,"div",6)(8,"div",7)(9,"tui-input-date",2),e.SAx(10),e.aS0(11,8),e.k70(),e.C$Y(),e.wR5(12,"app-errors",4),e.C$Y(),e.I0R(13,"div",9)(14,"tui-input-date",2),e.SAx(15),e.aS0(16,10),e.k70(),e.C$Y(),e.wR5(17,"app-errors",4),e.C$Y()()(),e.I0R(18,"span",11),e.aS0(19,12),e.C$Y(),e.I0R(20,"div",1)(21,"h3",13),e.aS0(22,14),e.C$Y(),e.wR5(23,"app-select-turns",2)(24,"app-errors",4),e.C$Y(),e.I0R(25,"div",1)(26,"button",15),e.SAx(27),e.aS0(28,16),e.k70(),e.C$Y(),e.I0R(29,"button",17),e.qCj("click",function(){return r.cancelForm()}),e.SAx(30),e.aS0(31,18),e.k70(),e.C$Y()()()),2&_&&(e.E7m("formGroup",r.form),e.yG2(2),e.E7m("formControl",r.form.controls.message),e.yG2(3),e.E7m("errors",r.form.controls.message.errors),e.yG2(4),e.E7m("formControl",r.form.controls.from_date),e.yG2(3),e.E7m("errors",r.form.controls.from_date.errors),e.yG2(2),e.E7m("formControl",r.form.controls.to_date),e.yG2(3),e.E7m("errors",r.form.controls.to_date.errors),e.yG2(6),e.E7m("formControl",r.form.controls.turns),e.yG2(),e.E7m("errors",r.form.controls.turns.errors))},dependencies:[g.Sk,s.w,u.y,u.sz,u.ue,u.u,i.oB,d.CI,d.Kw,u.sl,u.ug,u.uW,c.iO,c.yc,c.Ml,p.g,Y],encapsulation:2,changeDetection:0})}return f})()},964:(O,M,t)=>{t.d(M,{Ez:()=>c,In:()=>$,Q1:()=>h,Q9:()=>D,Qx:()=>g,_0:()=>R,cr:()=>u,yc:()=>s});var e=t(400),E=t(9772);function g(n,l){const m=new e.uc(l.hours,l.minutes).shift({hours:-E.MJ});return new Date(Date.UTC(n.year,n.month,n.day,m.hours,m.minutes)).toISOString()}function s(n){if(null==n||null==n||""==n)return null;if("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}\s{1}\d{1,2}:\d{1,2}$/)&&(n=n.split(" ")[0]),!("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}$/)))return console.error("Invalid string provided to stringToTuiDay. Expected format YYYY-MM-DD, got",{str:n}),null;const{day:l,month:m,year:T}=e.EK.parseRawDateString(n,"YMD");return new e.EK(T,m,l)}function u(n){if("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}\s{1}\d{1,2}:\d{1,2}$/)&&(n=n.split(" ")[1]),!("string"==typeof n&&n.length>0&&n.match(/^\d{1,2}:\d{1,2}$/)))return console.error("Invalid string provided to stringToTuiDay. Expected format HH:mm, got",{str:n}),null;const[l,m]=n.split(":").map(T=>Number(T));return"number"==typeof l&&l>=0&&l<=23?"number"==typeof m&&m>=0&&m<60?new e.uc(l,m):(console.error("error while parsing time in stringToTuiTime. minutes are invalid",{minutes:m}),null):(console.error("error while parsing time in stringToTuiTime. hours is invalid ",{hours:l}),null)}function c(n){return new Date(`1970-01-01 ${n.toString()}`).toISOString()}function D(n){const l=new Date(`${n}Z`);return`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")} ${String(l.getHours()).padStart(2,"0")}:${String(l.getMinutes()).padStart(2,"0")}`}function $(n){return function p(n){const l=new Date(`1970-01-01 ${n}`);return`${`${l.getUTCHours()}`.padStart(2,"0")}:${`${l.getUTCMinutes()}`.padStart(2,"0")}`}(n.toString())}function R(n){return new e.EK(n.getFullYear(),n.getMonth(),n.getDate())}function h(n){return new e.uc(n.getHours(),n.getMinutes())}},1960:(O,M,t)=>{t.d(M,{u:()=>g});var e=t(8400),E=t(5136);class a extends e.w{constructor(s){super(s),this.date=s.date?new Date(s.date):void 0,this.reservation_turn_id=s.reservation_turn_id,this.group_id=s.group_id,this.reservation_turn=s.reservation_turn?new E.e(s.reservation_turn):void 0}}class g extends e.w{constructor(s){super(s),this.turns=[],this.dates=[],this.title=s.title,this.status=s.status,this.preorder_type=s.preorder_type,this.payment_value=s.payment_value,this.min_people=s.min_people,this.message=s.message,this.turns=(s.turns||[]).map(u=>new E.e(u)),this.dates=(s.dates||[]).map(u=>new a(u)),this.translations=s.translations||{},this.table_type_to_preorder_reservation_groups=s.table_type_to_preorder_reservation_groups}}},5136:(O,M,t)=>{t.d(M,{e:()=>g});var e=t(8400),E=t(9772),a=t(1960);class g extends e.w{constructor(s){super(s),this.messages=[],this.name=s.name,this.weekday=s.weekday,this.step=s.step,this.valid_times=s.valid_times,this.starts_at=s.starts_at?(0,E.CU)(s.starts_at):void 0,this.ends_at=s.ends_at?(0,E.CU)(s.ends_at):void 0,this.preorder_reservation_group=s.preorder_reservation_group?new a.u(s.preorder_reservation_group):void 0,this.messages=s.messages}}},2516:(O,M,t)=>{t.d(M,{G:()=>E});var e=t(4496);let E=(()=>{class a{constructor(){this.weekdays=["Domenica","Luned\xEC","Marted\xEC","Mercoled\xEC","Gioved\xEC","Venerd\xEC","Sabato"]}transform(d){return"number"!=typeof d&&"string"==typeof d&&(d=parseInt(d)),"number"==typeof d&&d>=0&&d<=6?this.weekdays[d]:null}static#e=this.\u0275fac=function(s){return new(s||a)};static#t=this.\u0275pipe=e.UTH({name:"weekday",type:a,pure:!0,standalone:!0})}return a})()},1260:(O,M,t)=>{t.d(M,{U:()=>s});var e=t(6012),E=t(8400),a=t(5136);class g extends E.w{constructor(i){super(i),this.message=i.message,this.from_date=i.from_date,this.to_date=i.to_date,this.translations=i.translations,this.turns=i.turns?i.turns.map(S=>new a.e(S)):[]}}var d=t(4496);let s=(()=>{class u extends e.s{constructor(){super(g,"admin/reservation_turn_messages")}create(S){return super.create(S)}update(S,c){return super.update(S,c)}static#e=this.\u0275fac=function(c){return new(c||u)};static#t=this.\u0275prov=d.wxM({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()},7556:(O,M,t)=>{t.d(M,{K:()=>g});var e=t(6012),E=t(5136),a=t(4496);let g=(()=>{class d extends e.s{constructor(){super(E.e,"admin/reservation_turns")}static#e=this.\u0275fac=function(i){return new(i||d)};static#t=this.\u0275prov=a.wxM({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},1200:(O,M,t)=>{t.d(M,{A:()=>s,m:()=>u});var e=t(4496),E=t(900),a=t(3480),g=t(800),d=t(3616);let s=(()=>{class i{constructor(c,p,N){this.el=c,this.zone=p,this.destroy$=N,this.eventName=""}ngOnInit(){(0,g.w)(this.el.nativeElement,this.eventName,{passive:!1}).pipe((0,E.Uv)(this.zone),(0,E.uy)(),(0,d.a)(this.destroy$)).subscribe()}}return i.\u0275fac=function(c){return new(c||i)(e.GI1(e.GMv),e.GI1(e.WW2),e.GI1(a.UF,2))},i.\u0275dir=e.Sc5({type:i,selectors:[["","tuiPreventDefault",""]],inputs:{eventName:[e.Wk5.None,"tuiPreventDefault","eventName"]},features:[e.M5G([a.UF])]}),i})(),u=(()=>{class i{}return i.\u0275fac=function(c){return new(c||i)},i.\u0275mod=e.a4G({type:i}),i.\u0275inj=e.s3X({}),i})()},6988:(O,M,t)=>{t.d(M,{E:()=>s,Q:()=>u});var e=t(4496),E=t(3480),a=t(3840),g=t(3120),d=t(3616);let s=(()=>{class i{constructor(c,p){this.el=c,this.destroy$=p}set tuiScrollIntoView(c){c&&(0,g.k)(0).pipe((0,d.a)(this.destroy$)).subscribe(()=>{this.el.nativeElement.dispatchEvent(new CustomEvent(a.dG,{bubbles:!0,detail:this.el.nativeElement}))})}}return i.\u0275fac=function(c){return new(c||i)(e.GI1(e.GMv),e.GI1(E.UF,2))},i.\u0275dir=e.Sc5({type:i,selectors:[["","tuiScrollIntoView",""]],inputs:{tuiScrollIntoView:"tuiScrollIntoView"},features:[e.M5G([E.UF])]}),i})(),u=(()=>{class i{}return i.\u0275fac=function(c){return new(c||i)},i.\u0275mod=e.a4G({type:i}),i.\u0275inj=e.s3X({}),i})()},812:(O,M,t)=>{t.d(M,{m2:()=>N,mU:()=>i,qS:()=>g,w3:()=>D}),t(4392);var E=t(2528);t(3840);const g={DMY:"dd/mm/yyyy",MDY:"mm/dd/yyyy",YMD:"yyyy/mm/dd"},i=/\([#]+\)|[#\- ]/g,N=(R,h,n,l)=>{if(!h?.isSingleDay||!n)return R;const m=(0,E.Kw)(Object.entries(n).map(([v,C])=>[v,-C])),T=h.from.append(l?m:n).append({day:l?1:-1});return l?T.dayBefore(R)?R:T:R&&T.dayAfter(R)?R:T},D={HH:23,MM:59,SS:59,MS:999}}}]);