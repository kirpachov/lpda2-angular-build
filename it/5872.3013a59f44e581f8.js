"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[5872],{1920:(R,f,t)=>{t.d(f,{w:()=>n});var e=t(4496),d=t(6504),l=t(3480),M=t(6700),_=t(3616),i=t(6684),c=t(3797),a=t(8588),O=t(1368),g=t(9956),C=t(1292);function y(r,T){if(1&r&&(e.I0R(0,"tui-textarea",2),e.OEk(1),e.C$Y()),2&r){const s=e.GaO().$implicit,E=e.GaO();e.E7m("formControl",s.control),e.yG2(),e.oRS(" ",E.getFullLang(s.lang)," ")}}function I(r,T){if(1&r&&(e.I0R(0,"tui-input",2),e.OEk(1),e.C$Y()),2&r){const s=e.GaO().$implicit,E=e.GaO();e.E7m("formControl",s.control),e.yG2(),e.oRS(" ",E.getFullLang(s.lang)," ")}}const A=r=>({"mb-3":r});function p(r,T){if(1&r&&(e.SAx(0),e.I0R(1,"div",1),e.yuY(2,y,2,2,"tui-textarea",2)(3,I,2,2),e.wR5(4,"app-errors",3),e.C$Y(),e.k70()),2&r){const s=T.$implicit,E=T.last,h=e.GaO();e.yG2(),e.E7m("ngClass",e.S45(3,A,!E)),e.yG2(),e.C0Y(2,h.long?2:3),e.yG2(2),e.E7m("errors",s.control.errors)}}const v=["*"];let n=(()=>{class r{constructor(){this.destroy$=new l.UF,this.long=!1,this.controls=(0,e.OCB)({}),this.controlsArr=(0,e.S6b)(()=>{const s=this.controls();return Object.keys(s).map(E=>({lang:E,control:s[E]}))}),this.touched$=new M.g(!1),this.value$=new M.g({})}ngAfterViewInit(){this.addLang("it"),this.addLang("en")}ngOnInit(){}registerOnChange(s){this.value$.pipe((0,_.a)(this.destroy$)).subscribe({next:E=>s(E)})}registerOnTouched(s){this.touched$.pipe((0,i.I)(E=>!0===E)).subscribe({next:()=>s()})}writeValue(s){this.patchValue(s??{}),this.touched$.next(!1)}wasTouched(){this.touched$.next(!0)}getFullLang(s){return C.S[s]??s}controlChanged(s){this.value$.next({...this.value$.value,[s]:this.controls()[s].value})}patchValue(s){Object.keys(s).forEach(E=>this.addLang(E)),Object.keys(this.controls()).forEach(E=>{this.controls()[E].patchValue(s[E]??null)})}addLang(s){if(this.controls()[s])return;const E=new d.Ku;E.valueChanges.subscribe({next:()=>this.controlChanged(s)}),this.controls.set({...this.controls(),[s]:E})}static#e=this.\u0275fac=function(E){return new(E||r)};static#t=this.\u0275cmp=e.In1({type:r,selectors:[["app-i18n-input"]],inputs:{long:"long"},standalone:!0,features:[e.M5G([{provide:d.Y6,useExisting:(0,e.wd)(()=>r),multi:!0},l.UF]),e.UHJ],ngContentSelectors:v,decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"ngClass"],[3,"formControl"],[3,"errors"]],template:function(E,h){1&E&&(e.kPM(),e._Xx(0),e.yuY(1,p,5,5,"ng-container",0)),2&E&&(e.yG2(),e.E7m("ngForOf",h.controlsArr()))},dependencies:[d.sl,d.ue,d.ug,c.CQ,c.Oo,c.cP,O.Iw,g.g,O.QF,a.Y3,a.wp,a.kd],changeDetection:0})}return r})()},2192:(R,f,t)=>{t.d(f,{c:()=>B});var e=t(4496),d=t(1128),l=t(3480),M=t(7692),_=t(8212),i=t(1920),c=t(6504),a=t(1560),O=t(964),g=t(6380),C=t(9956),y=t(1368),I=t(7516),A=t(2516),p=t(7556),v=t(6732),n=t(466),r=t(5193),T=t(1673),s=t(6528),E=t(3616),h=t(8824),$=t(4704),U=t(9144),w=t(2700);const b=(S,N)=>N.id;function x(S,N){if(1&S){const o=e.KQA();e.I0R(0,"div",7)(1,"tui-checkbox-block",8),e.qCj("ngModelChange",function(){e.usT(o);const u=e.GaO().$implicit,D=e.GaO(2);return e.CGJ(D.triggerSelection(u.id))}),e.OEk(2),e.C$Y()()}if(2&S){const o=e.GaO().$implicit,m=e.GaO(2);e.yG2(),e.E7m("readOnly",m.disabled())("ngModel",m.selections().includes(o.id)),e.yG2(),e.oRS(" ",o.name," ")}}function K(S,N){1&S&&e.yuY(0,x,3,3,"div",6),2&S&&e.C0Y(0,N.$implicit.id?0:-1)}function V(S,N){if(1&S&&(e.I0R(0,"tr",2)(1,"td",3)(2,"p",4),e.OEk(3),e.wVc(4,"weekday"),e.C$Y()(),e.I0R(5,"td",3)(6,"div",5),e.c53(7,K,1,1,null,null,b),e.C$Y()()()),2&S){const o=N.$implicit,m=e.GaO();e.yG2(3),e.cNF(e.kDX(4,1,o)),e.yG2(4),e.oho(m.turnsPerDay()[o])}}let z=(()=>{class S{constructor(){this.turnsService=(0,e.uUt)(p.K),this.destroy$=(0,e.uUt)(l.UF),this.date=(0,e.uUt)(y.y),this.selectionsChanges=new e._w7,this.loading=(0,e.OCB)(!1),this.selections=(0,e.OCB)([]),this.disabled=(0,e.OCB)(!1),this.allTurns=(0,e.OCB)([]),this.turnsPerDay=(0,e.S6b)(()=>{const o=this.allTurns().filter(u=>null!=u.weekday),m={};for(const u of o){if(null==u.weekday||null==u.weekday)throw new Error("Turns must have a weekday");m[u.weekday]||=[],m[u.weekday].push(u)}return m}),this.weekdays=(0,e.S6b)(()=>Object.keys(this.turnsPerDay()).map(Number))}ngOnInit(){this.searchTurns()}writeValue(o){Array.isArray(o)||(o=[o]),o=o.filter(u=>null!=u&&null!=u);const m=[];o.forEach(u=>{u instanceof I.e&&u.id?m.push(u.id):"number"==typeof u?m.push(u):"object"==typeof u&&null!=u&&Object.keys(u).includes("id")&&"number"==typeof u.id?m.push(u.id):console.warn("invalid object provided to SelectTurnsComponent",o)}),this.selections.set(m)}registerOnChange(o){this.selectionsChanges.subscribe(o)}registerOnTouched(o){this.selectionsChanges.subscribe(o)}setDisabledState(o){this.disabled.set(o)}triggerSelection(o){this.selections.update(m=>{const u=m.indexOf(o);return-1!=u?m.splice(u,1):m.push(o),m}),this.emitChanges()}searchTurns(){this.loading.set(!0),this.turnsService.search({per_page:1e3}).pipe((0,E.a)(this.destroy$),(0,h.U)(()=>this.loading.set(!1)),(0,$.k)(o=>o.items),(0,U.a)(o=>(console.error(o),(0,w.of)([])))).subscribe({next:o=>{this.allTurns.set(o)}})}emitChanges(){this.selectionsChanges.emit(this.allTurns().filter(o=>"number"==typeof o.id&&this.selections().includes(o.id)))}static#e=this.\u0275fac=function(m){return new(m||S)};static#t=this.\u0275cmp=e.In1({type:S,selectors:[["app-select-turns"]],outputs:{selectionsChanges:"selectionsChanges"},standalone:!0,features:[e.M5G([{provide:c.Y6,multi:!0,useExisting:(0,e.wd)(()=>S)},l.UF]),e.UHJ],decls:5,vars:2,consts:[["size","xl",3,"overlay","showLoader"],[1,"tui-table"],[1,"tui-table__tr","tui-table__tr_border_none"],[1,"tui-table__td"],[1,"text-xl"],[1,"flex","flex-col"],["class","flex flex-row items-center mb-5"],[1,"flex","flex-row","items-center","mb-5"],[1,"me-1",3,"readOnly","ngModel","ngModelChange"],["class","tui-table__tr tui-table__tr_border_none"]],template:function(m,u){1&m&&(e.I0R(0,"tui-loader",0)(1,"table",1)(2,"tbody"),e.c53(3,V,9,3,"tr",9,e.oxv),e.C$Y()()()),2&m&&(e.E7m("overlay",!0)("showLoader",u.loading()),e.yG2(3),e.oho(u.weekdays()))},dependencies:[A.G,s.i,s.I,c.y,c.ue,c._G,M.Sk,M.Cb,n.GE,r.ms,T.y,_.CI,v.kR],encapsulation:2,changeDetection:0})}return S})(),B=(()=>{class S{constructor(){this.notifications=(0,e.uUt)(d.E),this.onSubmit=new e._w7,this.onCancel=new e._w7,this.loading=!1,this.submitted=(0,e.OCB)(!1),this.form=new c.WC({from_date:new c.Ku(null),to_date:new c.Ku(null),message:new c.Ku(null),turns:new c.Ku([])})}set data(o){null!=o&&null!=o?this.form.patchValue({from_date:"string"==typeof o.from_date?(0,O.yc)(o.from_date):o.from_date,to_date:"string"==typeof o.to_date?(0,O.yc)(o.to_date):o.to_date,message:o.translations?.message||{},turns:o.turns}):this.form.reset()}submitForm(){this.submitted.set(!0),!this.form.invalid&&this.onSubmit.emit(this.formatOutput())}cancelForm(){this.onCancel.emit()}formatOutput(){if(this.form.invalid)throw new Error("Form is invalid");return{from_date:this.form.value.from_date||null,to_date:this.form.value.to_date||null,translations:this.form.value.message||{},turns:this.form.value.turns??[]}}static#e=this.\u0275fac=function(m){return new(m||S)};static#t=this.\u0275cmp=e.In1({type:S,selectors:[["app-reservation-turn-message-form"]],inputs:{loading:"loading",data:"data"},outputs:{onSubmit:"onSubmit",onCancel:"onCancel"},standalone:!0,features:[e.M5G([l.UF]),e.UHJ],decls:32,vars:9,consts:()=>{let o,m,u,D,G,F,L;return o="Messaggio da mostrare",m="Visibile dal giorno",u="visibile fino al giorno",D=" Il primo e l'ultimo giorno in questione sono entrambi inclusi. Quindi, se vuoi mostrare un messaggio per un solo giorno, seleziona lo stesso giorno in entrambi i campi. ",G="Per quali turni mostrare il messaggio?",F="Conferma",L="Annulla",[[1,"block","mb-3",3,"formGroup","ngSubmit"],[1,"block","mb-3"],[3,"formControl"],o,[3,"errors"],[1,"block","mb-1"],[1,"flex","items-center"],[1,"grow","me-1"],m,[1,"grow","ms-1"],u,[1,"block","mb-3","text-slate-400"],D,[1,"text-2xl"],G,["tuiButton","","type","submit",1,"inline-block"],F,["tuiButton","","type","button","appearance","icon",1,"inline-block",3,"click"],L]},template:function(m,u){1&m&&(e.I0R(0,"form",0),e.qCj("ngSubmit",function(){return u.submitForm()}),e.I0R(1,"div",1)(2,"app-i18n-input",2),e.SAx(3),e.aS0(4,3),e.k70(),e.C$Y(),e.wR5(5,"app-errors",4),e.C$Y(),e.I0R(6,"div",5)(7,"div",6)(8,"div",7)(9,"tui-input-date",2),e.SAx(10),e.aS0(11,8),e.k70(),e.C$Y(),e.wR5(12,"app-errors",4),e.C$Y(),e.I0R(13,"div",9)(14,"tui-input-date",2),e.SAx(15),e.aS0(16,10),e.k70(),e.C$Y(),e.wR5(17,"app-errors",4),e.C$Y()()(),e.I0R(18,"span",11),e.aS0(19,12),e.C$Y(),e.I0R(20,"div",1)(21,"h3",13),e.aS0(22,14),e.C$Y(),e.wR5(23,"app-select-turns",2)(24,"app-errors",4),e.C$Y(),e.I0R(25,"div",1)(26,"button",15),e.SAx(27),e.aS0(28,16),e.k70(),e.C$Y(),e.I0R(29,"button",17),e.qCj("click",function(){return u.cancelForm()}),e.SAx(30),e.aS0(31,18),e.k70(),e.C$Y()()()),2&m&&(e.E7m("formGroup",u.form),e.yG2(2),e.E7m("formControl",u.form.controls.message),e.yG2(3),e.E7m("errors",u.form.controls.message.errors),e.yG2(4),e.E7m("formControl",u.form.controls.from_date),e.yG2(3),e.E7m("errors",u.form.controls.from_date.errors),e.yG2(2),e.E7m("formControl",u.form.controls.to_date),e.yG2(3),e.E7m("errors",u.form.controls.to_date.errors),e.yG2(6),e.E7m("formControl",u.form.controls.turns),e.yG2(),e.E7m("errors",u.form.controls.turns.errors))},dependencies:[M.Sk,i.w,c.y,c.sz,c.ue,c.u,a.oB,_.CI,_.Kw,c.sl,c.ug,c.uW,g.iO,g.yc,g.Ml,C.g,z],encapsulation:2,changeDetection:0})}return S})()},1292:(R,f,t)=>{t.d(f,{S:()=>e});const e={it:"Italiano",en:"Inglese",es:"Spagnolo",fr:"Francese",de:"Tedesco",pt:"Portoghese",ru:"Russo",zh:"Cinese",ja:"Giapponese",ar:"Arabo",hi:"Hindi",bn:"Bengalese",pa:"Punjabi",ms:"Malese"}},9772:(R,f,t)=>{t.d(f,{CU:()=>l,MJ:()=>d,ye:()=>M}),(new Date).getTimezoneOffset();const d=1;function l(_,i=d){if(!("string"==typeof _&&_.length>0&&_.match(/\d{1,2}:\d{1,2}/)))return console.error("Invalid string provided to strTimeTimezone",{string:_}),"";const a=Number(_.split(":")[0])+i;return`${a<10?"0":""}${a}:${_.split(":")[1]}`}function M(_,i=d){return l(_,-1*i)}},964:(R,f,t)=>{t.d(f,{Ez:()=>g,In:()=>A,Q1:()=>v,Q9:()=>I,QX:()=>a,Qx:()=>M,_0:()=>p,ay:()=>_,cr:()=>c,e6:()=>l,yc:()=>i});var e=t(400),d=t(9772);const l=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z$/;function M(n,r){const T=new e.uc(r.hours,r.minutes).shift({hours:-d.MJ});return new Date(Date.UTC(n.year,n.month,n.day,T.hours,T.minutes)).toISOString()}function _(n){if(!("string"==typeof n&&n.length>0&&n.match(l)))return console.error("Invalid string provided to isoStringToTuiDay",{isoString:n}),null;const r=new Date(n);return new e.EK(r.getFullYear(),r.getMonth()+1,r.getDate())}function i(n){if("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}\s{1}\d{1,2}:\d{1,2}$/)&&(n=n.split(" ")[0]),!("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}$/)))return console.error("Invalid string provided to stringToTuiDay. Expected format YYYY-MM-DD, got",{str:n}),null;const{day:r,month:T,year:s}=e.EK.parseRawDateString(n,"YMD");return new e.EK(s,T,r)}function c(n){if("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}\s{1}\d{1,2}:\d{1,2}$/)&&(n=n.split(" ")[1]),!("string"==typeof n&&n.length>0&&n.match(/^\d{1,2}:\d{1,2}$/)))return console.error("Invalid string provided to stringToTuiDay. Expected format HH:mm, got",{str:n}),null;const[r,T]=n.split(":").map(s=>Number(s));return"number"==typeof r&&r>=0&&r<=23?"number"==typeof T&&T>=0&&T<60?new e.uc(r,T):(console.error("error while parsing time in stringToTuiTime. minutes are invalid",{minutes:T}),null):(console.error("error while parsing time in stringToTuiTime. hours is invalid ",{hours:r}),null)}function a(n){if(!("string"==typeof n&&n.length>0&&n.match(l)))return console.error("Invalid string provided to isoStringToTuiTime",{isoString:n}),null;const r=new Date(n);return new e.uc(r.getHours(),r.getMinutes())}function g(n){return new Date(`1970-01-01 ${n.toString()}`).toISOString()}function I(n){const r=new Date(`${n}Z`);return`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")} ${String(r.getHours()).padStart(2,"0")}:${String(r.getMinutes()).padStart(2,"0")}`}function A(n){return function C(n){const r=new Date(`1970-01-01 ${n}`);return`${`${r.getUTCHours()}`.padStart(2,"0")}:${`${r.getUTCMinutes()}`.padStart(2,"0")}`}(n.toString())}function p(n){return new e.EK(n.getFullYear(),n.getMonth(),n.getDate())}function v(n){return new e.uc(n.getHours(),n.getMinutes())}},1960:(R,f,t)=>{t.d(f,{u:()=>M});var e=t(8400),d=t(7516);class l extends e.w{constructor(i){super(i),this.date=i.date?new Date(i.date):void 0,this.reservation_turn_id=i.reservation_turn_id,this.group_id=i.group_id,this.reservation_turn=i.reservation_turn?new d.e(i.reservation_turn):void 0}}class M extends e.w{constructor(i){super(i),this.turns=[],this.dates=[],this.title=i.title,this.status=i.status,this.preorder_type=i.preorder_type,this.payment_value=i.payment_value,this.message=i.message,this.turns=(i.turns||[]).map(c=>new d.e(c)),this.dates=(i.dates||[]).map(c=>new l(c)),this.translations=i.translations||{},this.table_type_to_preorder_reservation_groups=i.table_type_to_preorder_reservation_groups}}},7516:(R,f,t)=>{t.d(f,{e:()=>M});var e=t(8400),d=t(9772),l=t(1960);class M extends e.w{constructor(i){super(i),this.messages=[],this.name=i.name,this.weekday=i.weekday,this.step=i.step,this.valid_times=i.valid_times,this.starts_at=i.starts_at?(0,d.CU)(i.starts_at):void 0,this.ends_at=i.ends_at?(0,d.CU)(i.ends_at):void 0,this.preorder_reservation_group=i.preorder_reservation_group?new l.u(i.preorder_reservation_group):void 0,this.messages=i.messages}}},2516:(R,f,t)=>{t.d(f,{G:()=>d});var e=t(4496);let d=(()=>{class l{constructor(){this.weekdays=["Domenica","Luned\xEC","Marted\xEC","Mercoled\xEC","Gioved\xEC","Venerd\xEC","Sabato"]}transform(_){return"number"!=typeof _&&"string"==typeof _&&(_=parseInt(_)),"number"==typeof _&&_>=0&&_<=6?this.weekdays[_]:null}static#e=this.\u0275fac=function(i){return new(i||l)};static#t=this.\u0275pipe=e.UTH({name:"weekday",type:l,pure:!0,standalone:!0})}return l})()},1260:(R,f,t)=>{t.d(f,{U:()=>i});var e=t(6012),d=t(8400),l=t(7516);class M extends d.w{constructor(a){super(a),this.message=a.message,this.from_date=a.from_date,this.to_date=a.to_date,this.translations=a.translations,this.turns=a.turns?a.turns.map(O=>new l.e(O)):[]}}var _=t(4496);let i=(()=>{class c extends e.s{constructor(){super(M,"admin/reservation_turn_messages")}create(O){return super.create(O)}update(O,g){return super.update(O,g)}static#e=this.\u0275fac=function(g){return new(g||c)};static#t=this.\u0275prov=_.wxM({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},7556:(R,f,t)=>{t.d(f,{K:()=>M});var e=t(6012),d=t(7516),l=t(4496);let M=(()=>{class _ extends e.s{constructor(){super(d.e,"admin/reservation_turns")}static#e=this.\u0275fac=function(a){return new(a||_)};static#t=this.\u0275prov=l.wxM({token:_,factory:_.\u0275fac,providedIn:"root"})}return _})()},1200:(R,f,t)=>{t.d(f,{A:()=>i,m:()=>c});var e=t(4496),d=t(900),l=t(3480),M=t(800),_=t(3616);let i=(()=>{class a{constructor(g,C,y){this.el=g,this.zone=C,this.destroy$=y,this.eventName=""}ngOnInit(){(0,M.w)(this.el.nativeElement,this.eventName,{passive:!1}).pipe((0,d.Uv)(this.zone),(0,d.uy)(),(0,_.a)(this.destroy$)).subscribe()}}return a.\u0275fac=function(g){return new(g||a)(e.GI1(e.GMv),e.GI1(e.WW2),e.GI1(l.UF,2))},a.\u0275dir=e.Sc5({type:a,selectors:[["","tuiPreventDefault",""]],inputs:{eventName:[e.Wk5.None,"tuiPreventDefault","eventName"]},features:[e.M5G([l.UF])]}),a})(),c=(()=>{class a{}return a.\u0275fac=function(g){return new(g||a)},a.\u0275mod=e.a4G({type:a}),a.\u0275inj=e.s3X({}),a})()},6988:(R,f,t)=>{t.d(f,{E:()=>i,Q:()=>c});var e=t(4496),d=t(3480),l=t(3840),M=t(3120),_=t(3616);let i=(()=>{class a{constructor(g,C){this.el=g,this.destroy$=C}set tuiScrollIntoView(g){g&&(0,M.k)(0).pipe((0,_.a)(this.destroy$)).subscribe(()=>{this.el.nativeElement.dispatchEvent(new CustomEvent(l.dG,{bubbles:!0,detail:this.el.nativeElement}))})}}return a.\u0275fac=function(g){return new(g||a)(e.GI1(e.GMv),e.GI1(d.UF,2))},a.\u0275dir=e.Sc5({type:a,selectors:[["","tuiScrollIntoView",""]],inputs:{tuiScrollIntoView:"tuiScrollIntoView"},features:[e.M5G([d.UF])]}),a})(),c=(()=>{class a{}return a.\u0275fac=function(g){return new(g||a)},a.\u0275mod=e.a4G({type:a}),a.\u0275inj=e.s3X({}),a})()},812:(R,f,t)=>{t.d(f,{m2:()=>y,mU:()=>a,qS:()=>M,w3:()=>I}),t(4392);var d=t(2528);t(3840);const M={DMY:"dd/mm/yyyy",MDY:"mm/dd/yyyy",YMD:"yyyy/mm/dd"},a=/\([#]+\)|[#\- ]/g,y=(p,v,n,r)=>{if(!v?.isSingleDay||!n)return p;const T=(0,d.Kw)(Object.entries(n).map(([E,h])=>[E,-h])),s=v.from.append(r?T:n).append({day:r?1:-1});return r?s.dayBefore(p)?p:s:p&&s.dayAfter(p)?p:s},I={HH:23,MM:59,SS:59,MS:999}}}]);