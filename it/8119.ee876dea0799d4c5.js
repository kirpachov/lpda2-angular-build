"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[8119],{864:(E,c,s)=>{s.r(c),s.d(c,{LinkDishModule:()=>L});var r=s(1236),m=s(7552),t=s(4496),a=s(4436),o=s(8212),n=s(1512),u=s(6504),e=s(6832),i=s(1712),_=s(3480),h=s(1128),I=s(3616),S=s(4704),N=s(4e3),R=s(8824),f=s(8256),$=s(9088);function T(p,U){1&p&&(t.I0R(0,"p"),t.aS0(1,10),t.C$Y(),t.I0R(2,"p"),t.aS0(3,11),t.C$Y())}const P=p=>({except_in_category:p});function A(p,U){if(1&p){const l=t.KQA();t.I0R(0,"form",12),t.qCj("ngSubmit",function(){t.usT(l);const d=t.GaO();return t.CGJ(d.submit())}),t.I0R(1,"app-dish-select",13),t.SAx(2),t.aS0(3,14),t.k70(),t.C$Y(),t.I0R(4,"div",0)(5,"button",15),t.SAx(6),t.aS0(7,16),t.k70(),t.C$Y(),t.I0R(8,"button",17),t.qCj("click",function(){t.usT(l);const d=t.GaO();return t.CGJ(d.cancel())}),t.SAx(9),t.aS0(10,18),t.k70(),t.C$Y()()()}if(2&p){const l=t.GaO();t.E7m("formGroup",l.form),t.yG2(),t.E7m("filters",t.S45(3,P,l.categoryId))("formControlName","dish")}}let y=(()=>{class p{constructor(){this.service=(0,t.uUt)(i.S),this.destroy$=(0,t.uUt)(_.UF),this.route=(0,t.uUt)(r.gV),this.router=(0,t.uUt)(r.E5),this.notifications=(0,t.uUt)(h.E),this.loading=(0,t.OCB)(!1),this.category=(0,t.OCB)(null),this.categoryId=null,this.form=new u.WC({dish:new u.Ku(null)})}ngOnInit(){this.route.parent?.parent?.params.pipe((0,I.a)(this.destroy$),(0,S.k)(l=>l.category_id),(0,N.a)()).subscribe({next:l=>{this.categoryId=l,this.loadCategory()}})}submit(){const l=this.categoryId,g=this.form.value?.dish?.id;l&&g?this.form.invalid||(this.loading.set(!0),this.service.addDish(l,g).pipe((0,I.a)(this.destroy$),(0,R.U)(()=>this.loading.set(!1))).subscribe({next:()=>{this.navigateBack(),this.notifications.fireSnackBar("Piatto aggiunto.")},error:d=>{this.notifications.error((0,f.mk)(d)||"Qualcosa \xE8 andato storto nell'aggiunta del piatto.")}})):console.error("something invalid.",{categoryId:l,dishId:g})}cancel(){(this.form.touched||this.form.dirty)&&!confirm("Sei sicuro di voler annullare questa azione?")||this.navigateBack()}navigateBack(){const l=this.route.snapshot.queryParams.afterUrl;l?this.router.navigateByUrl(l):this.router.navigate([".."],{relativeTo:this.route})}loadCategory(){this.category.set(null),this.categoryId&&this.service.show(this.categoryId).pipe((0,I.a)(this.destroy$)).subscribe({next:l=>{this.category.set(l)},error:l=>{this.notifications.error((0,f.mk)(l)||"Qualcosa \xE8 andato storto nel caricamento della categoria padre.")}})}static#t=this.\u0275fac=function(g){return new(g||p)};static#e=this.\u0275cmp=t.In1({type:p,selectors:[["app-link-dish"]],standalone:!0,features:[t.M5G([_.UF]),t.UHJ],decls:15,vars:7,consts:()=>{let l,g,d,D,C,M,v;return l="Associa piatto esistente",g="Il piatto verr\xE0 aggiunto alla categoria",d="Associare un piatto esistente ti permette di tenere lo stesso identico piatto presente in pi\xF9 categorie.",D="Il vantaggio \xE8 che quando devi apportare una modifica al piatto, lo devi fare una volta sola.",C="Piatto da associare",M="Conferma",v="Annulla",[[1,"flex","items-center"],[1,"me-2"],l,[3,"content"],[1,"mb-3"],[1,"me-2","text-slate-400"],g,["tuiLink","",3,"routerLink"],["helpMsg",""],[3,"formGroup"],d,D,[3,"formGroup","ngSubmit"],[1,"block","mb-3",3,"filters","formControlName"],C,["tuiButton","","type","submit","size","l","appearance","primary",1,"me-2"],M,["tuiButton","","type","button","size","l","appearance","outline",3,"click"],v]},template:function(g,d){if(1&g&&(t.I0R(0,"span",0)(1,"h1",1),t.SAx(2),t.aS0(3,2),t.k70(),t.C$Y(),t.wR5(4,"tui-tooltip",3),t.C$Y(),t.I0R(5,"div",4)(6,"span",5),t.SAx(7),t.aS0(8,6),t.k70(),t.C$Y(),t.I0R(9,"a",7),t.wVc(10,"urlTo"),t.OEk(11),t.C$Y()(),t.yuY(12,T,4,0,"ng-template",null,8,t.gJz)(14,A,11,5,"form",9)),2&g){const D=t.Gew(13);let C,M;t.yG2(4),t.E7m("content",D),t.yG2(5),t.E7m("routerLink",t.g7$(10,4,null==(C=d.category())?null:C.id,"menuCategory.show")),t.yG2(2),t.cNF(null==(M=d.category())?null:M.name),t.yG2(3),t.C0Y(14,d.categoryId?14:-1)}},dependencies:[a.a,a.i,u.sl,u.sz,u.ue,u.u,u.uW,u.Wo,e.i,o.CI,o.Kw,n.w,n.C,r.ER,$.S],changeDetection:0})}return p})(),L=(()=>{class p{static#t=this.\u0275fac=function(g){return new(g||p)};static#e=this.\u0275mod=t.a4G({type:p});static#s=this.\u0275inj=t.s3X({imports:[r.qQ.forChild([(0,m.VV)(y,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return p})()},9052:(E,c,s)=>{s.d(c,{y:()=>e});var r=s(4496),m=s(7760),t=s(6700),a=s(7368),o=s(2700),n=s(1368);function u(i,_){if(1&i&&(r.wR5(0,"img",1),r.wVc(1,"async")),2&i){const h=r.GaO();r.uQ9("max-w-[100%] h-auto min-h-[50px] md:min-h-[100px] ",h.imgClass,""),r._6D("src",r.kDX(1,5,h.imageSrc$),r.K6U),r.E7m("draggable",!1)}}let e=(()=>{class i{constructor(){this.noImage="/assets/img/no-image.jpg",this.imagesService=(0,r.uUt)(m.U),this.imgClass="block rounded",this.image$=new t.g(null),this.imageSrc$=this.image$.pipe((0,a.G)(h=>h instanceof Blob?(0,o.of)(URL.createObjectURL(h)):h&&h.id?this.imagesService.downloadUrl(h.id):(0,o.of)(this.noImage)))}set image(h){this.image$.next(h??null)}static#t=this.\u0275fac=function(I){return new(I||i)};static#e=this.\u0275cmp=r.In1({type:i,selectors:[["app-show-image"]],inputs:{imgClass:"imgClass",image:"image"},standalone:!0,features:[r.UHJ],decls:2,vars:3,consts:[[3,"draggable","class","src"],[3,"draggable","src"]],template:function(I,S){1&I&&(r.yuY(0,u,2,7,"img",0),r.wVc(1,"async")),2&I&&r.C0Y(0,r.kDX(1,1,S.imageSrc$)?0:-1)},dependencies:[n.a],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center}"],changeDetection:0})}return i})()},4824:(E,c,s)=>{s.d(c,{o:()=>t});var r=s(8400),m=s(2264);class t extends r.w{constructor(o){super(o),this.name=o.name,this.description=o.description,this.status=o.status,this.other=o.other,this.translations={...o.translations},o.image&&(this.image=new m.W(o.image))}}},5891:(E,c,s)=>{s.d(c,{S:()=>n});var r=s(8400),m=s(2264),t=s(355),a=s(4824),o=s(532);class n extends r.w{constructor(e){super(e),this.name=e.name,this.description=e.description,this.status=e.status,this.price=e.price,this.translations=e.translations,this.images=e.images?e.images.map(i=>new m.W(i)):[],this.suggestions=e.suggestions?e.suggestions.map(i=>new n(i)):[],this.tags=e.tags?e.tags.map(i=>new t.E(i)):[],this.allergens=e.allergens?e.allergens.map(i=>new a.o(i)):[],this.ingredients=e.ingredients?e.ingredients.map(i=>new o.e(i)):[]}}},2264:(E,c,s)=>{s.d(c,{W:()=>m});var r=s(8400);class m extends r.w{constructor(a){super(a),this.filename=a.filename,this.status=a.status,this.key=a.key,this.original_id=a.original_id,this.tag=a.tag,this.url=a.url}}},532:(E,c,s)=>{s.d(c,{e:()=>t});var r=s(8400),m=s(2264);class t extends r.w{constructor(o){super(o),this.name=o.name,this.description=o.description,this.status=o.status,this.other=o.other,this.translations={...o.translations},o.image&&(this.image=new m.W(o.image))}}},5820:(E,c,s)=>{s.d(c,{Q:()=>a});var r=s(8400);class m extends r.w{constructor(n){super(n),this.public_visible=n.public_visible,this.public_from=n.public_from?new Date(n.public_from):void 0,this.public_to=n.public_to?new Date(n.public_to):void 0,this.private_visible=n.private_visible,this.daily_from=n.daily_from?new Date(n.daily_from):void 0,this.daily_to=n.daily_to?new Date(n.daily_to):void 0}}var t=s(2264);class a extends r.w{constructor(n){super(n),this.name=n.name,this.description=n.description,this.status=n.status,this.price=n.price,this.parent_id=n.parent_id,this.index=n.index,this.secret=n.secret,this.secret_desc=n.secret_desc,this.visibility_id=n.visibility_id,this.visibility=n.visibility?new m(n.visibility):void 0,this.parent=n.parent?new a(n.parent):void 0,this.children=n.children?n.children.map(u=>new a(u)):[],this.images=n.images?n.images.map(u=>new t.W(u)):[],this.translations=n.translations,this.public_visible=n.public_visible,this.stats=n.stats}}},355:(E,c,s)=>{s.d(c,{E:()=>t});var r=s(8400),m=s(2264);class t extends r.w{constructor(o){super(o),this.name=o.name,this.description=o.description,this.status=o.status,this.other=o.other,this.translations={...o.translations},this.color=o.color,o.image&&(this.image=new m.W(o.image))}}},8676:(E,c,s)=>{s.d(c,{k:()=>o});var r=s(6012),m=s(5891),t=s(4704),a=s(4496);let o=(()=>{class n extends r.s{constructor(){super(m.S,"admin/menu/dishes")}bulkUpdateStatus(e){return this.patch(`bulk_status/${e.status}`,{dish_ids:e.dish_ids})}relocate(e){return this.patch("relocate",e)}updatePrices(e){return(null==e.filters||null==e.filters)&&delete e.filters,this.patch("update_prices",e)}copy(e,i){return this.post(`${e}/copy`,i).pipe((0,t.k)(_=>this.mapItem(_)))}move(e,i){return this.patch(`${e}/move`,i).pipe((0,t.k)(_=>this.mapItem(_)))}moveIngredient(e,i,_){return this.patch(`${e}/ingredients/${i}/move`,{to_index:_}).pipe((0,t.k)(h=>this.mapItem(h)))}moveTag(e,i,_){return this.patch(`${e}/tags/${i}/move`,{to_index:_}).pipe((0,t.k)(h=>this.mapItem(h)))}moveAllergen(e,i,_){return this.patch(`${e}/allergens/${i}/move`,{to_index:_}).pipe((0,t.k)(h=>this.mapItem(h)))}updateStatus(e,i){return this.patch(`${e}/status/${i}`,{}).pipe((0,t.k)(_=>this.mapItem(_)))}addIngredient(e,i){return this.post(`${e}/ingredients/${i}`,{}).pipe((0,t.k)(_=>this.mapItem(_)))}removeIngredient(e,i){return this.delete(`${e}/ingredients/${i}`).pipe((0,t.k)(_=>this.mapItem(_)))}addTag(e,i){return this.post(`${e}/tags/${i}`,{}).pipe((0,t.k)(_=>this.mapItem(_)))}removeTag(e,i){return this.delete(`${e}/tags/${i}`).pipe((0,t.k)(_=>this.mapItem(_)))}addAllergen(e,i){return this.post(`${e}/allergens/${i}`,{}).pipe((0,t.k)(_=>this.mapItem(_)))}removeAllergen(e,i){return this.delete(`${e}/allergens/${i}`).pipe((0,t.k)(_=>this.mapItem(_)))}references(e){return this.get(`${e}/references`).pipe((0,t.k)(i=>i))}addSuggestion(e,i){return this.post(`${e}/suggestions/${i}`,{}).pipe((0,t.k)(_=>this.mapItem(_)))}removeSuggestion(e,i){return this.delete(`${e}/suggestions/${i}`).pipe((0,t.k)(_=>this.mapItem(_)))}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275prov=a.wxM({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()},7760:(E,c,s)=>{s.d(c,{U:()=>a});var r=s(6012),m=s(2264),t=s(4496);let a=(()=>{class o extends r.s{constructor(){super(m.W,"images")}removeFromRecord(u,e){return this.patch(`${u}/remove_from_record`,{record_type:e.record_type,record_id:e.record_id})}updateRecord(u,e){return this.patch("record",{image_ids:e,record_type:u.record_type,record_id:u.record_id})}downloadUrl(u){return this.url(`${u}/download`)}static#t=this.\u0275fac=function(e){return new(e||o)};static#e=this.\u0275prov=t.wxM({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})()},1712:(E,c,s)=>{s.d(c,{S:()=>o});var r=s(6012),m=s(5820),t=s(4704),a=s(4496);let o=(()=>{class n extends r.s{constructor(){super(m.Q,"admin/menu/categories")}addCategory(e,i,_={}){return this.post(`${e}/add_category/${i}`,_)}addDish(e,i){return this.post(`${e}/dishes/${i}`,{})}removeDish(e,i){return this.delete(`${e}/dishes/${i}`,{})}orderDishes(e,i){return this.patch(`${e}/order_dishes`,{field:i})}dashboardData(e){return this.get(`${e}/dashboard_data`)}updateVisibility(e,i){return this.patch(`${e}/visibility`,i).pipe((0,t.k)(_=>this.mapItem(_)))}copy(e,i){return this.post(`${e}/copy`,i).pipe((0,t.k)(_=>this.mapItem(_)))}move(e,i){return this.patch(`${e}/move/${i}`,{}).pipe((0,t.k)(_=>this.mapItem(_)))}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275prov=a.wxM({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()}}]);