"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[5748],{864:(S,m,e)=>{e.r(m),e.d(m,{LinkDishModule:()=>P});var s=e(1236),g=e(7552),t=e(4496),_=e(4436),u=e(8212),i=e(1512),a=e(6504),o=e(6832),r=e(1712),p=e(3480),d=e(1128),E=e(3616),N=e(4704),v=e(4e3),R=e(8824),M=e(8256),y=e(9088);function T(l,U){1&l&&(t.I0R(0,"p"),t.aS0(1,10),t.C$Y(),t.I0R(2,"p"),t.aS0(3,11),t.C$Y())}const $=l=>({except_in_category:l});function L(l,U){if(1&l){const n=t.KQA();t.I0R(0,"form",12),t.qCj("ngSubmit",function(){t.usT(n);const h=t.GaO();return t.CGJ(h.submit())}),t.I0R(1,"app-dish-select",13),t.SAx(2),t.aS0(3,14),t.k70(),t.C$Y(),t.I0R(4,"div",0)(5,"button",15),t.SAx(6),t.aS0(7,16),t.k70(),t.C$Y(),t.I0R(8,"button",17),t.qCj("click",function(){t.usT(n);const h=t.GaO();return t.CGJ(h.cancel())}),t.SAx(9),t.aS0(10,18),t.k70(),t.C$Y()()()}if(2&l){const n=t.GaO();t.E7m("formGroup",n.form),t.yG2(),t.E7m("filters",t.S45(3,$,n.categoryId))("formControlName","dish")}}let A=(()=>{class l{constructor(){this.service=(0,t.uUt)(r.S),this.destroy$=(0,t.uUt)(p.UF),this.route=(0,t.uUt)(s.gV),this.router=(0,t.uUt)(s.E5),this.notifications=(0,t.uUt)(d.E),this.loading=(0,t.OCB)(!1),this.category=(0,t.OCB)(null),this.categoryId=null,this.form=new a.WC({dish:new a.Ku(null)})}ngOnInit(){this.route.parent?.parent?.params.pipe((0,E.a)(this.destroy$),(0,N.k)(n=>n.category_id),(0,v.a)()).subscribe({next:n=>{this.categoryId=n,this.loadCategory()}})}submit(){const n=this.categoryId,c=this.form.value?.dish?.id;n&&c?this.form.invalid||(this.loading.set(!0),this.service.addDish(n,c).pipe((0,E.a)(this.destroy$),(0,R.U)(()=>this.loading.set(!1))).subscribe({next:()=>{this.navigateBack(),this.notifications.fireSnackBar("Piatto aggiunto.")},error:h=>{this.notifications.error((0,M.mk)(h)||"Qualcosa \xE8 andato storto nell'aggiunta del piatto.")}})):console.error("something invalid.",{categoryId:n,dishId:c})}cancel(){(this.form.touched||this.form.dirty)&&!confirm("Sei sicuro di voler annullare questa azione?")||this.navigateBack()}navigateBack(){const n=this.route.snapshot.queryParams.afterUrl;n?this.router.navigateByUrl(n):this.router.navigate([".."],{relativeTo:this.route})}loadCategory(){this.category.set(null),this.categoryId&&this.service.show(this.categoryId).pipe((0,E.a)(this.destroy$)).subscribe({next:n=>{this.category.set(n)},error:n=>{this.notifications.error((0,M.mk)(n)||"Qualcosa \xE8 andato storto nel caricamento della categoria padre.")}})}static#t=this.\u0275fac=function(c){return new(c||l)};static#e=this.\u0275cmp=t.In1({type:l,selectors:[["app-link-dish"]],standalone:!0,features:[t.M5G([p.UF]),t.UHJ],decls:15,vars:7,consts:()=>{let n,c,h,f,O,I,D;return n="Associa piatto esistente",c="Il piatto verr\xE0 aggiunto alla categoria",h="Associare un piatto esistente ti permette di tenere lo stesso identico piatto presente in pi\xF9 categorie.",f="Il vantaggio \xE8 che quando devi apportare una modifica al piatto, lo devi fare una volta sola.",O="Piatto da associare",I="Conferma",D="Annulla",[[1,"flex","items-center"],[1,"me-2"],n,[3,"content"],[1,"mb-3"],[1,"me-2","text-slate-400"],c,["tuiLink","",3,"routerLink"],["helpMsg",""],[3,"formGroup"],h,f,[3,"formGroup","ngSubmit"],[1,"block","mb-3",3,"filters","formControlName"],O,["tuiButton","","type","submit","size","l","appearance","primary",1,"me-2"],I,["tuiButton","","type","button","size","l","appearance","outline",3,"click"],D]},template:function(c,h){if(1&c&&(t.I0R(0,"span",0)(1,"h1",1),t.SAx(2),t.aS0(3,2),t.k70(),t.C$Y(),t.wR5(4,"tui-tooltip",3),t.C$Y(),t.I0R(5,"div",4)(6,"span",5),t.SAx(7),t.aS0(8,6),t.k70(),t.C$Y(),t.I0R(9,"a",7),t.wVc(10,"urlTo"),t.OEk(11),t.C$Y()(),t.yuY(12,T,4,0,"ng-template",null,8,t.gJz)(14,L,11,5,"form",9)),2&c){const f=t.Gew(13);let O,I;t.yG2(4),t.E7m("content",f),t.yG2(5),t.E7m("routerLink",t.g7$(10,4,null==(O=h.category())?null:O.id,"menuCategory.show")),t.yG2(2),t.cNF(null==(I=h.category())?null:I.name),t.yG2(3),t.C0Y(14,h.categoryId?14:-1)}},dependencies:[_.a,_.i,a.sl,a.sz,a.ue,a.u,a.uW,a.Wo,o.i,u.CI,u.Kw,i.w,i.C,s.ER,y.S],changeDetection:0})}return l})(),P=(()=>{class l{static#t=this.\u0275fac=function(c){return new(c||l)};static#e=this.\u0275mod=t.a4G({type:l});static#i=this.\u0275inj=t.s3X({imports:[s.qQ.forChild([(0,g.VV)(A,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return l})()},9052:(S,m,e)=>{e.d(m,{y:()=>o});var s=e(4496),g=e(7760),t=e(6700),_=e(7368),u=e(2700),i=e(1368);function a(r,p){if(1&r&&(s.wR5(0,"img",1),s.wVc(1,"async")),2&r){const d=s.GaO();s.uQ9("max-w-[100%] h-auto min-h-[50px] md:min-h-[100px] ",d.imgClass,""),s._6D("src",s.kDX(1,5,d.imageSrc$),s.K6U),s.E7m("draggable",!1)}}let o=(()=>{class r{constructor(){this.noImage="/assets/img/no-image.jpg",this.imagesService=(0,s.uUt)(g.U),this.imgClass="block rounded",this.image$=new t.g(null),this.imageSrc$=this.image$.pipe((0,_.G)(d=>d instanceof Blob?(0,u.of)(URL.createObjectURL(d)):d&&d.id?this.imagesService.downloadUrl(d.id):(0,u.of)(this.noImage)))}set image(d){this.image$.next(d??null)}static#t=this.\u0275fac=function(E){return new(E||r)};static#e=this.\u0275cmp=s.In1({type:r,selectors:[["app-show-image"]],inputs:{imgClass:"imgClass",image:"image"},standalone:!0,features:[s.UHJ],decls:2,vars:3,consts:[[3,"draggable","class","src"],[3,"draggable","src"]],template:function(E,N){1&E&&(s.yuY(0,a,2,7,"img",0),s.wVc(1,"async")),2&E&&s.C0Y(0,s.kDX(1,1,N.imageSrc$)?0:-1)},dependencies:[i.a],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center}"],changeDetection:0})}return r})()},2264:(S,m,e)=>{e.d(m,{W:()=>g});var s=e(8400);class g extends s.w{constructor(_){super(_),this.filename=_.filename,this.status=_.status,this.key=_.key,this.original_id=_.original_id,this.tag=_.tag,this.url=_.url}}},5820:(S,m,e)=>{e.d(m,{Q:()=>_});var s=e(8400);class g extends s.w{constructor(i){super(i),this.public_visible=i.public_visible,this.public_from=i.public_from?new Date(i.public_from):void 0,this.public_to=i.public_to?new Date(i.public_to):void 0,this.private_visible=i.private_visible,this.daily_from=i.daily_from?new Date(i.daily_from):void 0,this.daily_to=i.daily_to?new Date(i.daily_to):void 0}}var t=e(2264);class _ extends s.w{constructor(i){super(i),this.name=i.name,this.description=i.description,this.status=i.status,this.price=i.price,this.parent_id=i.parent_id,this.index=i.index,this.secret=i.secret,this.secret_desc=i.secret_desc,this.visibility_id=i.visibility_id,this.visibility=i.visibility?new g(i.visibility):void 0,this.parent=i.parent?new _(i.parent):void 0,this.children=i.children?i.children.map(a=>new _(a)):[],this.images=i.images?i.images.map(a=>new t.W(a)):[],this.translations=i.translations,this.public_visible=i.public_visible,this.stats=i.stats}}},7760:(S,m,e)=>{e.d(m,{U:()=>_});var s=e(6012),g=e(2264),t=e(4496);let _=(()=>{class u extends s.s{constructor(){super(g.W,"images")}removeFromRecord(a,o){return this.patch(`${a}/remove_from_record`,{record_type:o.record_type,record_id:o.record_id})}updateRecord(a,o){return this.patch("record",{image_ids:o,record_type:a.record_type,record_id:a.record_id})}downloadUrl(a){return this.url(`${a}/download`)}static#t=this.\u0275fac=function(o){return new(o||u)};static#e=this.\u0275prov=t.wxM({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()},1712:(S,m,e)=>{e.d(m,{S:()=>u});var s=e(6012),g=e(5820),t=e(4704),_=e(4496);let u=(()=>{class i extends s.s{constructor(){super(g.Q,"admin/menu/categories")}addCategory(o,r,p={}){return this.post(`${o}/add_category/${r}`,p)}addDish(o,r){return this.post(`${o}/dishes/${r}`,{})}removeDish(o,r){return this.delete(`${o}/dishes/${r}`,{})}orderDishes(o,r){return this.patch(`${o}/order_dishes`,{field:r})}dashboardData(o){return this.get(`${o}/dashboard_data`)}updateVisibility(o,r){return this.patch(`${o}/visibility`,r).pipe((0,t.k)(p=>this.mapItem(p)))}copy(o,r){return this.post(`${o}/copy`,r).pipe((0,t.k)(p=>this.mapItem(p)))}move(o,r){return this.patch(`${o}/move/${r}`,{}).pipe((0,t.k)(p=>this.mapItem(p)))}static#t=this.\u0275fac=function(r){return new(r||i)};static#e=this.\u0275prov=_.wxM({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()}}]);