"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[2544],{2544:(R,C,i)=>{i.r(C),i.d(C,{CreateCategoryModule:()=>L});var E=i(1236),m=i(7552),t=i(4496),l=i(8212),p=i(8976),e=i(4436),u=i(1512),s=i(9956),a=i(1920),r=i(6504),d=i(3480),f=i(1712),O=i(3616),y=i(4704),$=i(6684),A=i(8824),G=i(5820),g=i(9088),D=i(9938),P=i(1128),S=i(8256),I=i(3580),M=i(8392);function U(_,B){if(1&_&&(t.I0R(0,"h1",10)(1,"span"),t.aS0(2,11),t.C$Y()(),t.I0R(3,"div",1)(4,"span",12),t.SAx(5),t.aS0(6,13),t.k70(),t.C$Y(),t.I0R(7,"a",14),t.wVc(8,"urlTo"),t.OEk(9),t.C$Y()()),2&_){const n=t.GaO();let o,c;t.yG2(7),t.E7m("routerLink",t.g7$(8,2,null==(o=n.parent())?null:o.id,"menuCategory.show")),t.yG2(2),t.cNF(null==(c=n.parent())?null:c.name)}}function Y(_,B){1&_&&(t.I0R(0,"h1"),t.SAx(1),t.aS0(2,15),t.k70(),t.C$Y())}let b=(()=>{class _{constructor(){this.service=(0,t.uUt)(f.S),this.destroy$=(0,t.uUt)(d.UF),this.router=(0,t.uUt)(E.E5),this.route=(0,t.uUt)(E.gV),this.urlTo=(0,t.uUt)(g.S),this.notifications=(0,t.uUt)(P.E),this.afterUrl=this.route.snapshot.queryParams.afterUrl,this.form=new r.WC({name:new r.Ku(null)}),this.parentId=null,this.parent=(0,t.OCB)(null),this.loading=(0,t.OCB)(!1),this.submitted=!1,this.e=this.errorsFor}ngOnInit(){this.route.parent?.parent?.params.pipe((0,O.a)(this.destroy$),(0,y.k)(n=>Number(n.category_id)),(0,$.I)(n=>"number"==typeof n&&!isNaN(n)&&n>0)).subscribe({next:n=>{this.parentId=n,this.loadParent()}})}submit(){this.submitted=!0,!this.form.invalid&&(this.loading.set(!0),this.service.create(this.formData()).pipe((0,O.a)(this.destroy$),(0,A.U)(()=>this.loading.set(!1))).subscribe({next:n=>{const o=this.afterUrl||this.urlTo.transform(n.id,"menuCategory.show");console.assert(o,`URL for menu category ${n.id} not found`),this.router.navigate([o],{relativeTo:this.route}),this.notifications.fireSnackBar("Categoria creata.")},error:n=>{D.y.assignErrorsToForm(this.form,n),this.notifications.error((0,S.mk)(n)||M.a)}}))}formData(){const n=this.form.value,o=this.parent();return o instanceof G.Q&&(n.parent_id=o.id),n}errorsFor(n){const o=this.form.get(n);return o&&(o.dirty||o.touched||this.submitted)?o.errors:null}cancel(){this.router.navigate([this.afterUrl||".."],{relativeTo:this.route})}loadParent(n=this.parentId){n&&(this.loading.set(!0),this.service.show(n).pipe((0,O.a)(this.destroy$),(0,A.U)(()=>this.loading.set(!1))).subscribe({next:o=>{this.parent.set(o)},error:o=>{this.notifications.error((0,S.mk)(o)||M.a)}}))}static#t=this.\u0275fac=function(o){return new(o||_)};static#e=this.\u0275cmp=t.In1({type:_,selectors:[["app-create-category"]],standalone:!0,features:[t.M5G([d.UF,g.S]),t.UHJ],decls:15,vars:5,consts:()=>{let n,o,c,T,N,v;return n="Nome",o="Conferma",c="Annulla",T="Crea nuova categoria",N="La categoria verr\xE0 creata come sottocategoria di",v="Crea nuovo men\xF9",[[3,"formGroup","ngSubmit"],[1,"mb-3"],["formControlName","name"],n,[3,"errors"],[1,"flex"],["tuiButton","","type","submit","size","l",1,"me-2",3,"showLoader"],o,["tuiButton","","type","button","appearance","icon","size","l",3,"showLoader","click"],c,[1,"flex","items-center"],T,[1,"me-2","text-slate-400"],N,["tuiLink","",3,"routerLink"],v]},template:function(o,c){1&o&&(t.yuY(0,U,10,5)(1,Y,3,0),t.I0R(2,"form",0),t.qCj("ngSubmit",function(){return c.submit()}),t.I0R(3,"div",1)(4,"app-i18n-input",2),t.SAx(5),t.aS0(6,3),t.k70(),t.C$Y(),t.wR5(7,"app-errors",4),t.C$Y(),t.I0R(8,"div",5)(9,"button",6),t.SAx(10),t.aS0(11,7),t.k70(),t.C$Y(),t.I0R(12,"button",8),t.qCj("click",function(){return c.cancel()}),t.SAx(13),t.aS0(14,9),t.k70(),t.C$Y()()()),2&o&&(t.C0Y(0,c.parent()?0:1),t.yG2(2),t.E7m("formGroup",c.form),t.yG2(5),t.E7m("errors",c.e("name")),t.yG2(2),t.E7m("showLoader",c.loading()),t.yG2(3),t.E7m("showLoader",c.loading()))},dependencies:[l.CI,l.Kw,s.g,a.w,r.sl,r.sz,r.ue,r.u,r.uW,r.Wo,p.Gy,I.W,e.a,u.w,u.C,E.ER,g.S],encapsulation:2,changeDetection:0})}return _})(),L=(()=>{class _{static#t=this.\u0275fac=function(o){return new(o||_)};static#e=this.\u0275mod=t.a4G({type:_});static#i=this.\u0275inj=t.s3X({imports:[E.qQ.forChild([(0,m.VV)(b,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return _})()},5820:(R,C,i)=>{i.d(C,{Q:()=>l});var E=i(8400);class m extends E.w{constructor(e){super(e),this.public_visible=e.public_visible,this.public_from=e.public_from?new Date(e.public_from):void 0,this.public_to=e.public_to?new Date(e.public_to):void 0,this.private_visible=e.private_visible,this.daily_from=e.daily_from?new Date(e.daily_from):void 0,this.daily_to=e.daily_to?new Date(e.daily_to):void 0}}var t=i(2264);class l extends E.w{constructor(e){super(e),this.name=e.name,this.description=e.description,this.status=e.status,this.price=e.price,this.parent_id=e.parent_id,this.index=e.index,this.secret=e.secret,this.secret_desc=e.secret_desc,this.visibility_id=e.visibility_id,this.visibility=e.visibility?new m(e.visibility):void 0,this.parent=e.parent?new l(e.parent):void 0,this.children=e.children?e.children.map(u=>new l(u)):[],this.images=e.images?e.images.map(u=>new t.W(u)):[],this.translations=e.translations,this.public_visible=e.public_visible,this.stats=e.stats}}},9088:(R,C,i)=>{i.d(C,{S:()=>t});var E=i(4496);const m={menuCategory:{show:"/admin/menu/{itemId}",duplicate:"/admin/menu/{itemId}/duplicate",export:"/admin/menu/{itemId}/export",createChild:"/admin/menu/{itemId}/create-category",linkCategory:"/admin/menu/{itemId}/link-category",createDish:"/admin/menu/{itemId}/create-dish",linkDish:"/admin/menu/{itemId}/link-dish",private:"/menu/{itemId}",public:"/menu/{itemId}"},dish:{show:"/admin/menu/{categoryId}/dish/{itemId}"}};let t=(()=>{class l{transform(e,u){const s=m[u.split(".")[0]];if(!s)throw new Error(`Resource not found: ${u} (resouce: ${u.split(".")[0]})`);const a=u.split(".")[1];if(!s[a])throw new Error(`Action not found: ${u} (action: ${a})`);if(typeof e>"u"||null===e)return null;if("number"==typeof e&&(e=e.toString()),"object"==typeof e&&null!==e&&!Array.isArray(e)){let r=s[a];if(Object.keys(e).forEach(d=>{const f=e[d];void 0!==f&&r.includes(`{${d}}`)&&(r=r.replace(`{${d}}`,f??""))}),r.includes("{{"))throw new Error(`Unresolved interpolation: ${r}`);return r}if("string"!=typeof e)throw new Error(`Invalid itemId: ${e} (type: ${typeof e})`);return s[a].replace("{itemId}",e)}static#t=this.\u0275fac=function(u){return new(u||l)};static#e=this.\u0275pipe=E.UTH({name:"urlTo",type:l,pure:!0,standalone:!0})}return l})()},1712:(R,C,i)=>{i.d(C,{S:()=>p});var E=i(6012),m=i(5820),t=i(4704),l=i(4496);let p=(()=>{class e extends E.s{constructor(){super(m.Q,"admin/menu/categories")}addCategory(s,a,r={}){return this.post(`${s}/add_category/${a}`,r)}addDish(s,a){return this.post(`${s}/dishes/${a}`,{})}removeDish(s,a){return this.delete(`${s}/dishes/${a}`,{})}orderDishes(s,a){return this.patch(`${s}/order_dishes`,{field:a})}dashboardData(s){return this.get(`${s}/dashboard_data`)}updateVisibility(s,a){return this.patch(`${s}/visibility`,a).pipe((0,t.k)(r=>this.mapItem(r)))}copy(s,a){return this.post(`${s}/copy`,a).pipe((0,t.k)(r=>this.mapItem(r)))}move(s,a){return this.patch(`${s}/move/${a}`,{}).pipe((0,t.k)(r=>this.mapItem(r)))}static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275prov=l.wxM({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})()}}]);