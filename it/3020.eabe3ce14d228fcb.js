(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[3020],{83020:(L,f,o)=>{"use strict";o.d(f,{M:()=>xt});var t=o(54496),h=o(31236),S=o(41512),u=o(10466),M=o(58212),s=o(55193),T=o(94336),l=o(8048),c=o(27692),d=o(45656),j=o(1560),y=o(86376),Q=o(41104),$=o(53797),v=o(44856),D=o(91368),x=o(11712),V=o(83480),P=o(35e3),R=o(53616),J=o(74e3),W=o(34680),K=o(19212),N=o(68824),Z=o(1128),G=o(38256),q=o(79052),tt=o(49088),O=o(6504),b=o(5892),A=o(83400),et=o(63724),it=o(86772),nt=o(97048),ot=o(48128),k=o(53252),st=o(39144);let _t=(()=>{class i extends it.A{constructor(){super("admin/menu")}export(){return new k._(e=>{this.get("export",{responseType:"blob",observe:"response"}).pipe((0,st.a)(n=>(console.error("ExportMenuService.export() error:",n),e.error(n),new k._))).subscribe(n=>{if(n instanceof nt.WA&&n.body){const _=(0,ot.k)(n.headers?.get("Content-Disposition"))??"Menu.xlsx",E=n.headers?.get("Content-Type")??"application/octet-stream",p=window.URL.createObjectURL(new Blob([n.body],{type:E})),m=document.createElement("a");m.href=p,m.download=_,m.click(),e.complete()}})})}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275prov=t.wxM({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var a=o(57624),at=o(37936);const rt=(i,r)=>r.id;function lt(i,r){1&i&&(t.SAx(0),t.aS0(1,17),t.k70())}function ct(i,r){1&i&&(t.SAx(0),t.aS0(1,18),t.k70())}function Ct(i,r){if(1&i&&(t.I0R(0,"span",19),t.OEk(1),t.C$Y()),2&i){const e=t.GaO();let n;t.yG2(),t.oRS("(",null==(n=e.data())||null==n.metadata?null:n.metadata.total_count,")")}}function Et(i,r){if(1&i&&(t.I0R(0,"a",21),t.wVc(1,"urlTo"),t.I0R(2,"span",1)(3,"mat-icon",19),t.OEk(4,"share"),t.C$Y(),t.SAx(5),t.aS0(6,23),t.k70(),t.C$Y()()),2&i){const e=t.GaO(2);t.E7m("routerLink",t.g7$(1,1,e.parentCategoryId,"menuCategory.linkCategory"))}}function ut(i,r){if(1&i&&(t.I0R(0,"tui-data-list",20)(1,"a",21),t.wVc(2,"urlTo"),t.I0R(3,"span",1)(4,"mat-icon",19),t.OEk(5,"add_circle"),t.C$Y(),t.I0R(6,"span"),t.aS0(7,22),t.C$Y()()(),t.yuY(8,Et,7,4,"a",21),t.C$Y()),2&i){const e=t.GaO();let n;t.yG2(),t.E7m("routerLink",t.g7$(2,2,null!==(n=e.parentCategoryId)&&void 0!==n?n:"","menuCategory.createChild")),t.yG2(7),t.C0Y(8,e.parentCategoryId?8:-1)}}function dt(i,r){1&i&&(t.SAx(0),t.aS0(1,28),t.k70())}function gt(i,r){1&i&&(t.SAx(0),t.aS0(1,29),t.k70())}function St(i,r){if(1&i){const e=t.KQA();t.I0R(0,"tui-data-list",20)(1,"button",24),t.qCj("click",function(){t.usT(e);const _=t.GaO();return t.CGJ(_.triggerFiltering())}),t.I0R(2,"span",1)(3,"mat-icon",19),t.OEk(4,"search"),t.C$Y(),t.SAx(5),t.aS0(6,25),t.k70(),t.C$Y()(),t.I0R(7,"button",24),t.qCj("click",function(){t.usT(e);const _=t.GaO();return t.CGJ(_.exportAllMenu())}),t.I0R(8,"tui-loader",26)(9,"span",1)(10,"mat-icon",19),t.OEk(11,"download"),t.C$Y(),t.SAx(12),t.aS0(13,27),t.k70(),t.C$Y()()(),t.I0R(14,"button",24),t.qCj("click",function(){t.usT(e);const _=t.GaO();return t.CGJ(_.triggerOrdering())}),t.I0R(15,"span",1)(16,"mat-icon",19),t.OEk(17,"sort_by_alpha"),t.C$Y(),t.yuY(18,dt,2,0,"ng-container")(19,gt,2,0),t.C$Y()()()}if(2&i){const e=t.GaO();t.yG2(8),t.E7m("overlay",!0)("showLoader",e.exporting()),t.yG2(10),t.C0Y(18,e.ordering()?18:19)}}function Ot(i,r){if(1&i){const e=t.KQA();t.I0R(0,"div",30)(1,"form",31),t.qCj("ngSubmit",function(){t.usT(e);const _=t.GaO();return t.CGJ(_.submitFilters())}),t.I0R(2,"button",32)(3,"mat-icon"),t.OEk(4,"search"),t.C$Y()(),t.I0R(5,"tui-input",33),t.SAx(6),t.aS0(7,34),t.k70(),t.wR5(8,"input",35),t.C$Y()()()}if(2&i){const e=t.GaO();t.yG2(),t.E7m("formGroup",e.filters),t.yG2(),t.E7m("showLoader",e.searching()),t.yG2(3),t.E7m("tuiTextfieldSize","m"),t.yG2(3),t.E7m("autocomplete",!1)}}function pt(i,r){if(1&i&&(t.I0R(0,"a",47),t.wVc(1,"urlTo"),t.I0R(2,"span",1)(3,"mat-icon",19),t.OEk(4,"link"),t.C$Y(),t.I0R(5,"span"),t.aS0(6,50),t.C$Y()()()),2&i){const e=t.GaO(3).$implicit;t.E7m("routerLink",t.g7$(1,1,e.id,"menuCategory.public"))}}function mt(i,r){if(1&i&&(t.I0R(0,"a",47),t.wVc(1,"urlTo"),t.I0R(2,"span",1)(3,"mat-icon",19),t.OEk(4,"share"),t.C$Y(),t.I0R(5,"span"),t.aS0(6,51),t.C$Y()()()),2&i){const e=t.GaO(3).$implicit;t.E7m("routerLink",t.g7$(1,1,e.secret,"menuCategory.private"))}}function Tt(i,r){if(1&i){const e=t.KQA();t.I0R(0,"tui-data-list",20)(1,"a",21),t.wVc(2,"urlTo"),t.I0R(3,"span",1)(4,"mat-icon",19),t.OEk(5,"visibility"),t.C$Y(),t.I0R(6,"span"),t.aS0(7,45),t.C$Y()()(),t.I0R(8,"a",21),t.wVc(9,"urlTo"),t.I0R(10,"span",1)(11,"mat-icon",19),t.OEk(12,"content_copy"),t.C$Y(),t.I0R(13,"span"),t.aS0(14,46),t.C$Y()()(),t.yuY(15,pt,7,4,"a",47)(16,mt,7,4,"a",47),t.I0R(17,"button",48),t.qCj("click",function(){t.usT(e);const _=t.GaO(2).$implicit,E=t.GaO();return t.CGJ(E.remove(_))}),t.I0R(18,"span",1)(19,"mat-icon",19),t.OEk(20,"delete"),t.C$Y(),t.I0R(21,"span"),t.aS0(22,49),t.C$Y()()()()}if(2&i){const e=t.GaO(2).$implicit;t.yG2(),t.E7m("routerLink",t.g7$(2,4,e.id,"menuCategory.show")),t.yG2(7),t.E7m("routerLink",t.g7$(9,7,e.id,"menuCategory.duplicate")),t.yG2(7),t.C0Y(15,!0===(null==e.visibility?null:e.visibility.public_visible)?15:-1),t.yG2(),t.C0Y(16,!0===(null==e.visibility?null:e.visibility.private_visible)?16:-1)}}function Rt(i,r){if(1&i&&t.yuY(0,Tt,23,10,"tui-data-list",44),2&i){const e=t.GaO().$implicit;t.E7m("ngIf",e)}}function It(i,r){if(1&i&&t.wR5(0,"app-show-image",52),2&i){const e=t.GaO().$implicit;t.E7m("image",e.images[0])}}function ft(i,r){1&i&&(t.I0R(0,"button",43)(1,"mat-icon",53),t.OEk(2,"drag_handle"),t.C$Y()())}function ht(i,r){if(1&i&&(t.I0R(0,"tui-hosted-dropdown",5)(1,"button",43)(2,"mat-icon"),t.OEk(3,"more_vert"),t.C$Y()()()),2&i){t.GaO();const e=t.Gew(1);t.E7m("content",e)}}function Mt(i,r){if(1&i&&(t.yuY(0,Rt,1,1,"ng-template",null,36,t.gJz),t.I0R(2,"tui-island",37)(3,"div",38)(4,"span",1)(5,"a",39),t.wVc(6,"urlTo"),t.yuY(7,It,1,1,"app-show-image",40),t.C$Y(),t.I0R(8,"div")(9,"a",41),t.wVc(10,"urlTo"),t.OEk(11),t.C$Y(),t.I0R(12,"p",42),t.OEk(13),t.C$Y()()(),t.yuY(14,ft,3,0,"button",43)(15,ht,4,1),t.C$Y()()),2&i){const e=r.$implicit,n=t.GaO();t.yG2(5),t.E7m("routerLink",t.g7$(6,6,e.id,"menuCategory.show")),t.yG2(2),t.E7m("ngIf",e&&e.images&&e.images.length>0),t.yG2(2),t.E7m("routerLink",t.g7$(10,9,e.id,"menuCategory.show")),t.yG2(2),t.cNF(e.name),t.yG2(2),t.cNF(e.status),t.yG2(),t.C0Y(14,n.ordering()?14:15)}}function Nt(i,r){1&i&&t.wR5(0,"tui-loader",54),2&i&&t.E7m("showLoader",!0)}function At(i,r){1&i&&(t.I0R(0,"p",55),t.SAx(1),t.aS0(2,56),t.k70(),t.C$Y())}function $t(i,r){if(1&i&&t.yuY(0,Nt,1,1,"tui-loader",54)(1,At,3,0),2&i){const e=t.GaO();t.C0Y(0,e.searching()?0:1)}}const Gt=()=>[10,20,50,100];function Lt(i,r){if(1&i){const e=t.KQA();t.I0R(0,"tui-table-pagination",57),t.qCj("paginationChange",function(_){t.usT(e);const E=t.GaO();return t.CGJ(E.paginationChange(_))}),t.C$Y()}if(2&i){const e=t.GaO();let n;t.E7m("items",t.q4q(2,Gt))("total",null!==(n=null==(n=e.data())||null==n.metadata?null:n.metadata.total_count)&&void 0!==n?n:0)}}const yt=i=>({rotate180:i}),vt=i=>({invisible:i}),Dt=i=>({"allow-reorder":i});let xt=(()=>{class i{constructor(){this.service=(0,t.uUt)(x.S),this.destroy$=(0,t.uUt)(V.UF),this.notifications=(0,t.uUt)(Z.E),this.exportService=(0,t.uUt)(_t),this.data=(0,t.OCB)(null),this.items=(0,t.S6b)(()=>this.data()?.items??[]),this.filtering=(0,t.OCB)(!1),this.ordering=(0,t.OCB)(!1),this.exporting=(0,t.OCB)(!1),this.searching=(0,t.OCB)(!1),this.deleting=(0,t.OCB)(!1),this.moving=(0,t.OCB)(!1),this.loading=(0,t.S6b)(()=>this.searching()||this.deleting()||this.moving()||this.exporting()),this.reorderEnabled=(0,t.OCB)(!0),this.filters=new O.WC({query:new O.Ku(null)}),this.offset=0,this.per_page=10,this.parentCategoryId=null}ngOnInit(){this.search(),this.filters.valueChanges.pipe((0,R.a)(this.destroy$),(0,J.a)(),(0,W.o)(200),(0,K.y)(()=>this.offset=0)).subscribe({next:()=>this.search()})}ngOnChanges(e){e.parentCategoryId&&this.search()}triggerFiltering(){this.filtering.set(!this.filtering()),this.search()}submitFilters(){this.search()}paginationChange(e){this.per_page=e.size,this.offset=e.page,this.search()}search(e=this.parseFilters()){this.searchSub?.unsubscribe(),this.searching.set(!0),this.searchSub=this.service.search(e).pipe((0,R.a)(this.destroy$),(0,N.U)(()=>this.searching.set(!1))).subscribe({next:n=>this.data.set(n),error:n=>{this.data.set(null),this.notifications.error((0,G.mk)(n)||a.$localize`Qualcosa è andato storto. Riprova più tardi.`)}})}parseFilters(){const e=this.filters.value,n={per_page:this.per_page,offset:this.offset};return this.filtering()&&e.query&&(n.query=e.query),n.parent_id=this.parentCategoryId??"",n}remove(e){this.notifications.confirm(a.$localize`Sei sicuro di voler eliminare la categoria?`,{yes:a.$localize`Sì, elimina la categoria`,no:a.$localize`Annulla`}).pipe((0,R.a)(this.destroy$)).subscribe({next:n=>{this.deleteCategory(e)}})}deleteCategory(e){const n=e?.id;n&&(this.deleting.set(!0),this.service.destroy(n).pipe((0,R.a)(this.destroy$),(0,N.U)(()=>this.deleting.set(!1))).subscribe({next:()=>{this.notifications.fireSnackBar(a.$localize`Categoria eliminata.`),this.search()},error:_=>{this.notifications.error((0,G.mk)(_)||a.$localize`Qualcosa è andato storto.`)}}))}drop(e){if(e.previousIndex===e.currentIndex)return;const n=this.items(),_=n[e.previousIndex]?.id;_&&((0,A.qv)(n,e.previousIndex,e.currentIndex),this.moving.set(!0),this.service.move(_,e.currentIndex).pipe((0,R.a)(this.destroy$),(0,N.U)(()=>this.moving.set(!1)),(0,N.U)(()=>this.search())).subscribe({error:E=>this.notifications.error((0,G.mk)(E)||a.$localize`Qualcosa è andato storto.`)}))}triggerOrdering(){this.ordering()||this.notifications.fireSnackBar(a.$localize`Sposta le categorie trascinandole con il bottone sul lato destro di ciascuna categoria.`,a.$localize`Capito`,{duration:5e3}),this.ordering.set(!this.ordering())}exportAllMenu(){this.exporting.set(!0),this.exportService.export().pipe((0,R.a)(this.destroy$),(0,N.U)(()=>this.exporting.set(!1))).subscribe((0,et.I)())}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=t.In1({type:i,selectors:[["app-list-categories"]],inputs:{parentCategoryId:"parentCategoryId"},standalone:!0,features:[t.M5G([x.S]),t.SYr,t.UHJ],decls:32,vars:19,consts:()=>{let e,n,_,E,p,m,I,g,Y,B,U,z,H,w,F,X;return e=a.$localize`Aggiungi`,n=a.$localize`Categorie`,_=a.$localize`Menù`,E=a.$localize`Crea nuovo`,p=a.$localize`Associa esistente`,m=a.$localize`Filtra elementi`,I=a.$localize`Esporta tutto`,g=a.$localize`Fatto.`,Y=a.$localize`Riordina`,B=a.$localize`Filtra per nome o descrizione`,U=a.$localize`Visualizza`,z=a.$localize`Duplica`,H=a.$localize`Rimuovi`,w=a.$localize`Anteprima link pubblico`,F=a.$localize`Anteprima link privato`,X=a.$localize`Non ci sono categorie`,[[1,"flex","items-center","justify-between"],[1,"flex","items-center"],[1,"me-1",3,"click"],["class","me-1"],["addItemDropdownContent",""],[3,"content"],["addDropdown",""],["tuiButton","","appearance","flat","type","button","size","m"],e,[1,"animation-speed-2",3,"ngClass"],["categoriesOptions",""],["tuiIconButton","","size","m","appearance","outline","type","button"],["class","mt-3"],["tuiProgressBar","","max","100",3,"ngClass","size","value"],[1,"text-slate-400","my-3"],["cdkDropList","",1,"items-list",3,"ngClass","cdkDropListDisabled","cdkDropListDropped"],["class","my-2",3,"items","total"],n,_,[1,"me-1"],["role","menu"],["tuiOption","",3,"routerLink"],E,p,["tuiOption","",3,"click"],m,[3,"overlay","showLoader"],I,g,Y,[1,"mt-3"],[1,"flex","items-center",3,"formGroup","ngSubmit"],["type","submit","tuiIconButton","","appearance","flat",1,"me-2",3,"showLoader"],["formControlName","query","tuiAutoFocus","",1,"grow",3,"tuiTextfieldSize"],B,["type","text","tuiTextfield","",3,"autocomplete"],["actions",""],["cdkDrag","",1,"mb-2"],[1,"flex","justify-between","items-center"],[3,"routerLink"],["style","max-width: 100px;","class","inline-block rounded me-2",3,"image",4,"ngIf"],["tuiLink","",1,"text-lg",3,"routerLink"],[1,"tui-island__category"],["cdkDragHandle","","size","m","appearance","outline","type","button","tuiIconButton",""],["role","menu",4,"ngIf"],U,z,["type","button","tuiOption","",3,"routerLink"],["type","button","tuiOption","",3,"click"],H,w,F,[1,"inline-block","rounded","me-2",2,"max-width","100px",3,"image"],[1,"drag-shake"],["size","m",3,"showLoader"],[1,"text-center"],X,[1,"my-2",3,"items","total","paginationChange"]]},template:function(n,_){if(1&n&&(t.I0R(0,"div",0)(1,"div",1)(2,"h2",2),t.qCj("click",function(){return _.search()}),t.yuY(3,lt,2,0,"ng-container")(4,ct,2,0),t.C$Y(),t.yuY(5,Ct,2,1,"span",3)(6,ut,9,5,"ng-template",null,4,t.gJz),t.I0R(8,"tui-hosted-dropdown",5,6)(10,"button",7)(11,"span",1)(12,"mat-icon"),t.OEk(13,"add"),t.C$Y(),t.I0R(14,"span"),t.aS0(15,8),t.C$Y(),t.I0R(16,"mat-icon",9),t.OEk(17,"expand_more"),t.C$Y()()()()(),t.yuY(18,St,20,3,"ng-template",null,10,t.gJz),t.I0R(20,"tui-hosted-dropdown",5)(21,"button",11)(22,"mat-icon"),t.OEk(23,"more_vert"),t.C$Y()()()(),t.yuY(24,Ot,9,4,"div",12),t.wR5(25,"progress",13)(26,"hr",14),t.I0R(27,"div",15),t.qCj("cdkDropListDropped",function(p){return _.drop(p)}),t.c53(28,Mt,16,12,null,null,rt,!1,$t,2,1),t.C$Y(),t.yuY(31,Lt,1,3,"tui-table-pagination",16)),2&n){const E=t.Gew(7),p=t.Gew(9),m=t.Gew(19);let I,g;t.yG2(3),t.C0Y(3,_.parentCategoryId?3:4),t.yG2(2),t.C0Y(5,null!=(I=_.data())&&null!=I.metadata&&I.metadata.total_count?5:-1),t.yG2(3),t.E7m("content",E),t.yG2(8),t.E7m("ngClass",t.S45(13,yt,p.open)),t.yG2(4),t.E7m("content",m),t.yG2(4),t.C0Y(24,_.filtering()?24:-1),t.yG2(),t.E7m("ngClass",t.S45(15,vt,!_.loading()))("size","s")("value",void 0),t.yG2(2),t.E7m("ngClass",t.S45(17,Dt,_.reorderEnabled()))("cdkDropListDisabled",!_.reorderEnabled()),t.yG2(),t.oho(_.items()),t.yG2(3),t.C0Y(31,null!=(g=_.data())&&null!=g.metadata&&g.metadata.next_page||null!=(g=_.data())&&null!=g.metadata&&g.metadata.prev_page?31:-1)}},dependencies:[h.ER,S.w,S.C,j.qL,u.GE,u.Qw,M.CI,M.Kw,y.k,y.C,Q.t,s.ms,T.A$,T.yi,T.sP,D.u_,q.y,tt.S,O.sl,O.sz,O.ue,O.u,O.uW,O.Wo,$.CQ,$.Oo,$.cP,at.b,P.m6,P.gJ,l.aS,l.rD,c.Sk,c.Cb,D.QF,b.yy,b.Ws,A.Cm,A.w5,A.A3,d.WY,v.Gs,v.qA],styles:["[_nghost-%COMP%]   .items-list.allow-reorder.cdk-drop-list-dragging[_ngcontent-%COMP%]   tui-island[cdkDrag][_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}[_nghost-%COMP%]   .items-list.allow-reorder[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}[_nghost-%COMP%]   .items-list.allow-reorder[_ngcontent-%COMP%]   .cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}[_nghost-%COMP%]   [cdkDragHandle][_ngcontent-%COMP%]{cursor:move}"]})}return i})()},45820:(L,f,o)=>{"use strict";o.d(f,{Q:()=>u});var t=o(58400);class h extends t.w{constructor(s){super(s),this.public_visible=s.public_visible,this.public_from=s.public_from?new Date(s.public_from):void 0,this.public_to=s.public_to?new Date(s.public_to):void 0,this.private_visible=s.private_visible,this.daily_from=s.daily_from?new Date(s.daily_from):void 0,this.daily_to=s.daily_to?new Date(s.daily_to):void 0}}var S=o(22264);class u extends t.w{constructor(s){super(s),this.name=s.name,this.description=s.description,this.status=s.status,this.price=s.price,this.parent_id=s.parent_id,this.index=s.index,this.secret=s.secret,this.secret_desc=s.secret_desc,this.visibility_id=s.visibility_id,this.visibility=s.visibility?new h(s.visibility):void 0,this.parent=s.parent?new u(s.parent):void 0,this.children=s.children?s.children.map(T=>new u(T)):[],this.images=s.images?s.images.map(T=>new S.W(T)):[],this.translations=s.translations}}},11712:(L,f,o)=>{"use strict";o.d(f,{S:()=>M});var t=o(36012),h=o(45820),S=o(54704),u=o(54496);let M=(()=>{class s extends t.s{constructor(){super(h.Q,"admin/menu/categories")}addCategory(l,c,d={}){return this.post(`${l}/add_category/${c}`,d)}addDish(l,c){return this.post(`${l}/dishes/${c}`,{})}removeDish(l,c){return this.delete(`${l}/dishes/${c}`,{})}orderDishes(l,c){return this.patch(`${l}/order_dishes`,{field:c})}dashboardData(l){return this.get(`${l}/dashboard_data`)}updateVisibility(l,c){return this.patch(`${l}/visibility`,c).pipe((0,S.k)(d=>this.mapItem(d)))}copy(l,c){return this.post(`${l}/copy`,c).pipe((0,S.k)(d=>this.mapItem(d)))}move(l,c){return this.patch(`${l}/move/${c}`,{}).pipe((0,S.k)(d=>this.mapItem(d)))}static#t=this.\u0275fac=function(c){return new(c||s)};static#e=this.\u0275prov=u.wxM({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()},57624:()=>{}}]);