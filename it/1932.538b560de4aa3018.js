"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[1932],{2208:(y,A,e)=>{e.d(A,{G:()=>z});var t=e(4496),T=e(9956),o=e(6504),M=e(8212),C=e(8048),S=e(5193),d=e(3797),a=e(9888),m=e(3320),l=e(6380),I=e(2740),s=e(400),h=e(3480),n=e(4680),E=e(5e3),g=e(8304),p=e(3616),P=e(6684),D=e(9212),V=e(7368),$=e(8824),G=e(1343),K=e(1560),r=e(1368),f=e(9772),O=e(964),u=e(4208),v=e(4820),B=e(7936);const U=(N,x)=>({date:N,time:x});function F(N,x){if(1&N&&(t.I0R(0,"app-reservation-tables-summary",26)(1,"p"),t.OEk(2,"Situazione tavoli per l'orario selezionato:"),t.C$Y()()),2&N){const _=t.GaO();let R;t.E7m("filters",t.IBC(1,U,_.form.value.date,null!==(R=_.utcTime())&&void 0!==R?R:""))}}function W(N,x){if(1&N){const _=t.KQA();t.I0R(0,"button",27),t.qCj("click",function(){t.usT(_);const i=t.GaO();return i.dateOpen.set(!0),t.CGJ(i.timeOpen.set(!1))}),t.I0R(1,"span",3)(2,"span",28),t.aS0(3,29),t.C$Y(),t.I0R(4,"mat-icon"),t.OEk(5,"calendar_today"),t.C$Y()()()}}let z=(()=>{class N{set item(_){_?this.form.patchValue({date:_.datetime?new s.EK(_.datetime?.getFullYear(),_.datetime?.getMonth(),_.datetime?.getDate()):null,time:_.datetime?new s.uc(_.datetime?.getHours(),_.datetime?.getMinutes()):null,fullname:_.fullname,adults:_.adults,children:_.children,email:_.email,table:_.table,notes:_.notes,phone:_.phone}):this.form.reset()}constructor(_){this.isMobile=_,this.reservationsService=(0,t.uUt)(g.S),this.publicRes=(0,t.uUt)(v.G),this.destroy$=(0,t.uUt)(h.UF),this.datePipe=(0,t.uUt)(r.y),this.formSubmit=new t._w7,this.cancelled=new t._w7,this.validTimes=(0,t.OCB)([]),this.utcTime=(0,t.OCB)(null),this.today=s.EK.currentLocal(),this.inputSize="l",this.form=new o.WC({date:new o.Ku(null,[o.AQ.required]),time:new o.Ku(null,[o.AQ.required]),fullname:new o.Ku(null,[o.AQ.required]),adults:new o.Ku(null,[o.AQ.required,o.AQ.min(0)]),children:new o.Ku(0,[o.AQ.required,o.AQ.min(0)]),email:new o.Ku(null,[o.AQ.email]),table:new o.Ku(null),notes:new o.Ku(null),phone:new o.Ku(null)}),this.loading=!1,this.dateOpen=(0,t.OCB)(!1),this.timeOpen=(0,t.OCB)(!1),this.loadingTimes=(0,t.OCB)(!1),this.submitted=!1,this.e=this.errorsFor}ngOnInit(){this.dateOpen.set(!0),this.timeOpen.set(!1),this.form.get("date").valueChanges.pipe((0,p.a)(this.destroy$),(0,P.I)(_=>_ instanceof s.EK),(0,D.y)(()=>this.dateOpen.set(!1)),(0,D.y)(()=>this.timeOpen.set(!0)),(0,D.y)(()=>this.loadingTimes.set(!0)),(0,V.G)(_=>this.publicRes.getValidTimes(_)),(0,$.U)(()=>this.loadingTimes.set(!1))).subscribe({next:_=>{const R=_.map(i=>i.valid_times).filter(i=>Array.isArray(i)&&i.length>0).flat();this.validTimes.set(R.map(i=>s.uc.fromString((0,f.CU)(i))))}}),this.form.get("time").valueChanges.pipe((0,p.a)(this.destroy$),(0,D.y)(()=>this.timeOpen.set(!1)),(0,D.y)(_=>this.utcTime.set(_?(0,f.ye)(_.toString("HH:MM")):null))).subscribe((0,G.I)())}submit(){this.submitted=!0,!this.form.invalid&&this.formSubmit.emit(this.formVal())}formVal(){const _=this.form.value;return _.datetime=(0,O.Qx)(_.date,_.time),delete _.date,delete _.time,_}errorsFor(_){const R=this.form.get(_);return R&&(R.dirty||R.touched||this.submitted)?R.errors:null}cancel(){this.cancelled.emit()}static#t=this.\u0275fac=function(R){return new(R||N)(t.GI1(n.Mv))};static#e=this.\u0275cmp=t.In1({type:N,selectors:[["app-admin-reservation-form"]],inputs:{item:"item",loading:"loading"},outputs:{formSubmit:"formSubmit",cancelled:"cancelled"},standalone:!0,features:[t.M5G([h.UF,r.y]),t.UHJ],decls:59,vars:41,consts:()=>{let _,R,i,L,j,Y,X,w,b,k,Q,J;return _="Data",R="Ora",i="Nome",L="N\xB0 adulti",j="N\xB0 bambini",Y="Email",X="Tavolo",w="Cellulare",b="Note",k="Conferma",Q="Annulla",J="Imposta data",[[3,"autocomplete","formGroup","ngSubmit"],["class","block mb-3",3,"filters"],[1,"mb-3"],[1,"flex","items-center"],[1,"me-2","grow",3,"tuiDropdownOpen","tuiAutoFocus","tuiTextfieldSize","min","formControlName"],_,["formControlName","time",1,"grow",3,"tuiDropdownOpen","tuiTextfieldSize","items"],R,["tuiButton","","appearance","icon","type","button","size","s"],[3,"errors"],[3,"tuiTextfieldSize","formControlName"],i,["tuiTextfield","","type","text",3,"autocomplete"],[1,"me-2","grow",3,"tuiTextfieldSize","formControlName"],L,[1,"ms-2","grow",3,"tuiTextfieldSize","formControlName"],j,Y,X,w,b,[1,"flex"],["tuiButton","","type","submit","size","l",1,"me-2",3,"showLoader"],k,["tuiButton","","type","button","appearance","icon","size","l",3,"showLoader","click"],Q,[1,"block","mb-3",3,"filters"],["tuiButton","","appearance","icon","type","button","size","s",3,"click"],[1,"me-1"],J]},template:function(R,i){1&R&&(t.I0R(0,"form",0),t.qCj("ngSubmit",function(){return i.submit()}),t.yuY(1,F,3,4,"app-reservation-tables-summary",1),t.I0R(2,"div",2)(3,"div",3)(4,"tui-input-date",4),t.SAx(5),t.aS0(6,5),t.k70(),t.C$Y(),t.I0R(7,"tui-input-time",6),t.SAx(8),t.aS0(9,7),t.k70(),t.C$Y()(),t.yuY(10,W,6,0,"button",8),t.wR5(11,"app-errors",9),t.C$Y(),t.I0R(12,"div",2)(13,"tui-input",10),t.SAx(14),t.aS0(15,11),t.k70(),t.wR5(16,"input",12),t.C$Y(),t.wR5(17,"app-errors",9),t.C$Y(),t.I0R(18,"div",2)(19,"div",3)(20,"tui-input-number",13),t.SAx(21),t.aS0(22,14),t.k70(),t.wR5(23,"input",12),t.C$Y(),t.I0R(24,"tui-input-number",15),t.SAx(25),t.aS0(26,16),t.k70(),t.wR5(27,"input",12),t.C$Y()()(),t.I0R(28,"div",2)(29,"tui-input",10),t.SAx(30),t.aS0(31,17),t.k70(),t.wR5(32,"input",12),t.C$Y(),t.wR5(33,"app-errors",9),t.C$Y(),t.I0R(34,"div",2)(35,"tui-input",10),t.SAx(36),t.aS0(37,18),t.k70(),t.wR5(38,"input",12),t.C$Y(),t.wR5(39,"app-errors",9),t.C$Y(),t.I0R(40,"div",2)(41,"tui-input",10),t.SAx(42),t.aS0(43,19),t.k70(),t.wR5(44,"input",12),t.C$Y(),t.wR5(45,"app-errors",9),t.C$Y(),t.I0R(46,"div",2)(47,"tui-input",10),t.SAx(48),t.aS0(49,20),t.k70(),t.wR5(50,"input",12),t.C$Y(),t.wR5(51,"app-errors",9),t.C$Y(),t.I0R(52,"div",21)(53,"button",22),t.SAx(54),t.aS0(55,23),t.k70(),t.C$Y(),t.I0R(56,"button",24),t.qCj("click",function(){return i.cancel()}),t.SAx(57),t.aS0(58,25),t.k70(),t.C$Y()()()),2&R&&(t.E7m("autocomplete","off")("formGroup",i.form),t.yG2(),t.C0Y(1,i.form.value.date&&i.utcTime()?1:-1),t.yG2(3),t.E7m("tuiDropdownOpen",i.dateOpen())("tuiAutoFocus",!0)("tuiTextfieldSize",i.inputSize)("min",i.today)("formControlName","date"),t.yG2(3),t.E7m("tuiDropdownOpen",i.timeOpen())("tuiTextfieldSize",i.inputSize)("items",i.validTimes()),t.yG2(3),t.C0Y(10,i.isMobile?10:-1),t.yG2(),t.E7m("errors",i.e("datetime")),t.yG2(2),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","fullname"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",i.e("fullname")),t.yG2(3),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","adults"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","children"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(2),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","email"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",i.e("email")),t.yG2(2),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","table"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",i.e("table")),t.yG2(2),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","phone"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",i.e("phone")),t.yG2(2),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","notes"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",i.e("notes")),t.yG2(2),t.E7m("showLoader",i.loading),t.yG2(3),t.E7m("showLoader",i.loading))},dependencies:[T.g,o.sl,o.sz,o.ue,o.u,o.uW,o.Wo,M.CI,M.Kw,d.CQ,d.Oo,d.cP,B.b,C.aS,C.rD,a.Q7,a.mi,a.Qj,m.K6,l.iO,l.yc,l.Ml,I.IZ,I.iw,I.gt,E.m6,E.gJ,S.ms,S.oL,K.qL,u.u],encapsulation:2})}return N})()},1676:(y,A,e)=>{e.d(A,{s:()=>I});var t=e(4496),T=e(6772),o=e(1128),M=e(7048),C=e(8256),S=e(8392),d=e(6700),a=e(4704),m=e(9212);let I=(()=>{class s extends T.A{constructor(){super("public_data"),this.notifications=(0,t.uUt)(o.E),this.data$=new d.g(null),this.messages=(0,t.OCB)(null),this.messages$=this.data$.pipe((0,a.k)(n=>"object"==typeof n&&null!==n?function l(s){if(null==s)return null;if("object"==typeof s)return s;if(!("string"==typeof s&&s.length>0))return null;try{return JSON.parse(s)}catch{}return null}(n.public_messages):null),(0,m.y)(n=>this.messages.set(n))),this.contacts=(0,t.OCB)(null),this.contacts$=this.data$.pipe((0,a.k)(n=>"object"==typeof n&&null!==n?n.contacts:null),(0,m.y)(n=>this.contacts.set(n))),this.load(),[this.contacts$,this.messages$].forEach(n=>{n.subscribe({error:E=>{console.warn("unexpected error",E)}})})}load(){this.http.get("").subscribe({next:n=>{this.data$.next(n)},error:n=>{this.notifications.error(n instanceof M.gj?(0,C.mk)(n):S.a)}})}static#t=this.\u0275fac=function(E){return new(E||s)};static#e=this.\u0275prov=t.wxM({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()},4820:(y,A,e)=>{e.d(A,{G:()=>I});var t=e(4496),T=e(5180),o=e(6700),M=e(4704),C=e(9212),S=e(9144),d=e(6772),a=e(1676),m=e(5136),l=e(400);let I=(()=>{class s extends d.A{constructor(){super("reservations"),this.publicData=(0,t.uUt)(a.s),this.created=new o.g(null),this.publicData.data$.subscribe({next:n=>{this.created.next(n?.reservation?new T.C(n.reservation):null)}})}getValidTimes(n){let E="";return n instanceof l.EK&&(E=`${n.year}-${(n.month+1)%13}-${n.day}`),this.get("valid_times",{params:{date:E}}).pipe((0,M.k)(g=>g.map(p=>new m.e(p))))}getValidDates(n){return this.get("valid_dates",{params:n}).pipe((0,M.k)(E=>E.map(g=>l.EK.fromLocalNativeDate(new Date(g)))))}load(n){return this.get(`${n}`).pipe((0,M.k)(E=>new T.C(E.item)))}create(n){return this.post("",n).pipe((0,M.k)(E=>new T.C(E.item)),(0,C.y)(E=>this.created.next(E)),(0,S.a)(E=>{throw this.created.next(null),E}))}resendConfirmation(n){return this.post(`${n}/resend_confirmation_email`,{})}cancel(n){return this.post(`${n}/cancel`,{})}static#t=this.\u0275fac=function(E){return new(E||s)};static#e=this.\u0275prov=t.wxM({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()},6988:(y,A,e)=>{e.d(A,{E:()=>S,Q:()=>d});var t=e(4496),T=e(3480),o=e(3840),M=e(3120),C=e(3616);let S=(()=>{class a{constructor(l,I){this.el=l,this.destroy$=I}set tuiScrollIntoView(l){l&&(0,M.k)(0).pipe((0,C.a)(this.destroy$)).subscribe(()=>{this.el.nativeElement.dispatchEvent(new CustomEvent(o.dG,{bubbles:!0,detail:this.el.nativeElement}))})}}return a.\u0275fac=function(l){return new(l||a)(t.GI1(t.GMv),t.GI1(T.UF,2))},a.\u0275dir=t.Sc5({type:a,selectors:[["","tuiScrollIntoView",""]],inputs:{tuiScrollIntoView:"tuiScrollIntoView"},features:[t.M5G([T.UF])]}),a})(),d=(()=>{class a{}return a.\u0275fac=function(l){return new(l||a)},a.\u0275mod=t.a4G({type:a}),a.\u0275inj=t.s3X({}),a})()},5384:(y,A,e)=>{e.d(A,{E$:()=>G,YB:()=>K,wu:()=>$});var t=e(4496),T=e(6504),o=e(900),M=e(4392),C=e(2528),S=e(1800),d=e(3656),a=e(6988),m=e(5944),l=e(4336),I=e(1040),s=e(5657),h=e(3412),n=e(8960),E=e(5568),g=e(4704),p=e(4e3),P=e(1368);function D(r,f){if(1&r&&t.wR5(0,"tui-svg",3),2&r){const O=t.GaO();t.E7m("src",O.icons.check)("tuiScrollIntoView",!0)}}function V(r,f){1&r&&t.wR5(0,"span",4)}let $=(()=>{class r{constructor(O,u,v,B,U,F,W,z){this.icons=O,this.context=u,this.host=v,this.el=B,this.option=U,this.dataList=F,this.control=W,this.abstractControl=z,this.changeDetection$=new s.E,this.selected$=(0,h.U)(this.changeDetection$,this.control.valueChanges||n.k,(0,o.Ax)(this.el.nativeElement,"animationstart")).pipe((0,E.W)(null),(0,g.k)(()=>this.selected),(0,p.a)())}get matcher(){return this.host.identityMatcher||M.y}ngOnInit(){Promise.resolve().then(()=>{var O,u;(0,C.kF)(this.option.value)&&!this.option.disabled&&(null===(u=(O=this.host).checkOption)||void 0===u||u.call(O,this.option.value))})}ngDoCheck(){this.changeDetection$.next()}get value(){var O,u;return null!==(u=null===(O=this.abstractControl)||void 0===O?void 0:O.value)&&void 0!==u?u:this.control.value}get selected(){return(0,C.kF)(this.option.value)&&(0,C.kF)(this.value)&&this.matcher(this.value,this.option.value)}}return r.\u0275fac=function(O){return new(O||r)(t.GI1(m.QJ),t.GI1(I.C0),t.GI1(m.u2),t.GI1(t.GMv),t.GI1(l.sP),t.GI1(l.yi,8),t.GI1(T.eq),t.GI1(S._y,8))},r.\u0275cmp=t.In1({type:r,selectors:[["tui-select-option"]],decls:5,vars:5,consts:[[3,"ngTemplateOutlet"],["automation-id","tui-select-option__checkmark","class","t-checkmark",3,"src","tuiScrollIntoView",4,"ngIf","ngIfElse"],["dummy",""],["automation-id","tui-select-option__checkmark",1,"t-checkmark",3,"src","tuiScrollIntoView"],[1,"t-dummy"]],template:function(O,u){if(1&O&&(t.C_f(0,0),t.yuY(1,D,1,2,"tui-svg",1),t.wVc(2,"async"),t.yuY(3,V,1,0,"ng-template",null,2,t.gJz)),2&O){const v=t.Gew(4);t.E7m("ngTemplateOutlet",u.context.$implicit),t.yG2(),t.E7m("ngIf",t.kDX(2,3,u.selected$))("ngIfElse",v)}},dependencies:[d.Wu,P.XV,P.u_,a.E,P.a],styles:['@keyframes _ngcontent-%COMP%_retrigger{0%{left:1px}to{left:2px}}[_nghost-%COMP%]{display:flex;flex:1;align-items:center;max-width:100%;animation:_ngcontent-%COMP%_retrigger 1s}.t-checkmark[_ngcontent-%COMP%]{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-border-start:.25rem solid transparent;border-inline-start:.25rem solid transparent}tui-data-list[data-list-size="s"][_nghost-%COMP%]   .t-checkmark[_ngcontent-%COMP%], tui-data-list[data-list-size="s"]   [_nghost-%COMP%]   .t-checkmark[_ngcontent-%COMP%]{-webkit-margin-end:-.375rem;margin-inline-end:-.375rem}tui-data-list[data-list-size="m"][_nghost-%COMP%]   .t-checkmark[_ngcontent-%COMP%], tui-data-list[data-list-size="m"]   [_nghost-%COMP%]   .t-checkmark[_ngcontent-%COMP%]{-webkit-margin-end:-.125rem;margin-inline-end:-.125rem}.t-dummy[_ngcontent-%COMP%]{width:1.75rem}'],changeDetection:0}),r})();const G=new I.WO($);let K=(()=>{class r{}return r.\u0275fac=function(O){return new(O||r)},r.\u0275mod=t.a4G({type:r}),r.\u0275inj=t.s3X({imports:[[P.MD,d.Yt,a.Q]]}),r})()}}]);