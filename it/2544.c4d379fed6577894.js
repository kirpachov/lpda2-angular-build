"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[2544],{9064:(A,p,o)=>{o.d(p,{w:()=>D});var n=o(4496),m=o(6504),t=o(3480),C=o(6700),O=o(3616),e=o(6684),E=o(3797),a=o(8588),c=o(1368),u=o(9956),g=o(1292);function f(_,T){if(1&_&&(n.I0R(0,"tui-textarea",2),n.OEk(1),n.C$Y()),2&_){const i=n.GaO().$implicit,r=n.GaO();n.E7m("formControl",i.control),n.yG2(),n.oRS(" ",r.getFullLang(i.lang)," ")}}function M(_,T){if(1&_&&(n.I0R(0,"tui-input",2),n.OEk(1),n.C$Y()),2&_){const i=n.GaO().$implicit,r=n.GaO();n.E7m("formControl",i.control),n.yG2(),n.oRS(" ",r.getFullLang(i.lang)," ")}}const S=_=>({"mb-3":_});function N(_,T){if(1&_&&(n.SAx(0),n.I0R(1,"div",1),n.yuY(2,f,2,2,"tui-textarea",2)(3,M,2,2),n.wR5(4,"app-errors",3),n.C$Y(),n.k70()),2&_){const i=T.$implicit,r=T.last,R=n.GaO();n.yG2(),n.E7m("ngClass",n.S45(3,S,!r)),n.yG2(),n.C0Y(2,R.long?2:3),n.yG2(2),n.E7m("errors",i.control.errors)}}const $=["*"];let D=(()=>{class _{constructor(){this.destroy$=new t.UF,this.long=!1,this.controls=(0,n.OCB)({}),this.controlsArr=(0,n.S6b)(()=>{const i=this.controls();return Object.keys(i).map(r=>({lang:r,control:i[r]}))}),this.touched$=new C.g(!1),this.value$=new C.g({})}ngAfterViewInit(){this.addLang("it"),this.addLang("en")}ngOnInit(){}registerOnChange(i){this.value$.pipe((0,O.a)(this.destroy$)).subscribe({next:r=>i(r)})}registerOnTouched(i){this.touched$.pipe((0,e.I)(r=>!0===r)).subscribe({next:()=>i()})}writeValue(i){this.patchValue(i??{}),this.touched$.next(!1)}wasTouched(){this.touched$.next(!0)}getFullLang(i){return g.S[i]??i}controlChanged(i){this.value$.next({...this.value$.value,[i]:this.controls()[i].value})}patchValue(i){Object.keys(i).forEach(r=>this.addLang(r)),Object.keys(this.controls()).forEach(r=>{this.controls()[r].patchValue(i[r]??null)})}addLang(i){if(this.controls()[i])return;const r=new m.Ku;r.valueChanges.subscribe({next:()=>this.controlChanged(i)}),this.controls.set({...this.controls(),[i]:r})}static#t=this.\u0275fac=function(r){return new(r||_)};static#e=this.\u0275cmp=n.In1({type:_,selectors:[["app-i18n-input"]],inputs:{long:"long"},standalone:!0,features:[n.M5G([{provide:m.Y6,useExisting:(0,n.wd)(()=>_),multi:!0},t.UF]),n.UHJ],ngContentSelectors:$,decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"ngClass"],[3,"formControl"],[3,"errors"]],template:function(r,R){1&r&&(n.kPM(),n._Xx(0),n.yuY(1,N,5,5,"ng-container",0)),2&r&&(n.yG2(),n.E7m("ngForOf",R.controlsArr()))},dependencies:[m.sl,m.ue,m.ug,E.CQ,E.Oo,E.cP,c.Iw,u.g,c.QF,a.Y3,a.wp,a.kd],changeDetection:0})}return _})()},2544:(A,p,o)=>{o.r(p),o.d(p,{CreateCategoryModule:()=>b});var n=o(1236),m=o(7552),t=o(4496),C=o(8212),O=o(8976),e=o(4436),E=o(1512),a=o(9956),c=o(9064),u=o(6504),g=o(3480),f=o(1712),M=o(3616),S=o(4704),N=o(6684),$=o(8824),D=o(5820),_=o(9088),T=o(9938),i=o(1128),r=o(8256),R=o(3580),I=o(8392);function U(h,B){if(1&h&&(t.I0R(0,"h1",10)(1,"span"),t.aS0(2,11),t.C$Y()(),t.I0R(3,"div",1)(4,"span",12),t.SAx(5),t.aS0(6,13),t.k70(),t.C$Y(),t.I0R(7,"a",14),t.wVc(8,"urlTo"),t.OEk(9),t.C$Y()()),2&h){const s=t.GaO();let l,d;t.yG2(7),t.E7m("routerLink",t.g7$(8,2,null==(l=s.parent())?null:l.id,"menuCategory.show")),t.yG2(2),t.cNF(null==(d=s.parent())?null:d.name)}}function L(h,B){1&h&&(t.I0R(0,"h1"),t.SAx(1),t.aS0(2,15),t.k70(),t.C$Y())}let Y=(()=>{class h{constructor(){this.service=(0,t.uUt)(f.S),this.destroy$=(0,t.uUt)(g.UF),this.router=(0,t.uUt)(n.E5),this.route=(0,t.uUt)(n.gV),this.urlTo=(0,t.uUt)(_.S),this.notifications=(0,t.uUt)(i.E),this.afterUrl=this.route.snapshot.queryParams.afterUrl,this.form=new u.WC({name:new u.Ku(null)}),this.parentId=null,this.parent=(0,t.OCB)(null),this.loading=(0,t.OCB)(!1),this.submitted=!1,this.e=this.errorsFor}ngOnInit(){this.route.parent?.parent?.params.pipe((0,M.a)(this.destroy$),(0,S.k)(s=>Number(s.category_id)),(0,N.I)(s=>"number"==typeof s&&!isNaN(s)&&s>0)).subscribe({next:s=>{this.parentId=s,this.loadParent()}})}submit(){this.submitted=!0,!this.form.invalid&&(this.loading.set(!0),this.service.create(this.formData()).pipe((0,M.a)(this.destroy$),(0,$.U)(()=>this.loading.set(!1))).subscribe({next:s=>{const l=this.afterUrl||this.urlTo.transform(s.id,"menuCategory.show");console.assert(l,`URL for menu category ${s.id} not found`),this.router.navigate([l],{relativeTo:this.route}),this.notifications.fireSnackBar("Categoria creata.")},error:s=>{T.y.assignErrorsToForm(this.form,s),this.notifications.error((0,r.mk)(s)||I.a)}}))}formData(){const s=this.form.value,l=this.parent();return l instanceof D.Q&&(s.parent_id=l.id),s}errorsFor(s){const l=this.form.get(s);return l&&(l.dirty||l.touched||this.submitted)?l.errors:null}cancel(){this.router.navigate([this.afterUrl||".."],{relativeTo:this.route})}loadParent(s=this.parentId){s&&(this.loading.set(!0),this.service.show(s).pipe((0,M.a)(this.destroy$),(0,$.U)(()=>this.loading.set(!1))).subscribe({next:l=>{this.parent.set(l)},error:l=>{this.notifications.error((0,r.mk)(l)||I.a)}}))}static#t=this.\u0275fac=function(l){return new(l||h)};static#e=this.\u0275cmp=t.In1({type:h,selectors:[["app-create-category"]],standalone:!0,features:[t.M5G([g.UF,_.S]),t.UHJ],decls:15,vars:5,consts:()=>{let s,l,d,y,P,G;return s="Nome",l="Conferma",d="Annulla",y="Crea nuova categoria",P="La categoria verr\xE0 creata come sottocategoria di",G="Crea nuovo men\xF9",[[3,"formGroup","ngSubmit"],[1,"mb-3"],["formControlName","name"],s,[3,"errors"],[1,"flex"],["tuiButton","","type","submit","size","l",1,"me-2",3,"showLoader"],l,["tuiButton","","type","button","appearance","icon","size","l",3,"showLoader","click"],d,[1,"flex","items-center"],y,[1,"me-2","text-slate-400"],P,["tuiLink","",3,"routerLink"],G]},template:function(l,d){1&l&&(t.yuY(0,U,10,5)(1,L,3,0),t.I0R(2,"form",0),t.qCj("ngSubmit",function(){return d.submit()}),t.I0R(3,"div",1)(4,"app-i18n-input",2),t.SAx(5),t.aS0(6,3),t.k70(),t.C$Y(),t.wR5(7,"app-errors",4),t.C$Y(),t.I0R(8,"div",5)(9,"button",6),t.SAx(10),t.aS0(11,7),t.k70(),t.C$Y(),t.I0R(12,"button",8),t.qCj("click",function(){return d.cancel()}),t.SAx(13),t.aS0(14,9),t.k70(),t.C$Y()()()),2&l&&(t.C0Y(0,d.parent()?0:1),t.yG2(2),t.E7m("formGroup",d.form),t.yG2(5),t.E7m("errors",d.e("name")),t.yG2(2),t.E7m("showLoader",d.loading()),t.yG2(3),t.E7m("showLoader",d.loading()))},dependencies:[C.CI,C.Kw,a.g,c.w,u.sl,u.sz,u.ue,u.u,u.uW,u.Wo,O.Gy,R.W,e.a,E.w,E.C,n.ER,_.S],encapsulation:2,changeDetection:0})}return h})(),b=(()=>{class h{static#t=this.\u0275fac=function(l){return new(l||h)};static#e=this.\u0275mod=t.a4G({type:h});static#n=this.\u0275inj=t.s3X({imports:[n.qQ.forChild([(0,m.VV)(Y,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return h})()},1292:(A,p,o)=>{o.d(p,{S:()=>n});const n={it:"Italiano",en:"Inglese",es:"Spagnolo",fr:"Francese",de:"Tedesco",pt:"Portoghese",ru:"Russo",zh:"Cinese",ja:"Giapponese",ar:"Arabo",hi:"Hindi",bn:"Bengalese",pa:"Punjabi",ms:"Malese"}},5820:(A,p,o)=>{o.d(p,{Q:()=>C});var n=o(8400);class m extends n.w{constructor(e){super(e),this.public_visible=e.public_visible,this.public_from=e.public_from?new Date(e.public_from):void 0,this.public_to=e.public_to?new Date(e.public_to):void 0,this.private_visible=e.private_visible,this.daily_from=e.daily_from?new Date(e.daily_from):void 0,this.daily_to=e.daily_to?new Date(e.daily_to):void 0}}var t=o(2264);class C extends n.w{constructor(e){super(e),this.name=e.name,this.description=e.description,this.status=e.status,this.price=e.price,this.parent_id=e.parent_id,this.index=e.index,this.secret=e.secret,this.secret_desc=e.secret_desc,this.visibility_id=e.visibility_id,this.visibility=e.visibility?new m(e.visibility):void 0,this.parent=e.parent?new C(e.parent):void 0,this.children=e.children?e.children.map(E=>new C(E)):[],this.images=e.images?e.images.map(E=>new t.W(E)):[],this.translations=e.translations,this.public_visible=e.public_visible,this.stats=e.stats}}},9088:(A,p,o)=>{o.d(p,{S:()=>t});var n=o(4496);const m={menuCategory:{show:"/admin/menu/{itemId}",duplicate:"/admin/menu/{itemId}/duplicate",export:"/admin/menu/{itemId}/export",createChild:"/admin/menu/{itemId}/create-category",linkCategory:"/admin/menu/{itemId}/link-category",createDish:"/admin/menu/{itemId}/create-dish",linkDish:"/admin/menu/{itemId}/link-dish",private:"/menu/{itemId}",public:"/menu/{itemId}"},dish:{show:"/admin/menu/{categoryId}/dish/{itemId}"}};let t=(()=>{class C{transform(e,E){const a=m[E.split(".")[0]];if(!a)throw new Error(`Resource not found: ${E} (resouce: ${E.split(".")[0]})`);const c=E.split(".")[1];if(!a[c])throw new Error(`Action not found: ${E} (action: ${c})`);if(typeof e>"u"||null===e)return null;if("number"==typeof e&&(e=e.toString()),"object"==typeof e&&null!==e&&!Array.isArray(e)){let u=a[c];if(Object.keys(e).forEach(g=>{const f=e[g];void 0!==f&&u.includes(`{${g}}`)&&(u=u.replace(`{${g}}`,f??""))}),u.includes("{{"))throw new Error(`Unresolved interpolation: ${u}`);return u}if("string"!=typeof e)throw new Error(`Invalid itemId: ${e} (type: ${typeof e})`);return a[c].replace("{itemId}",e)}static#t=this.\u0275fac=function(E){return new(E||C)};static#e=this.\u0275pipe=n.UTH({name:"urlTo",type:C,pure:!0,standalone:!0})}return C})()},1712:(A,p,o)=>{o.d(p,{S:()=>O});var n=o(6012),m=o(5820),t=o(4704),C=o(4496);let O=(()=>{class e extends n.s{constructor(){super(m.Q,"admin/menu/categories")}addCategory(a,c,u={}){return this.post(`${a}/add_category/${c}`,u)}addDish(a,c){return this.post(`${a}/dishes/${c}`,{})}removeDish(a,c){return this.delete(`${a}/dishes/${c}`,{})}orderDishes(a,c){return this.patch(`${a}/order_dishes`,{field:c})}dashboardData(a){return this.get(`${a}/dashboard_data`)}updateVisibility(a,c){return this.patch(`${a}/visibility`,c).pipe((0,t.k)(u=>this.mapItem(u)))}copy(a,c){return this.post(`${a}/copy`,c).pipe((0,t.k)(u=>this.mapItem(u)))}move(a,c){return this.patch(`${a}/move/${c}`,{}).pipe((0,t.k)(u=>this.mapItem(u)))}static#t=this.\u0275fac=function(c){return new(c||e)};static#e=this.\u0275prov=C.wxM({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})()}}]);