"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[9264],{864:(M,p,e)=>{e.r(p),e.d(p,{LinkDishModule:()=>d});var o=e(2992),h=e(7552),t=e(4496),l=e(4436),r=e(8212),i=e(1512),_=e(6504),n=e(3716),s=e(1712),a=e(3480),g=e(1128),I=e(3616),v=e(4704),D=e(4e3),P=e(8824),y=e(8256),A=e(9088);function $(u,O){1&u&&(t.I0R(0,"p"),t.aS0(1,10),t.C$Y(),t.I0R(2,"p"),t.aS0(3,11),t.C$Y())}const L=u=>({except_in_category:u});function m(u,O){if(1&u){const c=t.KQA();t.I0R(0,"form",12),t.qCj("ngSubmit",function(){t.usT(c);const C=t.GaO();return t.CGJ(C.submit())}),t.I0R(1,"app-dish-select",13),t.SAx(2),t.aS0(3,14),t.k70(),t.C$Y(),t.I0R(4,"div",0)(5,"button",15),t.SAx(6),t.aS0(7,16),t.k70(),t.C$Y(),t.I0R(8,"button",17),t.qCj("click",function(){t.usT(c);const C=t.GaO();return t.CGJ(C.cancel())}),t.SAx(9),t.aS0(10,18),t.k70(),t.C$Y()()()}if(2&u){const c=t.GaO();t.E7m("formGroup",c.form),t.yG2(),t.E7m("filters",t.S45(3,L,c.categoryId))("formControlName","dish")}}let f=(()=>{class u{constructor(){this.service=(0,t.uUt)(s.S),this.destroy$=(0,t.uUt)(a.UF),this.route=(0,t.uUt)(o.gV),this.router=(0,t.uUt)(o.E5),this.notifications=(0,t.uUt)(g.E),this.loading=(0,t.OCB)(!1),this.category=(0,t.OCB)(null),this.categoryId=null,this.form=new _.WC({dish:new _.Ku(null)})}ngOnInit(){this.route.parent?.parent?.params.pipe((0,I.a)(this.destroy$),(0,v.k)(c=>c.category_id),(0,D.a)()).subscribe({next:c=>{this.categoryId=c,this.loadCategory()}})}submit(){const c=this.categoryId,E=this.form.value?.dish?.id;c&&E?this.form.invalid||(this.loading.set(!0),this.service.addDish(c,E).pipe((0,I.a)(this.destroy$),(0,P.U)(()=>this.loading.set(!1))).subscribe({next:()=>{this.navigateBack(),this.notifications.fireSnackBar("Piatto aggiunto.")},error:C=>{this.notifications.error((0,y.mk)(C)||"Qualcosa \xE8 andato storto nell'aggiunta del piatto.")}})):console.error("something invalid.",{categoryId:c,dishId:E})}cancel(){(this.form.touched||this.form.dirty)&&!confirm("Sei sicuro di voler annullare questa azione?")||this.navigateBack()}navigateBack(){const c=this.route.snapshot.queryParams.afterUrl;c?this.router.navigateByUrl(c):this.router.navigate([".."],{relativeTo:this.route})}loadCategory(){this.category.set(null),this.categoryId&&this.service.show(this.categoryId).pipe((0,I.a)(this.destroy$)).subscribe({next:c=>{this.category.set(c)},error:c=>{this.notifications.error((0,y.mk)(c)||"Qualcosa \xE8 andato storto nel caricamento della categoria padre.")}})}static#t=this.\u0275fac=function(E){return new(E||u)};static#e=this.\u0275cmp=t.In1({type:u,selectors:[["app-link-dish"]],standalone:!0,features:[t.M5G([a.UF]),t.UHJ],decls:15,vars:7,consts:()=>{let c,E,C,N,S,R,U;return c="Associa piatto esistente",E="Il piatto verr\xE0 aggiunto alla categoria",C="Associare un piatto esistente ti permette di tenere lo stesso identico piatto presente in pi\xF9 categorie.",N="Il vantaggio \xE8 che quando devi apportare una modifica al piatto, lo devi fare una volta sola.",S="Piatto da associare",R="Conferma",U="Annulla",[[1,"flex","items-center"],[1,"me-2"],c,[3,"content"],[1,"mb-3"],[1,"me-2","text-slate-400"],E,["tuiLink","",3,"routerLink"],["helpMsg",""],[3,"formGroup"],C,N,[3,"formGroup","ngSubmit"],[1,"block","mb-3",3,"filters","formControlName"],S,["tuiButton","","type","submit","size","l","appearance","primary",1,"me-2"],R,["tuiButton","","type","button","size","l","appearance","outline",3,"click"],U]},template:function(E,C){if(1&E&&(t.I0R(0,"span",0)(1,"h1",1),t.SAx(2),t.aS0(3,2),t.k70(),t.C$Y(),t.wR5(4,"tui-tooltip",3),t.C$Y(),t.I0R(5,"div",4)(6,"span",5),t.SAx(7),t.aS0(8,6),t.k70(),t.C$Y(),t.I0R(9,"a",7),t.wVc(10,"urlTo"),t.OEk(11),t.C$Y()(),t.yuY(12,$,4,0,"ng-template",null,8,t.gJz)(14,m,11,5,"form",9)),2&E){const N=t.Gew(13);let S,R;t.yG2(4),t.E7m("content",N),t.yG2(5),t.E7m("routerLink",t.g7$(10,4,null==(S=C.category())?null:S.id,"menuCategory.show")),t.yG2(2),t.cNF(null==(R=C.category())?null:R.name),t.yG2(3),t.C0Y(14,C.categoryId?14:-1)}},dependencies:[l.a,l.i,_.sl,_.sz,_.ue,_.u,_.uW,_.Wo,n.i,r.CI,r.Kw,i.w,i.C,o.ER,A.S],changeDetection:0})}return u})(),d=(()=>{class u{static#t=this.\u0275fac=function(E){return new(E||u)};static#e=this.\u0275mod=t.a4G({type:u});static#i=this.\u0275inj=t.s3X({imports:[o.qQ.forChild([(0,h.VV)(f,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return u})()},8256:(M,p,e)=>{function o(r,i){return r.error?.message?r.error.message:500==r.status?`${r.error.error} ${r.error.exception}`.replace(/\</gm,"").replace(/\>+/gm,""):504==r.status?"Server irraggiungibile, controlla la tua connessione e riprova.":h(function l(r){if("object"==typeof r.error&&"object"==typeof r.error.details&&Array.isArray(r.error.details)&&r.error.details.length>0){const i=r.error.details.filter(_=>"object"==typeof _&&null!=_&&_ instanceof Object&&Object.keys(_).length>0).filter(_=>"string"==typeof _.attribute&&_.attribute.length>0&&("string"==typeof _.message&&_.message.length>0||Array.isArray(_.message)&&_.message.length>0));if(i.length>0)return i}return[]}(r),i)}function h(r,i){if(0==r.length)return null;const _=i?.joinChar??", ",n=r.map(s=>`${s.attribute} ${s.message}`);return n.length?function t(r){return[...new Set(r)]}(n).join(_):null}e.d(p,{Yj:()=>h,mk:()=>o})},4824:(M,p,e)=>{e.d(p,{o:()=>t});var o=e(8400),h=e(2264);class t extends o.w{constructor(r){super(r),this.name=r.name,this.description=r.description,this.status=r.status,this.other=r.other,this.translations={...r.translations},r.image&&(this.image=new h.W(r.image))}}},5891:(M,p,e)=>{e.d(p,{S:()=>i});var o=e(8400),h=e(2264),t=e(355),l=e(4824),r=e(532);class i extends o.w{constructor(n){super(n),this.name=n.name,this.description=n.description,this.status=n.status,this.price=n.price,this.translations=n.translations,this.images=n.images?n.images.map(s=>new h.W(s)):[],this.suggestions=n.suggestions?n.suggestions.map(s=>new i(s)):[],this.tags=n.tags?n.tags.map(s=>new t.E(s)):[],this.allergens=n.allergens?n.allergens.map(s=>new l.o(s)):[],this.ingredients=n.ingredients?n.ingredients.map(s=>new r.e(s)):[]}}},2264:(M,p,e)=>{e.d(p,{W:()=>h});var o=e(8400);class h extends o.w{constructor(l){super(l),this.filename=l.filename,this.status=l.status,this.key=l.key,this.original_id=l.original_id,this.tag=l.tag,this.url=l.url}}},532:(M,p,e)=>{e.d(p,{e:()=>t});var o=e(8400),h=e(2264);class t extends o.w{constructor(r){super(r),this.name=r.name,this.description=r.description,this.status=r.status,this.other=r.other,this.translations={...r.translations},r.image&&(this.image=new h.W(r.image))}}},5820:(M,p,e)=>{e.d(p,{Q:()=>l});var o=e(8400);class h extends o.w{constructor(i){super(i),this.public_visible=i.public_visible,this.public_from=i.public_from?new Date(i.public_from):void 0,this.public_to=i.public_to?new Date(i.public_to):void 0,this.private_visible=i.private_visible,this.daily_from=i.daily_from?new Date(i.daily_from):void 0,this.daily_to=i.daily_to?new Date(i.daily_to):void 0}}var t=e(2264);class l extends o.w{constructor(i){super(i),this.name=i.name,this.description=i.description,this.status=i.status,this.price=i.price,this.parent_id=i.parent_id,this.index=i.index,this.secret=i.secret,this.secret_desc=i.secret_desc,this.visibility_id=i.visibility_id,this.visibility=i.visibility?new h(i.visibility):void 0,this.parent=i.parent?new l(i.parent):void 0,this.children=i.children?i.children.map(_=>new l(_)):[],this.images=i.images?i.images.map(_=>new t.W(_)):[],this.translations=i.translations}}},355:(M,p,e)=>{e.d(p,{E:()=>t});var o=e(8400),h=e(2264);class t extends o.w{constructor(r){super(r),this.name=r.name,this.description=r.description,this.status=r.status,this.other=r.other,this.translations={...r.translations},this.color=r.color,r.image&&(this.image=new h.W(r.image))}}},9088:(M,p,e)=>{e.d(p,{S:()=>t});var o=e(4496);const h={menuCategory:{show:"/admin/menu/{itemId}",duplicate:"/admin/menu/{itemId}/duplicate",export:"/admin/menu/{itemId}/export",createChild:"/admin/menu/{itemId}/create-category",linkCategory:"/admin/menu/{itemId}/link-category",createDish:"/admin/menu/{itemId}/create-dish",linkDish:"/admin/menu/{itemId}/link-dish",private:"/menu/{itemId}",public:"/menu/{itemId}"},dish:{show:"/admin/menu/{categoryId}/dish/{itemId}"}};let t=(()=>{class l{transform(i,_){const n=h[_.split(".")[0]];if(!n)throw new Error(`Resource not found: ${_} (resouce: ${_.split(".")[0]})`);const s=_.split(".")[1];if(!n[s])throw new Error(`Action not found: ${_} (action: ${s})`);if(typeof i>"u"||null===i)return null;if("number"==typeof i&&(i=i.toString()),"object"==typeof i&&null!==i&&!Array.isArray(i)){let a=n[s];if(Object.keys(i).forEach(g=>{const I=i[g];void 0!==I&&a.includes(`{${g}}`)&&(a=a.replace(`{${g}}`,I??""))}),a.includes("{{"))throw new Error(`Unresolved interpolation: ${a}`);return a}if("string"!=typeof i)throw new Error(`Invalid itemId: ${i} (type: ${typeof i})`);return n[s].replace("{itemId}",i)}static#t=this.\u0275fac=function(_){return new(_||l)};static#e=this.\u0275pipe=o.UTH({name:"urlTo",type:l,pure:!0,standalone:!0})}return l})()},8676:(M,p,e)=>{e.d(p,{k:()=>r});var o=e(6012),h=e(5891),t=e(4704),l=e(4496);let r=(()=>{class i extends o.s{constructor(){super(h.S,"admin/menu/dishes")}copy(n,s){return this.post(`${n}/copy`,s).pipe((0,t.k)(a=>this.mapItem(a)))}move(n,s){return this.patch(`${n}/move`,s).pipe((0,t.k)(a=>this.mapItem(a)))}moveIngredient(n,s,a){return this.patch(`${n}/ingredients/${s}/move`,{to_index:a}).pipe((0,t.k)(g=>this.mapItem(g)))}moveTag(n,s,a){return this.patch(`${n}/tags/${s}/move`,{to_index:a}).pipe((0,t.k)(g=>this.mapItem(g)))}moveAllergen(n,s,a){return this.patch(`${n}/allergens/${s}/move`,{to_index:a}).pipe((0,t.k)(g=>this.mapItem(g)))}updateStatus(n,s){return this.patch(`${n}/status/${s}`,{}).pipe((0,t.k)(a=>this.mapItem(a)))}addIngredient(n,s){return this.post(`${n}/ingredients/${s}`,{}).pipe((0,t.k)(a=>this.mapItem(a)))}removeIngredient(n,s){return this.delete(`${n}/ingredients/${s}`).pipe((0,t.k)(a=>this.mapItem(a)))}addTag(n,s){return this.post(`${n}/tags/${s}`,{}).pipe((0,t.k)(a=>this.mapItem(a)))}removeTag(n,s){return this.delete(`${n}/tags/${s}`).pipe((0,t.k)(a=>this.mapItem(a)))}addAllergen(n,s){return this.post(`${n}/allergens/${s}`,{}).pipe((0,t.k)(a=>this.mapItem(a)))}removeAllergen(n,s){return this.delete(`${n}/allergens/${s}`).pipe((0,t.k)(a=>this.mapItem(a)))}references(n){return this.get(`${n}/references`).pipe((0,t.k)(s=>s))}addSuggestion(n,s){return this.post(`${n}/suggestions/${s}`,{}).pipe((0,t.k)(a=>this.mapItem(a)))}removeSuggestion(n,s){return this.delete(`${n}/suggestions/${s}`).pipe((0,t.k)(a=>this.mapItem(a)))}static#t=this.\u0275fac=function(s){return new(s||i)};static#e=this.\u0275prov=l.wxM({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},1712:(M,p,e)=>{e.d(p,{S:()=>r});var o=e(6012),h=e(5820),t=e(4704),l=e(4496);let r=(()=>{class i extends o.s{constructor(){super(h.Q,"admin/menu/categories")}addCategory(n,s,a={}){return this.post(`${n}/add_category/${s}`,a)}addDish(n,s){return this.post(`${n}/dishes/${s}`,{})}removeDish(n,s){return this.delete(`${n}/dishes/${s}`,{})}orderDishes(n,s){return this.patch(`${n}/order_dishes`,{field:s})}dashboardData(n){return this.get(`${n}/dashboard_data`)}updateVisibility(n,s){return this.patch(`${n}/visibility`,s).pipe((0,t.k)(a=>this.mapItem(a)))}copy(n,s){return this.post(`${n}/copy`,s).pipe((0,t.k)(a=>this.mapItem(a)))}move(n,s){return this.patch(`${n}/move/${s}`,{}).pipe((0,t.k)(a=>this.mapItem(a)))}static#t=this.\u0275fac=function(s){return new(s||i)};static#e=this.\u0275prov=l.wxM({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},4736:(M,p,e)=>{e.d(p,{M:()=>l,O:()=>r});var o=e(4496),h=e(5944),t=e(4704);let l=(()=>{class i{constructor(n){this.months$=n}transform({month:n}){return this.months$.pipe((0,t.k)(s=>s[n]))}}return i.\u0275fac=function(n){return new(n||i)(o.GI1(h.GU,16))},i.\u0275pipe=o.UTH({name:"tuiMonth",type:i,pure:!0}),i})(),r=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=o.a4G({type:i}),i.\u0275inj=o.s3X({}),i})()},3797:(M,p,e)=>{e.d(p,{CQ:()=>L,Oo:()=>A,cP:()=>$});var o=e(4496),h=e(6504),t=e(3044),l=e(1800),r=e(4164),i=e(4680),_=e(466),n=e(7936),s=e(8048),a=e(4336),g=e(5944),I=e(9371),v=e(796),D=e(1368);const P=["*",[["input"]]],y=["*","input"];let A=(()=>{class m extends l._y{constructor(d,u,O,c){super(d,u,c),this.textfieldSize=O,this.open=!1}get size(){return this.textfieldSize.size}get nativeFocusableElement(){return this.computedDisabled||!this.textfield?null:this.textfield.nativeFocusableElement}get focused(){return(0,r.ER)(this.nativeFocusableElement)||!!this.hostedDropdown&&this.hostedDropdown.focused}get canOpen(){return this.interactive&&!!this.datalist}onValueChange(d){this.value=d,this.open=!0}onActiveZone(d){this.updateFocused(d)}handleOption(d){this.setNativeValue(String(d)),this.focusInput(),this.value=String(d),this.open=!1}getFallbackValue(){return""}focusInput(d=!1){this.nativeFocusableElement&&this.nativeFocusableElement.focus({preventScroll:d})}setNativeValue(d){this.nativeFocusableElement&&(this.nativeFocusableElement.value=d)}}return m.\u0275fac=function(d){return new(d||m)(o.GI1(h.eq,10),o.GI1(o.kD9),o.GI1(s.$K),o.GI1(l.cn,8))},m.\u0275cmp=o.In1({type:m,selectors:[["tui-input"]],contentQueries:function(d,u,O){if(1&d&&o.szK(O,a.Ux,5,o.Yw2),2&d){let c;o.wto(c=o.Gqi())&&(u.datalist=c.first)}},viewQuery:function(d,u){if(1&d&&(o.CC$(_.Qw,5),o.CC$(n.y_,5)),2&d){let O;o.wto(O=o.Gqi())&&(u.hostedDropdown=O.first),o.wto(O=o.Gqi())&&(u.textfield=O.first)}},hostVars:1,hostBindings:function(d,u){2&d&&o.e48("data-size",u.size)},features:[o.M5G([v.g3,(0,i.NK)(m),(0,g.UH)(m),(0,l.q4)(m)],[v.YL]),o.eg9],ngContentSelectors:y,decls:4,vars:11,consts:[[1,"t-hosted",3,"canOpen","content","open","openChange","tuiActiveZoneChange"],["automation-id","tui-input__textfield",1,"t-textfield",3,"disabled","focusable","invalid","nativeId","pseudoFocus","pseudoHover","readOnly","value","valueChange"]],template:function(d,u){1&d&&(o.kPM(P),o.I0R(0,"tui-hosted-dropdown",0),o.iHE("openChange",function(c){return o.kNx(u.open,c)||(u.open=c),c}),o.qCj("tuiActiveZoneChange",function(c){return u.onActiveZone(c)}),o.I0R(1,"tui-primitive-textfield",1),o.qCj("valueChange",function(c){return u.onValueChange(c)}),o._Xx(2),o._Xx(3,1,["ngProjectAs","input",5,["input"]]),o.C$Y()()),2&d&&(o.E7m("canOpen",u.canOpen)("content",u.datalist||""),o.OKB("open",u.open),o.yG2(),o.E7m("disabled",u.computedDisabled)("focusable",u.computedFocusable)("invalid",u.computedInvalid)("nativeId",u.nativeId)("pseudoFocus",u.computedFocused)("pseudoHover",u.pseudoHover)("readOnly",u.readOnly)("value",u.value))},dependencies:[_.Qw,n.y_,t.M,n.KQ],styles:["[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);text-align:left}._disabled[_nghost-%COMP%]{pointer-events:none}.t-hosted[_ngcontent-%COMP%]{display:block;border-radius:inherit}.t-textfield[_ngcontent-%COMP%]{border-radius:inherit;text-align:inherit}"],changeDetection:0}),m})(),$=(()=>{class m extends I.Cm{onValueChange(d){this.host.onValueChange(d)}}return m.\u0275fac=(()=>{let f;return function(u){return(f||(f=o.otF(m)))(u||m)}})(),m.\u0275dir=o.Sc5({type:m,selectors:[["tui-input"]],features:[o.M5G([(0,g.iu)(m)]),o.eg9]}),m})(),L=(()=>{class m{}return m.\u0275fac=function(d){return new(d||m)},m.\u0275mod=o.a4G({type:m}),m.\u0275inj=o.s3X({imports:[[D.MD,t.L,n.KA,_.GE]]}),m})()},796:(M,p,e)=>{e.d(p,{YL:()=>g,g3:()=>I}),e(4736);var h=e(5193),t=e(5944),i=(e(3012),e(2700),e(528)),n=(e(4704),e(4496)),s=e(6504);const g=(0,h.Sk)({limitWidth:"fixed",align:"right"}),I={provide:t.Y9,deps:[[new n.T7N,new n.Yiy,s.Y6]],useFactory:i.Z}}}]);