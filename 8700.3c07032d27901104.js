(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[8700],{96120:(X,x,a)=>{"use strict";a.r(x),a.d(x,{ViewDishModule:()=>Io});var m=a(31236),b=a(7552),e=a(54496),H=a(51264),g=a(83480),S=a(38676),d=a(1128),u=a(53616),f=a(54704),R=a(66684),F=a(74e3),he=a(19212),p=a(68824),I=a(38256),N=a(27692),A=a(58212),le=a(64436),v=a(1560),Y=a(10466),h=a(94336),E=a(91368),Te=a(28272),fe=a(22904),K=a(91736);function Oe(t,_){if(1&t&&e.wR5(0,"i"),2&t){const n=e.GaO();e.uQ9("align-self-center fas fa-fw fa-",n.icon,"")}}function Ie(t,_){if(1&t&&(e.I0R(0,"span",3),e.OEk(1),e.C$Y()),2&t){const n=e.GaO();e.yG2(),e.oRS(" ",n.humanStatus," ")}}const Ne=[[["","title",""]]],Me=t=>({color:t}),Ge=["[title]"];let Re=(()=>{class t extends fe.c{constructor(){super(...arguments),this.configs={active:{text:K.$localize`Attivo`,color:"var(--tui-positive, lime)",icon:"check"},inactive:{text:K.$localize`Inattivo`,color:"var(--tui-negative, red)",icon:"close"},deleted:{text:K.$localize`Eliminato`,color:"red",icon:"trash"}}}static#e=this.\u0275fac=(()=>{let n;return function(o){return(n||(n=e.otF(t)))(o||t)}})();static#t=this.\u0275cmp=e.In1({type:t,selectors:[["app-dish-status"]],inputs:{status:"status"},standalone:!0,features:[e.eg9,e.UHJ],ngContentSelectors:Ge,decls:7,vars:5,consts:[[1,"d-flex","flex-column"],[1,"d-flex","flex-row",3,"ngStyle"],[3,"class",4,"ngIf"],[1,"align-self-center"],["customTitle",""],["class","align-self-center",4,"ngIf"]],template:function(i,o){if(1&i&&(e.kPM(Ne),e.I0R(0,"span",0)(1,"span",1),e.yuY(2,Oe,1,3,"i",2),e.I0R(3,"span",3,4),e._Xx(5),e.C$Y(),e.yuY(6,Ie,2,1,"span",5),e.C$Y()()),2&i){const s=e.Gew(4);e.yG2(),e.E7m("ngStyle",e.S45(3,Me,o.color)),e.yG2(),e.E7m("ngIf",o.validStatus&&o.validConfig),e.yG2(4),e.E7m("ngIf",!s.hasChildNodes())}},dependencies:[E.Qt,E.u_],encapsulation:2,changeDetection:0})}return t})();var W=a(55220);function Ae(t,_){if(1&t){const n=e.KQA();e.I0R(0,"button",3),e.qCj("click",function(){e.usT(n);const o=e.GaO(2);return e.CGJ(o.updateStatus("active"))}),e.wR5(1,"app-dish-status",7),e.C$Y()}2&t&&(e.yG2(),e.E7m("status","active"))}function De(t,_){if(1&t){const n=e.KQA();e.I0R(0,"button",3),e.qCj("click",function(){e.usT(n);const o=e.GaO(2);return e.CGJ(o.updateStatus("inactive"))}),e.wR5(1,"app-dish-status",7),e.C$Y()}2&t&&(e.yG2(),e.E7m("status","inactive"))}function ye(t,_){if(1&t){const n=e.KQA();e.I0R(0,"tui-data-list"),e.yuY(1,Ae,2,1,"button",2)(2,De,2,1,"button",2),e.I0R(3,"button",3),e.qCj("click",function(){e.usT(n);const o=e.GaO();return e.CGJ(o.delete())}),e.I0R(4,"span",4)(5,"mat-icon",5),e.OEk(6,"delete"),e.C$Y(),e.I0R(7,"span"),e.aS0(8,6),e.C$Y()()()()}if(2&t){const n=e.GaO();e.yG2(),e.C0Y(1,"active"!=(null==n.dish?null:n.dish.status)?1:-1),e.yG2(),e.C0Y(2,"inactive"!=(null==n.dish?null:n.dish.status)?2:-1)}}const $e=t=>({rotate180:t});function xe(t,_){if(1&t&&(e.I0R(0,"tui-hosted-dropdown",1,8)(2,"button",9)(3,"span",4),e.wR5(4,"app-dish-status",10),e.I0R(5,"mat-icon",11),e.OEk(6,"expand_more"),e.C$Y()()()()),2&t){const n=e.Gew(1),i=e.GaO(),o=e.Gew(1);e.E7m("content",o),e.yG2(4),e.E7m("status",i.dish.status),e.yG2(),e.E7m("ngClass",e.S45(3,$e,n.open))}}let ve=(()=>{class t{constructor(){this.notifications=(0,e.uUt)(d.E),this.destroy$=(0,e.uUt)(g.UF),this.deleteDish=new e._w7,this.statusChange=new e._w7,this.dishChange=new e._w7,this.dish=null}delete(){this.notifications.confirm(W.$localize`Sei sicuro di voler eliminare il piatto?`,{yes:W.$localize`Sì, elimina il piatto`,no:W.$localize`Annulla`}).pipe((0,u.a)(this.destroy$)).subscribe({next:n=>{n&&this.deleteDish.emit()}})}updateStatus(n){this.dish instanceof Te.S&&(this.dish.status=n,this.dishChange.emit(this.dish)),this.statusChange.emit(n)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=e.In1({type:t,selectors:[["app-edit-dish-status"]],inputs:{dish:"dish"},outputs:{deleteDish:"deleteDish",statusChange:"statusChange",dishChange:"dishChange"},standalone:!0,features:[e.M5G([g.UF]),e.UHJ],decls:3,vars:1,consts:()=>{let n;return n=W.$localize`Elimina`,[["dropdownContent",""],[3,"content"],["tuiOption",""],["tuiOption","",3,"click"],[1,"flex","items-center"],[1,"me-1"],n,[3,"status"],["dropdown",""],["tuiButton","","type","button","appearance","outline","size","l"],[1,"me-1",3,"status"],[1,"animation-speed-2",3,"ngClass"]]},template:function(i,o){1&i&&e.yuY(0,ye,9,2,"ng-template",null,0,e.gJz)(2,xe,7,5,"tui-hosted-dropdown",1),2&i&&(e.yG2(2),e.C0Y(2,o.dish&&o.dish.status?2:-1))},dependencies:[Y.GE,Y.Qw,h.A$,h.yi,h.sP,v.qL,A.CI,A.Kw,E.QF,Re],encapsulation:2})}return t})();var Le=a(35004),q=a(35e3),ce=a(78432),V=a(98016),J=a(41512),Z=a(55193),L=a(8048),M=a(45656),w=a(86376),ee=a(41104),k=a(53797),te=a(44856),j=a(79052),c=a(6504),ne=a(5892),P=a(83400),ie=a(10580),U=a(86096),oe=a(66052),_e=a(21984),se=a(37936),ae=a(36732),B=a(1040);function Pe(t,_){1&t&&(e.SAx(0),e.aS0(1,10),e.k70())}function be(t,_){if(1&t&&(e.SAx(0),e.OEk(1),e.k70()),2&t){const n=_.polymorpheusOutlet;e.yG2(),e.oRS(" ",n," ")}}function He(t,_){if(1&t&&e.yuY(0,be,2,1,"ng-container",11),2&t){const n=e.GaO(2);e.E7m("polymorpheusOutlet",n.optionTemplate$())}}function Ye(t,_){1&t&&e.C_f(0)}const re=(t,_)=>({$implicit:t,injector:_});function ke(t,_){if(1&t&&e.yuY(0,Ye,1,0,"ng-container",12),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("polymorpheusOutlet",i.optionTemplate$())("polymorpheusOutletContext",e.IBC(2,re,n,i.injector))}}function Ue(t,_){1&t&&e.C_f(0)}const ue=t=>({data:t});function we(t,_){if(1&t&&e.yuY(0,Ue,1,0,"ng-container",12),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("polymorpheusOutlet",i.optionTemplate$())("polymorpheusOutletContext",e.S45(2,ue,n))}}function ze(t,_){if(1&t&&e.wR5(0,"div",13),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("innerText",i.stringify(n))}}function Be(t,_){if(1&t&&e.yuY(0,He,1,1)(1,ke,1,5)(2,we,1,4)(3,ze,1,1),2&t){const n=e.GaO();let i;e.C0Y(0,"text"===(i=n.optionTemplateType$())?0:"template"===i?1:"component"===i?2:3)}}function Xe(t,_){if(1&t&&(e.SAx(0),e.OEk(1),e.k70()),2&t){const n=_.polymorpheusOutlet;e.yG2(),e.oRS(" ",n," ")}}function Fe(t,_){if(1&t&&e.yuY(0,Xe,2,1,"ng-container",11),2&t){const n=e.GaO(2);e.E7m("polymorpheusOutlet",n.nativeOptionTemplate$())}}function Je(t,_){1&t&&e.C_f(0)}function We(t,_){if(1&t&&e.yuY(0,Je,1,0,"ng-container",12),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("polymorpheusOutlet",i.nativeOptionTemplate$())("polymorpheusOutletContext",e.IBC(2,re,n,i.injector))}}function Ve(t,_){1&t&&e.C_f(0)}function je(t,_){if(1&t&&e.yuY(0,Ve,1,0,"ng-container",12),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("polymorpheusOutlet",i.nativeOptionTemplate$())("polymorpheusOutletContext",e.S45(2,ue,n))}}function Qe(t,_){if(1&t&&e.wR5(0,"div",13),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("innerText",i.stringify(n))}}function Ke(t,_){if(1&t&&e.yuY(0,Fe,1,1)(1,We,1,5)(2,je,1,4)(3,Qe,1,1),2&t){const n=e.GaO();let i;e.C0Y(0,"text"===(i=n.nativeOptionTemplateType$())?0:"template"===i?1:"component"===i?2:3)}}function qe(t,_){if(1&t&&(e.SAx(0),e.OEk(1),e.k70()),2&t){const n=e.GaO(2);e.yG2(),e.oRS(" ",n.placeholder," ")}}function Ze(t,_){if(1&t&&(e.I0R(0,"span",null,14),e._Xx(2),e.C$Y(),e.yuY(3,qe,2,1,"ng-container",15)),2&t){const n=e.Gew(1);e.yG2(3),e.E7m("ngIf",!n.hasChildNodes())}}function et(t,_){1&t&&(e.SAx(0),e.aS0(1,19),e.k70())}function tt(t,_){if(1&t&&(e.I0R(0,"span"),e.OEk(1),e.C$Y()),2&t){const n=e.GaO(2);e.yG2(),e.cNF(n.emptyContentString())}}function nt(t,_){1&t&&e.C_f(0)}function it(t,_){if(1&t&&(e.SAx(0),e.yuY(1,nt,1,0,"ng-container",8),e.k70()),2&t){const n=e.GaO(4);e.yG2(),e.E7m("ngTemplateOutlet",n.emptyContentTemplate())}}function ot(t,_){if(1&t&&(e.SAx(0),e.yuY(1,it,2,1,"ng-container",20),e.k70()),2&t){e.GaO(2);const n=e.Gew(6),i=e.GaO();e.yG2(),e.E7m("ngIf",i.emptyContentTemplate())("ngIfElse",n)}}function _t(t,_){if(1&t&&(e.SAx(0),e.yuY(1,ot,2,2,"ng-container",20),e.k70()),2&t){e.GaO();const n=e.Gew(4),i=e.GaO();e.yG2(),e.E7m("ngIf",i.emptyContent$())("ngIfElse",n)}}function st(t,_){if(1&t&&(e.I0R(0,"span",null,16),e._Xx(2,1),e.C$Y(),e.yuY(3,et,2,0,"ng-template",null,17,e.gJz)(5,tt,2,1,"ng-template",null,18,e.gJz)(7,_t,2,2,"ng-container",15)),2&t){const n=e.Gew(1);e.yG2(7),e.E7m("ngIf",!n.hasChildNodes())}}function at(t,_){1&t&&e.wR5(0,"tui-loader")}function lt(t,_){1&t&&e.C_f(0)}function ct(t,_){if(1&t&&e.yuY(0,lt,1,0,"ng-container",8),2&t){e.GaO(2);const n=e.Gew(9);e.E7m("ngTemplateOutlet",n)}}function rt(t,_){1&t&&e.C_f(0)}function ut(t,_){if(1&t&&(e.SAx(0),e.yuY(1,rt,1,0,"ng-container",8),e.k70()),2&t){e.GaO(2);const n=e.Gew(11);e.yG2(),e.E7m("ngTemplateOutlet",n)}}function gt(t,_){if(1&t&&e.yuY(0,ct,1,1,"ng-template",null,21,e.gJz)(2,ut,2,1,"ng-container",20),2&t){const n=e.Gew(1),i=e.GaO();e.yG2(2),e.E7m("ngIf",i.loading())("ngIfElse",n)}}function pt(t,_){1&t&&e.C_f(0)}function dt(t,_){1&t&&e.C_f(0)}function mt(t,_){1&t&&e.C_f(0)}function Ct(t,_){if(1&t&&(e.SAx(0),e.yuY(1,mt,1,0,"ng-container",8),e.k70()),2&t){e.GaO(4);const n=e.Gew(11);e.yG2(),e.E7m("ngTemplateOutlet",n)}}function St(t,_){1&t&&e.C_f(0)}function Et(t,_){if(1&t){const n=e.KQA();e.I0R(0,"button",28)(1,"span",29),e.qCj("click",function(){e.usT(n);const o=e.GaO(4);return e.CGJ(o.loadMoreItems())}),e.yuY(2,St,1,0,"ng-container",20),e.C$Y()()}if(2&t){const n=e.GaO(4),i=e.Gew(1);e.E7m("size",n.optionSize)("disabled",!0),e.yG2(2),e.E7m("ngIf",n.loadMore)("ngIfElse",i)}}function ht(t,_){if(1&t&&(e.SAx(0),e.yuY(1,Ct,2,1,"ng-container",15)(2,Et,3,4,"button",27),e.k70()),2&t){const n=e.GaO(3);e.yG2(),e.E7m("ngIf",n.loading),e.yG2(),e.E7m("ngIf",!n.loading)}}const Tt=t=>({$implicit:t});function ft(t,_){if(1&t){const n=e.KQA();e.SAx(0),e.I0R(1,"button",25),e.qCj("mouseenter",function(){const o=e.usT(n),s=o.index,l=o.last,r=e.GaO(2);return e.CGJ(r.optionMouseEnter(s,l))})("focus",function(){const o=e.usT(n),s=o.index,l=o.last,r=e.GaO(2);return e.CGJ(r.optionFocus(s,l))}),e.yuY(2,dt,1,0,"ng-container",26),e.C$Y(),e.yuY(3,ht,3,2,"ng-container",15),e.k70()}if(2&t){const n=_.$implicit,i=_.last,o=e.GaO(2),s=e.Gew(5);e.yG2(),e.E7m("size",o.optionSize)("value",n)("disabled",o.disabledItemHandler(n)),e.yG2(),e.E7m("ngTemplateOutlet",s)("ngTemplateOutletContext",e.S45(6,Tt,n)),e.yG2(),e.E7m("ngIf",i&&o.thereAreMoreItems)}}function Ot(t,_){if(1&t){const n=e.KQA();e.I0R(0,"span",33),e.qCj("click",function(){e.usT(n);const o=e.GaO(3);return e.CGJ(o.createNew.emit())}),e.I0R(1,"mat-icon"),e.OEk(2,"add"),e.C$Y(),e.I0R(3,"span"),e.aS0(4,34),e.C$Y()()}}function It(t,_){if(1&t&&(e.I0R(0,"button",30)(1,"span",null,31),e._Xx(3,2),e.C$Y(),e.yuY(4,Ot,5,0,"span",32),e.C$Y()),2&t){const n=e.Gew(2),i=e.GaO(2);e.E7m("size",i.optionSize)("value",null)("disabled",!0),e.yG2(4),e.E7m("ngIf",!n.hasChildNodes())}}function Nt(t,_){if(1&t&&(e.I0R(0,"tui-data-list",22),e.yuY(1,ft,4,8,"ng-container",23)(2,It,5,4,"button",24),e.C$Y()),2&t){const n=e.GaO(),i=e.Gew(13);e.E7m("emptyContent",i),e.yG2(),e.E7m("ngForOf",n.items()),e.yG2(),e.E7m("ngIf",n.showCreateNew)}}const Mt=["*",[["","empty-content",""]],[["","create-new",""]]],Gt=["*","[empty-content]","[create-new]"];let Rt=(()=>{class t extends ie.m{constructor(){super(),this.stringify=n=>n.name??"",this.service=(0,e.uUt)(ce.K)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=e.In1({type:t,selectors:[["app-ingredient-select"]],inputs:{outputType:"outputType",multiple:"multiple",service:"service",stringify:"stringify",query:"query",autofocus:"autofocus",placeholder:"placeholder",optionTemplate:"optionTemplate",stringifyOption:"stringifyOption",inputSize:"inputSize",page:"page",per_page:"per_page",optionSize:"optionSize",disabledItemHandler:"disabledItemHandler",loadMoreOnLastItem:"loadMoreOnLastItem",emptyContent:"emptyContent",showCreateNew:"showCreateNew",nativeOptionTemplate:"nativeOptionTemplate",filters:"filters"},outputs:{httpError:"httpError",pageChange:"pageChange",queryChange:"queryChange",per_pageChange:"per_pageChange",createNew:"createNew"},standalone:!0,features:[e.M5G([{provide:c.Y6,useExisting:(0,e.wd)(()=>t),multi:!0},g.UF]),e.eg9,e.UHJ],ngContentSelectors:Gt,decls:17,vars:5,consts:()=>{let n,i,o;return n="Carica altri",i="Non abbiamo trovato nulla.",o="Crea nuovo",[["loadMoreDefault",""],["valueContent",""],["nativeOptionTemplate",""],["placeholderTemplate",""],["nativeEmptyContentTemplate",""],["loadingTemplate",""],["loadingOrEmptyContent",""],[3,"stringify","tuiTextfieldSize","formControl","valueContent","searchChange"],[4,"ngTemplateOutlet"],[3,"emptyContent",4,"tuiDataList"],n,[4,"polymorpheusOutlet"],[4,"polymorpheusOutlet","polymorpheusOutletContext"],[3,"innerText"],["customContent",""],[4,"ngIf"],["customEmptyContent",""],["defaultEmptyContent",""],["emptyContentCustomString",""],i,[4,"ngIf","ngIfElse"],["empty",""],[3,"emptyContent"],[4,"ngFor","ngForOf"],["tuiOption","",3,"size","value","disabled",4,"ngIf"],["tuiOption","",3,"size","value","disabled","mouseenter","focus"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["tuiOption","",3,"size","disabled",4,"ngIf"],["tuiOption","",3,"size","disabled"],["role","button",3,"click"],["tuiOption","",3,"size","value","disabled"],["createNewCustomTemplate",""],["role","button","class","d-flex align-items-center",3,"click",4,"ngIf"],["role","button",1,"d-flex","align-items-center",3,"click"],o]},template:function(i,o){if(1&i&&(e.kPM(Mt),e.yuY(0,Pe,2,0,"ng-template",null,0,e.gJz)(2,Be,4,1,"ng-template",null,1,e.gJz)(4,Ke,4,1,"ng-template",null,2,e.gJz)(6,Ze,4,1,"ng-template",null,3,e.gJz)(8,st,8,1,"ng-template",null,4,e.gJz)(10,at,1,0,"ng-template",null,5,e.gJz)(12,gt,3,2,"ng-template",null,6,e.gJz),e.I0R(14,"tui-combo-box",7),e.qCj("searchChange",function(l){return o.onSearchChange(l)}),e.yuY(15,pt,1,0,"ng-container",8)(16,Nt,3,3,"tui-data-list",9),e.C$Y()),2&i){const s=e.Gew(3),l=e.Gew(7);e.yG2(14),e.E7m("stringify",o.stringify)("tuiTextfieldSize",o.inputSize)("formControl",o.control)("valueContent",s),e.yG2(),e.E7m("ngTemplateOutlet",l)}},dependencies:[E.MD,E.ay,E.u_,E.XV,U.uk,U.i_,U.qI,L.aS,L.rD,se.KA,k.CQ,h.A$,h.yi,h.sP,h.Ux,oe.q8,c.sl,c.ue,c.ug,ae.kR,_e.CA,N.Sk,N.Cb,B.Ux,B.Af,v.oB,v.qL],changeDetection:0})}return t})();var Q=a(63724),D=a(20520);const At=(t,_)=>_.id;function Dt(t,_){if(1&t&&e.wR5(0,"app-show-image",16),2&t){const n=e.GaO().$implicit;e.E7m("image",n.image)}}function yt(t,_){1&t&&(e.SAx(0),e.aS0(1,17),e.k70())}function $t(t,_){if(1&t){const n=e.KQA();e.I0R(0,"button",18),e.qCj("click",function(){e.usT(n);const o=e.GaO().$implicit,s=e.GaO();return e.CGJ(s.remove(o))}),e.SAx(1),e.aS0(2,19),e.k70(),e.C$Y()}}function xt(t,_){if(1&t&&(e.I0R(0,"tui-island",8)(1,"div",9)(2,"span",5),e.yuY(3,Dt,1,1,"app-show-image",10),e.I0R(4,"div"),e.OEk(5),e.C$Y()(),e.I0R(6,"div",5),e.yuY(7,yt,2,0,"ng-template",null,11,e.gJz),e.I0R(9,"button",12)(10,"mat-icon"),e.OEk(11,"drag_handle"),e.C$Y()(),e.yuY(12,$t,3,0,"ng-template",null,13,e.gJz),e.I0R(14,"tui-hosted-dropdown",14)(15,"button",15)(16,"mat-icon"),e.OEk(17,"delete"),e.C$Y()()()()()()),2&t){const n=_.$implicit,i=e.Gew(8),o=e.Gew(13);e.yG2(3),e.E7m("ngIf",n&&n.image),e.yG2(2),e.oRS(" ",n.name," "),e.yG2(4),e.E7m("tuiHint",i),e.yG2(5),e.E7m("content",o)}}function vt(t,_){1&t&&(e.I0R(0,"p"),e.SAx(1),e.aS0(2,20),e.k70(),e.C$Y())}const Lt=t=>({avoid_associated_dish_id:t});function Pt(t,_){if(1&t){const n=e.KQA();e.I0R(0,"tui-loader",21)(1,"form",22),e.qCj("ngSubmit",function(){e.usT(n);const o=e.GaO(2);return e.CGJ(o.addIngredient())}),e.I0R(2,"div",23)(3,"app-ingredient-select",24),e.SAx(4),e.aS0(5,25),e.k70(),e.C$Y()(),e.I0R(6,"div",5)(7,"button",26),e.SAx(8),e.aS0(9,27),e.k70(),e.C$Y(),e.I0R(10,"button",28),e.qCj("click",function(){e.usT(n);const o=e.GaO(2);return e.CGJ(o.dismissAddIngredient())}),e.SAx(11),e.aS0(12,29),e.k70(),e.C$Y()()()()}if(2&t){const n=e.GaO(2);e.E7m("overlay",!0)("showLoader",n.associatingIngredient()),e.yG2(),e.E7m("formGroup",n.newIngredientForm),e.yG2(2),e.E7m("filters",e.S45(5,Lt,n.dish.id))("formControlName","ingredient")}}function bt(t,_){1&t&&e.OEk(0," no dish or dish.id ")}function Ht(t,_){if(1&t&&e.yuY(0,Pt,13,7,"tui-loader",21)(1,bt,1,0),2&t){const n=e.GaO();e.C0Y(0,n.dish&&n.dish.id?0:1)}}let Yt=(()=>{class t{constructor(){this.ingredientsService=(0,e.uUt)(ce.K),this.dishesService=(0,e.uUt)(S.k),this.destroy$=(0,e.uUt)(g.UF),this.notifications=(0,e.uUt)(d.E),this.dialogs=(0,e.uUt)(V._k),this.dishChange=new e._w7,this.dish=null,this.searching=(0,e.OCB)(!1),this.deleting=(0,e.OCB)(!1),this.moving=(0,e.OCB)(!1),this.associatingIngredient=(0,e.OCB)(!1),this.removingIngredient=(0,e.OCB)(!1),this.loading=(0,e.S6b)(()=>this.searching()||this.deleting()||this.moving()||this.associatingIngredient()||this.removingIngredient()),this.ordering=(0,e.OCB)(!1),this.data=(0,e.OCB)(null),this.items=(0,e.S6b)(()=>this.data()?.items??[]),this.newIngredientForm=new c.WC({ingredient:new c.Ku(null,c.AQ.required)})}ngOnChanges(n){n.dish&&this.search()}search(n=this.defaultFilters()){this.searchSub?.unsubscribe(),this.searching.set(!0),this.searchSub=this.ingredientsService.search(n).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.searching.set(!1))).subscribe({next:i=>this.data.set(i),error:i=>{this.data.set(null),this.notifications.error((0,I.mk)(i)||D.$localize`Qualcosa è andato storto. Riprova più tardi.`)}})}drop(n){if(n.previousIndex===n.currentIndex)return;const i=this.items(),o=i[n.previousIndex]?.id,s=this.dish?.id;o&&s&&((0,P.qv)(i,n.previousIndex,n.currentIndex),this.moving.set(!0),this.dishesService.moveIngredient(s,o,n.currentIndex).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.moving.set(!1)),(0,p.U)(()=>this.search())).subscribe({error:l=>this.notifications.error((0,I.mk)(l)||D.$localize`Qualcosa è andato storto.`)}))}remove(n){const i=this.dish?.id,o=n.id;i&&o&&(this.removingIngredient.set(!0),this.dishesService.removeIngredient(i,o).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.removingIngredient.set(!1)),(0,p.U)(()=>this.search())).subscribe((0,Q.I)()))}triggerOrdering(){this.ordering()||this.notifications.fireSnackBar(D.$localize`Sposta i piatti trascinandoli con il bottone sul lato destro di ciascuna categoria.`,D.$localize`Capito`,{duration:5e3}),this.ordering.set(!this.ordering())}dismissAddIngredient(){this.addIngredientModal?.unsubscribe(),this.newIngredientForm.reset()}showAddIngredient(n){this.addIngredientModal=this.dialogs.open(n).subscribe()}addIngredient(){const n=this.dish?.id,i=this.newIngredientForm.get("ingredient")?.value?.id;this.newIngredientForm.valid&&i&&n&&(this.associatingIngredient.set(!0),this.dishesService.addIngredient(n,i).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.dismissAddIngredient()),(0,p.U)(()=>this.search()),(0,p.U)(()=>this.associatingIngredient.set(!1))).subscribe({error:o=>this.notifications.error((0,I.mk)(o)||D.$localize`Qualcosa è andato storto.`)}))}defaultFilters(){const n={};return this.dish&&this.dish.id&&(n.associated_dish_id=this.dish.id),n}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=e.In1({type:t,selectors:[["app-dish-ingredients"]],inputs:{dish:"dish"},outputs:{dishChange:"dishChange"},standalone:!0,features:[e.M5G([g.UF]),e.SYr,e.UHJ],decls:15,vars:1,consts:()=>{let n,i,o,s,l,r,G,T;return n=D.$localize`Ingredienti`,i=D.$localize`Aggiungi ingrediente`,o=D.$localize`Trascina per ordinare.`,s=D.$localize`Rimuovi ingrediente dal piatto`,l=D.$localize`Non ci sono ingredienti`,r=D.$localize`Cerca ingrediente`,G=D.$localize`Aggiungi al piatto`,T=D.$localize`Annulla`,[[3,"click"],n,["cdkDropList","",1,"items-list",3,"cdkDropListDropped"],["addModal",""],["type","button","size","m","appearance","flat","tuiButton","",3,"click"],[1,"flex","items-center"],[1,"me-1"],i,["cdkDrag","",1,"mb-2"],[1,"flex","justify-between","items-center"],["style","max-width: 100px;","class","inline-block rounded me-2",3,"image",4,"ngIf"],["dragHint",""],["size","m","cdkDragHandle","","tuiIconButton","","type","button","appearance","outline",1,"me-2",3,"tuiHint"],["deleteDropdown",""],[3,"content"],["size","m","tuiIconButton","","type","button","appearance","outline"],[1,"inline-block","rounded","me-2",2,"max-width","100px",3,"image"],o,["tuiButton","","appearance","secondary-destructive","type","button",1,"m-4",3,"click"],s,l,[3,"overlay","showLoader"],[3,"formGroup","ngSubmit"],[1,"mb-4"],[3,"filters","formControlName"],r,["tuiButton","","size","m","type","submit",1,"me-2"],G,["type","button","appearance","outline","tuiButton","","size","m",3,"click"],T,["cdkDrag","","class","mb-2"]]},template:function(i,o){if(1&i){const s=e.KQA();e.I0R(0,"h4",0),e.qCj("click",function(){return o.search()}),e.SAx(1),e.aS0(2,1),e.k70(),e.C$Y(),e.I0R(3,"div",2),e.qCj("cdkDropListDropped",function(r){return o.drop(r)}),e.c53(4,xt,18,4,"tui-island",30,At,!1,vt,3,0,"p"),e.C$Y(),e.yuY(7,Ht,2,1,"ng-template",null,3,e.gJz),e.I0R(9,"button",4),e.qCj("click",function(){e.usT(s);const r=e.Gew(8);return e.CGJ(o.showAddIngredient(r))}),e.I0R(10,"span",5)(11,"mat-icon",6),e.OEk(12,"add"),e.C$Y(),e.I0R(13,"span"),e.aS0(14,7),e.C$Y()()()}2&i&&(e.yG2(4),e.oho(o.items()))},dependencies:[J.w,v.qL,Y.GE,Y.Qw,A.CI,A.Kw,w.k,w.C,ee.t,Z.ms,h.A$,E.u_,j.y,c.sl,c.sz,c.ue,c.u,c.uW,c.Wo,k.CQ,q.m6,L.aS,N.Sk,N.Cb,ne.yy,P.Cm,P.w5,P.A3,M.WY,M.lh,M.SL,M.i6,M.IT,te.Gs,Rt],styles:["[_nghost-%COMP%]   .items-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   tui-island[cdkDrag][_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}[_nghost-%COMP%]   .items-list[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}[_nghost-%COMP%]   .items-list[_ngcontent-%COMP%]   .cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}[_nghost-%COMP%]   [cdkDragHandle][_ngcontent-%COMP%]{cursor:move}"],changeDetection:0})}return t})();var ge=a(67307);function kt(t,_){1&t&&(e.SAx(0),e.aS0(1,10),e.k70())}function Ut(t,_){if(1&t&&(e.SAx(0),e.OEk(1),e.k70()),2&t){const n=_.polymorpheusOutlet;e.yG2(),e.oRS(" ",n," ")}}function wt(t,_){if(1&t&&e.yuY(0,Ut,2,1,"ng-container",11),2&t){const n=e.GaO(2);e.E7m("polymorpheusOutlet",n.optionTemplate$())}}function zt(t,_){1&t&&e.C_f(0)}const pe=(t,_)=>({$implicit:t,injector:_});function Bt(t,_){if(1&t&&e.yuY(0,zt,1,0,"ng-container",12),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("polymorpheusOutlet",i.optionTemplate$())("polymorpheusOutletContext",e.IBC(2,pe,n,i.injector))}}function Xt(t,_){1&t&&e.C_f(0)}const de=t=>({data:t});function Ft(t,_){if(1&t&&e.yuY(0,Xt,1,0,"ng-container",12),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("polymorpheusOutlet",i.optionTemplate$())("polymorpheusOutletContext",e.S45(2,de,n))}}function Jt(t,_){if(1&t&&e.wR5(0,"div",13),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("innerText",i.stringify(n))}}function Wt(t,_){if(1&t&&e.yuY(0,wt,1,1)(1,Bt,1,5)(2,Ft,1,4)(3,Jt,1,1),2&t){const n=e.GaO();let i;e.C0Y(0,"text"===(i=n.optionTemplateType$())?0:"template"===i?1:"component"===i?2:3)}}function Vt(t,_){if(1&t&&(e.SAx(0),e.OEk(1),e.k70()),2&t){const n=_.polymorpheusOutlet;e.yG2(),e.oRS(" ",n," ")}}function jt(t,_){if(1&t&&e.yuY(0,Vt,2,1,"ng-container",11),2&t){const n=e.GaO(2);e.E7m("polymorpheusOutlet",n.nativeOptionTemplate$())}}function Qt(t,_){1&t&&e.C_f(0)}function Kt(t,_){if(1&t&&e.yuY(0,Qt,1,0,"ng-container",12),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("polymorpheusOutlet",i.nativeOptionTemplate$())("polymorpheusOutletContext",e.IBC(2,pe,n,i.injector))}}function qt(t,_){1&t&&e.C_f(0)}function Zt(t,_){if(1&t&&e.yuY(0,qt,1,0,"ng-container",12),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("polymorpheusOutlet",i.nativeOptionTemplate$())("polymorpheusOutletContext",e.S45(2,de,n))}}function en(t,_){if(1&t&&e.wR5(0,"div",13),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("innerText",i.stringify(n))}}function tn(t,_){if(1&t&&e.yuY(0,jt,1,1)(1,Kt,1,5)(2,Zt,1,4)(3,en,1,1),2&t){const n=e.GaO();let i;e.C0Y(0,"text"===(i=n.nativeOptionTemplateType$())?0:"template"===i?1:"component"===i?2:3)}}function nn(t,_){if(1&t&&(e.SAx(0),e.OEk(1),e.k70()),2&t){const n=e.GaO(2);e.yG2(),e.oRS(" ",n.placeholder," ")}}function on(t,_){if(1&t&&(e.I0R(0,"span",null,14),e._Xx(2),e.C$Y(),e.yuY(3,nn,2,1,"ng-container",15)),2&t){const n=e.Gew(1);e.yG2(3),e.E7m("ngIf",!n.hasChildNodes())}}function _n(t,_){1&t&&(e.SAx(0),e.aS0(1,19),e.k70())}function sn(t,_){if(1&t&&(e.I0R(0,"span"),e.OEk(1),e.C$Y()),2&t){const n=e.GaO(2);e.yG2(),e.cNF(n.emptyContentString())}}function an(t,_){1&t&&e.C_f(0)}function ln(t,_){if(1&t&&(e.SAx(0),e.yuY(1,an,1,0,"ng-container",8),e.k70()),2&t){const n=e.GaO(4);e.yG2(),e.E7m("ngTemplateOutlet",n.emptyContentTemplate())}}function cn(t,_){if(1&t&&(e.SAx(0),e.yuY(1,ln,2,1,"ng-container",20),e.k70()),2&t){e.GaO(2);const n=e.Gew(6),i=e.GaO();e.yG2(),e.E7m("ngIf",i.emptyContentTemplate())("ngIfElse",n)}}function rn(t,_){if(1&t&&(e.SAx(0),e.yuY(1,cn,2,2,"ng-container",20),e.k70()),2&t){e.GaO();const n=e.Gew(4),i=e.GaO();e.yG2(),e.E7m("ngIf",i.emptyContent$())("ngIfElse",n)}}function un(t,_){if(1&t&&(e.I0R(0,"span",null,16),e._Xx(2,1),e.C$Y(),e.yuY(3,_n,2,0,"ng-template",null,17,e.gJz)(5,sn,2,1,"ng-template",null,18,e.gJz)(7,rn,2,2,"ng-container",15)),2&t){const n=e.Gew(1);e.yG2(7),e.E7m("ngIf",!n.hasChildNodes())}}function gn(t,_){1&t&&e.wR5(0,"tui-loader")}function pn(t,_){1&t&&e.C_f(0)}function dn(t,_){if(1&t&&e.yuY(0,pn,1,0,"ng-container",8),2&t){e.GaO(2);const n=e.Gew(9);e.E7m("ngTemplateOutlet",n)}}function mn(t,_){1&t&&e.C_f(0)}function Cn(t,_){if(1&t&&(e.SAx(0),e.yuY(1,mn,1,0,"ng-container",8),e.k70()),2&t){e.GaO(2);const n=e.Gew(11);e.yG2(),e.E7m("ngTemplateOutlet",n)}}function Sn(t,_){if(1&t&&e.yuY(0,dn,1,1,"ng-template",null,21,e.gJz)(2,Cn,2,1,"ng-container",20),2&t){const n=e.Gew(1),i=e.GaO();e.yG2(2),e.E7m("ngIf",i.loading())("ngIfElse",n)}}function En(t,_){1&t&&e.C_f(0)}function hn(t,_){1&t&&e.C_f(0)}function Tn(t,_){1&t&&e.C_f(0)}function fn(t,_){if(1&t&&(e.SAx(0),e.yuY(1,Tn,1,0,"ng-container",8),e.k70()),2&t){e.GaO(4);const n=e.Gew(11);e.yG2(),e.E7m("ngTemplateOutlet",n)}}function On(t,_){1&t&&e.C_f(0)}function In(t,_){if(1&t){const n=e.KQA();e.I0R(0,"button",28)(1,"span",29),e.qCj("click",function(){e.usT(n);const o=e.GaO(4);return e.CGJ(o.loadMoreItems())}),e.yuY(2,On,1,0,"ng-container",20),e.C$Y()()}if(2&t){const n=e.GaO(4),i=e.Gew(1);e.E7m("size",n.optionSize)("disabled",!0),e.yG2(2),e.E7m("ngIf",n.loadMore)("ngIfElse",i)}}function Nn(t,_){if(1&t&&(e.SAx(0),e.yuY(1,fn,2,1,"ng-container",15)(2,In,3,4,"button",27),e.k70()),2&t){const n=e.GaO(3);e.yG2(),e.E7m("ngIf",n.loading),e.yG2(),e.E7m("ngIf",!n.loading)}}const Mn=t=>({$implicit:t});function Gn(t,_){if(1&t){const n=e.KQA();e.SAx(0),e.I0R(1,"button",25),e.qCj("mouseenter",function(){const o=e.usT(n),s=o.index,l=o.last,r=e.GaO(2);return e.CGJ(r.optionMouseEnter(s,l))})("focus",function(){const o=e.usT(n),s=o.index,l=o.last,r=e.GaO(2);return e.CGJ(r.optionFocus(s,l))}),e.yuY(2,hn,1,0,"ng-container",26),e.C$Y(),e.yuY(3,Nn,3,2,"ng-container",15),e.k70()}if(2&t){const n=_.$implicit,i=_.last,o=e.GaO(2),s=e.Gew(5);e.yG2(),e.E7m("size",o.optionSize)("value",n)("disabled",o.disabledItemHandler(n)),e.yG2(),e.E7m("ngTemplateOutlet",s)("ngTemplateOutletContext",e.S45(6,Mn,n)),e.yG2(),e.E7m("ngIf",i&&o.thereAreMoreItems)}}function Rn(t,_){if(1&t){const n=e.KQA();e.I0R(0,"span",33),e.qCj("click",function(){e.usT(n);const o=e.GaO(3);return e.CGJ(o.createNew.emit())}),e.I0R(1,"mat-icon"),e.OEk(2,"add"),e.C$Y(),e.I0R(3,"span"),e.aS0(4,34),e.C$Y()()}}function An(t,_){if(1&t&&(e.I0R(0,"button",30)(1,"span",null,31),e._Xx(3,2),e.C$Y(),e.yuY(4,Rn,5,0,"span",32),e.C$Y()),2&t){const n=e.Gew(2),i=e.GaO(2);e.E7m("size",i.optionSize)("value",null)("disabled",!0),e.yG2(4),e.E7m("ngIf",!n.hasChildNodes())}}function Dn(t,_){if(1&t&&(e.I0R(0,"tui-data-list",22),e.yuY(1,Gn,4,8,"ng-container",23)(2,An,5,4,"button",24),e.C$Y()),2&t){const n=e.GaO(),i=e.Gew(13);e.E7m("emptyContent",i),e.yG2(),e.E7m("ngForOf",n.items()),e.yG2(),e.E7m("ngIf",n.showCreateNew)}}const yn=["*",[["","empty-content",""]],[["","create-new",""]]],$n=["*","[empty-content]","[create-new]"];let xn=(()=>{class t extends ie.m{constructor(){super(),this.stringify=n=>n.name??"",this.service=(0,e.uUt)(ge._)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=e.In1({type:t,selectors:[["app-allergen-select"]],inputs:{outputType:"outputType",multiple:"multiple",service:"service",stringify:"stringify",query:"query",autofocus:"autofocus",placeholder:"placeholder",optionTemplate:"optionTemplate",stringifyOption:"stringifyOption",inputSize:"inputSize",page:"page",per_page:"per_page",optionSize:"optionSize",disabledItemHandler:"disabledItemHandler",loadMoreOnLastItem:"loadMoreOnLastItem",emptyContent:"emptyContent",showCreateNew:"showCreateNew",nativeOptionTemplate:"nativeOptionTemplate",filters:"filters"},outputs:{httpError:"httpError",pageChange:"pageChange",queryChange:"queryChange",per_pageChange:"per_pageChange",createNew:"createNew"},standalone:!0,features:[e.M5G([{provide:c.Y6,useExisting:(0,e.wd)(()=>t),multi:!0},g.UF]),e.eg9,e.UHJ],ngContentSelectors:$n,decls:17,vars:5,consts:()=>{let n,i,o;return n="Carica altri",i="Non abbiamo trovato nulla.",o="Crea nuovo",[["loadMoreDefault",""],["valueContent",""],["nativeOptionTemplate",""],["placeholderTemplate",""],["nativeEmptyContentTemplate",""],["loadingTemplate",""],["loadingOrEmptyContent",""],[3,"stringify","tuiTextfieldSize","formControl","valueContent","searchChange"],[4,"ngTemplateOutlet"],[3,"emptyContent",4,"tuiDataList"],n,[4,"polymorpheusOutlet"],[4,"polymorpheusOutlet","polymorpheusOutletContext"],[3,"innerText"],["customContent",""],[4,"ngIf"],["customEmptyContent",""],["defaultEmptyContent",""],["emptyContentCustomString",""],i,[4,"ngIf","ngIfElse"],["empty",""],[3,"emptyContent"],[4,"ngFor","ngForOf"],["tuiOption","",3,"size","value","disabled",4,"ngIf"],["tuiOption","",3,"size","value","disabled","mouseenter","focus"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["tuiOption","",3,"size","disabled",4,"ngIf"],["tuiOption","",3,"size","disabled"],["role","button",3,"click"],["tuiOption","",3,"size","value","disabled"],["createNewCustomTemplate",""],["role","button","class","d-flex align-items-center",3,"click",4,"ngIf"],["role","button",1,"d-flex","align-items-center",3,"click"],o]},template:function(i,o){if(1&i&&(e.kPM(yn),e.yuY(0,kt,2,0,"ng-template",null,0,e.gJz)(2,Wt,4,1,"ng-template",null,1,e.gJz)(4,tn,4,1,"ng-template",null,2,e.gJz)(6,on,4,1,"ng-template",null,3,e.gJz)(8,un,8,1,"ng-template",null,4,e.gJz)(10,gn,1,0,"ng-template",null,5,e.gJz)(12,Sn,3,2,"ng-template",null,6,e.gJz),e.I0R(14,"tui-combo-box",7),e.qCj("searchChange",function(l){return o.onSearchChange(l)}),e.yuY(15,En,1,0,"ng-container",8)(16,Dn,3,3,"tui-data-list",9),e.C$Y()),2&i){const s=e.Gew(3),l=e.Gew(7);e.yG2(14),e.E7m("stringify",o.stringify)("tuiTextfieldSize",o.inputSize)("formControl",o.control)("valueContent",s),e.yG2(),e.E7m("ngTemplateOutlet",l)}},dependencies:[E.MD,E.ay,E.u_,E.XV,U.uk,U.i_,U.qI,L.aS,L.rD,se.KA,k.CQ,h.A$,h.yi,h.sP,h.Ux,oe.q8,c.sl,c.ue,c.ug,ae.kR,_e.CA,N.Sk,N.Cb,B.Ux,B.Af,v.oB,v.qL],changeDetection:0})}return t})();var y=a(83e3);const vn=(t,_)=>_.id;function Ln(t,_){if(1&t&&e.wR5(0,"app-show-image",16),2&t){const n=e.GaO().$implicit;e.E7m("image",n.image)}}function Pn(t,_){1&t&&(e.SAx(0),e.aS0(1,17),e.k70())}function bn(t,_){if(1&t){const n=e.KQA();e.I0R(0,"button",18),e.qCj("click",function(){e.usT(n);const o=e.GaO().$implicit,s=e.GaO();return e.CGJ(s.remove(o))}),e.SAx(1),e.aS0(2,19),e.k70(),e.C$Y()}}function Hn(t,_){if(1&t&&(e.I0R(0,"tui-island",8)(1,"div",9)(2,"span",5),e.yuY(3,Ln,1,1,"app-show-image",10),e.I0R(4,"div"),e.OEk(5),e.C$Y()(),e.I0R(6,"div",5),e.yuY(7,Pn,2,0,"ng-template",null,11,e.gJz),e.I0R(9,"button",12)(10,"mat-icon"),e.OEk(11,"drag_handle"),e.C$Y()(),e.yuY(12,bn,3,0,"ng-template",null,13,e.gJz),e.I0R(14,"tui-hosted-dropdown",14)(15,"button",15)(16,"mat-icon"),e.OEk(17,"delete"),e.C$Y()()()()()()),2&t){const n=_.$implicit,i=e.Gew(8),o=e.Gew(13);e.yG2(3),e.E7m("ngIf",n&&n.image),e.yG2(2),e.oRS(" ",n.name," "),e.yG2(4),e.E7m("tuiHint",i),e.yG2(5),e.E7m("content",o)}}function Yn(t,_){1&t&&(e.I0R(0,"p"),e.SAx(1),e.aS0(2,20),e.k70(),e.C$Y())}const kn=t=>({avoid_associated_dish_id:t});function Un(t,_){if(1&t){const n=e.KQA();e.I0R(0,"tui-loader",21)(1,"form",22),e.qCj("ngSubmit",function(){e.usT(n);const o=e.GaO(2);return e.CGJ(o.addAllergen())}),e.I0R(2,"div",23)(3,"app-allergen-select",24),e.SAx(4),e.aS0(5,25),e.k70(),e.C$Y()(),e.I0R(6,"div",5)(7,"button",26),e.SAx(8),e.aS0(9,27),e.k70(),e.C$Y(),e.I0R(10,"button",28),e.qCj("click",function(){e.usT(n);const o=e.GaO(2);return e.CGJ(o.dismissAddAllergen())}),e.SAx(11),e.aS0(12,29),e.k70(),e.C$Y()()()()}if(2&t){const n=e.GaO(2);e.E7m("overlay",!0)("showLoader",n.addingAllergen()),e.yG2(),e.E7m("formGroup",n.newAllergenForm),e.yG2(2),e.E7m("filters",e.S45(5,kn,n.dish.id))("formControlName","allergen")}}function wn(t,_){1&t&&e.OEk(0," no dish or dish.id ")}function zn(t,_){if(1&t&&e.yuY(0,Un,13,7,"tui-loader",21)(1,wn,1,0),2&t){const n=e.GaO();e.C0Y(0,n.dish&&n.dish.id?0:1)}}let Bn=(()=>{class t{constructor(){this.allergensService=(0,e.uUt)(ge._),this.dishesService=(0,e.uUt)(S.k),this.destroy$=(0,e.uUt)(g.UF),this.notifications=(0,e.uUt)(d.E),this.dialogs=(0,e.uUt)(V._k),this.dishChange=new e._w7,this.dish=null,this.searching=(0,e.OCB)(!1),this.deleting=(0,e.OCB)(!1),this.moving=(0,e.OCB)(!1),this.addingAllergen=(0,e.OCB)(!1),this.removingAllergen=(0,e.OCB)(!1),this.loading=(0,e.S6b)(()=>this.searching()||this.deleting()||this.moving()||this.addingAllergen()||this.removingAllergen()),this.ordering=(0,e.OCB)(!1),this.data=(0,e.OCB)(null),this.items=(0,e.S6b)(()=>this.data()?.items??[]),this.newAllergenForm=new c.WC({allergen:new c.Ku(null,c.AQ.required)})}ngOnChanges(n){n.dish&&this.search()}search(n=this.defaultFilters()){this.searchSub?.unsubscribe(),this.searching.set(!0),this.searchSub=this.allergensService.search(n).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.searching.set(!1))).subscribe({next:i=>this.data.set(i),error:i=>{this.data.set(null),this.notifications.error((0,I.mk)(i)||y.$localize`Qualcosa è andato storto. Riprova più tardi.`)}})}drop(n){if(n.previousIndex===n.currentIndex)return;const i=this.items(),o=i[n.previousIndex]?.id,s=this.dish?.id;o&&s&&((0,P.qv)(i,n.previousIndex,n.currentIndex),this.moving.set(!0),this.dishesService.moveAllergen(s,o,n.currentIndex).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.moving.set(!1)),(0,p.U)(()=>this.search())).subscribe({error:l=>this.notifications.error((0,I.mk)(l)||y.$localize`Qualcosa è andato storto.`)}))}remove(n){const i=this.dish?.id,o=n.id;i&&o&&(this.removingAllergen.set(!0),this.dishesService.removeAllergen(i,o).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.removingAllergen.set(!1)),(0,p.U)(()=>this.search())).subscribe((0,Q.I)()))}triggerOrdering(){this.ordering()||this.notifications.fireSnackBar(y.$localize`Sposta i piatti trascinandoli con il bottone sul lato destro di ciascuna categoria.`,y.$localize`Capito`,{duration:5e3}),this.ordering.set(!this.ordering())}dismissAddAllergen(){this.addAllergenModal?.unsubscribe(),this.newAllergenForm.reset()}showAddAllergen(n){this.addAllergenModal=this.dialogs.open(n).subscribe()}addAllergen(){const n=this.dish?.id,i=this.newAllergenForm.get("allergen")?.value?.id;this.newAllergenForm.valid&&i&&n&&(this.addingAllergen.set(!0),this.dishesService.addAllergen(n,i).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.dismissAddAllergen()),(0,p.U)(()=>this.search()),(0,p.U)(()=>this.addingAllergen.set(!1))).subscribe({error:o=>this.notifications.error((0,I.mk)(o)||y.$localize`Qualcosa è andato storto.`)}))}defaultFilters(){const n={};return this.dish&&this.dish.id&&(n.associated_dish_id=this.dish.id),n}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=e.In1({type:t,selectors:[["app-dish-allergens"]],inputs:{dish:"dish"},outputs:{dishChange:"dishChange"},standalone:!0,features:[e.M5G([g.UF]),e.SYr,e.UHJ],decls:15,vars:1,consts:()=>{let n,i,o,s,l,r,G,T;return n=y.$localize`Allergeni`,i=y.$localize`Aggiungi allergene`,o=y.$localize`Trascina per ordinare.`,s=y.$localize`Rimuovi allergene dal piatto`,l=y.$localize`Non ci sono allergeni`,r=y.$localize`Cerca allergene`,G=y.$localize`Aggiungi al piatto`,T=y.$localize`Annulla`,[[3,"click"],n,["cdkDropList","",1,"items-list",3,"cdkDropListDropped"],["addModal",""],["type","button","size","m","appearance","flat","tuiButton","",3,"click"],[1,"flex","items-center"],[1,"me-1"],i,["cdkDrag","",1,"mb-2"],[1,"flex","justify-between","items-center"],["style","max-width: 100px;","class","inline-block rounded me-2",3,"image",4,"ngIf"],["dragHint",""],["size","m","cdkDragHandle","","tuiIconButton","","type","button","appearance","outline",1,"me-2",3,"tuiHint"],["deleteDropdown",""],[3,"content"],["size","m","tuiIconButton","","type","button","appearance","outline"],[1,"inline-block","rounded","me-2",2,"max-width","100px",3,"image"],o,["tuiButton","","appearance","secondary-destructive","type","button",1,"m-4",3,"click"],s,l,[3,"overlay","showLoader"],[3,"formGroup","ngSubmit"],[1,"mb-4"],[3,"filters","formControlName"],r,["tuiButton","","size","m","type","submit",1,"me-2"],G,["type","button","appearance","outline","tuiButton","","size","m",3,"click"],T,["cdkDrag","","class","mb-2"]]},template:function(i,o){if(1&i){const s=e.KQA();e.I0R(0,"h4",0),e.qCj("click",function(){return o.search()}),e.SAx(1),e.aS0(2,1),e.k70(),e.C$Y(),e.I0R(3,"div",2),e.qCj("cdkDropListDropped",function(r){return o.drop(r)}),e.c53(4,Hn,18,4,"tui-island",30,vn,!1,Yn,3,0,"p"),e.C$Y(),e.yuY(7,zn,2,1,"ng-template",null,3,e.gJz),e.I0R(9,"button",4),e.qCj("click",function(){e.usT(s);const r=e.Gew(8);return e.CGJ(o.showAddAllergen(r))}),e.I0R(10,"span",5)(11,"mat-icon",6),e.OEk(12,"add"),e.C$Y(),e.I0R(13,"span"),e.aS0(14,7),e.C$Y()()()}2&i&&(e.yG2(4),e.oho(o.items()))},dependencies:[J.w,v.qL,Y.GE,Y.Qw,A.CI,A.Kw,w.k,w.C,ee.t,Z.ms,h.A$,E.u_,j.y,c.sl,c.sz,c.ue,c.u,c.uW,c.Wo,k.CQ,q.m6,L.aS,N.Sk,N.Cb,ne.yy,P.Cm,P.w5,P.A3,M.WY,M.lh,M.SL,M.i6,M.IT,te.Gs,xn],styles:["[_nghost-%COMP%]   .items-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   tui-island[cdkDrag][_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}[_nghost-%COMP%]   .items-list[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}[_nghost-%COMP%]   .items-list[_ngcontent-%COMP%]   .cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}[_nghost-%COMP%]   [cdkDragHandle][_ngcontent-%COMP%]{cursor:move}"],changeDetection:0})}return t})();var me=a(19116);function Xn(t,_){1&t&&(e.SAx(0),e.aS0(1,10),e.k70())}function Fn(t,_){if(1&t&&(e.SAx(0),e.OEk(1),e.k70()),2&t){const n=_.polymorpheusOutlet;e.yG2(),e.oRS(" ",n," ")}}function Jn(t,_){if(1&t&&e.yuY(0,Fn,2,1,"ng-container",11),2&t){const n=e.GaO(2);e.E7m("polymorpheusOutlet",n.optionTemplate$())}}function Wn(t,_){1&t&&e.C_f(0)}const Ce=(t,_)=>({$implicit:t,injector:_});function Vn(t,_){if(1&t&&e.yuY(0,Wn,1,0,"ng-container",12),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("polymorpheusOutlet",i.optionTemplate$())("polymorpheusOutletContext",e.IBC(2,Ce,n,i.injector))}}function jn(t,_){1&t&&e.C_f(0)}const Se=t=>({data:t});function Qn(t,_){if(1&t&&e.yuY(0,jn,1,0,"ng-container",12),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("polymorpheusOutlet",i.optionTemplate$())("polymorpheusOutletContext",e.S45(2,Se,n))}}function Kn(t,_){if(1&t&&e.wR5(0,"div",13),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("innerText",i.stringify(n))}}function qn(t,_){if(1&t&&e.yuY(0,Jn,1,1)(1,Vn,1,5)(2,Qn,1,4)(3,Kn,1,1),2&t){const n=e.GaO();let i;e.C0Y(0,"text"===(i=n.optionTemplateType$())?0:"template"===i?1:"component"===i?2:3)}}function Zn(t,_){if(1&t&&(e.SAx(0),e.OEk(1),e.k70()),2&t){const n=_.polymorpheusOutlet;e.yG2(),e.oRS(" ",n," ")}}function ei(t,_){if(1&t&&e.yuY(0,Zn,2,1,"ng-container",11),2&t){const n=e.GaO(2);e.E7m("polymorpheusOutlet",n.nativeOptionTemplate$())}}function ti(t,_){1&t&&e.C_f(0)}function ni(t,_){if(1&t&&e.yuY(0,ti,1,0,"ng-container",12),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("polymorpheusOutlet",i.nativeOptionTemplate$())("polymorpheusOutletContext",e.IBC(2,Ce,n,i.injector))}}function ii(t,_){1&t&&e.C_f(0)}function oi(t,_){if(1&t&&e.yuY(0,ii,1,0,"ng-container",12),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("polymorpheusOutlet",i.nativeOptionTemplate$())("polymorpheusOutletContext",e.S45(2,Se,n))}}function _i(t,_){if(1&t&&e.wR5(0,"div",13),2&t){const n=e.GaO().$implicit,i=e.GaO();e.E7m("innerText",i.stringify(n))}}function si(t,_){if(1&t&&e.yuY(0,ei,1,1)(1,ni,1,5)(2,oi,1,4)(3,_i,1,1),2&t){const n=e.GaO();let i;e.C0Y(0,"text"===(i=n.nativeOptionTemplateType$())?0:"template"===i?1:"component"===i?2:3)}}function ai(t,_){if(1&t&&(e.SAx(0),e.OEk(1),e.k70()),2&t){const n=e.GaO(2);e.yG2(),e.oRS(" ",n.placeholder," ")}}function li(t,_){if(1&t&&(e.I0R(0,"span",null,14),e._Xx(2),e.C$Y(),e.yuY(3,ai,2,1,"ng-container",15)),2&t){const n=e.Gew(1);e.yG2(3),e.E7m("ngIf",!n.hasChildNodes())}}function ci(t,_){1&t&&(e.SAx(0),e.aS0(1,19),e.k70())}function ri(t,_){if(1&t&&(e.I0R(0,"span"),e.OEk(1),e.C$Y()),2&t){const n=e.GaO(2);e.yG2(),e.cNF(n.emptyContentString())}}function ui(t,_){1&t&&e.C_f(0)}function gi(t,_){if(1&t&&(e.SAx(0),e.yuY(1,ui,1,0,"ng-container",8),e.k70()),2&t){const n=e.GaO(4);e.yG2(),e.E7m("ngTemplateOutlet",n.emptyContentTemplate())}}function pi(t,_){if(1&t&&(e.SAx(0),e.yuY(1,gi,2,1,"ng-container",20),e.k70()),2&t){e.GaO(2);const n=e.Gew(6),i=e.GaO();e.yG2(),e.E7m("ngIf",i.emptyContentTemplate())("ngIfElse",n)}}function di(t,_){if(1&t&&(e.SAx(0),e.yuY(1,pi,2,2,"ng-container",20),e.k70()),2&t){e.GaO();const n=e.Gew(4),i=e.GaO();e.yG2(),e.E7m("ngIf",i.emptyContent$())("ngIfElse",n)}}function mi(t,_){if(1&t&&(e.I0R(0,"span",null,16),e._Xx(2,1),e.C$Y(),e.yuY(3,ci,2,0,"ng-template",null,17,e.gJz)(5,ri,2,1,"ng-template",null,18,e.gJz)(7,di,2,2,"ng-container",15)),2&t){const n=e.Gew(1);e.yG2(7),e.E7m("ngIf",!n.hasChildNodes())}}function Ci(t,_){1&t&&e.wR5(0,"tui-loader")}function Si(t,_){1&t&&e.C_f(0)}function Ei(t,_){if(1&t&&e.yuY(0,Si,1,0,"ng-container",8),2&t){e.GaO(2);const n=e.Gew(9);e.E7m("ngTemplateOutlet",n)}}function hi(t,_){1&t&&e.C_f(0)}function Ti(t,_){if(1&t&&(e.SAx(0),e.yuY(1,hi,1,0,"ng-container",8),e.k70()),2&t){e.GaO(2);const n=e.Gew(11);e.yG2(),e.E7m("ngTemplateOutlet",n)}}function fi(t,_){if(1&t&&e.yuY(0,Ei,1,1,"ng-template",null,21,e.gJz)(2,Ti,2,1,"ng-container",20),2&t){const n=e.Gew(1),i=e.GaO();e.yG2(2),e.E7m("ngIf",i.loading())("ngIfElse",n)}}function Oi(t,_){1&t&&e.C_f(0)}function Ii(t,_){1&t&&e.C_f(0)}function Ni(t,_){1&t&&e.C_f(0)}function Mi(t,_){if(1&t&&(e.SAx(0),e.yuY(1,Ni,1,0,"ng-container",8),e.k70()),2&t){e.GaO(4);const n=e.Gew(11);e.yG2(),e.E7m("ngTemplateOutlet",n)}}function Gi(t,_){1&t&&e.C_f(0)}function Ri(t,_){if(1&t){const n=e.KQA();e.I0R(0,"button",28)(1,"span",29),e.qCj("click",function(){e.usT(n);const o=e.GaO(4);return e.CGJ(o.loadMoreItems())}),e.yuY(2,Gi,1,0,"ng-container",20),e.C$Y()()}if(2&t){const n=e.GaO(4),i=e.Gew(1);e.E7m("size",n.optionSize)("disabled",!0),e.yG2(2),e.E7m("ngIf",n.loadMore)("ngIfElse",i)}}function Ai(t,_){if(1&t&&(e.SAx(0),e.yuY(1,Mi,2,1,"ng-container",15)(2,Ri,3,4,"button",27),e.k70()),2&t){const n=e.GaO(3);e.yG2(),e.E7m("ngIf",n.loading),e.yG2(),e.E7m("ngIf",!n.loading)}}const Di=t=>({$implicit:t});function yi(t,_){if(1&t){const n=e.KQA();e.SAx(0),e.I0R(1,"button",25),e.qCj("mouseenter",function(){const o=e.usT(n),s=o.index,l=o.last,r=e.GaO(2);return e.CGJ(r.optionMouseEnter(s,l))})("focus",function(){const o=e.usT(n),s=o.index,l=o.last,r=e.GaO(2);return e.CGJ(r.optionFocus(s,l))}),e.yuY(2,Ii,1,0,"ng-container",26),e.C$Y(),e.yuY(3,Ai,3,2,"ng-container",15),e.k70()}if(2&t){const n=_.$implicit,i=_.last,o=e.GaO(2),s=e.Gew(5);e.yG2(),e.E7m("size",o.optionSize)("value",n)("disabled",o.disabledItemHandler(n)),e.yG2(),e.E7m("ngTemplateOutlet",s)("ngTemplateOutletContext",e.S45(6,Di,n)),e.yG2(),e.E7m("ngIf",i&&o.thereAreMoreItems)}}function $i(t,_){if(1&t){const n=e.KQA();e.I0R(0,"span",33),e.qCj("click",function(){e.usT(n);const o=e.GaO(3);return e.CGJ(o.createNew.emit())}),e.I0R(1,"mat-icon"),e.OEk(2,"add"),e.C$Y(),e.I0R(3,"span"),e.aS0(4,34),e.C$Y()()}}function xi(t,_){if(1&t&&(e.I0R(0,"button",30)(1,"span",null,31),e._Xx(3,2),e.C$Y(),e.yuY(4,$i,5,0,"span",32),e.C$Y()),2&t){const n=e.Gew(2),i=e.GaO(2);e.E7m("size",i.optionSize)("value",null)("disabled",!0),e.yG2(4),e.E7m("ngIf",!n.hasChildNodes())}}function vi(t,_){if(1&t&&(e.I0R(0,"tui-data-list",22),e.yuY(1,yi,4,8,"ng-container",23)(2,xi,5,4,"button",24),e.C$Y()),2&t){const n=e.GaO(),i=e.Gew(13);e.E7m("emptyContent",i),e.yG2(),e.E7m("ngForOf",n.items()),e.yG2(),e.E7m("ngIf",n.showCreateNew)}}const Li=["*",[["","empty-content",""]],[["","create-new",""]]],Pi=["*","[empty-content]","[create-new]"];let bi=(()=>{class t extends ie.m{constructor(){super(),this.stringify=n=>n.name??"",this.service=(0,e.uUt)(me.w)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=e.In1({type:t,selectors:[["app-menu-tag-select"]],inputs:{outputType:"outputType",multiple:"multiple",service:"service",stringify:"stringify",query:"query",autofocus:"autofocus",placeholder:"placeholder",optionTemplate:"optionTemplate",stringifyOption:"stringifyOption",inputSize:"inputSize",page:"page",per_page:"per_page",optionSize:"optionSize",disabledItemHandler:"disabledItemHandler",loadMoreOnLastItem:"loadMoreOnLastItem",emptyContent:"emptyContent",showCreateNew:"showCreateNew",nativeOptionTemplate:"nativeOptionTemplate",filters:"filters"},outputs:{httpError:"httpError",pageChange:"pageChange",queryChange:"queryChange",per_pageChange:"per_pageChange",createNew:"createNew"},standalone:!0,features:[e.M5G([{provide:c.Y6,useExisting:(0,e.wd)(()=>t),multi:!0},g.UF]),e.eg9,e.UHJ],ngContentSelectors:Pi,decls:17,vars:5,consts:()=>{let n,i,o;return n="Carica altri",i="Non abbiamo trovato nulla.",o="Crea nuovo",[["loadMoreDefault",""],["valueContent",""],["nativeOptionTemplate",""],["placeholderTemplate",""],["nativeEmptyContentTemplate",""],["loadingTemplate",""],["loadingOrEmptyContent",""],[3,"stringify","tuiTextfieldSize","formControl","valueContent","searchChange"],[4,"ngTemplateOutlet"],[3,"emptyContent",4,"tuiDataList"],n,[4,"polymorpheusOutlet"],[4,"polymorpheusOutlet","polymorpheusOutletContext"],[3,"innerText"],["customContent",""],[4,"ngIf"],["customEmptyContent",""],["defaultEmptyContent",""],["emptyContentCustomString",""],i,[4,"ngIf","ngIfElse"],["empty",""],[3,"emptyContent"],[4,"ngFor","ngForOf"],["tuiOption","",3,"size","value","disabled",4,"ngIf"],["tuiOption","",3,"size","value","disabled","mouseenter","focus"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["tuiOption","",3,"size","disabled",4,"ngIf"],["tuiOption","",3,"size","disabled"],["role","button",3,"click"],["tuiOption","",3,"size","value","disabled"],["createNewCustomTemplate",""],["role","button","class","d-flex align-items-center",3,"click",4,"ngIf"],["role","button",1,"d-flex","align-items-center",3,"click"],o]},template:function(i,o){if(1&i&&(e.kPM(Li),e.yuY(0,Xn,2,0,"ng-template",null,0,e.gJz)(2,qn,4,1,"ng-template",null,1,e.gJz)(4,si,4,1,"ng-template",null,2,e.gJz)(6,li,4,1,"ng-template",null,3,e.gJz)(8,mi,8,1,"ng-template",null,4,e.gJz)(10,Ci,1,0,"ng-template",null,5,e.gJz)(12,fi,3,2,"ng-template",null,6,e.gJz),e.I0R(14,"tui-combo-box",7),e.qCj("searchChange",function(l){return o.onSearchChange(l)}),e.yuY(15,Oi,1,0,"ng-container",8)(16,vi,3,3,"tui-data-list",9),e.C$Y()),2&i){const s=e.Gew(3),l=e.Gew(7);e.yG2(14),e.E7m("stringify",o.stringify)("tuiTextfieldSize",o.inputSize)("formControl",o.control)("valueContent",s),e.yG2(),e.E7m("ngTemplateOutlet",l)}},dependencies:[E.MD,E.ay,E.u_,E.XV,U.uk,U.i_,U.qI,L.aS,L.rD,se.KA,k.CQ,h.A$,h.yi,h.sP,h.Ux,oe.q8,c.sl,c.ue,c.ug,ae.kR,_e.CA,N.Sk,N.Cb,B.Ux,B.Af,v.oB,v.qL],changeDetection:0})}return t})();var $=a(70580);const Hi=(t,_)=>_.id;function Yi(t,_){if(1&t&&e.wR5(0,"app-show-image",16),2&t){const n=e.GaO().$implicit;e.E7m("image",n.image)}}function ki(t,_){1&t&&(e.SAx(0),e.aS0(1,17),e.k70())}function Ui(t,_){if(1&t){const n=e.KQA();e.I0R(0,"button",18),e.qCj("click",function(){e.usT(n);const o=e.GaO().$implicit,s=e.GaO();return e.CGJ(s.remove(o))}),e.SAx(1),e.aS0(2,19),e.k70(),e.C$Y()}}function wi(t,_){if(1&t&&(e.I0R(0,"tui-island",8)(1,"div",9)(2,"span",5),e.yuY(3,Yi,1,1,"app-show-image",10),e.I0R(4,"div"),e.OEk(5),e.C$Y()(),e.I0R(6,"div",5),e.yuY(7,ki,2,0,"ng-template",null,11,e.gJz),e.I0R(9,"button",12)(10,"mat-icon"),e.OEk(11,"drag_handle"),e.C$Y()(),e.yuY(12,Ui,3,0,"ng-template",null,13,e.gJz),e.I0R(14,"tui-hosted-dropdown",14)(15,"button",15)(16,"mat-icon"),e.OEk(17,"delete"),e.C$Y()()()()()()),2&t){const n=_.$implicit,i=e.Gew(8),o=e.Gew(13);e.yG2(3),e.E7m("ngIf",n&&n.image),e.yG2(2),e.oRS(" ",n.name," "),e.yG2(4),e.E7m("tuiHint",i),e.yG2(5),e.E7m("content",o)}}function zi(t,_){1&t&&(e.I0R(0,"p"),e.SAx(1),e.aS0(2,20),e.k70(),e.C$Y())}const Bi=t=>({avoid_associated_dish_id:t});function Xi(t,_){if(1&t){const n=e.KQA();e.I0R(0,"tui-loader",21)(1,"form",22),e.qCj("ngSubmit",function(){e.usT(n);const o=e.GaO(2);return e.CGJ(o.addTag())}),e.I0R(2,"div",23)(3,"app-menu-tag-select",24),e.SAx(4),e.aS0(5,25),e.k70(),e.C$Y()(),e.I0R(6,"div",5)(7,"button",26),e.SAx(8),e.aS0(9,27),e.k70(),e.C$Y(),e.I0R(10,"button",28),e.qCj("click",function(){e.usT(n);const o=e.GaO(2);return e.CGJ(o.dismissAddTag())}),e.SAx(11),e.aS0(12,29),e.k70(),e.C$Y()()()()}if(2&t){const n=e.GaO(2);e.E7m("overlay",!0)("showLoader",n.addingTag()),e.yG2(),e.E7m("formGroup",n.newTagForm),e.yG2(2),e.E7m("filters",e.S45(5,Bi,n.dish.id))("formControlName","tag")}}function Fi(t,_){1&t&&e.OEk(0," no dish or dish.id ")}function Ji(t,_){if(1&t&&e.yuY(0,Xi,13,7,"tui-loader",21)(1,Fi,1,0),2&t){const n=e.GaO();e.C0Y(0,n.dish&&n.dish.id?0:1)}}let Wi=(()=>{class t{constructor(){this.tagsService=(0,e.uUt)(me.w),this.dishesService=(0,e.uUt)(S.k),this.destroy$=(0,e.uUt)(g.UF),this.notifications=(0,e.uUt)(d.E),this.dialogs=(0,e.uUt)(V._k),this.dishChange=new e._w7,this.dish=null,this.searching=(0,e.OCB)(!1),this.deleting=(0,e.OCB)(!1),this.moving=(0,e.OCB)(!1),this.addingTag=(0,e.OCB)(!1),this.removingTag=(0,e.OCB)(!1),this.loading=(0,e.S6b)(()=>this.searching()||this.deleting()||this.moving()||this.addingTag()||this.removingTag()),this.ordering=(0,e.OCB)(!1),this.data=(0,e.OCB)(null),this.items=(0,e.S6b)(()=>this.data()?.items??[]),this.newTagForm=new c.WC({tag:new c.Ku(null,c.AQ.required)})}ngOnChanges(n){n.dish&&this.search()}search(n=this.defaultFilters()){this.searchSub?.unsubscribe(),this.searching.set(!0),this.searchSub=this.tagsService.search(n).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.searching.set(!1))).subscribe({next:i=>this.data.set(i),error:i=>{this.data.set(null),this.notifications.error((0,I.mk)(i)||$.$localize`Qualcosa è andato storto. Riprova più tardi.`)}})}drop(n){if(n.previousIndex===n.currentIndex)return;const i=this.items(),o=i[n.previousIndex]?.id,s=this.dish?.id;o&&s&&((0,P.qv)(i,n.previousIndex,n.currentIndex),this.moving.set(!0),this.dishesService.moveTag(s,o,n.currentIndex).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.moving.set(!1)),(0,p.U)(()=>this.search())).subscribe({error:l=>this.notifications.error((0,I.mk)(l)||$.$localize`Qualcosa è andato storto.`)}))}remove(n){const i=this.dish?.id,o=n.id;i&&o&&(this.removingTag.set(!0),this.dishesService.removeTag(i,o).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.removingTag.set(!1)),(0,p.U)(()=>this.search())).subscribe((0,Q.I)()))}triggerOrdering(){this.ordering()||this.notifications.fireSnackBar($.$localize`Sposta i piatti trascinandoli con il bottone sul lato destro di ciascuna categoria.`,$.$localize`Capito`,{duration:5e3}),this.ordering.set(!this.ordering())}dismissAddTag(){this.addTagModal?.unsubscribe(),this.newTagForm.reset()}showAddTag(n){this.addTagModal=this.dialogs.open(n).subscribe()}addTag(){const n=this.dish?.id,i=this.newTagForm.get("tag")?.value?.id;this.newTagForm.valid&&i&&n&&(this.addingTag.set(!0),this.dishesService.addTag(n,i).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.dismissAddTag()),(0,p.U)(()=>this.search()),(0,p.U)(()=>this.addingTag.set(!1))).subscribe({error:o=>this.notifications.error((0,I.mk)(o)||$.$localize`Qualcosa è andato storto.`)}))}defaultFilters(){const n={};return this.dish&&this.dish.id&&(n.associated_dish_id=this.dish.id),n}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=e.In1({type:t,selectors:[["app-dish-tags"]],inputs:{dish:"dish"},outputs:{dishChange:"dishChange"},standalone:!0,features:[e.M5G([g.UF]),e.SYr,e.UHJ],decls:15,vars:1,consts:()=>{let n,i,o,s,l,r,G,T;return n=$.$localize`Tag`,i=$.$localize`Aggiungi tag`,o=$.$localize`Trascina per ordinare.`,s=$.$localize`Rimuovi tag dal piatto`,l=$.$localize`Non ci sono tag`,r=$.$localize`Cerca tag`,G=$.$localize`Aggiungi al piatto`,T=$.$localize`Annulla`,[[3,"click"],n,["cdkDropList","",1,"items-list",3,"cdkDropListDropped"],["addModal",""],["type","button","size","m","appearance","flat","tuiButton","",3,"click"],[1,"flex","items-center"],[1,"me-1"],i,["cdkDrag","",1,"mb-2"],[1,"flex","justify-between","items-center"],["style","max-width: 100px;","class","inline-block rounded me-2",3,"image",4,"ngIf"],["dragHint",""],["size","m","cdkDragHandle","","tuiIconButton","","type","button","appearance","outline",1,"me-2",3,"tuiHint"],["deleteDropdown",""],[3,"content"],["size","m","tuiIconButton","","type","button","appearance","outline"],[1,"inline-block","rounded","me-2",2,"max-width","100px",3,"image"],o,["tuiButton","","appearance","secondary-destructive","type","button",1,"m-4",3,"click"],s,l,[3,"overlay","showLoader"],[3,"formGroup","ngSubmit"],[1,"mb-4"],[3,"filters","formControlName"],r,["tuiButton","","size","m","type","submit",1,"me-2"],G,["type","button","appearance","outline","tuiButton","","size","m",3,"click"],T,["cdkDrag","","class","mb-2"]]},template:function(i,o){if(1&i){const s=e.KQA();e.I0R(0,"h4",0),e.qCj("click",function(){return o.search()}),e.SAx(1),e.aS0(2,1),e.k70(),e.C$Y(),e.I0R(3,"div",2),e.qCj("cdkDropListDropped",function(r){return o.drop(r)}),e.c53(4,wi,18,4,"tui-island",30,Hi,!1,zi,3,0,"p"),e.C$Y(),e.yuY(7,Ji,2,1,"ng-template",null,3,e.gJz),e.I0R(9,"button",4),e.qCj("click",function(){e.usT(s);const r=e.Gew(8);return e.CGJ(o.showAddTag(r))}),e.I0R(10,"span",5)(11,"mat-icon",6),e.OEk(12,"add"),e.C$Y(),e.I0R(13,"span"),e.aS0(14,7),e.C$Y()()()}2&i&&(e.yG2(4),e.oho(o.items()))},dependencies:[J.w,v.qL,Y.GE,Y.Qw,A.CI,A.Kw,w.k,w.C,ee.t,Z.ms,h.A$,E.u_,j.y,c.sl,c.sz,c.ue,c.u,c.uW,c.Wo,k.CQ,q.m6,L.aS,N.Sk,N.Cb,ne.yy,P.Cm,P.w5,P.A3,M.WY,M.lh,M.SL,M.i6,M.IT,te.Gs,bi],styles:["[_nghost-%COMP%]   .items-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   tui-island[cdkDrag][_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}[_nghost-%COMP%]   .items-list[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}[_nghost-%COMP%]   .items-list[_ngcontent-%COMP%]   .cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}[_nghost-%COMP%]   [cdkDragHandle][_ngcontent-%COMP%]{cursor:move}"],changeDetection:0})}return t})();var Vi=a(34680),ji=a(19880),Ee=a(14336);const Qi=["*"];let Ki=(()=>{class t{constructor(){this.dishChanged=new e._w7,this.dish=null,this.destroy$=(0,e.uUt)(g.UF),this.notifications=(0,e.uUt)(d.E),this.dishesService=(0,e.uUt)(S.k),this.removingPrice=(0,e.OCB)(!1),this.searchingDishes=(0,e.OCB)(!1),this.savingPrice=(0,e.OCB)(!1),this.loading=(0,e.S6b)(()=>this.savingPrice()||this.searchingDishes()||this.removingPrice()),this.price=new c.Ku(null)}ngOnInit(){this.price.valueChanges.pipe((0,u.a)(this.destroy$),(0,F.a)(),(0,R.I)(n=>n!=this.dish?.price),(0,Vi.o)(1500)).subscribe({next:n=>this.updateRemote(n)})}ngOnChanges(n){n.dish&&this.price.patchValue(this.dish?.price??null)}updateRemote(n){const i=this.dish?.id;i&&(this.updateRemoteSub?.unsubscribe(),this.savingPrice.set(!0),this.updateRemoteSub=this.dishesService.update(i,{price:n}).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.savingPrice.set(!1))).subscribe({next:o=>{this.dish=o,this.dishChanged.emit(o),this.notifications.fireSnackBar(Ee.$localize`Prezzo salvato.`)},error:o=>{this.notifications.fireSnackBar((0,I.mk)(o)||Ee.$localize`Qualcosa è andato storto nel salvataggio del prezzo.`)}}))}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=e.In1({type:t,selectors:[["app-dish-price"]],inputs:{dish:"dish"},outputs:{dishChanged:"dishChanged"},standalone:!0,features:[e.M5G([g.UF]),e.SYr,e.UHJ],ngContentSelectors:Qi,decls:2,vars:1,consts:[["tuiTextfieldSize","l","tuiTextfieldPostfix","\u20ac",3,"formControl"]],template:function(i,o){1&i&&(e.kPM(),e.I0R(0,"tui-input",0),e._Xx(1),e.C$Y()),2&i&&e.E7m("formControl",o.price)},dependencies:[k.CQ,k.Oo,k.cP,L.aS,L.rD,L.We,c.sl,c.ue,c.ug,ji.kh,A.CI],encapsulation:2,changeDetection:0})}return t})();var qi=a(49088),Zi=a(87552);const eo=(t,_)=>_.id;function to(t,_){if(1&t&&(e.I0R(0,"li",2)(1,"a",3),e.wVc(2,"urlTo"),e.OEk(3),e.C$Y()()),2&t){const n=_.$implicit;e.yG2(),e._6D("routerLink",e.g7$(2,2,n.id,"menuCategory.show")),e.yG2(2),e.oRS(" ",n.name," ")}}function no(t,_){if(1&t&&(e._Xx(0),e.I0R(1,"ul",1),e.c53(2,to,4,5,"li",4,eo),e.C$Y()),2&t){const n=e.GaO();e.yG2(2),e.oho(n.references().categories)}}const io=["*"];let oo=(()=>{class t{constructor(){this.destroy$=(0,e.uUt)(g.UF),this.service=(0,e.uUt)(S.k),this.notifications=(0,e.uUt)(d.E),this.item=(0,e.OCB)(null),this.references=(0,e.OCB)(null),this.searching=(0,e.OCB)(!1)}set dish(n){this.item.set(n??null),this.searchReferences()}searchReferences(){this.references.set(null);const n=this.item()?.id;n&&(this.searching.set(!0),this.service.references(n).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.searching.set(!1))).subscribe({next:i=>this.references.set(i),error:i=>this.notifications.error((0,I.mk)(i)||Zi.$localize`Qualcosa è andato storto.`)}))}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=e.In1({type:t,selectors:[["app-dish-references"]],inputs:{dish:"dish"},standalone:!0,features:[e.M5G([g.UF]),e.UHJ],ngContentSelectors:io,decls:1,vars:1,consts:[["class","tui-list tui-list_small"],[1,"tui-list","tui-list_small"],[1,"tui-list__item"],["tuiLink","",1,"mb-2",3,"routerLink"],["class","tui-list__item"]],template:function(i,o){1&i&&(e.kPM(),e.yuY(0,no,4,0,"ul",0)),2&i&&e.C0Y(0,o.item()&&o.references()?0:-1)},dependencies:[qi.S,m.ER,J.w,J.C],changeDetection:0})}return t})();var _o=a(48392),so=a(6096);const ao=(t,_)=>_.id;function lo(t,_){if(1&t&&e.wR5(0,"app-show-image",13),2&t){const n=e.GaO().$implicit;e.E7m("image",n.images[0])}}function co(t,_){if(1&t){const n=e.KQA();e.I0R(0,"button",14),e.qCj("click",function(){e.usT(n);const o=e.GaO().$implicit,s=e.GaO();return e.CGJ(s.remove(o))}),e.SAx(1),e.aS0(2,15),e.k70(),e.C$Y()}}function ro(t,_){if(1&t&&(e.I0R(0,"tui-island",7)(1,"div",8)(2,"span",4),e.yuY(3,lo,1,1,"app-show-image",9),e.I0R(4,"div"),e.OEk(5),e.C$Y()(),e.I0R(6,"div",4),e.yuY(7,co,3,0,"ng-template",null,10,e.gJz),e.I0R(9,"tui-hosted-dropdown",11)(10,"button",12)(11,"mat-icon"),e.OEk(12,"delete"),e.C$Y()()()()()()),2&t){const n=_.$implicit,i=e.Gew(8);e.yG2(3),e.E7m("ngIf",n&&n.images&&n.images[0]),e.yG2(2),e.oRS(" ",n.name," "),e.yG2(4),e.E7m("content",i)}}function uo(t,_){1&t&&(e.I0R(0,"p"),e.SAx(1),e.aS0(2,16),e.k70(),e.C$Y())}const go=t=>({can_suggest:t});function po(t,_){if(1&t){const n=e.KQA();e.I0R(0,"tui-loader",17)(1,"form",18),e.qCj("ngSubmit",function(){e.usT(n);const o=e.GaO(2);return e.CGJ(o.addDish())}),e.I0R(2,"div",19)(3,"app-dish-select",20),e.SAx(4),e.aS0(5,21),e.k70(),e.C$Y()(),e.I0R(6,"div",4)(7,"button",22),e.SAx(8),e.aS0(9,23),e.k70(),e.C$Y(),e.I0R(10,"button",24),e.qCj("click",function(){e.usT(n);const o=e.GaO(2);return e.CGJ(o.dismissAddDish())}),e.SAx(11),e.aS0(12,25),e.k70(),e.C$Y()()()()}if(2&t){const n=e.GaO(2);e.E7m("overlay",!0)("showLoader",n.addingDish()),e.yG2(),e.E7m("formGroup",n.newDishForm),e.yG2(2),e.E7m("filters",e.S45(5,go,n.dish.id))("formControlName","dish")}}function mo(t,_){1&t&&e.OEk(0," no dish or dish.id ")}function Co(t,_){if(1&t&&e.yuY(0,po,13,7,"tui-loader",17)(1,mo,1,0),2&t){const n=e.GaO();e.C0Y(0,n.dish&&n.dish.id?0:1)}}let So=(()=>{class t{constructor(){this.dishesService=(0,e.uUt)(S.k),this.destroy$=(0,e.uUt)(g.UF),this.notifications=(0,e.uUt)(d.E),this.dialogs=(0,e.uUt)(V._k),this.dishChange=new e._w7,this.dish$=(0,e.OCB)(null),this.deleting=(0,e.OCB)(!1),this.moving=(0,e.OCB)(!1),this.addingDish=(0,e.OCB)(!1),this.removingDish=(0,e.OCB)(!1),this.loading=(0,e.S6b)(()=>this.deleting()||this.moving()||this.addingDish()||this.removingDish()),this.ordering=(0,e.OCB)(!1),this.items=(0,e.OCB)([]),this.newDishForm=new c.WC({dish:new c.Ku(null,c.AQ.required)})}set dish(n){this.dish$.set(n??null),this.items.set(n?.suggestions??[])}get dish(){return this.dish$()}remove(n){const i=this.dish$()?.id;i&&n.id&&(this.removingDish.set(!0),this.dishesService.removeSuggestion(i,n.id).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.removingDish.set(!1))).subscribe((0,Q.I)()))}dismissAddDish(){this.addDishModal?.unsubscribe(),this.newDishForm.reset()}showAddDish(n){this.addDishModal=this.dialogs.open(n).subscribe()}addDish(){const n=this.dish?.id,i=this.newDishForm.get("dish")?.value?.id;this.newDishForm.valid&&i&&n&&(this.addingDish.set(!0),this.dishesService.addSuggestion(n,i).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.dismissAddDish()),(0,p.U)(()=>this.addingDish.set(!1))).subscribe({error:o=>this.notifications.error((0,I.mk)(o)||_o.a)}))}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=e.In1({type:t,selectors:[["app-dish-suggestions"]],inputs:{dish:"dish"},outputs:{dishChange:"dishChange"},standalone:!0,features:[e.UHJ],decls:15,vars:1,consts:()=>{let n,i,o,s,l,r,G;return n="Piatti/bibite da accoppiare suggeriti",i="Aggiungi suggerimento",o="Rimuovi suggerimento",s="Non ci sono suggerimenti per questo piatto",l="Cerca piatto",r="Aggiungi",G="Annulla",[n,[1,"items-list"],["addModal",""],["type","button","size","m","appearance","flat","tuiButton","",3,"click"],[1,"flex","items-center"],[1,"me-1"],i,[1,"mb-2"],[1,"flex","justify-between","items-center"],["style","max-width: 100px;","class","inline-block rounded me-2",3,"image",4,"ngIf"],["deleteDropdown",""],[3,"content"],["size","m","tuiIconButton","","type","button","appearance","outline"],[1,"inline-block","rounded","me-2",2,"max-width","100px",3,"image"],["tuiButton","","appearance","secondary-destructive","type","button",1,"m-4",3,"click"],o,s,[3,"overlay","showLoader"],[3,"formGroup","ngSubmit"],[1,"mb-4"],[3,"filters","formControlName"],l,["tuiButton","","size","m","type","submit",1,"me-2"],r,["type","button","appearance","outline","tuiButton","","size","m",3,"click"],G,["class","mb-2"]]},template:function(i,o){if(1&i){const s=e.KQA();e.I0R(0,"h4"),e.SAx(1),e.aS0(2,0),e.k70(),e.C$Y(),e.I0R(3,"div",1),e.c53(4,ro,13,3,"tui-island",26,ao,!1,uo,3,0,"p"),e.C$Y(),e.yuY(7,Co,2,1,"ng-template",null,2,e.gJz),e.I0R(9,"button",3),e.qCj("click",function(){e.usT(s);const r=e.Gew(8);return e.CGJ(o.showAddDish(r))}),e.I0R(10,"span",4)(11,"mat-icon",5),e.OEk(12,"add"),e.C$Y(),e.I0R(13,"span"),e.aS0(14,6),e.C$Y()()()}2&i&&(e.yG2(4),e.oho(o.items()))},dependencies:[w.k,w.C,j.y,E.u_,A.CI,A.Kw,Y.GE,Y.Qw,v.qL,N.Sk,N.Cb,c.sl,c.sz,c.ue,c.u,c.uW,c.Wo,so.i],encapsulation:2})}return t})();var O=a(93228);function Eo(t,_){1&t&&(e.I0R(0,"p"),e.aS0(1,23),e.C$Y(),e.I0R(2,"p"),e.aS0(3,24),e.C$Y())}function ho(t,_){if(1&t){const n=e.KQA();e.I0R(0,"div",3)(1,"h4",4),e.aS0(2,25),e.C$Y(),e.I0R(3,"app-name-desc-eip",26),e.qCj("submittedChanges",function(o){e.usT(n);const s=e.GaO(2);return e.CGJ(s.saveNameDesc(o))}),e.C$Y()()}if(2&t){const n=e.GaO(2);let i;e.yG2(3),e.E7m("translations",null==(i=n.dish())?null:i.translations)}}function To(t,_){if(1&t){const n=e.KQA();e.I0R(0,"div")(1,"div",0)(2,"div",1)(3,"h1"),e.OEk(4),e.C$Y()(),e.I0R(5,"div")(6,"a",2)(7,"mat-icon"),e.OEk(8,"close"),e.C$Y()()()(),e.I0R(9,"div",3)(10,"h4",4),e.aS0(11,5),e.C$Y(),e.wR5(12,"app-show-images",6),e.C$Y(),e.I0R(13,"div",3)(14,"h4",4),e.aS0(15,7),e.C$Y(),e.I0R(16,"app-edit-dish-status",8),e.qCj("deleteDish",function(){e.usT(n);const o=e.GaO();return e.CGJ(o.delete())})("statusChange",function(o){e.usT(n);const s=e.GaO();return e.CGJ(s.updateStatus(o))})("dishChange",function(o){e.usT(n);const s=e.GaO();return e.CGJ(s.dish.set(o))}),e.C$Y()(),e.yuY(17,Eo,4,0,"ng-template",null,9,e.gJz),e.I0R(19,"div",3)(20,"div",10)(21,"mat-icon",11),e.OEk(22,"link"),e.C$Y(),e.I0R(23,"h4",12),e.aS0(24,13),e.C$Y(),e.wR5(25,"tui-tooltip",14),e.C$Y(),e.wR5(26,"app-dish-references",15),e.C$Y(),e.I0R(27,"div",3)(28,"h4",4),e.aS0(29,16),e.C$Y(),e.I0R(30,"app-dish-price",17),e.qCj("dishChanged",function(o){e.usT(n);const s=e.GaO();return e.CGJ(s.dish.set(o))}),e.SAx(31),e.aS0(32,18),e.k70(),e.C$Y()(),e.yuY(33,ho,4,1,"div",19),e.I0R(34,"div",3)(35,"app-dish-ingredients",20),e.qCj("dishChange",function(o){e.usT(n);const s=e.GaO();return e.CGJ(s.dish.set(o))}),e.C$Y()(),e.I0R(36,"div",3)(37,"app-dish-allergens",20),e.qCj("dishChange",function(o){e.usT(n);const s=e.GaO();return e.CGJ(s.dish.set(o))}),e.C$Y()(),e.I0R(38,"div",3)(39,"app-dish-tags",20),e.qCj("dishChange",function(o){e.usT(n);const s=e.GaO();return e.CGJ(s.dish.set(o))}),e.C$Y()(),e.I0R(40,"div",3)(41,"app-dish-suggestions",20),e.qCj("dishChange",function(o){e.usT(n);const s=e.GaO();return e.CGJ(s.dish.set(o))}),e.C$Y()(),e.I0R(42,"button",21),e.qCj("click",function(){e.usT(n);const o=e.GaO();return e.CGJ(o.confirmAndDelete())}),e.SAx(43),e.aS0(44,22),e.k70(),e.C$Y()()}if(2&t){const n=e.Gew(18),i=e.GaO();let o,s,l,r;e.yG2(4),e.cNF(null==(o=i.dish())?null:o.name),e.yG2(2),e.E7m("type","button")("routerLink","../.."),e.yG2(6),e.E7m("recordType","Menu::Dish")("recordId",null==(s=i.dish())?null:s.id)("images",null==(l=i.dish())?null:l.images),e.yG2(4),e.E7m("dish",i.dish()),e.yG2(9),e.E7m("content",n),e.yG2(),e.E7m("dish",i.dish()),e.yG2(4),e.E7m("dish",i.dish()),e.yG2(3),e.C0Y(33,null!=(r=i.dish())&&r.translations?33:-1),e.yG2(2),e.E7m("dish",i.dish()),e.yG2(2),e.E7m("dish",i.dish()),e.yG2(2),e.E7m("dish",i.dish()),e.yG2(2),e.E7m("dish",i.dish()),e.yG2(),e.E7m("appearance","secondary-destructive")}}function fo(t,_){1&t&&e.wR5(0,"tui-loader",27),2&t&&e.E7m("showLoader",!0)("size","l")}let Oo=(()=>{class t{constructor(){this.destroy$=(0,e.uUt)(g.UF),this.service=(0,e.uUt)(S.k),this.notifications=(0,e.uUt)(d.E),this.router=(0,e.uUt)(m.E5),this.route=(0,e.uUt)(m.gV),this.loading=(0,e.OCB)(!1),this.dish=(0,e.OCB)(null),this.dishId=(0,e.OCB)(null)}ngOnInit(){this.route.params.pipe((0,u.a)(this.destroy$),(0,f.k)(n=>Number(n.dish_id)),(0,R.I)(n=>"number"==typeof n&&!isNaN(n)&&n>0),(0,F.a)(),(0,he.y)(n=>this.dishId.set(n))).subscribe({next:n=>this.loadDish(n),error:n=>{this.dishId.set(null),this.dish.set(null)}})}delete(){const n=this.dish()?.id;n&&(this.loading.set(!0),this.service.destroy(n).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.loading.set(!1))).subscribe({next:()=>{this.notifications.fireSnackBar(O.$localize`Piatto eliminata.`),this.router.navigate(["../.."],{relativeTo:this.route})},error:i=>{this.notifications.error((0,I.mk)(i)||O.$localize`Qualcosa è andato storto.`)}}))}updateStatus(n){const i=this.dish()?.id;!n||!i||(this.loading.set(!0),this.service.updateStatus(i,n).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.loading.set(!1))).subscribe({next:o=>{this.notifications.fireSnackBar(O.$localize`Stato aggiornato.`),this.dish.set(o)},error:o=>{this.notifications.error((0,I.mk)(o)||O.$localize`Qualcosa è andato storto.`)}}))}loadDish(n){this.dishId.set(n),this.loading.set(!0),this.service.show(n).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.loading.set(!1))).subscribe({next:i=>this.dish.set(i),error:i=>{this.dish.set(null),this.notifications.error((0,I.mk)(i)||O.$localize`Qualcosa è andato storto.`)}})}saveNameDesc(n){const i=this.dish()?.id;i&&(this.loading.set(!0),this.service.update(i,n).pipe((0,u.a)(this.destroy$),(0,p.U)(()=>this.loading.set(!1))).subscribe({next:o=>{this.notifications.fireSnackBar(O.$localize`Traduzioni aggiornate.`),this.dish.set(o)},error:o=>{this.notifications.error((0,I.mk)(o)||O.$localize`Qualcosa è andato storto.`)}}))}confirmAndDelete(){this.notifications.confirm(O.$localize`Sei sicuro di voler eliminare questo piatto?`).subscribe({next:n=>{n&&this.delete()}})}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=e.In1({type:t,selectors:[["__app-view-dish"]],standalone:!0,features:[e.M5G([g.UF]),e.UHJ],decls:2,vars:1,consts:()=>{let n,i,o,s,l,r,G,T,C;return n=O.$localize`Immagini piatto`,i=O.$localize`Stato piatto`,o=O.$localize`Piatto presente anche in:`,s=O.$localize`Prezzo`,l=O.$localize`Prezzo`,r=O.$localize`Elimina piatto`,G=O.$localize`Lo stesso piatto può essere presente in più categorie.`,T=O.$localize`Le categorie elencate di seguito sono tutte le categorie in cui è possibile vedere questo piatto.`,C=O.$localize`Traduzioni`,[[1,"flex","items-center","justify-between"],[1,"flex","flex-items"],["tuiIconButton","","appearance","icon",3,"type","routerLink"],[1,"mb-3"],[1,"mb-1","me-1"],n,[1,"mb-3",3,"recordType","recordId","images"],i,[3,"dish","deleteDish","statusChange","dishChange"],["referencesHelp",""],[1,"flex","items-center","mb-2"],[1,"me-1"],[1,"me-1","my-0"],o,["direction","right",3,"content"],[3,"dish"],s,[3,"dish","dishChanged"],l,["class","mb-3"],[3,"dish","dishChange"],["tuiButton","","type","button",3,"appearance","click"],r,G,T,C,[1,"mb-3",3,"translations","submittedChanges"],[3,"showLoader","size"]]},template:function(i,o){1&i&&e.yuY(0,To,45,16,"div")(1,fo,1,2),2&i&&e.C0Y(0,o.dish()?0:o.loading()?1:-1)},dependencies:[H.g,N.Sk,N.Cb,A.CI,A.Kw,m.ER,v.qL,ve,Le.O,Yt,Bn,Wi,Ki,oo,le.a,le.i,So],changeDetection:0})}return t})(),Io=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=e.a4G({type:t});static#n=this.\u0275inj=e.s3X({imports:[m.qQ.forChild([(0,b.VV)(Oo,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return t})()},67307:(X,x,a)=>{"use strict";a.d(x,{_:()=>H});var m=a(36012),b=a(34824),e=a(54496);let H=(()=>{class g extends m.s{constructor(){super(b.o,"admin/menu/allergens")}static#e=this.\u0275fac=function(u){return new(u||g)};static#t=this.\u0275prov=e.wxM({token:g,factory:g.\u0275fac,providedIn:"root"})}return g})()},78432:(X,x,a)=>{"use strict";a.d(x,{K:()=>H});var m=a(36012),b=a(60532),e=a(54496);let H=(()=>{class g extends m.s{constructor(){super(b.e,"admin/menu/ingredients")}static#e=this.\u0275fac=function(u){return new(u||g)};static#t=this.\u0275prov=e.wxM({token:g,factory:g.\u0275fac,providedIn:"root"})}return g})()},19116:(X,x,a)=>{"use strict";a.d(x,{w:()=>H});var m=a(36012),b=a(70355),e=a(54496);let H=(()=>{class g extends m.s{constructor(){super(b.E,"admin/menu/tags")}static#e=this.\u0275fac=function(u){return new(u||g)};static#t=this.\u0275prov=e.wxM({token:g,factory:g.\u0275fac,providedIn:"root"})}return g})()},41632:(X,x,a)=>{"use strict";a.d(x,{k:()=>H,u:()=>g});var m=a(54496),b=a(50900),e=a(74680);let H=(()=>{class S{constructor(u,f){this.el=u,this.takeOnlyTrustedEvents=f,this.tuiPressedChange=(0,b.Y7)(this.el.nativeElement,{onlyTrusted:this.takeOnlyTrustedEvents})}}return S.\u0275fac=function(u){return new(u||S)(m.GI1(m.GMv),m.GI1(e.mm))},S.\u0275dir=m.Sc5({type:S,selectors:[["","tuiPressedChange",""]],outputs:{tuiPressedChange:"tuiPressedChange"}}),S})(),g=(()=>{class S{}return S.\u0275fac=function(u){return new(u||S)},S.\u0275mod=m.a4G({type:S}),S.\u0275inj=m.s3X({}),S})()},54259:(X,x,a)=>{"use strict";a.d(x,{U9:()=>S,_k:()=>g});var m=a(54496),b=a(7232);class H{constructor(u){this.$implicit=u}}let g=(()=>{class d{constructor(f,R){this.viewContainer=f,this.templateRef=R}set tuiRepeatTimesOf(f){const R=Math.floor((0,b.K6)(f,0,65536)),{length:F}=this.viewContainer;f<F?this.removeContainers(F-f):this.addContainers(R)}addContainers(f){for(let R=this.viewContainer.length;R<f;R++)this.viewContainer.createEmbeddedView(this.templateRef,new H(R))}removeContainers(f){for(let R=0;R<f;R++)this.viewContainer.remove()}}return d.\u0275fac=function(f){return new(f||d)(m.GI1(m.y8U),m.GI1(m.Yw2))},d.\u0275dir=m.Sc5({type:d,selectors:[["","tuiRepeatTimes","","tuiRepeatTimesOf",""]],inputs:{tuiRepeatTimesOf:"tuiRepeatTimesOf"}}),d})(),S=(()=>{class d{}return d.\u0275fac=function(f){return new(f||d)},d.\u0275mod=m.a4G({type:d}),d.\u0275inj=m.s3X({}),d})()},83e3:()=>{},20520:()=>{},14336:()=>{},87552:()=>{},70580:()=>{},93228:()=>{},91736:()=>{},55220:()=>{}}]);