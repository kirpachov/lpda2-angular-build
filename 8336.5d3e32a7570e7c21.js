(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[8336],{88336:(G,y,o)=>{"use strict";o.r(y),o.d(y,{DuplicateCategoryModule:()=>b});var t=o(31236),h=o(7552),e=o(54496),I=o(11712),f=o(83480),E=o(6504),m=o(89852),g=o(53616),i=o(68824),r=o(1128),u=o(45820),C=o(38256),a=o(9938),R=o(6524),D=o(99956),v=o(78976),s=o(58212),O=o(19880),n=o(41512),l=o(75704),T=o(48392),N=o(49088),c=o(98456);let X=(()=>{class M{constructor(){this.destroy$=(0,e.uUt)(f.UF),this.router=(0,e.uUt)(t.E5),this.route=(0,e.uUt)(t.gV),this.service=(0,e.uUt)(I.S),this.notifications=(0,e.uUt)(r.E),this.submitted=!1,this.category=(0,e.OCB)(null),this.form=new E.WC({copy_dishes:new E.Ku("full",[E.AQ.required,m.S.in(["full","link","none"])]),copy_images:new E.Ku("full",[E.AQ.required,m.S.in(["full","link","none"])]),copy_children:new E.Ku("full",[E.AQ.required,m.S.in(["full","none"])]),create_as_root:new E.Ku(!1),parent:new E.Ku(null,[m.S.instanceof(u.Q)])}),this.saving=(0,e.OCB)(!1),this.loading=(0,e.S6b)(()=>this.saving()),this.e=this.getErrorsFor}ngOnInit(){this.route.parent?.parent?.params.pipe((0,g.a)(this.destroy$)).subscribe({next:d=>{this.loadCategory(d.category_id)}})}submit(){if(this.submitted=!0,this.form.invalid)return;const d=this.category()?.id;if(!d)throw new Error(`Category id invalid: ${d}`);this.saving.set(!0),this.service.copy(d,this.formValue()).pipe((0,g.a)(this.destroy$),(0,i.U)(()=>this.saving.set(!1))).subscribe({next:_=>{this.notifications.fireSnackBar(c.$localize`Duplicato.`),this.router.navigate(["../..",_.id],{relativeTo:this.route})},error:_=>{this.manageError(_)}})}cancel(){(this.form.touched||this.form.dirty)&&!confirm(c.$localize`Sei sicuro di voler annullare le modifiche fatte?`)||(this.notifications.fireSnackBar(c.$localize`Operazione annullata`),this.navigateBack())}formValue(){return{copy_dishes:this.form.value.copy_dishes,copy_images:this.form.value.copy_images,copy_children:this.form.value.copy_children,parent_id:this.form.value.create_as_root?null:this.form.value.parent?.id??null}}navigateBack(){this.router.navigate([".."],{relativeTo:this.route})}manageError(d){422==d.status?a.y.assignErrorsToForm(this.form,d):this.notifications.error((0,C.mk)(d)||T.a)}getErrorsFor(d){const _=this.form.get(d);return _&&(this.submitted||_.touched||_.dirty)?_.errors:null}loadCategory(d){d&&this.service.show(d).pipe((0,g.a)(this.destroy$)).subscribe({next:_=>{this.category.set(_)},error:_=>{this.notifications.error((0,C.mk)(_)||T.a)}})}static#e=this.\u0275fac=function(_){return new(_||M)};static#t=this.\u0275cmp=e.In1({type:M,selectors:[["app-duplicate-category"]],standalone:!0,features:[e.M5G([f.UF]),e.UHJ],decls:67,vars:33,consts:()=>{let d,_,A,S,P,L,$,U,Y,B,x,z,k,H;return d=c.$localize`Copia categoria`,_=c.$localize`Creare la nuova categoria come:`,A=c.$localize`Menù principale`,S=c.$localize`Categoria padre della nuova categoria:`,P=c.$localize`Copiare sotto-categorie?`,L=c.$localize`Copia`,$=c.$localize`Copiare piatti?`,U=c.$localize`Copia`,Y=c.$localize`Associa esistenti`,B=c.$localize`Copiare immagini?`,x=c.$localize`Copia`,z=c.$localize`Associa esistenti`,k=c.$localize`Conferma`,H=c.$localize`Annulla`,[[1,"flex","items-center"],d,[1,"ml-2"],["tuiLink","",3,"routerLink"],[3,"formGroup","ngSubmit"],[1,"mb-3"],_,["tuiGroup","",1,"group",3,"collapsed"],["contentAlign","right","size","l",3,"hideRadio","formControlName","item"],A,[3,"errors"],[3,"expanded"],[3,"formControlName"],S,P,["contentAlign","right","formControlName","copy_children","item","full","size","l",3,"hideRadio"],L,["contentAlign","right","formControlName","copy_children","item","none","size","l",3,"hideRadio"],$,["contentAlign","right","formControlName","copy_dishes","item","full","size","l",3,"hideRadio"],U,["contentAlign","right","formControlName","copy_dishes","item","link","size","l",3,"hideRadio"],Y,["contentAlign","right","formControlName","copy_dishes","item","none","size","l",3,"hideRadio"],B,["contentAlign","right","formControlName","copy_images","item","full","size","l",3,"hideRadio"],x,["contentAlign","right","formControlName","copy_images","item","link","size","l",3,"hideRadio"],z,["contentAlign","right","formControlName","copy_images","item","none","size","l",3,"hideRadio"],["type","submit","size","l","tuiButton","",1,"me-2",3,"appearance"],k,["type","button","size","l","tuiButton","",1,"me-2",3,"appearance","click"],H]},template:function(_,A){if(1&_&&(e.I0R(0,"div",0)(1,"h1"),e.aS0(2,1),e.C$Y(),e.I0R(3,"span",2)(4,"a",3),e.wVc(5,"urlTo"),e.OEk(6),e.C$Y()()(),e.I0R(7,"form",4),e.qCj("ngSubmit",function(){return A.submit()}),e.I0R(8,"div",5)(9,"p"),e.aS0(10,6),e.C$Y(),e.I0R(11,"div",7)(12,"tui-radio-block",8),e.SAx(13),e.aS0(14,9),e.k70(),e.C$Y(),e.I0R(15,"tui-radio-block",8),e.OEk(16," Sotto-categoria "),e.C$Y()(),e.wR5(17,"app-errors",10),e.C$Y(),e.I0R(18,"tui-expand",11)(19,"div",5)(20,"app-menu-category-select",12),e.SAx(21),e.aS0(22,13),e.k70(),e.C$Y(),e.wR5(23,"app-errors",10),e.C$Y()(),e.I0R(24,"div",5)(25,"p"),e.aS0(26,14),e.C$Y(),e.I0R(27,"div",7)(28,"tui-radio-block",15),e.SAx(29),e.aS0(30,16),e.k70(),e.C$Y(),e.I0R(31,"tui-radio-block",17),e.OEk(32," No "),e.C$Y()(),e.wR5(33,"app-errors",10),e.C$Y(),e.I0R(34,"div",5)(35,"p"),e.aS0(36,18),e.C$Y(),e.I0R(37,"div",7)(38,"tui-radio-block",19),e.SAx(39),e.aS0(40,20),e.k70(),e.C$Y(),e.I0R(41,"tui-radio-block",21),e.SAx(42),e.aS0(43,22),e.k70(),e.C$Y(),e.I0R(44,"tui-radio-block",23),e.OEk(45," No "),e.C$Y()(),e.wR5(46,"app-errors",10),e.C$Y(),e.I0R(47,"div",5)(48,"p"),e.aS0(49,24),e.C$Y(),e.I0R(50,"div",7)(51,"tui-radio-block",25),e.SAx(52),e.aS0(53,26),e.k70(),e.C$Y(),e.I0R(54,"tui-radio-block",27),e.SAx(55),e.aS0(56,28),e.k70(),e.C$Y(),e.I0R(57,"tui-radio-block",29),e.OEk(58," No "),e.C$Y()(),e.wR5(59,"app-errors",10),e.C$Y(),e.I0R(60,"div",0)(61,"button",30),e.SAx(62),e.aS0(63,31),e.k70(),e.C$Y(),e.I0R(64,"button",32),e.qCj("click",function(){return A.cancel()}),e.SAx(65),e.aS0(66,33),e.k70(),e.C$Y()()()),2&_){let S,P;e.yG2(4),e.E7m("routerLink",e.g7$(5,30,null==(S=A.category())?null:S.id,"menuCategory.show")),e.yG2(2),e.cNF(null==(P=A.category())?null:P.name),e.yG2(),e.E7m("formGroup",A.form),e.yG2(4),e.E7m("collapsed",!0),e.yG2(),e.E7m("hideRadio",!0)("formControlName","create_as_root")("item",!0),e.yG2(3),e.E7m("hideRadio",!0)("formControlName","create_as_root")("item",!1),e.yG2(2),e.E7m("errors",A.e("create_as_root")),e.yG2(),e.E7m("expanded",!A.form.value.create_as_root),e.yG2(2),e.E7m("formControlName","parent"),e.yG2(3),e.E7m("errors",A.e("parent")),e.yG2(4),e.E7m("collapsed",!0),e.yG2(),e.E7m("hideRadio",!0),e.yG2(3),e.E7m("hideRadio",!0),e.yG2(2),e.E7m("errors",A.e("copy_children")),e.yG2(4),e.E7m("collapsed",!0),e.yG2(),e.E7m("hideRadio",!0),e.yG2(3),e.E7m("hideRadio",!0),e.yG2(3),e.E7m("hideRadio",!0),e.yG2(2),e.E7m("errors",A.e("copy_dishes")),e.yG2(4),e.E7m("collapsed",!0),e.yG2(),e.E7m("hideRadio",!0),e.yG2(3),e.E7m("hideRadio",!0),e.yG2(3),e.E7m("hideRadio",!0),e.yG2(2),e.E7m("errors",A.e("copy_images")),e.yG2(2),e.E7m("appearance","primary"),e.yG2(3),e.E7m("appearance","outline")}},dependencies:[E.sl,E.sz,E.ue,E.u,E.uW,E.Wo,R.a,D.g,v.Gy,v.Ko,l.W,l.I,s.CI,s.Kw,O.kh,O.st,n.w,n.C,t.ER,N.S],changeDetection:0})}return M})(),b=(()=>{class M{static#e=this.\u0275fac=function(_){return new(_||M)};static#t=this.\u0275mod=e.a4G({type:M});static#n=this.\u0275inj=e.s3X({imports:[t.qQ.forChild([(0,h.VV)(X,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return M})()},89852:(G,y,o)=>{"use strict";o.d(y,{S:()=>m});var t=o(6504),h=o(400),e=o(19664);const f=g=>null!=g&&""!=`${g}`;class m extends t.AQ{static formWeeklyFromTo(i,r){return u=>{if(!(u instanceof t.WC))return console.warn("formWeeklyFromTo: param is not a FormGroup",u),null;const C=u,a=C.get(i),R=C.get(r);return a&&R&&a.value instanceof h.uc&&R.value instanceof h.uc&&a.value&&R.value&&a.value.toAbsoluteMilliseconds()>=R.value.toAbsoluteMilliseconds()?{formWeeklyFromTo:!0}:null}}static canBeBlankIf(i,r,u){const C=u?.message||e.$localize`La form non è valida.`;return a=>{if(!(a instanceof t.WC))throw new Error("canBeBlankIf: thisIsAFormGroup is not a FormGroup");const D=a.get(i);if(!D)throw new Error("canBeBlankIf: control is blank. control name: "+i);return f(D.value)||r()?null:{[`${i}canBeBlankIf`]:C}}}static listOfEmails(i){const r=i.value;if(!r||"string"!=typeof r||!r.length)return null;const u=new RegExp("^[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,4}$","i");return r.split(/\,|\s+/gm).map(C=>C.trim()).filter(C=>C.length).forEach(C=>{if(!u.test(C))return{listOfEmails:!0}}),null}static mustBeArray(i){return Array.isArray(i.value)?null:{mustBeArray:!0}}static objectNotEmpty(i){return f(i.value)&&"object"==typeof i.value&&0===Object.keys(i.value).length&&0===Object.values(i.value).filter(u=>f(u)).length?{objectNotEmpty:!0}:null}static arrayMinLength(i){return r=>Array.isArray(r.value)&&r.value.length<i?{arrayMinLength:{requiredLength:i,actualLength:r.value?.length??0}}:null}static validateArray(i){return r=>{if(!Array.isArray(r.value))return null;const u={};for(const C of r.value){const a=i(new t.yM(C));a&&Object.assign(u,a)}return Object.keys(u).length?u:null}}static percentage(i){return f(i.value)&&(isNaN(i.value)||i.value<0||i.value>100)?{percentage:!0}:null}static phoneIT(i){const r=C=>C?null:{phoneIT:!0},u=`${i.value}`.trim().replace(/\s+/gm,"").replace(/^\+39/gm,"");return f(u)?r(!((g=u).length<9||isNaN(Number(g))||g.length>14)):r(!0);var g}static instanceof(i){return r=>!f(r.value)||r.value instanceof i?null:{instanceof:!0}}static#e=this.instanceOf=this.instanceof;static numerical(i){return f(i.value)&&isNaN(i.value)?{numerical:!0}:null}static moreThan(i){return r=>r.value<=i?{moreThan:!0}:null}static in(i){return this.inclusion(i)}static inclusion(i){return r=>f(r.value)&&!i.includes(r.value)?{inclusion:!0}:null}}},19880:(G,y,o)=>{"use strict";o.d(y,{kP:()=>C,kh:()=>v,st:()=>D});var t=o(54496),h=o(83480),e=o(64392),I=o(83120),f=o(53616),E=o(27692),m=o(91368);const g=["wrapper"];function i(s,O){if(1&s&&(t.I0R(0,"tui-loader",4),t.C_f(1,5),t.C$Y()),2&s){const n=t.GaO(2);t.E7m("overlay",!0)("showLoader",n.loading),t.yG2(),t.E7m("ngTemplateOutlet",n.content)}}function r(s,O){if(1&s&&(t.SAx(0),t._Xx(1),t.yuY(2,i,2,3,"tui-loader",3),t.k70()),2&s){const n=t.GaO();t.yG2(2),t.E7m("ngIf",n.async)("ngIfElse",n.content)}}const u=["*"];let C=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275dir=t.Sc5({type:s,selectors:[["","tuiExpandContent",""]]}),s})();let D=(()=>{class s{constructor(n,l){this.cdr=n,this.destroy$=l,this.state=0,this.async=!1,this.content=null,this.expanded=null}set expandedSetter(n){if(null!==this.expanded)return 0!==this.state?(this.expanded=n,void(this.state=3)):(this.expanded=n,void this.retrigger(this.async&&n?1:3));this.expanded=n}get overflow(){return 0!==this.state}get loading(){return!!this.expanded&&this.async&&1===this.state}get height(){const{expanded:n,state:l,contentWrapper:T}=this;return n&&2===l||!n&&3===l?0:T&&(!n&&2===l||n&&3===l)?T.nativeElement.offsetHeight:T&&n&&1===l?Math.max(T.nativeElement.offsetHeight,48):null}get contentVisible(){return this.expanded||0!==this.state}onTransitionEnd({propertyName:n}){"opacity"===n&&3===this.state&&(this.state=0)}onExpandLoaded(n){n.stopPropagation(),1===this.state&&this.retrigger(3)}retrigger(n){this.state=2,(0,I.k)(0).pipe((0,f.a)(this.destroy$)).subscribe(()=>{2===this.state&&(this.state=n,this.cdr.markForCheck())})}}return s.\u0275fac=function(n){return new(n||s)(t.GI1(t.kD9),t.GI1(h.UF,2))},s.\u0275cmp=t.In1({type:s,selectors:[["tui-expand"]],contentQueries:function(n,l,T){if(1&n&&t.szK(T,C,5,t.Yw2),2&n){let N;t.wto(N=t.Gqi())&&(l.content=N.first)}},viewQuery:function(n,l){if(1&n&&t.CC$(g,5),2&n){let T;t.wto(T=t.Gqi())&&(l.contentWrapper=T.first)}},hostVars:9,hostBindings:function(n,l){1&n&&t.qCj("transitionend.self",function(N){return l.onTransitionEnd(N)})("tui-expand-loaded",function(N){return l.onExpandLoaded(N)}),2&n&&(t.e48("aria-expanded",l.expanded),t.m4B("height",l.height,"px"),t.eAK("_expanded",l.expanded)("_overflow",l.overflow)("_loading",l.loading))},inputs:{async:"async",expandedSetter:[t.Wk5.None,"expanded","expandedSetter"]},features:[t.M5G([h.UF])],ngContentSelectors:u,decls:3,vars:3,consts:[[1,"t-wrapper"],["wrapper",""],[4,"ngIf"],["size","l",3,"overlay","showLoader",4,"ngIf","ngIfElse"],["size","l",3,"overlay","showLoader"],[3,"ngTemplateOutlet"]],template:function(n,l){1&n&&(t.kPM(),t.I0R(0,"div",0,1),t.yuY(2,r,3,2,"ng-container",2),t.C$Y()),2&n&&(t.E7m("@tuiParentAnimation",void 0)("@.disabled",l.overflow),t.yG2(2),t.E7m("ngIf",l.contentVisible))},dependencies:[E.Cb,m.u_,m.XV],styles:['[_nghost-%COMP%]{transition-property:opacity,height,visibility;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;display:block;opacity:0;transition-delay:1ms}._overflow[_nghost-%COMP%]{overflow:hidden}._expanded[_nghost-%COMP%]{opacity:1;transform:translate(0)}._loading[_nghost-%COMP%]{opacity:.99}.t-wrapper[_ngcontent-%COMP%]:before, .t-wrapper[_ngcontent-%COMP%]:after{content:"";display:table}'],data:{animation:[e.cI]},changeDetection:0}),s})(),v=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=t.a4G({type:s}),s.\u0275inj=t.s3X({imports:[[m.MD,E.Sk]]}),s})()},98456:()=>{}}]);