"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[3204],{864:(E,c,n)=>{n.r(c),n.d(c,{LinkDishModule:()=>L});var l=n(2992),m=n(7552),e=n(4496),a=n(4436),r=n(8212),i=n(1512),u=n(6504),t=n(3716),s=n(1712),o=n(3480),g=n(1128),I=n(3616),N=n(4704),v=n(4e3),$=n(8824),M=n(8256),T=n(9088);function R(h,K){1&h&&(e.I0R(0,"p"),e.aS0(1,10),e.C$Y(),e.I0R(2,"p"),e.aS0(3,11),e.C$Y())}const y=h=>({except_in_category:h});function A(h,K){if(1&h){const _=e.KQA();e.I0R(0,"form",12),e.qCj("ngSubmit",function(){e.usT(_);const d=e.GaO();return e.CGJ(d.submit())}),e.I0R(1,"app-dish-select",13),e.SAx(2),e.aS0(3,14),e.k70(),e.C$Y(),e.I0R(4,"div",0)(5,"button",15),e.SAx(6),e.aS0(7,16),e.k70(),e.C$Y(),e.I0R(8,"button",17),e.qCj("click",function(){e.usT(_);const d=e.GaO();return e.CGJ(d.cancel())}),e.SAx(9),e.aS0(10,18),e.k70(),e.C$Y()()()}if(2&h){const _=e.GaO();e.E7m("formGroup",_.form),e.yG2(),e.E7m("filters",e.S45(3,y,_.categoryId))("formControlName","dish")}}let P=(()=>{class h{constructor(){this.service=(0,e.uUt)(s.S),this.destroy$=(0,e.uUt)(o.UF),this.route=(0,e.uUt)(l.gV),this.router=(0,e.uUt)(l.E5),this.notifications=(0,e.uUt)(g.E),this.loading=(0,e.OCB)(!1),this.category=(0,e.OCB)(null),this.categoryId=null,this.form=new u.WC({dish:new u.Ku(null)})}ngOnInit(){this.route.parent?.parent?.params.pipe((0,I.a)(this.destroy$),(0,N.k)(_=>_.category_id),(0,v.a)()).subscribe({next:_=>{this.categoryId=_,this.loadCategory()}})}submit(){const _=this.categoryId,p=this.form.value?.dish?.id;_&&p?this.form.invalid||(this.loading.set(!0),this.service.addDish(_,p).pipe((0,I.a)(this.destroy$),(0,$.U)(()=>this.loading.set(!1))).subscribe({next:()=>{this.navigateBack(),this.notifications.fireSnackBar("Piatto aggiunto.")},error:d=>{this.notifications.error((0,M.mk)(d)||"Qualcosa \xE8 andato storto nell'aggiunta del piatto.")}})):console.error("something invalid.",{categoryId:_,dishId:p})}cancel(){(this.form.touched||this.form.dirty)&&!confirm("Sei sicuro di voler annullare questa azione?")||this.navigateBack()}navigateBack(){const _=this.route.snapshot.queryParams.afterUrl;_?this.router.navigateByUrl(_):this.router.navigate([".."],{relativeTo:this.route})}loadCategory(){this.category.set(null),this.categoryId&&this.service.show(this.categoryId).pipe((0,I.a)(this.destroy$)).subscribe({next:_=>{this.category.set(_)},error:_=>{this.notifications.error((0,M.mk)(_)||"Qualcosa \xE8 andato storto nel caricamento della categoria padre.")}})}static#e=this.\u0275fac=function(p){return new(p||h)};static#t=this.\u0275cmp=e.In1({type:h,selectors:[["app-link-dish"]],standalone:!0,features:[e.M5G([o.UF]),e.UHJ],decls:15,vars:7,consts:()=>{let _,p,d,S,C,f,D;return _="Associa piatto esistente",p="Il piatto verr\xE0 aggiunto alla categoria",d="\n          Associare un piatto esistente ti permette di tenere lo stesso identico\n          piatto presente in pi\xF9 categorie.\n        ",S="\n          Il vantaggio \xE8 che quando devi apportare una modifica al piatto, lo\n          devi fare una volta sola.\n        ",C="Piatto da associare",f="Conferma",D="Annulla",[[1,"flex","items-center"],[1,"me-2"],_,[3,"content"],[1,"mb-3"],[1,"me-2","text-slate-400"],p,["tuiLink","",3,"routerLink"],["helpMsg",""],[3,"formGroup"],d,S,[3,"formGroup","ngSubmit"],[1,"block","mb-3",3,"filters","formControlName"],C,["tuiButton","","type","submit","size","l","appearance","primary",1,"me-2"],f,["tuiButton","","type","button","size","l","appearance","outline",3,"click"],D]},template:function(p,d){if(1&p&&(e.I0R(0,"span",0)(1,"h1",1),e.SAx(2),e.aS0(3,2),e.k70(),e.C$Y(),e.wR5(4,"tui-tooltip",3),e.C$Y(),e.I0R(5,"div",4)(6,"span",5),e.SAx(7),e.aS0(8,6),e.k70(),e.C$Y(),e.I0R(9,"a",7),e.wVc(10,"urlTo"),e.OEk(11),e.C$Y()(),e.yuY(12,R,4,0,"ng-template",null,8,e.gJz)(14,A,11,5,"form",9)),2&p){const S=e.Gew(13);let C,f;e.yG2(4),e.E7m("content",S),e.yG2(5),e.E7m("routerLink",e.g7$(10,4,null==(C=d.category())?null:C.id,"menuCategory.show")),e.yG2(2),e.cNF(null==(f=d.category())?null:f.name),e.yG2(3),e.C0Y(14,d.categoryId?14:-1)}},dependencies:[a.a,a.i,u.sl,u.sz,u.ue,u.u,u.uW,u.Wo,t.i,r.CI,r.Kw,i.w,i.C,l.ER,T.S],changeDetection:0})}return h})(),L=(()=>{class h{static#e=this.\u0275fac=function(p){return new(p||h)};static#t=this.\u0275mod=e.a4G({type:h});static#i=this.\u0275inj=e.s3X({imports:[l.qQ.forChild([(0,m.VV)(P,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return h})()},4824:(E,c,n)=>{n.d(c,{o:()=>e});var l=n(8400),m=n(2264);class e extends l.w{constructor(r){super(r),this.name=r.name,this.description=r.description,this.status=r.status,this.other=r.other,this.translations={...r.translations},r.image&&(this.image=new m.W(r.image))}}},5891:(E,c,n)=>{n.d(c,{S:()=>i});var l=n(8400),m=n(2264),e=n(355),a=n(4824),r=n(532);class i extends l.w{constructor(t){super(t),this.name=t.name,this.description=t.description,this.status=t.status,this.price=t.price,this.translations=t.translations,this.images=t.images?t.images.map(s=>new m.W(s)):[],this.suggestions=t.suggestions?t.suggestions.map(s=>new i(s)):[],this.tags=t.tags?t.tags.map(s=>new e.E(s)):[],this.allergens=t.allergens?t.allergens.map(s=>new a.o(s)):[],this.ingredients=t.ingredients?t.ingredients.map(s=>new r.e(s)):[]}}},2264:(E,c,n)=>{n.d(c,{W:()=>m});var l=n(8400);class m extends l.w{constructor(a){super(a),this.filename=a.filename,this.status=a.status,this.key=a.key,this.original_id=a.original_id,this.tag=a.tag,this.url=a.url}}},532:(E,c,n)=>{n.d(c,{e:()=>e});var l=n(8400),m=n(2264);class e extends l.w{constructor(r){super(r),this.name=r.name,this.description=r.description,this.status=r.status,this.other=r.other,this.translations={...r.translations},r.image&&(this.image=new m.W(r.image))}}},5820:(E,c,n)=>{n.d(c,{Q:()=>a});var l=n(8400);class m extends l.w{constructor(i){super(i),this.public_visible=i.public_visible,this.public_from=i.public_from?new Date(i.public_from):void 0,this.public_to=i.public_to?new Date(i.public_to):void 0,this.private_visible=i.private_visible,this.daily_from=i.daily_from?new Date(i.daily_from):void 0,this.daily_to=i.daily_to?new Date(i.daily_to):void 0}}var e=n(2264);class a extends l.w{constructor(i){super(i),this.name=i.name,this.description=i.description,this.status=i.status,this.price=i.price,this.parent_id=i.parent_id,this.index=i.index,this.secret=i.secret,this.secret_desc=i.secret_desc,this.visibility_id=i.visibility_id,this.visibility=i.visibility?new m(i.visibility):void 0,this.parent=i.parent?new a(i.parent):void 0,this.children=i.children?i.children.map(u=>new a(u)):[],this.images=i.images?i.images.map(u=>new e.W(u)):[],this.translations=i.translations}}},355:(E,c,n)=>{n.d(c,{E:()=>e});var l=n(8400),m=n(2264);class e extends l.w{constructor(r){super(r),this.name=r.name,this.description=r.description,this.status=r.status,this.other=r.other,this.translations={...r.translations},this.color=r.color,r.image&&(this.image=new m.W(r.image))}}},9088:(E,c,n)=>{n.d(c,{S:()=>e});var l=n(4496);const m={menuCategory:{show:"/admin/menu/{itemId}",duplicate:"/admin/menu/{itemId}/duplicate",export:"/admin/menu/{itemId}/export",createChild:"/admin/menu/{itemId}/create-category",linkCategory:"/admin/menu/{itemId}/link-category",createDish:"/admin/menu/{itemId}/create-dish",linkDish:"/admin/menu/{itemId}/link-dish",private:"/menu/{itemId}",public:"/menu/{itemId}"},dish:{show:"/admin/menu/{categoryId}/dish/{itemId}"}};let e=(()=>{class a{transform(i,u){const t=m[u.split(".")[0]];if(!t)throw new Error(`Resource not found: ${u} (resouce: ${u.split(".")[0]})`);const s=u.split(".")[1];if(!t[s])throw new Error(`Action not found: ${u} (action: ${s})`);if(typeof i>"u"||null===i)return null;if("number"==typeof i&&(i=i.toString()),"object"==typeof i&&null!==i&&!Array.isArray(i)){let o=t[s];if(Object.keys(i).forEach(g=>{const I=i[g];void 0!==I&&o.includes(`{${g}}`)&&(o=o.replace(`{${g}}`,I??""))}),o.includes("{{"))throw new Error(`Unresolved interpolation: ${o}`);return o}if("string"!=typeof i)throw new Error(`Invalid itemId: ${i} (type: ${typeof i})`);return t[s].replace("{itemId}",i)}static#e=this.\u0275fac=function(u){return new(u||a)};static#t=this.\u0275pipe=l.UTH({name:"urlTo",type:a,pure:!0,standalone:!0})}return a})()},8676:(E,c,n)=>{n.d(c,{k:()=>r});var l=n(6012),m=n(5891),e=n(4704),a=n(4496);let r=(()=>{class i extends l.s{constructor(){super(m.S,"admin/menu/dishes")}copy(t,s){return this.post(`${t}/copy`,s).pipe((0,e.k)(o=>this.mapItem(o)))}move(t,s){return this.patch(`${t}/move`,s).pipe((0,e.k)(o=>this.mapItem(o)))}moveIngredient(t,s,o){return this.patch(`${t}/ingredients/${s}/move`,{to_index:o}).pipe((0,e.k)(g=>this.mapItem(g)))}moveTag(t,s,o){return this.patch(`${t}/tags/${s}/move`,{to_index:o}).pipe((0,e.k)(g=>this.mapItem(g)))}moveAllergen(t,s,o){return this.patch(`${t}/allergens/${s}/move`,{to_index:o}).pipe((0,e.k)(g=>this.mapItem(g)))}updateStatus(t,s){return this.patch(`${t}/status/${s}`,{}).pipe((0,e.k)(o=>this.mapItem(o)))}addIngredient(t,s){return this.post(`${t}/ingredients/${s}`,{}).pipe((0,e.k)(o=>this.mapItem(o)))}removeIngredient(t,s){return this.delete(`${t}/ingredients/${s}`).pipe((0,e.k)(o=>this.mapItem(o)))}addTag(t,s){return this.post(`${t}/tags/${s}`,{}).pipe((0,e.k)(o=>this.mapItem(o)))}removeTag(t,s){return this.delete(`${t}/tags/${s}`).pipe((0,e.k)(o=>this.mapItem(o)))}addAllergen(t,s){return this.post(`${t}/allergens/${s}`,{}).pipe((0,e.k)(o=>this.mapItem(o)))}removeAllergen(t,s){return this.delete(`${t}/allergens/${s}`).pipe((0,e.k)(o=>this.mapItem(o)))}references(t){return this.get(`${t}/references`).pipe((0,e.k)(s=>s))}addSuggestion(t,s){return this.post(`${t}/suggestions/${s}`,{}).pipe((0,e.k)(o=>this.mapItem(o)))}removeSuggestion(t,s){return this.delete(`${t}/suggestions/${s}`).pipe((0,e.k)(o=>this.mapItem(o)))}static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275prov=a.wxM({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},1712:(E,c,n)=>{n.d(c,{S:()=>r});var l=n(6012),m=n(5820),e=n(4704),a=n(4496);let r=(()=>{class i extends l.s{constructor(){super(m.Q,"admin/menu/categories")}addCategory(t,s,o={}){return this.post(`${t}/add_category/${s}`,o)}addDish(t,s){return this.post(`${t}/dishes/${s}`,{})}removeDish(t,s){return this.delete(`${t}/dishes/${s}`,{})}orderDishes(t,s){return this.patch(`${t}/order_dishes`,{field:s})}dashboardData(t){return this.get(`${t}/dashboard_data`)}updateVisibility(t,s){return this.patch(`${t}/visibility`,s).pipe((0,e.k)(o=>this.mapItem(o)))}copy(t,s){return this.post(`${t}/copy`,s).pipe((0,e.k)(o=>this.mapItem(o)))}move(t,s){return this.patch(`${t}/move/${s}`,{}).pipe((0,e.k)(o=>this.mapItem(o)))}static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275prov=a.wxM({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()}}]);