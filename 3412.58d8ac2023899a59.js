"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[3412],{1032:(V,A,_)=>{_.r(A),_.d(A,{AdminReservationsHomeComponent:()=>Kn});var t=_(4496),p=_(1368),u=_(6504),O=_(3797),m=_(3480),c=_(5e3),S=_(8212),s=_(1512),N=_(5656),G=_(7692),z=_(9880),R=_(1560),d=_(1236),x=_(5892),w=_(1128),g=_(3616),T=_(8824),E=_(8256),l=_(8304),M=_(7556),D=_(580),L=_(2516),J=_(6096),j=_(6052),Z=_(9604),B=_(8048),q=_(7936),F=_(4336),C=_(6732),$=_(1040);function f(n,a){1&n&&(t.SAx(0),t.aS0(1,10),t.k70())}function P(n,a){if(1&n&&(t.SAx(0),t.OEk(1),t.k70()),2&n){const e=a.polymorpheusOutlet;t.yG2(),t.oRS(" ",e," ")}}function v(n,a){if(1&n&&t.yuY(0,P,2,1,"ng-container",11),2&n){const e=t.GaO(2);t.E7m("polymorpheusOutlet",e.optionTemplate$())}}function U(n,a){1&n&&t.C_f(0)}const K=(n,a)=>({$implicit:n,injector:a});function Et(n,a){if(1&n&&t.yuY(0,U,1,0,"ng-container",12),2&n){const e=t.GaO().$implicit,o=t.GaO();t.E7m("polymorpheusOutlet",o.optionTemplate$())("polymorpheusOutletContext",t.IBC(2,K,e,o.injector))}}function dt(n,a){1&n&&t.C_f(0)}const ot=n=>({data:n});function Tt(n,a){if(1&n&&t.yuY(0,dt,1,0,"ng-container",12),2&n){const e=t.GaO().$implicit,o=t.GaO();t.E7m("polymorpheusOutlet",o.optionTemplate$())("polymorpheusOutletContext",t.S45(2,ot,e))}}function Ct(n,a){if(1&n&&t.wR5(0,"div",13),2&n){const e=t.GaO().$implicit,o=t.GaO();t.E7m("innerText",o.stringify(e))}}function St(n,a){if(1&n&&t.yuY(0,v,1,1)(1,Et,1,5)(2,Tt,1,4)(3,Ct,1,1),2&n){const e=t.GaO();let o;t.C0Y(0,"text"===(o=e.optionTemplateType$())?0:"template"===o?1:"component"===o?2:3)}}function Rt(n,a){if(1&n&&(t.SAx(0),t.OEk(1),t.k70()),2&n){const e=a.polymorpheusOutlet;t.yG2(),t.oRS(" ",e," ")}}function gt(n,a){if(1&n&&t.yuY(0,Rt,2,1,"ng-container",11),2&n){const e=t.GaO(2);t.E7m("polymorpheusOutlet",e.nativeOptionTemplate$())}}function Ot(n,a){1&n&&t.C_f(0)}function ft(n,a){if(1&n&&t.yuY(0,Ot,1,0,"ng-container",12),2&n){const e=t.GaO().$implicit,o=t.GaO();t.E7m("polymorpheusOutlet",o.nativeOptionTemplate$())("polymorpheusOutletContext",t.IBC(2,K,e,o.injector))}}function Nt(n,a){1&n&&t.C_f(0)}function Mt(n,a){if(1&n&&t.yuY(0,Nt,1,0,"ng-container",12),2&n){const e=t.GaO().$implicit,o=t.GaO();t.E7m("polymorpheusOutlet",o.nativeOptionTemplate$())("polymorpheusOutletContext",t.S45(2,ot,e))}}function ht(n,a){if(1&n&&t.wR5(0,"div",13),2&n){const e=t.GaO().$implicit,o=t.GaO();t.E7m("innerText",o.stringify(e))}}function It(n,a){if(1&n&&t.yuY(0,gt,1,1)(1,ft,1,5)(2,Mt,1,4)(3,ht,1,1),2&n){const e=t.GaO();let o;t.C0Y(0,"text"===(o=e.nativeOptionTemplateType$())?0:"template"===o?1:"component"===o?2:3)}}function At(n,a){if(1&n&&(t.SAx(0),t.OEk(1),t.k70()),2&n){const e=t.GaO(2);t.yG2(),t.oRS(" ",e.placeholder," ")}}function yt(n,a){if(1&n&&(t.I0R(0,"span",null,14),t._Xx(2),t.C$Y(),t.yuY(3,At,2,1,"ng-container",15)),2&n){const e=t.Gew(1);t.yG2(3),t.E7m("ngIf",!e.hasChildNodes())}}function vt(n,a){1&n&&(t.SAx(0),t.aS0(1,19),t.k70())}function Pt(n,a){if(1&n&&(t.I0R(0,"span"),t.OEk(1),t.C$Y()),2&n){const e=t.GaO(2);t.yG2(),t.cNF(e.emptyContentString())}}function $t(n,a){1&n&&t.C_f(0)}function xt(n,a){if(1&n&&(t.SAx(0),t.yuY(1,$t,1,0,"ng-container",8),t.k70()),2&n){const e=t.GaO(4);t.yG2(),t.E7m("ngTemplateOutlet",e.emptyContentTemplate())}}function Gt(n,a){if(1&n&&(t.SAx(0),t.yuY(1,xt,2,1,"ng-container",20),t.k70()),2&n){t.GaO(2);const e=t.Gew(6),o=t.GaO();t.yG2(),t.E7m("ngIf",o.emptyContentTemplate())("ngIfElse",e)}}function Dt(n,a){if(1&n&&(t.SAx(0),t.yuY(1,Gt,2,2,"ng-container",20),t.k70()),2&n){t.GaO();const e=t.Gew(4),o=t.GaO();t.yG2(),t.E7m("ngIf",o.emptyContent$())("ngIfElse",e)}}function Lt(n,a){if(1&n&&(t.I0R(0,"span",null,16),t._Xx(2,1),t.C$Y(),t.yuY(3,vt,2,0,"ng-template",null,17,t.gJz)(5,Pt,2,1,"ng-template",null,18,t.gJz)(7,Dt,2,2,"ng-container",15)),2&n){const e=t.Gew(1);t.yG2(7),t.E7m("ngIf",!e.hasChildNodes())}}function Yt(n,a){1&n&&t.wR5(0,"tui-loader")}function Vt(n,a){1&n&&t.C_f(0)}function bt(n,a){if(1&n&&t.yuY(0,Vt,1,0,"ng-container",8),2&n){t.GaO(2);const e=t.Gew(9);t.E7m("ngTemplateOutlet",e)}}function kt(n,a){1&n&&t.C_f(0)}function wt(n,a){if(1&n&&(t.SAx(0),t.yuY(1,kt,1,0,"ng-container",8),t.k70()),2&n){t.GaO(2);const e=t.Gew(11);t.yG2(),t.E7m("ngTemplateOutlet",e)}}function zt(n,a){if(1&n&&t.yuY(0,bt,1,1,"ng-template",null,21,t.gJz)(2,wt,2,1,"ng-container",20),2&n){const e=t.Gew(1),o=t.GaO();t.yG2(2),t.E7m("ngIf",o.loading())("ngIfElse",e)}}function Ft(n,a){1&n&&t.C_f(0)}function Ut(n,a){1&n&&t.C_f(0)}function Ht(n,a){1&n&&t.C_f(0)}function Xt(n,a){if(1&n&&(t.SAx(0),t.yuY(1,Ht,1,0,"ng-container",8),t.k70()),2&n){t.GaO(4);const e=t.Gew(11);t.yG2(),t.E7m("ngTemplateOutlet",e)}}function Bt(n,a){1&n&&t.C_f(0)}function Kt(n,a){if(1&n){const e=t.KQA();t.I0R(0,"button",28)(1,"span",29),t.qCj("click",function(){t.usT(e);const i=t.GaO(4);return t.CGJ(i.loadMoreItems())}),t.yuY(2,Bt,1,0,"ng-container",20),t.C$Y()()}if(2&n){const e=t.GaO(4),o=t.Gew(1);t.E7m("size",e.optionSize)("disabled",!0),t.yG2(2),t.E7m("ngIf",e.loadMore)("ngIfElse",o)}}function Jt(n,a){if(1&n&&(t.SAx(0),t.yuY(1,Xt,2,1,"ng-container",15)(2,Kt,3,4,"button",27),t.k70()),2&n){const e=t.GaO(3);t.yG2(),t.E7m("ngIf",e.loading),t.yG2(),t.E7m("ngIf",!e.loading)}}const Wt=n=>({$implicit:n});function Qt(n,a){if(1&n){const e=t.KQA();t.SAx(0),t.I0R(1,"button",25),t.qCj("mouseenter",function(){const i=t.usT(e),r=i.index,h=i.last,y=t.GaO(2);return t.CGJ(y.optionMouseEnter(r,h))})("focus",function(){const i=t.usT(e),r=i.index,h=i.last,y=t.GaO(2);return t.CGJ(y.optionFocus(r,h))}),t.yuY(2,Ut,1,0,"ng-container",26),t.C$Y(),t.yuY(3,Jt,3,2,"ng-container",15),t.k70()}if(2&n){const e=a.$implicit,o=a.last,i=t.GaO(2),r=t.Gew(5);t.yG2(),t.E7m("size",i.optionSize)("value",e)("disabled",i.disabledItemHandler(e)),t.yG2(),t.E7m("ngTemplateOutlet",r)("ngTemplateOutletContext",t.S45(6,Wt,e)),t.yG2(),t.E7m("ngIf",o&&i.thereAreMoreItems)}}function jt(n,a){if(1&n){const e=t.KQA();t.I0R(0,"span",33),t.qCj("click",function(){t.usT(e);const i=t.GaO(3);return t.CGJ(i.createNew.emit())}),t.I0R(1,"mat-icon"),t.OEk(2,"add"),t.C$Y(),t.I0R(3,"span"),t.aS0(4,34),t.C$Y()()}}function Zt(n,a){if(1&n&&(t.I0R(0,"button",30)(1,"span",null,31),t._Xx(3,2),t.C$Y(),t.yuY(4,jt,5,0,"span",32),t.C$Y()),2&n){const e=t.Gew(2),o=t.GaO(2);t.E7m("size",o.optionSize)("value",null)("disabled",!0),t.yG2(4),t.E7m("ngIf",!e.hasChildNodes())}}function qt(n,a){if(1&n&&(t.I0R(0,"tui-data-list",22),t.yuY(1,Qt,4,8,"ng-container",23)(2,Zt,5,4,"button",24),t.C$Y()),2&n){const e=t.GaO(),o=t.Gew(13);t.E7m("emptyContent",o),t.yG2(),t.E7m("ngForOf",e.items()),t.yG2(),t.E7m("ngIf",e.showCreateNew)}}const te=["*",[["","empty-content",""]],[["","create-new",""]]],ee=["*","[empty-content]","[create-new]"];let it=(()=>{class n extends D.m{constructor(){super(),this.weekday=(0,t.uUt)(L.G),this.stringify=e=>`${e.name} (${e.starts_at} - ${e.ends_at}, ${this.weekday.transform(e.weekday)})`,this.service=(0,t.uUt)(M.K)}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.In1({type:n,selectors:[["app-reservation-turn-select"]],inputs:{outputType:"outputType",multiple:"multiple",service:"service",stringify:"stringify",query:"query",autofocus:"autofocus",placeholder:"placeholder",optionTemplate:"optionTemplate",stringifyOption:"stringifyOption",inputSize:"inputSize",page:"page",per_page:"per_page",optionSize:"optionSize",disabledItemHandler:"disabledItemHandler",loadMoreOnLastItem:"loadMoreOnLastItem",emptyContent:"emptyContent",showCreateNew:"showCreateNew",nativeOptionTemplate:"nativeOptionTemplate",filters:"filters",showCleaner:"showCleaner"},outputs:{httpError:"httpError",pageChange:"pageChange",queryChange:"queryChange",per_pageChange:"per_pageChange",createNew:"createNew"},standalone:!0,features:[t.M5G([{provide:u.Y6,useExisting:(0,t.wd)(()=>n),multi:!0},m.UF,L.G]),t.eg9,t.UHJ],ngContentSelectors:ee,decls:17,vars:6,consts:()=>{let e,o,i;return e="Carica altri",o="Non abbiamo trovato nulla.",i="Crea nuovo",[["loadMoreDefault",""],["valueContent",""],["nativeOptionTemplate",""],["placeholderTemplate",""],["nativeEmptyContentTemplate",""],["loadingTemplate",""],["loadingOrEmptyContent",""],[3,"tuiTextfieldCleaner","stringify","tuiTextfieldSize","formControl","valueContent","searchChange"],[4,"ngTemplateOutlet"],[3,"emptyContent",4,"tuiDataList"],e,[4,"polymorpheusOutlet"],[4,"polymorpheusOutlet","polymorpheusOutletContext"],[3,"innerText"],["customContent",""],[4,"ngIf"],["customEmptyContent",""],["defaultEmptyContent",""],["emptyContentCustomString",""],o,[4,"ngIf","ngIfElse"],["empty",""],[3,"emptyContent"],[4,"ngFor","ngForOf"],["tuiOption","",3,"size","value","disabled",4,"ngIf"],["tuiOption","",3,"size","value","disabled","mouseenter","focus"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["tuiOption","",3,"size","disabled",4,"ngIf"],["tuiOption","",3,"size","disabled"],["role","button",3,"click"],["tuiOption","",3,"size","value","disabled"],["createNewCustomTemplate",""],["role","button","class","d-flex align-items-center",3,"click",4,"ngIf"],["role","button",1,"d-flex","align-items-center",3,"click"],i]},template:function(o,i){if(1&o&&(t.kPM(te),t.yuY(0,f,2,0,"ng-template",null,0,t.gJz)(2,St,4,1,"ng-template",null,1,t.gJz)(4,It,4,1,"ng-template",null,2,t.gJz)(6,yt,4,1,"ng-template",null,3,t.gJz)(8,Lt,8,1,"ng-template",null,4,t.gJz)(10,Yt,1,0,"ng-template",null,5,t.gJz)(12,zt,3,2,"ng-template",null,6,t.gJz),t.I0R(14,"tui-combo-box",7),t.qCj("searchChange",function(h){return i.onSearchChange(h)}),t.yuY(15,Ft,1,0,"ng-container",8)(16,qt,3,3,"tui-data-list",9),t.C$Y()),2&o){const r=t.Gew(3),h=t.Gew(7);t.yG2(14),t.E7m("tuiTextfieldCleaner",i.showCleaner)("stringify",i.stringify)("tuiTextfieldSize",i.inputSize)("formControl",i.control)("valueContent",r),t.yG2(),t.E7m("ngTemplateOutlet",h)}},dependencies:[p.MD,p.ay,p.u_,p.XV,J.uk,J.i_,J.qI,B.aS,B.es,B.rD,q.KA,O.CQ,F.A$,F.yi,F.sP,F.Ux,j.q8,u.sl,u.ue,u.ug,C.kR,Z.CA,G.Sk,G.Cb,$.Ux,$.Af,R.oB,R.qL],changeDetection:0})}return n})();var tt=_(8016),W=_(466),I=_(400),ne=_(3264),et=_(3984),at=_(1338),oe=_(9160);let ie=(()=>{class n{constructor(){this.datePipe=(0,t.uUt)(p.y),this.today=I.EK.currentLocal(),this.singleDateFormat={default:"cccc d MMMM",differentYear:"d MMMM y"}}transform(e){if(!(e instanceof I.Se))return"";const o=e.from.year==e.to.year&&e.from.year==this.today.year?this.singleDateFormat.default:this.singleDateFormat.differentYear;return e.isSingleDay?e.from.daySame(this.today)?"Oggi":this.datePipe.transform(e.from.toUtcNativeDate(),o)||"":e.from.month==e.to.month?1==e.from.day&&e.to.daySame(e.from.append({month:1}).append({day:-1}))?this.datePipe.transform(e.from.toUtcNativeDate(),"MMMM y")||"":`${e.from.day} - ${e.to.day} ${this.datePipe.transform(e.to.toUtcNativeDate(),"MMMM")||""}`:`${this.datePipe.transform(e.from.toLocalNativeDate(),o)||""} - ${this.datePipe.transform(e.to.toLocalNativeDate(),o)||""}`}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275pipe=t.UTH({name:"stringifyTuiDayRange",type:n,pure:!0,standalone:!0})}return n})();function ae(n,a){if(1&n&&(t.I0R(0,"span",9),t.aS0(1,10),t.C$Y(),t.I0R(2,"span",9),t.OEk(3),t.wVc(4,"date"),t.wVc(5,"fromTuiDay"),t.C$Y(),t.I0R(6,"span",9),t.aS0(7,11),t.C$Y(),t.I0R(8,"span",9),t.OEk(9),t.wVc(10,"date"),t.wVc(11,"fromTuiDay"),t.C$Y()),2&n){const e=t.GaO(2);t.yG2(3),t.cNF(t.g7$(4,2,t.kDX(5,5,e.control.value.from),"fullDate")),t.yG2(6),t.cNF(t.g7$(10,7,t.kDX(11,10,e.control.value.to),"fullDate"))}}function _e(n,a){if(1&n&&t.yuY(0,ae,12,12),2&n){const e=t.GaO();t.C0Y(0,e.control.value&&e.control.value.from&&e.control.value.to?0:-1)}}function se(n,a){if(1&n&&(t.I0R(0,"p",14)(1,"span",6),t.OEk(2),t.wVc(3,"stringifyTuiDayRange"),t.C$Y()()),2&n){const e=t.GaO(2),o=t.Gew(1);t.yG2(),t.E7m("tuiHint",o),t.yG2(),t.cNF(t.kDX(3,2,e.control.value))}}function re(n,a){1&n&&(t.I0R(0,"p",15),t.SAx(1),t.aS0(2,16),t.k70(),t.C$Y())}function le(n,a){if(1&n){const e=t.KQA();t.I0R(0,"tui-calendar-range",12),t.qCj("valueChange",function(i){t.usT(e);const r=t.GaO();return t.CGJ(r.selectRange(i))}),t.C$Y(),t.yuY(1,se,4,4,"p",13)(2,re,3,0)}if(2&n){const e=t.GaO();t.E7m("items",e.periodOptions)("value",e.control.value),t.yG2(),t.C0Y(1,e.control.value&&e.control.valid?1:2)}}function ce(n,a){if(1&n&&(t.I0R(0,"span",6),t.OEk(1),t.wVc(2,"stringifyTuiDayRange"),t.C$Y()),2&n){const e=t.GaO(),o=t.Gew(1);t.E7m("tuiHint",o),t.yG2(),t.cNF(t.kDX(2,2,e.control.value))}}function ue(n,a){1&n&&t._Xx(0)}const pe=["*"];let me=(()=>{class n{constructor(){this.cd=(0,t.uUt)(t.kD9),this.dialogs=(0,t.uUt)(tt._k),this.destroy$=(0,t.uUt)(m.UF),this.date=(0,t.uUt)(p.y),this.today=I.EK.currentLocal(),this.control=new u.Ku(new I.Se(this.today,this.today)),this.periodOptions=[new et.Ib(new I.Se(this.today,this.today),"Oggi"),new et.Ib(new I.Se(this.today.append({day:-7}),this.today),"Ultima settimana"),...Array.from({length:3},(e,o)=>o).map(e=>{const o=this.today.append({month:-1*e}),i=new I.EK(o.year,o.month,1),r=this.date.transform(i.toUtcNativeDate(),"MMMM")||`Mese ${i.month}`;return new et.Ib(new I.Se(i,i.append({month:1}).append({day:-1})),r)})]}ngOnInit(){}registerOnChange(e){this.control.valueChanges.pipe((0,g.a)(this.destroy$)).subscribe(e)}registerOnTouched(e){this.control.valueChanges.pipe((0,g.a)(this.destroy$)).subscribe(e)}setDisabledState(e){e?this.control.disable():this.control.enable()}writeValue(e){this.control.patchValue(this.formatToTuiDayRange(e))}fireModal(e){this.modalSub=this.dialogs.open(e).subscribe()}selectRange(e){this.control.setValue(e),this.modalSub?.unsubscribe(),this.cd.markForCheck()}prevDay(){if(!(this.control.value instanceof I.Se))return void console.warn("control value invalid",this.control.value);const e=this.control.value.from.append({day:-1}),o=this.control.value.to.append({day:-1});this.control.setValue(new I.Se(e,o))}nextDay(){if(!(this.control.value instanceof I.Se))return void console.warn("control value invalid",this.control.value);const e=this.control.value.from.append({day:1}),o=this.control.value.to.append({day:1});this.control.setValue(new I.Se(e,o))}formatToTuiDayRange(e){if(null==e)return null;if(e instanceof I.Se)return e;if(e instanceof Date)return new I.Se(I.EK.fromLocalNativeDate(e),I.EK.fromLocalNativeDate(e));if("string"==typeof e)return new I.Se(I.EK.fromLocalNativeDate(new Date(e)),I.EK.fromLocalNativeDate(new Date(e)));if(Array.isArray(e)&&2==e.length){if(e[0]instanceof Date&&e[1]instanceof Date)return new I.Se(I.EK.fromLocalNativeDate(e[0]),I.EK.fromLocalNativeDate(e[1]));if(e[0]instanceof I.EK&&e[1]instanceof I.EK)return new I.Se(e[0],e[1]);if("string"==typeof e[0]&&"string"==typeof e[1])return new I.Se(I.EK.fromLocalNativeDate(new Date(e[0])),I.EK.fromLocalNativeDate(new Date(e[1])))}return console.warn("Invalid value for reservation date select:",e),null}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.In1({type:n,selectors:[["app-reservation-date-select"]],standalone:!0,features:[t.M5G([{provide:u.Y6,useExisting:(0,t.wd)(()=>n),multi:!0},m.UF]),t.UHJ],ngContentSelectors:pe,decls:18,vars:1,consts:()=>{let e,o,i;return e="Dal giorno",o="fino al giorno",i="Nessuna data selezionata.",[["rangeHint",""],["editDateModal",""],[1,"flex","border","rounded","border-slate-200","items-center","justify-between"],[1,"h-full","border-r","border-slate-200"],["type","button",1,"h-full","flex","items-center","justify-center","p-2",3,"click"],["type","button",1,"flex","items-center","justify-center","grow",3,"click"],[3,"tuiHint"],[1,"ms-1"],[1,"h-full","border-l","border-slate-200"],[1,"me-1"],e,o,[3,"items","value","valueChange"],["class","text-slate-400 block mb-3"],[1,"text-slate-400","block","mb-3"],[1,"block","text-red-200"],i]},template:function(o,i){if(1&o){const r=t.KQA();t.kPM(),t.yuY(0,_e,1,1,"ng-template",null,0,t.gJz)(2,le,3,3,"ng-template",null,1,t.gJz),t.I0R(4,"div",2)(5,"div",3)(6,"button",4),t.qCj("click",function(){return i.prevDay()}),t.I0R(7,"mat-icon"),t.OEk(8,"arrow_back"),t.C$Y()()(),t.I0R(9,"button",5),t.qCj("click",function(){t.usT(r);const y=t.Gew(3);return t.CGJ(i.fireModal(y))}),t.yuY(10,ce,3,4,"span",6)(11,ue,1,0),t.I0R(12,"mat-icon",7),t.OEk(13,"event"),t.C$Y()(),t.I0R(14,"div",8)(15,"button",4),t.qCj("click",function(){return i.nextDay()}),t.I0R(16,"mat-icon"),t.OEk(17,"arrow_forward"),t.C$Y()()()()}2&o&&(t.yG2(10),t.C0Y(10,i.control.valid&&i.control.value?10:11))},dependencies:[R.qL,u.sl,p.y,oe.E,at.N,at.W,ie,N.WY,N.lh,N.SL,N.i6,N.IT],styles:["[_nghost-%COMP%]{display:block;min-width:250px}"],changeDetection:0})}return n})();var Ee=_(5136),_t=_(4e3),st=_(6684),de=_(2300),rt=_(9772),lt=_(9368);const Te=["*"];let Ce=(()=>{class n{constructor(){this.removeClick=new t._w7}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.In1({type:n,selectors:[["app-chip"]],outputs:{removeClick:"removeClick"},standalone:!0,features:[t.UHJ],ngContentSelectors:Te,decls:6,vars:0,consts:[[1,"rounded","border","py-2","px-3","border-slate-200","flex","items-center"],["size","s","tuiIconButton","","type","button","appearance","custom",1,"!flex","ms-1",3,"click"]],template:function(o,i){1&o&&(t.kPM(),t.I0R(0,"div",0)(1,"span"),t._Xx(2),t.C$Y(),t.I0R(3,"button",1),t.qCj("click",function(){return i.removeClick.emit()}),t.I0R(4,"mat-icon"),t.OEk(5,"close"),t.C$Y()()())},dependencies:[R.oB,R.qL],styles:["[_nghost-%COMP%]{display:inline-block}"]})}return n})();function Se(n,a){if(1&n){const e=t.KQA();t.I0R(0,"form",16),t.qCj("ngSubmit",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.closeFiltersModal())}),t.I0R(1,"div",17)(2,"div",14)(3,"tui-input",18),t.SAx(4),t.aS0(5,19),t.k70(),t.wR5(6,"input",20),t.C$Y()()(),t.I0R(7,"div",17)(8,"app-reservation-status-select",21),t.SAx(9),t.aS0(10,22),t.k70(),t.C$Y()(),t.I0R(11,"button",23),t.SAx(12),t.aS0(13,24),t.k70(),t.C$Y()()}if(2&n){const e=t.GaO();t.E7m("formGroup",e.hiddenFormGroup),t.yG2(3),t.E7m("tuiTextfieldSize","l")("tuiAutoFocus",!0)("formControl",e.query),t.yG2(5),t.E7m("showCleaner",!0)("inputSize","l")("formControl",e.status)}}function Re(n,a){if(1&n){const e=t.KQA();t.I0R(0,"app-chip",25),t.qCj("removeClick",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.status.patchValue(null))}),t.SAx(1),t.aS0(2,26),t.k70(),t.OEk(3,": "),t.wR5(4,"app-reservation-status",27),t.C$Y()}if(2&n){const e=t.GaO();t.yG2(4),t.E7m("status",e.status.value)}}function ge(n,a){if(1&n){const e=t.KQA();t.I0R(0,"app-chip",25),t.qCj("removeClick",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.query.patchValue(null))}),t.SAx(1),t.aS0(2,28),t.k70(),t.OEk(3),t.C$Y()}if(2&n){const e=t.GaO();t.yG2(3),t.oRS(": ",e.query.value," ")}}const Oe=n=>({date:n}),fe=()=>[10,100,1e3],Ne=["*"];let Me=(()=>{class n{constructor(){this.dialogs=(0,t.uUt)(tt._k),this.loading=!1,this.data=null,this.filtersChanged=new t._w7,this.destroy$=(0,t.uUt)(m.UF),this.datePipe=(0,t.uUt)(p.y),this.query=new u.Ku(null),this.turn=new u.Ku(null),this.date=new u.Ku(new I.Se(I.EK.currentLocal(),I.EK.currentLocal())),this.status=new u.Ku("active"),this.hiddenFormGroup=new u.WC({query:this.query,status:this.status}),this.dateStr=(0,t.OCB)(this.formatDate(this.date.value)),this.offset=0,this.per_page=100,this.lastFilters={}}ngOnInit(){this.date.valueChanges.pipe((0,g.a)(this.destroy$)).subscribe({next:e=>{this.turn.setValue(null),e&&e.isSingleDay?this.turn.disabled&&this.turn.enable():this.turn.disable(),this.dateStr.set(this.formatDate(e))},error:e=>console.error(e)}),[this.date,this.turn,this.status].map(e=>{e.valueChanges.pipe((0,g.a)(this.destroy$),(0,_t.a)(),(0,st.I)(()=>e.valid)).subscribe({next:()=>{this.offset=0,this.filtersMayHaveChanged()}})}),[this.query].map(e=>{e.valueChanges.pipe((0,g.a)(this.destroy$),(0,_t.a)(),(0,de.o)(500),(0,st.I)(()=>e.valid)).subscribe({next:()=>{this.offset=0,this.filtersMayHaveChanged()}})})}ngAfterViewInit(){this.emitCurrentFilters()}submit(){this.emitCurrentFilters()}mergeFilters(e){}setFilters(e){}currentFilters(){const e={offset:this.offset,per_page:this.per_page};if("string"==typeof this.query.value&&this.query.valid&&this.query.value.length>0&&(e.query=this.query.value),this.date.value instanceof I.Se&&this.date.valid){const i=this.datePipe.transform(this.date.value.from.toUtcNativeDate(),"YYYY-MM-dd"),r=this.datePipe.transform(this.date.value.to.toUtcNativeDate(),"YYYY-MM-dd");i&&r&&(e.date_from=`${i}`,e.date_to=`${r}`)}const o=this.turn.value;return this.turn.valid&&o instanceof Ee.e&&o.starts_at&&o.ends_at&&(e.time_from=`${(0,rt.ye)(o.starts_at)}`,e.time_to=`${(0,rt.ye)(o.ends_at)}`),"string"==typeof this.status.value&&this.status.valid&&(e.status=this.status.value),e}paginationChange(e){this.offset=e.page,this.per_page=e.size,this.filtersMayHaveChanged()}fireModal(e){this.filtersSub?.unsubscribe(),this.filtersSub=this.dialogs.open(e).subscribe()}closeFiltersModal(){this.filtersSub?.unsubscribe()}filtersMayHaveChanged(){const e=this.currentFilters(),o=JSON.stringify(e)!==JSON.stringify(this.lastFilters);return console.log("changed",{changed:o,currentFilters:e}),o&&(this.lastFilters=e,this.emitCurrentFilters()),o}formatDate(e){return e instanceof Date?this.datePipe.transform(e,"YYYY-MM-dd"):e instanceof I.Se?e.isSingleDay?this.datePipe.transform(e.from.toUtcNativeDate(),"YYYY-MM-dd"):`${this.datePipe.transform(e.from.toUtcNativeDate(),"YYYY-MM-dd")} - ${this.datePipe.transform(e.to.toUtcNativeDate(),"YYYY-MM-dd")}`:null}emitCurrentFilters(){this.filtersChanged.emit(this.currentFilters())}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.In1({type:n,selectors:[["app-list-reservations-filters"]],inputs:{loading:"loading",data:"data"},outputs:{filtersChanged:"filtersChanged"},standalone:!0,features:[t.M5G([m.UF]),t.UHJ],ngContentSelectors:Ne,decls:27,vars:14,consts:()=>{let e,o,i,r,h,y,H,X;return e="Data",o="Turno",i="Esporta prenotazioni",r="Filtra prenotazioni",h="Stato",y="Chiudi",H="Stato",X="Ricerca per",[["additionalFiltersTemplate",""],[1,"flex","flex-wrap","items-center"],[1,"col-12","md:col-6"],[3,"formControl"],e,[1,"col-11","md:col-5","px-1"],[1,"mx-2",2,"min-width","150px",3,"showCleaner","filters","inputSize","formControl"],o,[1,"col-1"],["type","button","tuiIconButton","","appearance","flat",3,"showLoader","click"],[1,"col-12"],[1,"my-2",3,"size","items","total","paginationChange"],[1,"flex","items-center","mb-2"],["routerLink","export","tuiLink",""],[1,"flex","items-center"],i,[3,"formGroup","ngSubmit"],[1,"block","mb-3"],[1,"grow","me-2",3,"tuiTextfieldSize","tuiAutoFocus","formControl"],r,["tuiTextfield",""],[3,"showCleaner","inputSize","formControl"],h,["tuiButton","","appearance","primary","type","submit"],y,[3,"removeClick"],H,[3,"status"],X]},template:function(o,i){if(1&o){const r=t.KQA();t.kPM(),t.yuY(0,Se,14,7,"ng-template",null,0,t.gJz),t.I0R(2,"div",1)(3,"div",2)(4,"app-reservation-date-select",3),t.SAx(5),t.aS0(6,4),t.k70(),t.C$Y()(),t.I0R(7,"div",5)(8,"app-reservation-turn-select",6),t.SAx(9),t.aS0(10,7),t.k70(),t.C$Y()(),t.I0R(11,"div",8)(12,"button",9),t.qCj("click",function(){t.usT(r);const y=t.Gew(1);return t.CGJ(i.fireModal(y))}),t.I0R(13,"mat-icon"),t.OEk(14,"filter_alt"),t.C$Y()()(),t.I0R(15,"div",10),t.yuY(16,Re,5,1,"app-chip")(17,ge,4,1,"app-chip"),t.C$Y()(),t._Xx(18),t.I0R(19,"tui-table-pagination",11),t.qCj("paginationChange",function(y){return i.paginationChange(y)}),t.C$Y(),t.I0R(20,"div",12)(21,"a",13)(22,"span",14)(23,"mat-icon"),t.OEk(24,"download_file"),t.C$Y(),t.SAx(25),t.aS0(26,15),t.k70(),t.C$Y()()()}if(2&o){let r;t.yG2(4),t.E7m("formControl",i.date),t.yG2(4),t.E7m("showCleaner",!0)("filters",t.S45(11,Oe,i.dateStr()))("inputSize","m")("formControl",i.turn),t.yG2(4),t.E7m("showLoader",i.loading),t.yG2(4),t.C0Y(16,i.status.value?16:-1),t.yG2(),t.C0Y(17,i.query.value?17:-1),t.yG2(2),t.E7m("size",100)("items",t.q4q(13,fe))("total",null!==(r=null==i.data||null==i.data.metadata?null:i.data.metadata.total_count)&&void 0!==r?r:0)}},dependencies:[S.CI,S.Kw,R.qL,O.CQ,O.Oo,O.cP,q.b,c.m6,c.gJ,s.w,s.C,d.ER,ne.Y,it,me,x.yy,x.Ws,u.sl,u.sz,u.ue,u.u,u.ug,u.uW,W.GE,B.aS,B.rD,lt.a,Ce],encapsulation:2,changeDetection:0})}return n})(),he=(()=>{class n{constructor(){this.human={email_open:"Email aperta"}}transform(e){return null==e?null:this.human[e]??null}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275pipe=t.UTH({name:"humanizeEventType",type:n,pure:!0,standalone:!0})}return n})();function Ie(n,a){1&n&&(t.SAx(0),t.aS0(1,3),t.k70())}const Ae=(n,a)=>({"text-blue-500":n,"text-slate-500":a}),ye=n=>({rotate180:n});function ve(n,a){if(1&n&&(t.I0R(0,"tui-hosted-dropdown",1,4)(2,"button",5)(3,"span",6)(4,"span",7),t.OEk(5),t.C$Y(),t.I0R(6,"mat-icon",8),t.OEk(7,"mail"),t.C$Y(),t.I0R(8,"mat-icon",9),t.OEk(9,"expand_more"),t.C$Y()()()()),2&n){const e=t.Gew(1),o=t.GaO(),i=t.Gew(4);t.E7m("content",i),t.yG2(5),t.cNF(o.emails().length),t.yG2(),t.E7m("ngClass",t.IBC(4,Ae,o.emailOpenAtLeastOnce(),!o.emailOpenAtLeastOnce())),t.yG2(2),t.E7m("ngClass",t.S45(7,ye,e.open))}}const nt=(n,a)=>a.id;function Pe(n,a){if(1&n&&(t.I0R(0,"span",19),t.OEk(1),t.wVc(2,"json"),t.C$Y()),2&n){const e=t.GaO().$implicit;t.yG2(),t.cNF(t.kDX(2,1,e.event_data))}}function $e(n,a){if(1&n&&(t.I0R(0,"li")(1,"span",6)(2,"span",7),t.OEk(3),t.wVc(4,"humanizeEventType"),t.C$Y(),t.I0R(5,"span",7),t.OEk(6),t.wVc(7,"date"),t.C$Y(),t.yuY(8,Pe,3,3,"span",18),t.C$Y()()),2&n){const e=a.$implicit,o=t.GaO().$implicit;t.yG2(3),t.cNF(t.kDX(4,3,o.event_type)),t.yG2(3),t.cNF(t.g7$(7,5,e.event_time,"EEEE d MMMM y, H:m")),t.yG2(2),t.C0Y(8,e.event_data?8:-1)}}function xe(n,a){1&n&&t.c53(0,$e,9,8,"li",null,nt),2&n&&t.oho(a.$implicit.events)}function Ge(n,a){if(1&n&&(t.I0R(0,"div",14)(1,"div",15)(2,"span",16),t.OEk(3),t.C$Y(),t.I0R(4,"b",7),t.aS0(5,17),t.C$Y(),t.I0R(6,"span"),t.OEk(7),t.wVc(8,"date"),t.C$Y()()(),t.I0R(9,"ul"),t.c53(10,xe,2,0,null,null,nt),t.C$Y()),2&n){const e=a.$implicit;t.yG2(3),t.oRS("#",e.id,""),t.yG2(4),t.cNF(t.g7$(8,2,e.created_at,"EEEE d MMMM y, H:m")),t.yG2(3),t.oho(e.image_pixels)}}function De(n,a){1&n&&(t.SAx(0),t.aS0(1,20),t.k70())}function Le(n,a){1&n&&(t.SAx(0),t.aS0(1,21),t.k70())}function Ye(n,a){if(1&n){const e=t.KQA();t.I0R(0,"div",11),t.c53(1,Ge,12,5,null,null,nt),t.I0R(3,"button",12),t.qCj("click",function(){t.usT(e);const i=t.GaO(2);return t.CGJ(i.resendEmail())}),t.I0R(4,"span",6)(5,"span",13),t.yuY(6,De,2,0,"ng-container")(7,Le,2,0),t.C$Y(),t.I0R(8,"mat-icon"),t.OEk(9,"send"),t.C$Y()()()()}if(2&n){const e=t.GaO(2);t.yG2(),t.oho(e.emails()),t.yG2(2),t.E7m("showLoader",e.loading())("appearance","outline")("disabled",!(e.reservation.email&&e.reservation.email.length>0)),t.yG2(3),t.C0Y(6,e.emails().length>0?6:7)}}function Ve(n,a){if(1&n&&t.yuY(0,Ye,10,4,"div",10),2&n){const e=t.GaO();t.C0Y(0,e.reservation?0:-1)}}let be=(()=>{class n{constructor(){this.service=(0,t.uUt)(l.S),this.notifications=(0,t.uUt)(w.E),this.destroy$=(0,t.uUt)(m.UF),this.emails=(0,t.OCB)([]),this.loading=(0,t.OCB)(!1),this.emailOpenAtLeastOnce=(0,t.S6b)(()=>{const e=this.emails();let o=!1;return e.forEach(i=>{i.image_pixels?.forEach(r=>{"email_open"===r.event_type&&r.events&&r.events.length>0&&(o=!0)})}),o})}resendEmail(){const e=this.reservation?.id;e&&(this.loading.set(!0),this.service.deliverConfirmationEmail(e).pipe((0,g.a)(this.destroy$),(0,T.U)(()=>this.loading.set(!1))).subscribe({next:o=>{this.notifications.fireSnackBar("Email inviata"),this.setEmailsByReservation(o)},error:o=>{this.notifications.error((0,E.mk)(o)??"Qualcosa \xE8 andato storto. Riprova pi\xF9 tardi.")}}))}ngOnChanges(e){e.reservation&&this.setEmailsByReservation(e.reservation.currentValue)}setEmailsByReservation(e){this.emails.set(e?.delivered_emails??[])}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.In1({type:n,selectors:[["app-reservation-events"]],inputs:{reservation:"reservation"},standalone:!0,features:[t.SYr,t.UHJ],decls:5,vars:1,consts:()=>{let e,o,i,r;return e="Invia conferma prenotazione",o="Email inviata",i="Rimanda email di conferma",r="Invia email di conferma",[["resendHint",""],[3,"content"],["allEvents",""],e,["dropdown",""],["tuiButton","","appearance","custom","size","s","type","button"],[1,"flex","items-center"],[1,"me-1"],[1,"text-slate-500",3,"ngClass"],[1,"text-slate-500","animation-speed-2",3,"ngClass"],["class","p-3"],[1,"p-3"],["type","button","tuiButton","","size","s",3,"showLoader","appearance","disabled","click"],[1,"me-2"],[1,"flex","flex-col"],[1,"flex"],[1,"text-slate-400","me-1"],o,["class","text-slate-400"],[1,"text-slate-400"],i,r]},template:function(o,i){1&o&&t.yuY(0,Ie,2,0,"ng-template",null,0,t.gJz)(2,ve,10,9,"tui-hosted-dropdown",1)(3,Ve,1,1,"ng-template",null,2,t.gJz),2&o&&(t.yG2(2),t.C0Y(2,i.reservation?2:-1))},dependencies:[S.CI,S.Kw,R.qL,N.WY,W.GE,W.Qw,p.y,p.ED,he,p.QF],encapsulation:2})}return n})();const ke=["phoneTo",""];function we(n,a){1&n&&(t.I0R(0,"mat-icon",3),t.OEk(1,"chat"),t.C$Y())}function ze(n,a){1&n&&(t.I0R(0,"mat-icon",3),t.OEk(1,"call"),t.C$Y())}const Fe=["*"];let Ue=(()=>{class n{constructor(){this.whatsapp=!1}ngOnChanges(){this.href=this.whatsapp?`https://wa.me/${this.phoneTo}`:`tel:${this.phoneTo}`}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.In1({type:n,selectors:[["","phoneTo",""]],inputs:{phoneTo:"phoneTo",whatsapp:"whatsapp"},standalone:!0,features:[t.SYr,t.UHJ],attrs:ke,ngContentSelectors:Fe,decls:5,vars:2,consts:[["target","_blank","tuiLink","",3,"href"],[1,"flex","items-center"],["class","ms-1"],[1,"ms-1"]],template:function(o,i){1&o&&(t.kPM(),t.I0R(0,"a",0)(1,"span",1),t._Xx(2),t.yuY(3,we,2,0,"mat-icon",2)(4,ze,2,0),t.C$Y()()),2&o&&(t._6D("href",i.href,t.K6U),t.yG2(3),t.C0Y(3,i.whatsapp?3:4))},dependencies:[s.w,s.C,R.qL],changeDetection:0})}return n})();const He=["mailTo",""],Xe=["*"];let Be=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.In1({type:n,selectors:[["","mailTo",""]],inputs:{mailTo:"mailTo"},standalone:!0,features:[t.UHJ],attrs:He,ngContentSelectors:Xe,decls:3,vars:1,consts:[["target","_blank","tuiLink","",3,"href"],[1,"flex","items-center"]],template:function(o,i){1&o&&(t.kPM(),t.I0R(0,"a",0)(1,"span",1),t._Xx(2),t.C$Y()()),2&o&&t.CI5("href","mailto:",i.mailTo,"",t.K6U)},dependencies:[s.w,s.C],changeDetection:0})}return n})();function Ke(n,a){if(1&n&&(t.I0R(0,"p"),t.OEk(1),t.SAx(2),t.aS0(3,2),t.k70(),t.C$Y(),t.I0R(4,"p"),t.OEk(5),t.SAx(6),t.aS0(7,3),t.k70(),t.C$Y()),2&n){const e=t.GaO();let o,i;t.yG2(),t.oRS(" ",null!==(o=e.adults)&&void 0!==o?o:0," "),t.yG2(4),t.oRS(" ",null!==(i=e.children)&&void 0!==i?i:0," ")}}function Je(n,a){if(1&n&&(t.I0R(0,"span"),t.OEk(1),t.C$Y(),t.I0R(2,"mat-icon"),t.OEk(3,"person2"),t.C$Y()),2&n){const e=t.GaO();t.yG2(),t.cNF(e.adults)}}function We(n,a){if(1&n&&(t.I0R(0,"span"),t.OEk(1),t.C$Y(),t.I0R(2,"mat-icon"),t.OEk(3,"child_care"),t.C$Y()),2&n){const e=t.GaO();t.yG2(),t.cNF(e.children)}}function Qe(n,a){1&n&&t.OEk(0," ??? ")}let je=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.In1({type:n,selectors:[["app-reservation-people"]],inputs:{adults:"adults",children:"children"},standalone:!0,features:[t.UHJ],decls:6,vars:4,consts:()=>{let e,o;return e="Adulti",o="Bambini",[["hint",""],[1,"flex","items-center",3,"tuiHint"],e,o]},template:function(o,i){if(1&o&&(t.yuY(0,Ke,8,2,"ng-template",null,0,t.gJz),t.I0R(2,"div",1),t.yuY(3,Je,4,1)(4,We,4,1)(5,Qe,1,0),t.C$Y()),2&o){const r=t.Gew(1);t.yG2(2),t.E7m("tuiHint",r),t.yG2(),t.C0Y(3,i.adults&&i.adults>0?3:-1),t.yG2(),t.C0Y(4,i.children&&i.children>0?4:-1),t.yG2(),t.C0Y(5,i.adults&&i.adults>0||i.children&&i.children>0?-1:5)}},dependencies:[R.qL,N.WY,N.lh,N.SL,N.i6,N.IT],encapsulation:2})}return n})();var Ze=_(4476),qe=_(8640),tn=_(3040);function en(n,a){1&n&&(t.I0R(0,"span",4),t.aS0(1,5),t.C$Y())}function nn(n,a){1&n&&(t.I0R(0,"span",6),t.aS0(1,7),t.C$Y())}function on(n,a){1&n&&(t.I0R(0,"span",8),t.aS0(1,9),t.C$Y())}function an(n,a){1&n&&t.OEk(0," error ")}function _n(n,a){if(1&n&&t.yuY(0,en,2,0)(1,nn,2,0)(2,on,2,0)(3,an,1,0),2&n){const e=t.GaO(2);let o;t.C0Y(0,"paid"===(o=e.status())?0:"todo"===o?1:"refunded"===o?2:3)}}function sn(n,a){if(1&n&&(t.I0R(0,"div",18),t.OEk(1),t.wVc(2,"currency"),t.C$Y()),2&n){const e=t.GaO(3);let o;t.yG2(),t.oRS(" ",t.kDX(2,1,null==(o=e.payment())?null:o.value)," ")}}function rn(n,a){if(1&n&&(t.I0R(0,"p",19),t.SAx(1),t.aS0(2,20),t.k70(),t.I0R(3,"app-copy-content",21),t.OEk(4),t.C$Y()()),2&n){const e=t.GaO(3);let o,i;t.yG2(3),t.E7m("content",null==(o=e.payment())?null:o.external_id),t.yG2(),t.cNF(null==(i=e.payment())?null:i.external_id)}}function ln(n,a){1&n&&t.C_f(0)}function cn(n,a){1&n&&(t.SAx(0),t.aS0(1,22),t.k70())}function un(n,a){if(1&n){const e=t.KQA();t.I0R(0,"p",23),t.aS0(1,24),t.C$Y(),t.I0R(2,"button",25),t.qCj("click",function(){t.usT(e);const i=t.GaO(3);return t.CGJ(i.cancelPayment())}),t.SAx(3),t.aS0(4,26),t.k70(),t.C$Y()}if(2&n){const e=t.GaO(3);t.yG2(2),t.E7m("showLoader",e.loading())}}function pn(n,a){if(1&n&&(t.I0R(0,"p"),t.aS0(1,27),t.C$Y(),t.I0R(2,"div",28)(3,"a",29),t.OEk(4),t.C$Y(),t.wR5(5,"app-copy-content",21),t.C$Y()),2&n){const e=t.GaO(3);let o,i,r;t.yG2(3),t._6D("href",null==(o=e.payment())?null:o.hpp_url,t.K6U),t.yG2(),t.cNF(null==(i=e.payment())?null:i.hpp_url),t.yG2(),t.E7m("content",null==(r=e.payment())?null:r.hpp_url)}}function mn(n,a){1&n&&(t.I0R(0,"p"),t.aS0(1,30),t.C$Y())}function En(n,a){1&n&&t.OEk(0," error ")}function dn(n,a){if(1&n){const e=t.KQA();t.I0R(0,"h2",10),t.aS0(1,11),t.C$Y(),t.yuY(2,sn,3,3,"div",12)(3,rn,5,2,"p",13),t.I0R(4,"div",14)(5,"div",15),t.yuY(6,ln,1,0,"ng-container",3),t.C$Y(),t.yuY(7,cn,2,0,"ng-template",null,16,t.gJz),t.I0R(9,"button",17),t.qCj("click",function(){t.usT(e);const i=t.GaO(2);return t.CGJ(i.fetchPaymentStatus())}),t.I0R(10,"mat-icon"),t.OEk(11,"refresh"),t.C$Y()()(),t.yuY(12,un,5,1)(13,pn,6,3)(14,mn,2,0)(15,En,1,0)}if(2&n){const e=t.Gew(8);t.GaO();const o=t.Gew(1),i=t.GaO();let r,h,y;t.yG2(2),t.C0Y(2,null!=(r=i.payment())&&r.value?2:-1),t.yG2(),t.C0Y(3,null!=(h=i.payment())&&h.external_id?3:-1),t.yG2(3),t.E7m("ngTemplateOutlet",o),t.yG2(3),t.E7m("tuiHint",e)("showLoader",i.loading()),t.yG2(3),t.C0Y(12,"paid"===(y=i.status())?12:"todo"===y?13:"refunded"===y?14:15)}}function Tn(n,a){1&n&&t.C_f(0)}function Cn(n,a){if(1&n){const e=t.KQA();t.yuY(0,_n,4,1,"ng-template",null,0,t.gJz)(2,dn,16,6,"ng-template",null,1,t.gJz),t.I0R(4,"button",2),t.qCj("click",function(){t.usT(e);const i=t.Gew(3),r=t.GaO();return t.CGJ(r.showDialog(i))}),t.yuY(5,Tn,1,0,"ng-container",3),t.C$Y()}if(2&n){const e=t.Gew(1);t.yG2(5),t.E7m("ngTemplateOutlet",e)}}let Sn=(()=>{class n{constructor(){this.destroy=(0,t.uUt)(m.UF),this.dialogs=(0,t.uUt)(tt._k),this.reservations=(0,t.uUt)(l.S),this.notifications=(0,t.uUt)(w.E),this.reservation=(0,t.OCB)(null),this.payment=(0,t.OCB)(null),this.status=(0,t.S6b)(()=>this.payment()?.status||null),this.loading=(0,t.OCB)(!1)}set reservationValue(e){this.reservation.set(e),this.payment.set(e?.payment||null)}showDialog(e){this.dialogs.open(e).subscribe()}fetchPaymentStatus(){const e=this.reservation()?.id;e?(this.loading.set(!0),this.reservations.refreshPaymentStatus(e).pipe((0,g.a)(this.destroy),(0,T.U)(()=>this.loading.set(!1))).subscribe(o=>{this.reservationValue=o},o=>{this.notifications.error((0,E.mk)(o))})):this.notifications.error()}cancelPayment(){const e=this.reservation()?.id;e?this.notifications.confirm("I soldi della prenotazione verranno ritornati al cliente. Sei sicuro?").subscribe({next:o=>{o&&(this.loading.set(!0),this.reservations.refoundPayment(e).pipe((0,g.a)(this.destroy),(0,T.U)(()=>this.loading.set(!1))).subscribe(i=>{this.reservationValue=i},i=>{this.notifications.error((0,E.mk)(i))}))}}):this.notifications.error()}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.In1({type:n,selectors:[["app-admin-reservation-payment"]],inputs:{reservationValue:[t.Wk5.None,"reservation","reservationValue"]},standalone:!0,features:[t.M5G([m.UF]),t.UHJ],decls:1,vars:1,consts:()=>{let e,o,i,r,h,y,H,X,b,Q;return e="Pagata",o="Non pagata",i="Rimborsata",r="Stato pagamento",h="Id pagamento:",y="Aggiorna stato (scarica ultima versione dal gateway di pagamento)",H="Il pagamento \xE8 stato completato con successo.",X="Storna pagamento",b="Link per completare il pagamento:",Q="Il pagamento \xE8 stato rimborsato.",[["paymentStatus",""],["modalTemplate",""],["type","button","tuiButton","","size","m","appearance","outline",3,"click"],[4,"ngTemplateOutlet"],[1,"text-center","text-success-dark","text-nowrap"],e,[1,"text-center","text-danger","text-nowrap"],o,[1,"text-center","text-warning","text-nowrap"],i,[1,"text-xl","bold","mb-3"],r,["class","w-fit border font-bold rounded-md border-success-dark text-success-dark flex items-center p-2"],["class","mt-3"],[1,"flex","items-center"],[1,"me-2"],["hintForRefresh",""],["size","m","type","button","tuiIconButton","",3,"tuiHint","showLoader","click"],[1,"w-fit","border","font-bold","rounded-md","border-success-dark","text-success-dark","flex","items-center","p-2"],[1,"mt-3"],h,[3,"content"],y,[1,"my-3"],H,["tuiButton","","type","button","size","m","appearance","secondary-destructive",3,"showLoader","click"],X,b,[1,"flex","items-center","justify-center"],["tuiLink","",1,"me-2",3,"href"],Q]},template:function(o,i){1&o&&t.yuY(0,Cn,6,1),2&o&&t.C0Y(0,i.payment()?0:-1)},dependencies:[S.CI,S.Kw,tn.M,s.w,s.C,p.cf,p.XV,R.oB,R.qL,N.WY,N.lh,N.SL,N.i6,N.IT],changeDetection:0})}return n})();function Rn(n,a){if(1&n){const e=t.KQA();t.I0R(0,"button",8),t.qCj("click",function(){t.usT(e);const i=t.GaO().$implicit,r=t.GaO(2);return t.CGJ(r.emit(i))}),t.wR5(1,"app-reservation-status",5),t.C$Y()}if(2&n){const e=t.GaO().$implicit;t.yG2(),t.E7m("status",e)}}function gn(n,a){if(1&n&&t.yuY(0,Rn,2,1,"button",7),2&n){const e=a.$implicit,o=t.GaO(2);t.C0Y(0,e!=o.status()?0:-1)}}function On(n,a){if(1&n&&(t.I0R(0,"tui-data-list"),t.c53(1,gn,1,1,null,null,t.oxv),t.C$Y()),2&n){const e=t.GaO();t.yG2(),t.oho(e.options)}}const fn=n=>({rotate180:n});let Nn=(()=>{class n{constructor(){this.destroy$=(0,t.uUt)(m.UF),this.service=(0,t.uUt)(l.S),this.statusChange=new t._w7,this.itemId=(0,t.OCB)(null),this.loading=(0,t.OCB)(!1),this.status=(0,t.OCB)(null),this.options=["arrived","noshow","deleted"],this.buttonAppearance="outline"}set reservation(e){this.itemId.set(e.id||null),this.loading.set(!1),this.status.set(e.status||null)}emit(e){this.statusChange.emit(e)}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.In1({type:n,selectors:[["app-eip-reservation-status"]],inputs:{buttonAppearance:"buttonAppearance",reservation:"reservation"},outputs:{statusChange:"statusChange"},standalone:!0,features:[t.M5G([m.UF]),t.UHJ],decls:9,vars:6,consts:[["dropdownContent",""],[3,"content"],["dropdown",""],["type","button","size","m","tuiButton","",3,"appearance"],[1,"flex","items-center"],[3,"status"],[1,"animation-speed-2",3,"ngClass"],["type","button","tuiOption",""],["type","button","tuiOption","",3,"click"]],template:function(o,i){if(1&o&&(t.yuY(0,On,3,0,"ng-template",null,0,t.gJz),t.I0R(2,"tui-hosted-dropdown",1,2)(4,"button",3)(5,"span",4),t.wR5(6,"app-reservation-status",5),t.I0R(7,"mat-icon",6),t.OEk(8,"expand_more"),t.C$Y()()()()),2&o){const r=t.Gew(1),h=t.Gew(3);t.yG2(2),t.E7m("content",r),t.yG2(2),t.E7m("appearance",i.buttonAppearance),t.yG2(2),t.E7m("status",i.status()),t.yG2(),t.E7m("ngClass",t.S45(4,fn,h.open))}},dependencies:[S.CI,S.Kw,W.GE,W.Qw,F.A$,F.yi,F.sP,G.Sk,lt.a,R.oB,R.qL,p.QF],changeDetection:0})}return n})();var Mn=_(1183),hn=_(6964);const In=(n,a)=>a.id;function An(n,a){1&n&&(t.SAx(0),t.aS0(1,13),t.k70())}function yn(n,a){1&n&&(t.SAx(0),t.aS0(1,14),t.k70())}function vn(n,a){1&n&&(t.SAx(0),t.aS0(1,15),t.k70())}function Pn(n,a){1&n&&(t.SAx(0),t.aS0(1,16),t.k70())}function $n(n,a){1&n&&(t.SAx(0),t.aS0(1,17),t.k70())}function xn(n,a){1&n&&(t.SAx(0),t.aS0(1,18),t.k70())}function Gn(n,a){1&n&&(t.SAx(0),t.aS0(1,19),t.k70())}function Dn(n,a){1&n&&(t.SAx(0),t.aS0(1,20),t.k70())}function Ln(n,a){1&n&&(t.I0R(0,"app-no-items",21)(1,"h4"),t.aS0(2,22),t.C$Y(),t.I0R(3,"span"),t.aS0(4,23),t.C$Y()()),2&n&&t.E7m("showLoader",!1)}function Yn(n,a){if(1&n&&(t.OEk(0),t.wVc(1,"date")),2&n){const e=t.GaO().$implicit;t.oRS(" ",t.g7$(1,1,e.datetime,"full")," ")}}function Vn(n,a){if(1&n&&(t.I0R(0,"span",45)(1,"span",46),t.aS0(2,47),t.C$Y(),t.OEk(3),t.C$Y()),2&n){const e=t.GaO().$implicit;t.yG2(3),t.oRS("",e.table," ")}}function bn(n,a){if(1&n&&(t.I0R(0,"p",48),t.OEk(1),t.C$Y()),2&n){const e=t.GaO().$implicit;t.E7m("phoneTo",e.phone)("whatsapp",!0),t.yG2(),t.cNF(e.phone)}}function kn(n,a){if(1&n&&(t.I0R(0,"p",49),t.OEk(1),t.C$Y()),2&n){const e=t.GaO().$implicit;t.E7m("mailTo",e.email),t.yG2(),t.cNF(e.email)}}function wn(n,a){if(1&n&&(t.I0R(0,"p",50),t.OEk(1),t.C$Y()),2&n){const e=t.GaO().$implicit;t.yG2(),t.oRS(" ",e.notes," ")}}function zn(n,a){1&n&&(t.I0R(0,"span"),t.aS0(1,51),t.C$Y())}function Fn(n,a){1&n&&(t.I0R(0,"span"),t.aS0(1,52),t.C$Y())}const Un=n=>({rotate180:n});function Hn(n,a){if(1&n){const e=t.KQA();t.I0R(0,"div",24)(1,"div")(2,"span",25),t.qCj("click",function(){t.usT(e);const i=t.Gew(13);return t.CGJ(i.expanded=!i.expanded)}),t.yuY(3,Yn,2,4,"ng-template",null,26,t.gJz),t.I0R(5,"span",27),t.OEk(6),t.wVc(7,"date"),t.C$Y(),t.I0R(8,"span",28),t.OEk(9),t.C$Y(),t.wR5(10,"app-reservation-people",29),t.yuY(11,Vn,4,1,"span",30),t.C$Y(),t.I0R(12,"tui-expand",null,31),t.yuY(14,bn,2,3,"p",32)(15,kn,2,2,"p",33)(16,wn,2,1,"p",34),t.I0R(17,"div",35)(18,"a",36),t.SAx(19),t.aS0(20,37),t.k70(),t.C$Y()(),t.I0R(21,"div",35),t.wR5(22,"app-admin-reservation-payment",38),t.C$Y(),t.wR5(23,"app-reservation-events",39),t.C$Y(),t.I0R(24,"button",40),t.qCj("click",function(){t.usT(e);const i=t.Gew(13);return t.CGJ(i.expanded=!i.expanded)}),t.I0R(25,"span",41),t.yuY(26,zn,2,0,"span")(27,Fn,2,0),t.I0R(28,"mat-icon",42),t.OEk(29,"expand_more"),t.C$Y()()()(),t.I0R(30,"div",43)(31,"app-eip-reservation-status",44),t.qCj("statusChange",function(i){const h=t.usT(e).$implicit,y=t.GaO();return t.CGJ(y.updateStatus(h,i))}),t.C$Y()()()}if(2&n){const e=a.$implicit,o=t.Gew(4),i=t.Gew(13);t.yG2(5),t.E7m("tuiHint",o),t.yG2(),t.oRS(" ",t.g7$(7,16,e.datetime,"HH:mm")," "),t.yG2(3),t.cNF(e.fullname),t.yG2(),t.E7m("adults",e.adults)("children",e.children),t.yG2(),t.C0Y(11,e.table?11:-1),t.yG2(3),t.C0Y(14,e.phone&&e.phone.length>0?14:-1),t.yG2(),t.C0Y(15,e.email&&e.email.length>0?15:-1),t.yG2(),t.C0Y(16,e.notes&&e.notes.length>0?16:-1),t.yG2(2),t._6D("routerLink",e.id),t.yG2(4),t.E7m("reservation",e),t.yG2(),t.E7m("reservation",e),t.yG2(3),t.C0Y(26,i.expanded?26:27),t.yG2(2),t.E7m("ngClass",t.S45(19,Un,i.expanded)),t.yG2(3),t.E7m("buttonAppearance","flat")("reservation",e)}}function Xn(n,a){1&n&&t.C_f(0)}function Bn(n,a){if(1&n&&t.yuY(0,Xn,1,0,"ng-container",53),2&n){t.GaO();const e=t.Gew(20);t.E7m("ngTemplateOutlet",e)}}let Kn=(()=>{class n{constructor(){this.loading=(0,t.OCB)(!1),this.data=(0,t.OCB)(null),this.items=(0,t.S6b)(()=>this.data()?.items||[]),this.service=(0,t.uUt)(l.S),this.router=(0,t.uUt)(d.E5),this.notifications=(0,t.uUt)(w.E),this.date=(0,t.uUt)(p.y),this.destroy$=(0,t.uUt)(m.UF),this._=(0,t.uUt)(Ze.OY).setTitle("Prenotazioni | La Porta D'Acqua"),this.inputSize="m",this.defaultOrder={field:"datetime",asc:!0},this.filters={},this.order=new u.Ku(null)}ngOnInit(){this.order.valueChanges.subscribe({next:e=>{this.search()}}),this.router.events.pipe((0,g.a)(this.destroy$)).subscribe({next:e=>{e instanceof d.MT&&this.search()}})}updateStatus(e,o){const i=e.id;i&&o?this.notifications.confirm("La prenotazione verr\xe0 aggiornata.",{title:"Prenotazione " + e.fullname + " x " + ((e.adults || 0) + (e.children || 0)) + " in stato " + Mn.au[o].title + ""}).subscribe({next:r=>{r&&this.confirmedUpdateStatus(i,o)}}):this.notifications.error()}delete(e){e&&this.notifications.confirm("Sei sicuro di voler cancellare questa prenotazione?").subscribe({next:o=>{o&&this.confirmedDelete(e)}})}filtersChanged(e){this.filters=e,this.search(e)}confirmedUpdateStatus(e,o){this.loading.set(!0),("deleted"==o?this.service.destroy(e):this.service.updateStatus(e,o)).pipe((0,g.a)(this.destroy$),(0,T.U)(()=>this.loading.set(!1))).subscribe({next:()=>{this.notifications.fireSnackBar("Stato aggiornato con successo."),this.search()},error:r=>{this.notifications.error((0,E.mk)(r)||"Qualcosa \xE8 andato storto nell'aggiornamento dello stato.")}})}confirmedDelete(e){this.loading.set(!0),this.service.destroy(e).pipe((0,g.a)(this.destroy$),(0,T.U)(()=>{this.loading.set(!1),this.search()})).subscribe({error:o=>{this.notifications.error((0,E.mk)(o)||"Qualcosa \xE8 andato storto nella cancellazione.")}})}search(e=this.filters){e||={},e={...e};const o=this.order.value;this.order.valid&&o&&(e.order_by_field=o.field,e.order_by_direction=o.asc?"ASC":"DESC"),this.loading.set(!0),this.service.search(e).pipe((0,g.a)(this.destroy$),(0,T.U)(()=>this.loading.set(!1))).subscribe({next:i=>{this.data.set(i)},error:i=>{this.notifications.error((0,E.mk)(i)||"Qualcosa \xE8 andato storto nella ricerca."),console.error(i)}})}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.In1({type:n,selectors:[["app-admin-reservations-home"]],viewQuery:function(o,i){if(1&o&&t.CC$(it,7),2&o){let r;t.wto(r=t.Gqi())&&(i.turnSelect=r.first)}},standalone:!0,features:[t.M5G([m.UF]),t.UHJ],decls:28,vars:7,consts:()=>{let e,o,i,r,h,y,H,X,b,Q,k,ct,ut,pt,mt;return e="Prenotazioni",o="Orario",i="Nome",r="Email",h="N\xB0",y="Stato",H="Tavolo",X="Note",b="Contatti",Q="Nessuna prenotazione",k="Prova a modificare i filtri di ricerca",ct="Modifica prenotazione",ut="Tavolo",pt="Nascondi dettagli",mt="Mostra dettagli",[e,["datetimeCol",""],["nameCol",""],["emailCol",""],["peopleCol",""],["statusCol",""],["tableCol",""],["detailsCol",""],["contactsCol",""],["noItems",""],[3,"loading","data","filtersChanged"],[3,"overlay","showLoader"],[3,"showLoader","filters"],o,i,r,h,y,H,X,b,[3,"showLoader"],Q,k,[1,"p-3","m-2","flex","items-center","justify-between","border","rounded-md","border-slate-400"],[1,"flex","items-center","text-lg","mb-2",3,"click"],["detailDatetime",""],[1,"me-2",3,"tuiHint"],[1,"me-2"],[3,"adults","children"],["class","text-slate-400"],["expand",""],["class","block mb-2",3,"phoneTo","whatsapp"],["class","block mb-2",3,"mailTo"],["class","block mb-2 text-slate-400"],[1,"block","mb-2"],["tuiLink","",3,"routerLink"],ct,[3,"reservation"],[1,"my-auto",3,"reservation"],["type","button","size","s","tuiButton","","appearance","outline",3,"click"],[1,"flex","items-center"],[1,"animation-speed-2",3,"ngClass"],[1,"flex","flex-col","items-around"],[1,"mb-3",3,"buttonAppearance","reservation","statusChange"],[1,"text-slate-400"],[1,"me-1"],ut,[1,"block","mb-2",3,"phoneTo","whatsapp"],[1,"block","mb-2",3,"mailTo"],[1,"block","mb-2","text-slate-400"],pt,mt,[4,"ngTemplateOutlet"],["class","p-3 m-2 flex items-center justify-between border rounded-md border-slate-400"]]},template:function(o,i){1&o&&(t.I0R(0,"h1"),t.SAx(1),t.aS0(2,0),t.k70(),t.C$Y(),t.yuY(3,An,2,0,"ng-template",null,1,t.gJz)(5,yn,2,0,"ng-template",null,2,t.gJz)(7,vn,2,0,"ng-template",null,3,t.gJz)(9,Pn,2,0,"ng-template",null,4,t.gJz)(11,$n,2,0,"ng-template",null,5,t.gJz)(13,xn,2,0,"ng-template",null,6,t.gJz)(15,Gn,2,0,"ng-template",null,7,t.gJz)(17,Dn,2,0,"ng-template",null,8,t.gJz)(19,Ln,5,1,"ng-template",null,9,t.gJz),t.I0R(21,"app-list-reservations-filters",10),t.qCj("filtersChanged",function(h){return i.filtersChanged(h)}),t.I0R(22,"tui-loader",11),t.c53(23,Hn,32,21,"div",54,In,!1,Bn,1,1,"ng-container"),t.C$Y()(),t.wR5(26,"app-reservation-tables-summary",12)(27,"router-outlet")),2&o&&(t.yG2(21),t.E7m("loading",i.loading())("data",i.data()),t.yG2(),t.E7m("overlay",!0)("showLoader",i.loading()),t.yG2(),t.oho(i.items()),t.yG2(3),t.E7m("showLoader",i.loading())("filters",i.filters))},dependencies:[p.MD,p.QF,p.XV,p.y,u.sl,O.CQ,c.m6,S.CI,S.Kw,R.qL,d.ER,s.w,s.C,d.cP,x.yy,N.WY,N.lh,N.SL,N.i6,N.IT,Me,be,Ue,Be,je,qe.O,G.Sk,G.Cb,Sn,u.y,Nn,z.kh,z.st,hn.u],encapsulation:2,changeDetection:0})}return n})()},6964:(V,A,_)=>{_.d(A,{u:()=>w});var t=_(4496),p=_(3480),u=_(8304),O=_(3616),m=_(8824),c=_(7692),S=_(5656),s=_(1560);function N(g,T){if(1&g&&t.wR5(0,"tui-loader",0),2&g){const E=t.GaO();t.E7m("showLoader",E.showLoader)("size","s")}}const G=(g,T)=>T[0];function z(g,T){if(1&g&&(t.SAx(0),t.aS0(1,7),t.k70(),t.OEk(2)),2&g){const E=t.GaO(2);t.yG2(2),t.oRS(" ",E.totalPeople(),"\n")}}function R(g,T){if(1&g&&(t.OEk(0),t.SAx(1),t.aS0(2,10),t.k70(),t.OEk(3),t.SAx(4),t.aS0(5,11),t.k70()),2&g){const E=t.GaO().$implicit;t.oRS(" ",E[1]," "),t.yG2(3),t.oRS(" ",E[0]," ")}}function d(g,T){if(1&g&&(t.yuY(0,R,6,2,"ng-template",null,8,t.gJz),t.I0R(2,"span",9),t.OEk(3),t.C$Y()),2&g){const E=T.$implicit,l=t.Gew(1);t.yG2(2),t.E7m("tuiHint",l),t.yG2(),t.CAO(" ",E[1]," x ",E[0]," ")}}function x(g,T){if(1&g&&(t.yuY(0,z,3,1,"ng-template",null,1,t.gJz),t.I0R(2,"div",2)(3,"span",3),t.SAx(4),t.aS0(5,4),t.k70(),t.C$Y(),t.c53(6,d,4,3,null,null,G),t.I0R(8,"span",5)(9,"mat-icon",6),t.OEk(10,"import_contacts"),t.C$Y(),t.OEk(11),t.C$Y()()),2&g){const E=t.Gew(1),l=t.GaO();t.yG2(6),t.oho(l.data()),t.yG2(2),t.E7m("tuiHint",E),t.yG2(3),t.oRS(" ",l.totalPeople()," ")}}let w=(()=>{class g{constructor(){this.destroy$=(0,t.uUt)(p.UF),this.service=(0,t.uUt)(u.S),this.data=(0,t.OCB)(null),this.totalPeople=(0,t.S6b)(()=>this.data()?.reduce((E,[l,M])=>E+l*M,0)||0),this.loading=(0,t.OCB)(!1),this.showLoader=!0,this.filters=null}ngOnChanges(){this.query()}query(){this.loading.set(!0),this.service.ungroupedTablesSummary(this.filters??{}).pipe((0,O.a)(this.destroy$),(0,m.U)(()=>this.loading.set(!1))).subscribe({next:E=>{this.data.set(Object.entries(E).map(([l,M])=>[Number(l),M]))}})}static#t=this.\u0275fac=function(l){return new(l||g)};static#e=this.\u0275cmp=t.In1({type:g,selectors:[["app-reservation-tables-summary"]],inputs:{showLoader:"showLoader",filters:"filters"},standalone:!0,features:[t.M5G([p.UF]),t.SYr,t.UHJ],decls:2,vars:1,consts:()=>{let E,l,M,D;return E="Distribuzione tavoli",l="Totale persone",M="tavoli da",D=" persone",[[3,"showLoader","size"],["totalHint",""],[1,"flex","items-center","justify-around","border","px-2","py-2","border-slate-200"],[1,"hidden","md:flex","items-center","justify-center"],E,[1,"flex","items-center",3,"tuiHint"],[1,"me-1"],l,["dHint",""],[1,"me-1",3,"tuiHint"],M,D]},template:function(l,M){1&l&&t.yuY(0,N,1,2,"tui-loader",0)(1,x,12,2),2&l&&t.C0Y(0,M.loading()?0:1)},dependencies:[c.Sk,c.Cb,S.WY,S.lh,S.SL,S.i6,S.IT,s.oB,s.qL],styles:["td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{border:1px solid var(--tui-base-04)}table[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{font-size:.9rem}table[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]   .tui-table__td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]   .tui-table__th[_ngcontent-%COMP%]{padding:.5rem;height:inherit}"],changeDetection:0})}return g})()},8128:(V,A,_)=>{function t(p){if(!p)return null;const u=p.match(/filename="(.+)"/);return u?u[1]:null}_.d(A,{k:()=>t})},9772:(V,A,_)=>{_.d(A,{CU:()=>p,ye:()=>u});const t=(new Date).getTimezoneOffset()/60;function p(O,m=t){return"string"==typeof O&&O.length>0&&O.match(/\d{1,2}:\d{1,2}/)?`${Number(O.split(":")[0])-m}:${O.split(":")[1]}`:(console.error("Invalid string provided to strTimeTimezone",{string:O}),"")}function u(O,m=t){return p(O,-1*m)}},1960:(V,A,_)=>{_.d(A,{u:()=>O});var t=_(8400),p=_(5136);class u extends t.w{constructor(c){super(c),this.date=c.date?new Date(c.date):void 0,this.reservation_turn_id=c.reservation_turn_id,this.group_id=c.group_id,this.reservation_turn=c.reservation_turn?new p.e(c.reservation_turn):void 0}}class O extends t.w{constructor(c){super(c),this.turns=[],this.dates=[],this.title=c.title,this.status=c.status,this.preorder_type=c.preorder_type,this.payment_value=c.payment_value,this.message=c.message,this.turns=(c.turns||[]).map(S=>new p.e(S)),this.dates=(c.dates||[]).map(S=>new u(S))}}},5136:(V,A,_)=>{_.d(A,{e:()=>O});var t=_(8400),p=_(9772),u=_(1960);class O extends t.w{constructor(c){super(c),this.messages=[],this.name=c.name,this.weekday=c.weekday,this.step=c.step,this.valid_times=c.valid_times,this.starts_at=c.starts_at?(0,p.CU)(c.starts_at):void 0,this.ends_at=c.ends_at?(0,p.CU)(c.ends_at):void 0,this.preorder_reservation_group=c.preorder_reservation_group?new u.u(c.preorder_reservation_group):void 0,this.messages=c.messages}}},5180:(V,A,_)=>{_.d(A,{C:()=>c});var t=_(8400);class p extends t.w{constructor(s){super(s),this.image_pixel_id=s.image_pixel_id,this.event_data=s.event_data,this.event_time=s.event_time?new Date(s.event_time):void 0}}class u extends t.w{constructor(s){super(s),this.image_id=s.image_id,this.delivered_email_id=s.delivered_email_id,this.record_type=s.record_type,this.record_id=s.record_id,this.event_type=s.event_type,this.secret=s.secret,this.events=s.events?s.events.map(N=>new p(N)):[]}}class O extends t.w{constructor(s){super(s),this.record_id=s.record_id,this.record_type=s.record_type,this.text=s.text,this.html=s.html,this.subject=s.subject,this.headers=s.headers,this.raw=s.raw,this.image_pixels=s.image_pixels?s.image_pixels.map(N=>new u(N)):[]}}class m extends t.w{constructor(s){super(s),this.hpp_url=s.hpp_url,this.value=s.value,this.status=s.status,this.reservation_id=s.reservation_id,this.preorder_type=s.preorder_type,this.external_id=s.external_id,this.other=s.other}}class c extends t.w{constructor(s){super(s),this.fullname=s.fullname,this.datetime=s.datetime?new Date(s.datetime):void 0,this.status=s.status,this.secret=s.secret,this.adults=s.adults,this.children=s.children,this.table=s.table,this.notes=s.notes,this.email=s.email,this.phone=s.phone,this.payment=s.payment?new m(s.payment):void 0,this.delivered_emails=s.delivered_emails?s.delivered_emails.map(N=>new O(N)):[]}}},9160:(V,A,_)=>{_.d(A,{E:()=>u});var t=_(400),p=_(4496);let u=(()=>{class O{transform(c){return c instanceof Date?c:c instanceof t.EK?c.toUtcNativeDate():null}static#t=this.\u0275fac=function(S){return new(S||O)};static#e=this.\u0275pipe=p.UTH({name:"fromTuiDay",type:O,pure:!0,standalone:!0})}return O})()},2516:(V,A,_)=>{_.d(A,{G:()=>p});var t=_(4496);let p=(()=>{class u{constructor(){this.weekdays=["Domenica","Luned\xEC","Marted\xEC","Mercoled\xEC","Gioved\xEC","Venerd\xEC","Sabato"]}transform(m){return"number"!=typeof m&&"string"==typeof m&&(m=parseInt(m)),"number"==typeof m&&m>=0&&m<=6?this.weekdays[m]:null}static#t=this.\u0275fac=function(c){return new(c||u)};static#e=this.\u0275pipe=t.UTH({name:"weekday",type:u,pure:!0,standalone:!0})}return u})()},7556:(V,A,_)=>{_.d(A,{K:()=>O});var t=_(6012),p=_(5136),u=_(4496);let O=(()=>{class m extends t.s{constructor(){super(p.e,"admin/reservation_turns")}static#t=this.\u0275fac=function(s){return new(s||m)};static#e=this.\u0275prov=u.wxM({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})()},8304:(V,A,_)=>{_.d(A,{S:()=>N});var t=_(6012),p=_(5180),u=_(4704),O=_(3252),m=_(9144),c=_(7048),S=_(8128),s=_(4496);let N=(()=>{class G extends t.s{constructor(){super(p.C,"admin/reservations")}updateStatus(R,d){return this.patch(`${R}/status/${d}`,{}).pipe((0,u.k)(x=>this.mapItem(x)))}tablesSummary(R={}){return this.get("tables_summary",{params:R})}ungroupedTablesSummary(R={}){return this.get("ungrouped_tables_summary",{params:R})}deliverConfirmationEmail(R){return this.post(`${R}/deliver_confirmation_email`,{}).pipe((0,u.k)(d=>this.mapItem(d)))}refoundPayment(R){return this.post(`${R}/refund_payment`,{}).pipe((0,u.k)(d=>this.mapItem(d)))}refreshPaymentStatus(R){return this.post(`${R}/refresh_payment_status`,{}).pipe((0,u.k)(d=>this.mapItem(d)))}export(R){return new O._(d=>{this.get("export",{responseType:"blob",observe:"response",params:R}).pipe((0,m.a)(x=>(console.error("ReservationsService.export() error:",x),d.error(x),new O._))).subscribe(x=>{if(x instanceof c.WA&&x.body){const w=(0,S.k)(x.headers?.get("Content-Disposition"))??"Prenotazioni.xlsx",g=x.headers?.get("Content-Type")??"application/octet-stream",T=window.URL.createObjectURL(new Blob([x.body],{type:g})),E=document.createElement("a");E.href=T,E.download=w,E.click(),d.complete()}})})}static#t=this.\u0275fac=function(d){return new(d||G)};static#e=this.\u0275prov=s.wxM({token:G,factory:G.\u0275fac,providedIn:"root"})}return G})()},5892:(V,A,_)=>{_.d(A,{Ws:()=>q,yy:()=>F});var t=_(4496),p=_(2528),u=_(4472);(0,p.W0)((0,u.u)("showHideText"));const m=(0,p.W0)((0,u.u)("paginationTexts"));var c=_(466),S=_(1512),s=_(4336),N=_(3656),G=_(8212),z=_(5944),R=_(1368),d=_(1040);function x(C,$){if(1&C&&(t.SAx(0),t.OEk(1),t.I0R(2,"strong",6),t.OEk(3),t.C$Y(),t.k70()),2&C){const f=t.GaO().ngIf,P=t.GaO();t.yG2(),t.oRS(" ",f.pages," "),t.yG2(2),t.cNF(P.pages)}}function w(C,$){if(1&C&&(t.SAx(0),t.OEk(1),t.k70()),2&C){const f=$.polymorpheusOutlet;t.yG2(),t.oRS(" ",f," ")}}function g(C,$){if(1&C&&t.wR5(0,"tui-svg",13),2&C){const f=t.GaO(4);t.E7m("src",f.commonIcons.check)}}function T(C,$){1&C&&t.wR5(0,"span",14)}const E=(C,$)=>({$implicit:C,total:$});function l(C,$){if(1&C){const f=t.KQA();t.SAx(0),t.I0R(1,"button",9),t.qCj("click",function(){const U=t.usT(f).$implicit,K=t.GaO(3);return t.CGJ(K.onItem(U))}),t.yuY(2,w,2,1,"ng-container",10)(3,g,1,1,"tui-svg",11)(4,T,1,0,"ng-template",null,12,t.gJz),t.C$Y(),t.k70()}if(2&C){const f=$.$implicit,P=t.Gew(5),v=t.GaO(3);t.yG2(2),t.E7m("polymorpheusOutlet",v.options.sizeOptionContent)("polymorpheusOutletContext",t.IBC(4,E,f,v.total)),t.yG2(),t.E7m("ngIf",f===v.size)("ngIfElse",P)}}function M(C,$){if(1&C&&(t.I0R(0,"tui-data-list",7),t.yuY(1,l,6,7,"ng-container",8),t.C$Y()),2&C){const f=t.GaO(2);t.yG2(),t.E7m("ngForOf",f.items)}}function D(C,$){if(1&C){const f=t.KQA();t.SAx(0),t.I0R(1,"button",15),t.qCj("click",function(){t.usT(f);const v=t.GaO(2);return t.CGJ(v.back())}),t.C$Y(),t.I0R(2,"button",16),t.qCj("click",function(){t.usT(f);const v=t.GaO(2);return t.CGJ(v.forth())}),t.C$Y(),t.k70()}if(2&C){const f=$.ngIf,P=t.GaO(2);t.yG2(),t.E7m("disabled",P.leftDisabled)("icon",P.icons.decrement)("title",f[0]),t.yG2(),t.E7m("disabled",P.rightDisabled)("icon",P.icons.increment)("title",f[1])}}function L(C,$){if(1&C){const f=t.KQA();t.SAx(0),t.I0R(1,"span",1),t.yuY(2,x,4,2,"ng-container",0),t.C$Y(),t.I0R(3,"span",2),t.OEk(4),t.I0R(5,"tui-hosted-dropdown",3),t.iHE("openChange",function(v){t.usT(f);const U=t.GaO();return t.kNx(U.open,v)||(U.open=v),t.CGJ(v)}),t.I0R(6,"button",4)(7,"strong"),t.OEk(8),t.C$Y()(),t.yuY(9,M,2,1,"ng-template",null,5,t.gJz),t.C$Y(),t.OEk(11),t.I0R(12,"strong",6),t.OEk(13),t.C$Y()(),t.yuY(14,D,3,6,"ng-container",0),t.wVc(15,"async"),t.k70()}if(2&C){const f=$.ngIf,P=t.Gew(10),v=t.GaO();t.yG2(2),t.E7m("ngIf",v.options.showPages),t.yG2(2),t.oRS(" ",f.linesPerPage," "),t.yG2(),t.E7m("content",P),t.OKB("open",v.open),t.yG2(3),t.CAO("",v.start+1,"\u2013",v.end,""),t.yG2(3),t.oRS(" ",f.of," "),t.yG2(2),t.cNF(v.total),t.yG2(),t.E7m("ngIf",t.kDX(15,9,v.spinTexts$))}}const Z=(0,p.AL)({sizeOptionContent:function J({$implicit:C}){return`${C}`},showPages:!0,items:[10,20,50,100],size:10});let q=(()=>{class C{constructor(f,P,v,U,K){this.icons=f,this.spinTexts$=P,this.texts$=v,this.options=U,this.commonIcons=K,this.items=this.options.items,this.total=0,this.page=0,this.size=this.options.size,this.pageChange=new t._w7,this.sizeChange=new t._w7,this.paginationChange=new t._w7,this.open=!1}get pages(){return Math.ceil(this.total/this.size)}get start(){return this.page*this.size}get end(){return Math.min(this.start+this.size,this.total)}get leftDisabled(){return!this.start}get rightDisabled(){return this.end===this.total}get pagination(){return{page:this.page,size:this.size}}onItem(f){const{start:P}=this;this.size=f,this.sizeChange.emit(f),this.open=!1,this.page=Math.floor(P/this.size),this.pageChange.emit(this.page),this.paginationChange.emit(this.pagination)}back(){this.page--,this.pageChange.emit(this.page),this.paginationChange.emit(this.pagination)}forth(){this.page++,this.pageChange.emit(this.page),this.paginationChange.emit(this.pagination)}}return C.\u0275fac=function(f){return new(f||C)(t.GI1(z.KY),t.GI1(z.s1),t.GI1(m),t.GI1(Z),t.GI1(z.QJ))},C.\u0275cmp=t.In1({type:C,selectors:[["tui-table-pagination"]],inputs:{items:"items",total:"total",page:"page",size:"size"},outputs:{pageChange:"pageChange",sizeChange:"sizeChange",paginationChange:"paginationChange"},decls:2,vars:3,consts:[[4,"ngIf"],[1,"t-pages"],["automation-id","tui-table-pagination__lines-per-page-wrapper"],[3,"content","open","openChange"],["tuiLink","","type","button"],["content",""],[1,"t-strong"],["size","s"],[4,"ngFor","ngForOf"],["tuiOption","",1,"t-item",3,"click"],[4,"polymorpheusOutlet","polymorpheusOutletContext"],["class","t-checkmark",3,"src",4,"ngIf","ngIfElse"],["fakeIcon",""],[1,"t-checkmark",3,"src"],[1,"t-checkmark"],["appearance","icon","size","xs","tuiIconButton","","type","button",1,"t-back",3,"disabled","icon","title","click"],["appearance","icon","size","xs","tuiIconButton","","type","button",3,"disabled","icon","title","click"]],template:function(f,P){1&f&&(t.yuY(0,L,16,11,"ng-container",0),t.wVc(1,"async")),2&f&&t.E7m("ngIf",t.kDX(1,1,P.texts$))},dependencies:[c.Qw,S.C,s.yi,s.sP,N.Wu,G.Kw,R.u_,R.ay,d.Af,R.a],styles:["[_nghost-%COMP%]{display:flex;font:var(--tui-font-text-s);align-items:center;color:var(--tui-text-03)}.t-strong[_ngcontent-%COMP%]{color:var(--tui-text-01)}.t-pages[_ngcontent-%COMP%]{margin-right:auto}.t-item[_ngcontent-%COMP%]{min-width:5.5rem;box-sizing:border-box}.t-checkmark[_ngcontent-%COMP%]{min-width:1.5rem;border-left:5px solid transparent}.t-back[_ngcontent-%COMP%]{margin:0 .25rem 0 1.5rem}"],changeDetection:0}),C})(),F=(()=>{class C{}return C.\u0275fac=function(f){return new(f||C)},C.\u0275mod=t.a4G({type:C}),C.\u0275inj=t.s3X({imports:[[R.MD,G.CI,S.w,c.GE,s.A$,N.Yt,d.Ux]]}),C})()},9880:(V,A,_)=>{_.d(A,{kP:()=>R,kh:()=>g,st:()=>w});var t=_(4496),p=_(3480),u=_(4392),O=_(3120),m=_(3616),c=_(7692),S=_(1368);const s=["wrapper"];function N(T,E){if(1&T&&(t.I0R(0,"tui-loader",4),t.C_f(1,5),t.C$Y()),2&T){const l=t.GaO(2);t.E7m("overlay",!0)("showLoader",l.loading),t.yG2(),t.E7m("ngTemplateOutlet",l.content)}}function G(T,E){if(1&T&&(t.SAx(0),t._Xx(1),t.yuY(2,N,2,3,"tui-loader",3),t.k70()),2&T){const l=t.GaO();t.yG2(2),t.E7m("ngIf",l.async)("ngIfElse",l.content)}}const z=["*"];let R=(()=>{class T{}return T.\u0275fac=function(l){return new(l||T)},T.\u0275dir=t.Sc5({type:T,selectors:[["","tuiExpandContent",""]]}),T})();let w=(()=>{class T{constructor(l,M){this.cdr=l,this.destroy$=M,this.state=0,this.async=!1,this.content=null,this.expanded=null}set expandedSetter(l){if(null!==this.expanded)return 0!==this.state?(this.expanded=l,void(this.state=3)):(this.expanded=l,void this.retrigger(this.async&&l?1:3));this.expanded=l}get overflow(){return 0!==this.state}get loading(){return!!this.expanded&&this.async&&1===this.state}get height(){const{expanded:l,state:M,contentWrapper:D}=this;return l&&2===M||!l&&3===M?0:D&&(!l&&2===M||l&&3===M)?D.nativeElement.offsetHeight:D&&l&&1===M?Math.max(D.nativeElement.offsetHeight,48):null}get contentVisible(){return this.expanded||0!==this.state}onTransitionEnd({propertyName:l}){"opacity"===l&&3===this.state&&(this.state=0)}onExpandLoaded(l){l.stopPropagation(),1===this.state&&this.retrigger(3)}retrigger(l){this.state=2,(0,O.k)(0).pipe((0,m.a)(this.destroy$)).subscribe(()=>{2===this.state&&(this.state=l,this.cdr.markForCheck())})}}return T.\u0275fac=function(l){return new(l||T)(t.GI1(t.kD9),t.GI1(p.UF,2))},T.\u0275cmp=t.In1({type:T,selectors:[["tui-expand"]],contentQueries:function(l,M,D){if(1&l&&t.szK(D,R,5,t.Yw2),2&l){let L;t.wto(L=t.Gqi())&&(M.content=L.first)}},viewQuery:function(l,M){if(1&l&&t.CC$(s,5),2&l){let D;t.wto(D=t.Gqi())&&(M.contentWrapper=D.first)}},hostVars:9,hostBindings:function(l,M){1&l&&t.qCj("transitionend.self",function(L){return M.onTransitionEnd(L)})("tui-expand-loaded",function(L){return M.onExpandLoaded(L)}),2&l&&(t.e48("aria-expanded",M.expanded),t.m4B("height",M.height,"px"),t.eAK("_expanded",M.expanded)("_overflow",M.overflow)("_loading",M.loading))},inputs:{async:"async",expandedSetter:[t.Wk5.None,"expanded","expandedSetter"]},features:[t.M5G([p.UF])],ngContentSelectors:z,decls:3,vars:3,consts:[[1,"t-wrapper"],["wrapper",""],[4,"ngIf"],["size","l",3,"overlay","showLoader",4,"ngIf","ngIfElse"],["size","l",3,"overlay","showLoader"],[3,"ngTemplateOutlet"]],template:function(l,M){1&l&&(t.kPM(),t.I0R(0,"div",0,1),t.yuY(2,G,3,2,"ng-container",2),t.C$Y()),2&l&&(t.E7m("@tuiParentAnimation",void 0)("@.disabled",M.overflow),t.yG2(2),t.E7m("ngIf",M.contentVisible))},dependencies:[c.Cb,S.u_,S.XV],styles:['[_nghost-%COMP%]{transition-property:opacity,height,visibility;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;display:block;opacity:0;transition-delay:1ms}._overflow[_nghost-%COMP%]{overflow:hidden}._expanded[_nghost-%COMP%]{opacity:1;transform:translate(0)}._loading[_nghost-%COMP%]{opacity:.99}.t-wrapper[_ngcontent-%COMP%]:before, .t-wrapper[_ngcontent-%COMP%]:after{content:"";display:table}'],data:{animation:[u.cI]},changeDetection:0}),T})(),g=(()=>{class T{}return T.\u0275fac=function(l){return new(l||T)},T.\u0275mod=t.a4G({type:T}),T.\u0275inj=t.s3X({imports:[[S.MD,c.Sk]]}),T})()},3984:(V,A,_)=>{_.d(A,{AF:()=>u,Ib:()=>t});class t{constructor(m,c,S){this.range=m,this.name=c,this.content=S}toString(){return this.name}}class u{constructor(m,c){this.item=m,this.stringify=c}toString(){return this.stringify(this.item)}}}}]);