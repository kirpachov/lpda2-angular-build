"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[1932],{2208:(y,A,e)=>{e.d(A,{G:()=>z});var t=e(4496),T=e(9956),o=e(6504),M=e(8212),C=e(8048),S=e(5193),d=e(3797),a=e(9888),m=e(3320),l=e(6380),I=e(2740),s=e(400),h=e(3480),i=e(4680),E=e(5e3),g=e(8304),p=e(3616),P=e(6684),D=e(9212),V=e(7368),$=e(8824),G=e(1343),K=e(1560),r=e(1368),f=e(9772),O=e(964),u=e(4208),v=e(4820),B=e(7936);const U=(N,x)=>({date:N,time:x});function F(N,x){if(1&N&&(t.I0R(0,"app-reservation-tables-summary",27)(1,"p"),t.OEk(2,"Situazione tavoli per l'orario selezionato:"),t.C$Y()()),2&N){const _=t.GaO();let R;t.E7m("filters",t.IBC(1,U,_.form.value.date,null!==(R=_.utcTime())&&void 0!==R?R:""))}}function W(N,x){if(1&N){const _=t.KQA();t.I0R(0,"button",28),t.qCj("click",function(){t.usT(_);const n=t.GaO();return n.dateOpen.set(!0),t.CGJ(n.timeOpen.set(!1))}),t.I0R(1,"span",3)(2,"span",29),t.aS0(3,30),t.C$Y(),t.I0R(4,"mat-icon"),t.OEk(5,"calendar_today"),t.C$Y()()()}}let z=(()=>{class N{set item(_){_?this.form.patchValue({date:_.datetime?new s.EK(_.datetime?.getFullYear(),_.datetime?.getMonth(),_.datetime?.getDate()):null,time:_.datetime?new s.uc(_.datetime?.getHours(),_.datetime?.getMinutes()):null,fullname:_.fullname,adults:_.adults,children:_.children,email:_.email,table:_.table,notes:_.notes,phone:_.phone}):this.form.reset()}constructor(_){this.isMobile=_,this.reservationsService=(0,t.uUt)(g.S),this.publicRes=(0,t.uUt)(v.G),this.destroy$=(0,t.uUt)(h.UF),this.datePipe=(0,t.uUt)(r.y),this.formSubmit=new t._w7,this.cancelled=new t._w7,this.validTimes=(0,t.OCB)([]),this.utcTime=(0,t.OCB)(null),this.today=s.EK.currentLocal(),this.inputSize="l",this.form=new o.WC({date:new o.Ku(null,[o.AQ.required]),time:new o.Ku(null,[o.AQ.required]),fullname:new o.Ku(null,[o.AQ.required]),adults:new o.Ku(null,[o.AQ.required,o.AQ.min(0)]),children:new o.Ku(0,[o.AQ.required,o.AQ.min(0)]),email:new o.Ku(null,[o.AQ.email]),table:new o.Ku(null),notes:new o.Ku(null),phone:new o.Ku(null)}),this.loading=!1,this.dateOpen=(0,t.OCB)(!1),this.timeOpen=(0,t.OCB)(!1),this.loadingTimes=(0,t.OCB)(!1),this.submitted=!1,this.e=this.errorsFor}ngOnInit(){this.dateOpen.set(!0),this.timeOpen.set(!1),this.form.get("date").valueChanges.pipe((0,p.a)(this.destroy$),(0,P.I)(_=>_ instanceof s.EK),(0,D.y)(()=>this.dateOpen.set(!1)),(0,D.y)(()=>this.timeOpen.set(!0)),(0,D.y)(()=>this.loadingTimes.set(!0)),(0,V.G)(_=>this.publicRes.getValidTimes(_)),(0,$.U)(()=>this.loadingTimes.set(!1))).subscribe({next:_=>{const R=_.map(n=>n.valid_times).filter(n=>Array.isArray(n)&&n.length>0).flat();this.validTimes.set(R.map(n=>s.uc.fromString((0,f.CU)(n))))}}),this.form.get("time").valueChanges.pipe((0,p.a)(this.destroy$),(0,D.y)(()=>this.timeOpen.set(!1)),(0,D.y)(_=>this.utcTime.set(_?(0,f.ye)(_.toString("HH:MM")):null))).subscribe((0,G.I)())}submit(){this.submitted=!0,!this.form.invalid&&this.formSubmit.emit(this.formVal())}formVal(){const _=this.form.value;return this.form.value.date&&this.form.value.time&&(_.datetime=(0,O.Qx)(this.form.value.date,this.form.value.time)),delete _.date,delete _.time,_}errorsFor(_){const R=this.form.get(_);return R&&(R.dirty||R.touched||this.submitted)?R.errors:null}cancel(){this.cancelled.emit()}static#t=this.\u0275fac=function(R){return new(R||N)(t.GI1(i.Mv))};static#e=this.\u0275cmp=t.In1({type:N,selectors:[["app-admin-reservation-form"]],inputs:{item:"item",loading:"loading"},outputs:{formSubmit:"formSubmit",cancelled:"cancelled"},standalone:!0,features:[t.M5G([h.UF,r.y]),t.UHJ],decls:63,vars:43,consts:()=>{let _,R,n,L,Y,j,w,X,b,k,Q,J;return _="Data",R="Ora",n="Nome",L="N\xB0 adulti",Y="N\xB0 bambini",j="Email",w="Tavolo",X="Cellulare",b="Note",k="Conferma",Q="Annulla",J="Imposta data",[[3,"autocomplete","formGroup","ngSubmit"],["class","block mb-3",3,"filters"],[1,"mb-3"],[1,"flex","items-center"],[1,"me-2","grow",3,"tuiDropdownOpen","tuiAutoFocus","tuiTextfieldSize","min","formControlName"],_,["formControlName","time",1,"grow",3,"tuiDropdownOpen","tuiTextfieldSize","items"],R,["tuiButton","","appearance","icon","type","button","size","s"],[3,"errors"],[3,"tuiTextfieldSize","formControlName"],n,["tuiTextfield","","type","text",3,"autocomplete"],[1,"flex","flex-col","grow"],[1,"me-2","grow",3,"tuiTextfieldSize","formControlName"],L,[1,"ms-2","grow",3,"tuiTextfieldSize","formControlName"],Y,j,w,X,b,[1,"flex"],["tuiButton","","type","submit","size","l",1,"me-2",3,"showLoader"],k,["tuiButton","","type","button","appearance","icon","size","l",3,"showLoader","click"],Q,[1,"block","mb-3",3,"filters"],["tuiButton","","appearance","icon","type","button","size","s",3,"click"],[1,"me-1"],J]},template:function(R,n){1&R&&(t.I0R(0,"form",0),t.qCj("ngSubmit",function(){return n.submit()}),t.yuY(1,F,3,4,"app-reservation-tables-summary",1),t.I0R(2,"div",2)(3,"div",3)(4,"tui-input-date",4),t.SAx(5),t.aS0(6,5),t.k70(),t.C$Y(),t.I0R(7,"tui-input-time",6),t.SAx(8),t.aS0(9,7),t.k70(),t.C$Y()(),t.yuY(10,W,6,0,"button",8),t.wR5(11,"app-errors",9),t.C$Y(),t.I0R(12,"div",2)(13,"tui-input",10),t.SAx(14),t.aS0(15,11),t.k70(),t.wR5(16,"input",12),t.C$Y(),t.wR5(17,"app-errors",9),t.C$Y(),t.I0R(18,"div",2)(19,"div",3)(20,"div",13)(21,"tui-input-number",14),t.SAx(22),t.aS0(23,15),t.k70(),t.wR5(24,"input",12),t.C$Y(),t.wR5(25,"app-errors",9),t.C$Y(),t.I0R(26,"div",13)(27,"tui-input-number",16),t.SAx(28),t.aS0(29,17),t.k70(),t.wR5(30,"input",12),t.C$Y(),t.wR5(31,"app-errors",9),t.C$Y()()(),t.I0R(32,"div",2)(33,"tui-input",10),t.SAx(34),t.aS0(35,18),t.k70(),t.wR5(36,"input",12),t.C$Y(),t.wR5(37,"app-errors",9),t.C$Y(),t.I0R(38,"div",2)(39,"tui-input",10),t.SAx(40),t.aS0(41,19),t.k70(),t.wR5(42,"input",12),t.C$Y(),t.wR5(43,"app-errors",9),t.C$Y(),t.I0R(44,"div",2)(45,"tui-input",10),t.SAx(46),t.aS0(47,20),t.k70(),t.wR5(48,"input",12),t.C$Y(),t.wR5(49,"app-errors",9),t.C$Y(),t.I0R(50,"div",2)(51,"tui-input",10),t.SAx(52),t.aS0(53,21),t.k70(),t.wR5(54,"input",12),t.C$Y(),t.wR5(55,"app-errors",9),t.C$Y(),t.I0R(56,"div",22)(57,"button",23),t.SAx(58),t.aS0(59,24),t.k70(),t.C$Y(),t.I0R(60,"button",25),t.qCj("click",function(){return n.cancel()}),t.SAx(61),t.aS0(62,26),t.k70(),t.C$Y()()()),2&R&&(t.E7m("autocomplete","off")("formGroup",n.form),t.yG2(),t.C0Y(1,n.form.value.date&&n.utcTime()?1:-1),t.yG2(3),t.E7m("tuiDropdownOpen",n.dateOpen())("tuiAutoFocus",!0)("tuiTextfieldSize",n.inputSize)("min",n.today)("formControlName","date"),t.yG2(3),t.E7m("tuiDropdownOpen",n.timeOpen())("tuiTextfieldSize",n.inputSize)("items",n.validTimes()),t.yG2(3),t.C0Y(10,n.isMobile?10:-1),t.yG2(),t.E7m("errors",n.e("datetime")),t.yG2(2),t.E7m("tuiTextfieldSize",n.inputSize)("formControlName","fullname"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",n.e("fullname")),t.yG2(4),t.E7m("tuiTextfieldSize",n.inputSize)("formControlName","adults"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",n.e("adults")),t.yG2(2),t.E7m("tuiTextfieldSize",n.inputSize)("formControlName","children"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",n.e("children")),t.yG2(2),t.E7m("tuiTextfieldSize",n.inputSize)("formControlName","email"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",n.e("email")),t.yG2(2),t.E7m("tuiTextfieldSize",n.inputSize)("formControlName","table"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",n.e("table")),t.yG2(2),t.E7m("tuiTextfieldSize",n.inputSize)("formControlName","phone"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",n.e("phone")),t.yG2(2),t.E7m("tuiTextfieldSize",n.inputSize)("formControlName","notes"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",n.e("notes")),t.yG2(2),t.E7m("showLoader",n.loading),t.yG2(3),t.E7m("showLoader",n.loading))},dependencies:[T.g,o.sl,o.sz,o.ue,o.u,o.uW,o.Wo,M.CI,M.Kw,d.CQ,d.Oo,d.cP,B.b,C.aS,C.rD,a.Q7,a.mi,a.Qj,m.K6,l.iO,l.yc,l.Ml,I.IZ,I.iw,I.gt,E.m6,E.gJ,S.ms,S.oL,K.qL,u.u],encapsulation:2})}return N})()},1676:(y,A,e)=>{e.d(A,{s:()=>I});var t=e(4496),T=e(6772),o=e(1128),M=e(7048),C=e(8256),S=e(8392),d=e(6700),a=e(4704),m=e(9212);let I=(()=>{class s extends T.A{constructor(){super("public_data"),this.notifications=(0,t.uUt)(o.E),this.data$=new d.g(null),this.messages=(0,t.OCB)(null),this.messages$=this.data$.pipe((0,a.k)(i=>"object"==typeof i&&null!==i?function l(s){if(null==s)return null;if("object"==typeof s)return s;if(!("string"==typeof s&&s.length>0))return null;try{return JSON.parse(s)}catch{}return null}(i.public_messages):null),(0,m.y)(i=>this.messages.set(i))),this.contacts=(0,t.OCB)(null),this.contacts$=this.data$.pipe((0,a.k)(i=>"object"==typeof i&&null!==i?i.contacts:null),(0,m.y)(i=>this.contacts.set(i))),this.load(),[this.contacts$,this.messages$].forEach(i=>{i.subscribe({error:E=>{console.warn("unexpected error",E)}})})}load(){this.http.get("").subscribe({next:i=>{this.data$.next(i)},error:i=>{this.notifications.error(i instanceof M.gj?(0,C.mk)(i):S.a)}})}static#t=this.\u0275fac=function(E){return new(E||s)};static#e=this.\u0275prov=t.wxM({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()},4820:(y,A,e)=>{e.d(A,{G:()=>I});var t=e(4496),T=e(5180),o=e(6700),M=e(4704),C=e(9212),S=e(9144),d=e(6772),a=e(1676),m=e(5136),l=e(400);let I=(()=>{class s extends d.A{constructor(){super("reservations"),this.publicData=(0,t.uUt)(a.s),this.created=new o.g(null),this.publicData.data$.subscribe({next:i=>{this.created.next(i?.reservation?new T.C(i.reservation):null)}})}getValidTimes(i){let E="";return i instanceof l.EK&&(E=`${i.year}-${(i.month+1)%13}-${i.day}`),this.get("valid_times",{params:{date:E}}).pipe((0,M.k)(g=>g.map(p=>new m.e(p))))}getValidDates(i){return this.get("valid_dates",{params:i}).pipe((0,M.k)(E=>E.map(g=>l.EK.fromLocalNativeDate(new Date(g)))))}load(i){return this.get(`${i}`).pipe((0,M.k)(E=>new T.C(E.item)))}create(i){return this.post("",i).pipe((0,M.k)(E=>new T.C(E.item)),(0,C.y)(E=>this.created.next(E)),(0,S.a)(E=>{throw this.created.next(null),E}))}resendConfirmation(i){return this.post(`${i}/resend_confirmation_email`,{})}cancel(i){return this.post(`${i}/cancel`,{})}static#t=this.\u0275fac=function(E){return new(E||s)};static#e=this.\u0275prov=t.wxM({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()},6988:(y,A,e)=>{e.d(A,{E:()=>S,Q:()=>d});var t=e(4496),T=e(3480),o=e(3840),M=e(3120),C=e(3616);let S=(()=>{class a{constructor(l,I){this.el=l,this.destroy$=I}set tuiScrollIntoView(l){l&&(0,M.k)(0).pipe((0,C.a)(this.destroy$)).subscribe(()=>{this.el.nativeElement.dispatchEvent(new CustomEvent(o.dG,{bubbles:!0,detail:this.el.nativeElement}))})}}return a.\u0275fac=function(l){return new(l||a)(t.GI1(t.GMv),t.GI1(T.UF,2))},a.\u0275dir=t.Sc5({type:a,selectors:[["","tuiScrollIntoView",""]],inputs:{tuiScrollIntoView:"tuiScrollIntoView"},features:[t.M5G([T.UF])]}),a})(),d=(()=>{class a{}return a.\u0275fac=function(l){return new(l||a)},a.\u0275mod=t.a4G({type:a}),a.\u0275inj=t.s3X({}),a})()},5384:(y,A,e)=>{e.d(A,{E$:()=>G,YB:()=>K,wu:()=>$});var t=e(4496),T=e(6504),o=e(900),M=e(4392),C=e(2528),S=e(1800),d=e(3656),a=e(6988),m=e(5944),l=e(4336),I=e(1040),s=e(5657),h=e(3412),i=e(8960),E=e(5568),g=e(4704),p=e(4e3),P=e(1368);function D(r,f){if(1&r&&t.wR5(0,"tui-svg",3),2&r){const O=t.GaO();t.E7m("src",O.icons.check)("tuiScrollIntoView",!0)}}function V(r,f){1&r&&t.wR5(0,"span",4)}let $=(()=>{class r{constructor(O,u,v,B,U,F,W,z){this.icons=O,this.context=u,this.host=v,this.el=B,this.option=U,this.dataList=F,this.control=W,this.abstractControl=z,this.changeDetection$=new s.E,this.selected$=(0,h.U)(this.changeDetection$,this.control.valueChanges||i.k,(0,o.Ax)(this.el.nativeElement,"animationstart")).pipe((0,E.W)(null),(0,g.k)(()=>this.selected),(0,p.a)())}get matcher(){return this.host.identityMatcher||M.y}ngOnInit(){Promise.resolve().then(()=>{var O,u;(0,C.kF)(this.option.value)&&!this.option.disabled&&(null===(u=(O=this.host).checkOption)||void 0===u||u.call(O,this.option.value))})}ngDoCheck(){this.changeDetection$.next()}get value(){var O,u;return null!==(u=null===(O=this.abstractControl)||void 0===O?void 0:O.value)&&void 0!==u?u:this.control.value}get selected(){return(0,C.kF)(this.option.value)&&(0,C.kF)(this.value)&&this.matcher(this.value,this.option.value)}}return r.\u0275fac=function(O){return new(O||r)(t.GI1(m.QJ),t.GI1(I.C0),t.GI1(m.u2),t.GI1(t.GMv),t.GI1(l.sP),t.GI1(l.yi,8),t.GI1(T.eq),t.GI1(S._y,8))},r.\u0275cmp=t.In1({type:r,selectors:[["tui-select-option"]],decls:5,vars:5,consts:[[3,"ngTemplateOutlet"],["automation-id","tui-select-option__checkmark","class","t-checkmark",3,"src","tuiScrollIntoView",4,"ngIf","ngIfElse"],["dummy",""],["automation-id","tui-select-option__checkmark",1,"t-checkmark",3,"src","tuiScrollIntoView"],[1,"t-dummy"]],template:function(O,u){if(1&O&&(t.C_f(0,0),t.yuY(1,D,1,2,"tui-svg",1),t.wVc(2,"async"),t.yuY(3,V,1,0,"ng-template",null,2,t.gJz)),2&O){const v=t.Gew(4);t.E7m("ngTemplateOutlet",u.context.$implicit),t.yG2(),t.E7m("ngIf",t.kDX(2,3,u.selected$))("ngIfElse",v)}},dependencies:[d.Wu,P.XV,P.u_,a.E,P.a],styles:['@keyframes _ngcontent-%COMP%_retrigger{0%{left:1px}to{left:2px}}[_nghost-%COMP%]{display:flex;flex:1;align-items:center;max-width:100%;animation:_ngcontent-%COMP%_retrigger 1s}.t-checkmark[_ngcontent-%COMP%]{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-border-start:.25rem solid transparent;border-inline-start:.25rem solid transparent}tui-data-list[data-list-size="s"][_nghost-%COMP%]   .t-checkmark[_ngcontent-%COMP%], tui-data-list[data-list-size="s"]   [_nghost-%COMP%]   .t-checkmark[_ngcontent-%COMP%]{-webkit-margin-end:-.375rem;margin-inline-end:-.375rem}tui-data-list[data-list-size="m"][_nghost-%COMP%]   .t-checkmark[_ngcontent-%COMP%], tui-data-list[data-list-size="m"]   [_nghost-%COMP%]   .t-checkmark[_ngcontent-%COMP%]{-webkit-margin-end:-.125rem;margin-inline-end:-.125rem}.t-dummy[_ngcontent-%COMP%]{width:1.75rem}'],changeDetection:0}),r})();const G=new I.WO($);let K=(()=>{class r{}return r.\u0275fac=function(O){return new(O||r)},r.\u0275mod=t.a4G({type:r}),r.\u0275inj=t.s3X({imports:[[P.MD,d.Yt,a.Q]]}),r})()}}]);