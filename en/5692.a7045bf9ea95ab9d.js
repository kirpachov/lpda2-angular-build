"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[5692],{9064:(g,O,t)=>{t.d(O,{w:()=>$});var e=t(4496),u=t(6504),E=t(3480),c=t(6700),a=t(3616),s=t(6684),i=t(3797),r=t(8588),f=t(1368),m=t(9956),S=t(1292);function N(R,T){if(1&R&&(e.I0R(0,"tui-textarea",2),e.OEk(1),e.C$Y()),2&R){const l=e.GaO().$implicit,d=e.GaO();e.E7m("formControl",l.control),e.yG2(),e.oRS(" ",d.getFullLang(l.lang)," ")}}function I(R,T){if(1&R&&(e.I0R(0,"tui-input",2),e.OEk(1),e.C$Y()),2&R){const l=e.GaO().$implicit,d=e.GaO();e.E7m("formControl",l.control),e.yG2(),e.oRS(" ",d.getFullLang(l.lang)," ")}}const y=R=>({"mb-3":R});function A(R,T){if(1&R&&(e.SAx(0),e.I0R(1,"div",1),e.yuY(2,N,2,2,"tui-textarea",2)(3,I,2,2),e.wR5(4,"app-errors",3),e.C$Y(),e.k70()),2&R){const l=T.$implicit,d=T.last,C=e.GaO();e.yG2(),e.E7m("ngClass",e.S45(3,y,!d)),e.yG2(),e.C0Y(2,C.long?2:3),e.yG2(2),e.E7m("errors",l.control.errors)}}const P=["*"];let $=(()=>{class R{constructor(){this.destroy$=new E.UF,this.long=!1,this.controls=(0,e.OCB)({}),this.controlsArr=(0,e.S6b)(()=>{const l=this.controls();return Object.keys(l).map(d=>({lang:d,control:l[d]}))}),this.touched$=new c.g(!1),this.value$=new c.g({})}ngAfterViewInit(){this.addLang("it"),this.addLang("en")}ngOnInit(){}registerOnChange(l){this.value$.pipe((0,a.a)(this.destroy$)).subscribe({next:d=>l(d)})}registerOnTouched(l){this.touched$.pipe((0,s.I)(d=>!0===d)).subscribe({next:()=>l()})}writeValue(l){this.patchValue(l??{}),this.touched$.next(!1)}wasTouched(){this.touched$.next(!0)}getFullLang(l){return S.S[l]??l}controlChanged(l){this.value$.next({...this.value$.value,[l]:this.controls()[l].value})}patchValue(l){Object.keys(l).forEach(d=>this.addLang(d)),Object.keys(this.controls()).forEach(d=>{this.controls()[d].patchValue(l[d]??null)})}addLang(l){if(this.controls()[l])return;const d=new u.Ku;d.valueChanges.subscribe({next:()=>this.controlChanged(l)}),this.controls.set({...this.controls(),[l]:d})}static#e=this.\u0275fac=function(d){return new(d||R)};static#t=this.\u0275cmp=e.In1({type:R,selectors:[["app-i18n-input"]],inputs:{long:"long"},standalone:!0,features:[e.M5G([{provide:u.Y6,useExisting:(0,e.wd)(()=>R),multi:!0},E.UF]),e.UHJ],ngContentSelectors:P,decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"ngClass"],[3,"formControl"],[3,"errors"]],template:function(d,C){1&d&&(e.kPM(),e._Xx(0),e.yuY(1,A,5,5,"ng-container",0)),2&d&&(e.yG2(),e.E7m("ngForOf",C.controlsArr()))},dependencies:[u.sl,u.ue,u.ug,i.CQ,i.Oo,i.cP,f.Iw,m.g,f.QF,r.Y3,r.wp,r.kd],changeDetection:0})}return R})()},2192:(g,O,t)=>{t.d(O,{c:()=>K});var e=t(4496),u=t(1128),E=t(3480),c=t(7692),a=t(8212),s=t(9064),i=t(6504),r=t(1560),f=t(964),m=t(6380),S=t(9956),N=t(1368),I=t(5136),y=t(2516),A=t(7556),P=t(6732),$=t(466),R=t(5193),T=t(1673),l=t(6528),d=t(3616),C=t(8824),F=t(4704),b=t(9144),L=t(2700);const w=(M,h)=>h.id;function x(M,h){if(1&M){const n=e.KQA();e.I0R(0,"div",7)(1,"tui-checkbox-block",8),e.qCj("ngModelChange",function(){e.usT(n);const o=e.GaO().$implicit,p=e.GaO(2);return e.CGJ(p.triggerSelection(o.id))}),e.OEk(2),e.C$Y()()}if(2&M){const n=e.GaO().$implicit,_=e.GaO(2);e.yG2(),e.E7m("readOnly",_.disabled())("ngModel",_.selections().includes(n.id)),e.yG2(),e.oRS(" ",n.name," ")}}function V(M,h){1&M&&e.yuY(0,x,3,3,"div",6),2&M&&e.C0Y(0,h.$implicit.id?0:-1)}function z(M,h){if(1&M&&(e.I0R(0,"tr",2)(1,"td",3)(2,"p",4),e.OEk(3),e.wVc(4,"weekday"),e.C$Y()(),e.I0R(5,"td",3)(6,"div",5),e.c53(7,V,1,1,null,null,w),e.C$Y()()()),2&M){const n=h.$implicit,_=e.GaO();e.yG2(3),e.cNF(e.kDX(4,1,n)),e.yG2(4),e.oho(_.turnsPerDay()[n])}}let B=(()=>{class M{constructor(){this.turnsService=(0,e.uUt)(A.K),this.destroy$=(0,e.uUt)(E.UF),this.date=(0,e.uUt)(N.y),this.selectionsChanges=new e._w7,this.loading=(0,e.OCB)(!1),this.selections=(0,e.OCB)([]),this.disabled=(0,e.OCB)(!1),this.allTurns=(0,e.OCB)([]),this.turnsPerDay=(0,e.S6b)(()=>{const n=this.allTurns().filter(o=>null!=o.weekday),_={};for(const o of n){if(null==o.weekday||null==o.weekday)throw new Error("Turns must have a weekday");_[o.weekday]||=[],_[o.weekday].push(o)}return _}),this.weekdays=(0,e.S6b)(()=>Object.keys(this.turnsPerDay()).map(Number))}ngOnInit(){this.searchTurns()}writeValue(n){Array.isArray(n)||(n=[n]),n=n.filter(o=>null!=o&&null!=o);const _=[];n.forEach(o=>{o instanceof I.e&&o.id?_.push(o.id):"number"==typeof o?_.push(o):"object"==typeof o&&null!=o&&Object.keys(o).includes("id")&&"number"==typeof o.id?_.push(o.id):console.warn("invalid object provided to SelectTurnsComponent",n)}),this.selections.set(_)}registerOnChange(n){this.selectionsChanges.subscribe(n)}registerOnTouched(n){this.selectionsChanges.subscribe(n)}setDisabledState(n){this.disabled.set(n)}triggerSelection(n){this.selections.update(_=>{const o=_.indexOf(n);return-1!=o?_.splice(o,1):_.push(n),_}),this.emitChanges()}searchTurns(){this.loading.set(!0),this.turnsService.search({per_page:1e3}).pipe((0,d.a)(this.destroy$),(0,C.U)(()=>this.loading.set(!1)),(0,F.k)(n=>n.items),(0,b.a)(n=>(console.error(n),(0,L.of)([])))).subscribe({next:n=>{this.allTurns.set(n)}})}emitChanges(){this.selectionsChanges.emit(this.allTurns().filter(n=>"number"==typeof n.id&&this.selections().includes(n.id)))}static#e=this.\u0275fac=function(_){return new(_||M)};static#t=this.\u0275cmp=e.In1({type:M,selectors:[["app-select-turns"]],outputs:{selectionsChanges:"selectionsChanges"},standalone:!0,features:[e.M5G([{provide:i.Y6,multi:!0,useExisting:(0,e.wd)(()=>M)},E.UF]),e.UHJ],decls:5,vars:2,consts:[["size","xl",3,"overlay","showLoader"],[1,"tui-table"],[1,"tui-table__tr","tui-table__tr_border_none"],[1,"tui-table__td"],[1,"text-xl"],[1,"flex","flex-col"],["class","flex flex-row items-center mb-5"],[1,"flex","flex-row","items-center","mb-5"],[1,"me-1",3,"readOnly","ngModel","ngModelChange"],["class","tui-table__tr tui-table__tr_border_none"]],template:function(_,o){1&_&&(e.I0R(0,"tui-loader",0)(1,"table",1)(2,"tbody"),e.c53(3,z,9,3,"tr",9,e.oxv),e.C$Y()()()),2&_&&(e.E7m("overlay",!0)("showLoader",o.loading()),e.yG2(3),e.oho(o.weekdays()))},dependencies:[y.G,l.i,l.I,i.y,i.ue,i._G,c.Sk,c.Cb,$.GE,R.ms,T.y,a.CI,P.kR],encapsulation:2,changeDetection:0})}return M})(),K=(()=>{class M{constructor(){this.notifications=(0,e.uUt)(u.E),this.onSubmit=new e._w7,this.onCancel=new e._w7,this.loading=!1,this.submitted=(0,e.OCB)(!1),this.form=new i.WC({from_date:new i.Ku(null),to_date:new i.Ku(null),message:new i.Ku(null),turns:new i.Ku([])})}set data(n){null!=n&&null!=n?this.form.patchValue({from_date:"string"==typeof n.from_date?(0,f.yc)(n.from_date):n.from_date,to_date:"string"==typeof n.to_date?(0,f.yc)(n.to_date):n.to_date,message:n.translations?.message||{},turns:n.turns}):this.form.reset()}submitForm(){this.submitted.set(!0),!this.form.invalid&&this.onSubmit.emit(this.formatOutput())}cancelForm(){this.onCancel.emit()}formatOutput(){if(this.form.invalid)throw new Error("Form is invalid");return{from_date:this.form.value.from_date||null,to_date:this.form.value.to_date||null,translations:this.form.value.message||{},turns:this.form.value.turns??[]}}static#e=this.\u0275fac=function(_){return new(_||M)};static#t=this.\u0275cmp=e.In1({type:M,selectors:[["app-reservation-turn-message-form"]],inputs:{loading:"loading",data:"data"},outputs:{onSubmit:"onSubmit",onCancel:"onCancel"},standalone:!0,features:[e.M5G([E.UF]),e.UHJ],decls:32,vars:9,consts:()=>{let n,_,o,p,G,D,U;return n="Message to display",_="Visible from the day",o="visible until the day",p="\n           The first and last day in question are both included. So, if you want\n          to display a message for just one day, select the same day in both\n          fields. \n        ",G="For which shifts to show the message?",D="Confirm",U="Cancel",[[1,"block","mb-3",3,"formGroup","ngSubmit"],[1,"block","mb-3"],[3,"formControl"],n,[3,"errors"],[1,"block","mb-1"],[1,"flex","items-center"],[1,"grow","me-1"],_,[1,"grow","ms-1"],o,[1,"block","mb-3","text-slate-400"],p,[1,"text-2xl"],G,["tuiButton","","type","submit",1,"inline-block"],D,["tuiButton","","type","button","appearance","icon",1,"inline-block",3,"click"],U]},template:function(_,o){1&_&&(e.I0R(0,"form",0),e.qCj("ngSubmit",function(){return o.submitForm()}),e.I0R(1,"div",1)(2,"app-i18n-input",2),e.SAx(3),e.aS0(4,3),e.k70(),e.C$Y(),e.wR5(5,"app-errors",4),e.C$Y(),e.I0R(6,"div",5)(7,"div",6)(8,"div",7)(9,"tui-input-date",2),e.SAx(10),e.aS0(11,8),e.k70(),e.C$Y(),e.wR5(12,"app-errors",4),e.C$Y(),e.I0R(13,"div",9)(14,"tui-input-date",2),e.SAx(15),e.aS0(16,10),e.k70(),e.C$Y(),e.wR5(17,"app-errors",4),e.C$Y()()(),e.I0R(18,"span",11),e.aS0(19,12),e.C$Y(),e.I0R(20,"div",1)(21,"h3",13),e.aS0(22,14),e.C$Y(),e.wR5(23,"app-select-turns",2)(24,"app-errors",4),e.C$Y(),e.I0R(25,"div",1)(26,"button",15),e.SAx(27),e.aS0(28,16),e.k70(),e.C$Y(),e.I0R(29,"button",17),e.qCj("click",function(){return o.cancelForm()}),e.SAx(30),e.aS0(31,18),e.k70(),e.C$Y()()()),2&_&&(e.E7m("formGroup",o.form),e.yG2(2),e.E7m("formControl",o.form.controls.message),e.yG2(3),e.E7m("errors",o.form.controls.message.errors),e.yG2(4),e.E7m("formControl",o.form.controls.from_date),e.yG2(3),e.E7m("errors",o.form.controls.from_date.errors),e.yG2(2),e.E7m("formControl",o.form.controls.to_date),e.yG2(3),e.E7m("errors",o.form.controls.to_date.errors),e.yG2(6),e.E7m("formControl",o.form.controls.turns),e.yG2(),e.E7m("errors",o.form.controls.turns.errors))},dependencies:[c.Sk,s.w,i.y,i.sz,i.ue,i.u,r.oB,a.CI,a.Kw,i.sl,i.ug,i.uW,m.iO,m.yc,m.Ml,S.g,B],encapsulation:2,changeDetection:0})}return M})()},1292:(g,O,t)=>{t.d(O,{S:()=>e});const e={it:"Italian",en:"English",es:"Spanish",fr:"French",de:"German",pt:"Portuguese",ru:"Russian",zh:"Chinese",ja:"Japanese",ar:"Arabic",hi:"Hindi",bn:"Bengali",pa:"Punjabi",ms:"Malaysian"}},9772:(g,O,t)=>{t.d(O,{CU:()=>u,ye:()=>E});const e=(new Date).getTimezoneOffset()/60;function u(c,a=e){return"string"==typeof c&&c.length>0&&c.match(/\d{1,2}:\d{1,2}/)?`${Number(c.split(":")[0])-a}:${c.split(":")[1]}`:(console.error("Invalid string provided to strTimeTimezone",{string:c}),"")}function E(c,a=e){return u(c,-1*a)}},1960:(g,O,t)=>{t.d(O,{u:()=>c});var e=t(8400),u=t(5136);class E extends e.w{constructor(s){super(s),this.date=s.date?new Date(s.date):void 0,this.reservation_turn_id=s.reservation_turn_id,this.group_id=s.group_id,this.reservation_turn=s.reservation_turn?new u.e(s.reservation_turn):void 0}}class c extends e.w{constructor(s){super(s),this.turns=[],this.dates=[],this.title=s.title,this.status=s.status,this.preorder_type=s.preorder_type,this.payment_value=s.payment_value,this.message=s.message,this.turns=(s.turns||[]).map(i=>new u.e(i)),this.dates=(s.dates||[]).map(i=>new E(i)),this.translations=s.translations||{}}}},5136:(g,O,t)=>{t.d(O,{e:()=>c});var e=t(8400),u=t(9772),E=t(1960);class c extends e.w{constructor(s){super(s),this.messages=[],this.name=s.name,this.weekday=s.weekday,this.step=s.step,this.valid_times=s.valid_times,this.starts_at=s.starts_at?(0,u.CU)(s.starts_at):void 0,this.ends_at=s.ends_at?(0,u.CU)(s.ends_at):void 0,this.preorder_reservation_group=s.preorder_reservation_group?new E.u(s.preorder_reservation_group):void 0,this.messages=s.messages}}},2516:(g,O,t)=>{t.d(O,{G:()=>u});var e=t(4496);let u=(()=>{class E{constructor(){this.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}transform(a){return"number"!=typeof a&&"string"==typeof a&&(a=parseInt(a)),"number"==typeof a&&a>=0&&a<=6?this.weekdays[a]:null}static#e=this.\u0275fac=function(s){return new(s||E)};static#t=this.\u0275pipe=e.UTH({name:"weekday",type:E,pure:!0,standalone:!0})}return E})()},1260:(g,O,t)=>{t.d(O,{U:()=>s});var e=t(6012),u=t(8400),E=t(5136);class c extends u.w{constructor(r){super(r),this.message=r.message,this.from_date=r.from_date,this.to_date=r.to_date,this.translations=r.translations,this.turns=r.turns?r.turns.map(f=>new E.e(f)):[]}}var a=t(4496);let s=(()=>{class i extends e.s{constructor(){super(c,"admin/reservation_turn_messages")}create(f){return super.create(f)}update(f,m){return super.update(f,m)}static#e=this.\u0275fac=function(m){return new(m||i)};static#t=this.\u0275prov=a.wxM({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},7556:(g,O,t)=>{t.d(O,{K:()=>c});var e=t(6012),u=t(5136),E=t(4496);let c=(()=>{class a extends e.s{constructor(){super(u.e,"admin/reservation_turns")}static#e=this.\u0275fac=function(r){return new(r||a)};static#t=this.\u0275prov=E.wxM({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()},1200:(g,O,t)=>{t.d(O,{A:()=>s,m:()=>i});var e=t(4496),u=t(900),E=t(3480),c=t(800),a=t(3616);let s=(()=>{class r{constructor(m,S,N){this.el=m,this.zone=S,this.destroy$=N,this.eventName=""}ngOnInit(){(0,c.w)(this.el.nativeElement,this.eventName,{passive:!1}).pipe((0,u.Uv)(this.zone),(0,u.uy)(),(0,a.a)(this.destroy$)).subscribe()}}return r.\u0275fac=function(m){return new(m||r)(e.GI1(e.GMv),e.GI1(e.WW2),e.GI1(E.UF,2))},r.\u0275dir=e.Sc5({type:r,selectors:[["","tuiPreventDefault",""]],inputs:{eventName:[e.Wk5.None,"tuiPreventDefault","eventName"]},features:[e.M5G([E.UF])]}),r})(),i=(()=>{class r{}return r.\u0275fac=function(m){return new(m||r)},r.\u0275mod=e.a4G({type:r}),r.\u0275inj=e.s3X({}),r})()},6988:(g,O,t)=>{t.d(O,{E:()=>s,Q:()=>i});var e=t(4496),u=t(3480),E=t(3840),c=t(3120),a=t(3616);let s=(()=>{class r{constructor(m,S){this.el=m,this.destroy$=S}set tuiScrollIntoView(m){m&&(0,c.k)(0).pipe((0,a.a)(this.destroy$)).subscribe(()=>{this.el.nativeElement.dispatchEvent(new CustomEvent(E.dG,{bubbles:!0,detail:this.el.nativeElement}))})}}return r.\u0275fac=function(m){return new(m||r)(e.GI1(e.GMv),e.GI1(u.UF,2))},r.\u0275dir=e.Sc5({type:r,selectors:[["","tuiScrollIntoView",""]],inputs:{tuiScrollIntoView:"tuiScrollIntoView"},features:[e.M5G([u.UF])]}),r})(),i=(()=>{class r{}return r.\u0275fac=function(m){return new(m||r)},r.\u0275mod=e.a4G({type:r}),r.\u0275inj=e.s3X({}),r})()}}]);