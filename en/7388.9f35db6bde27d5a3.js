"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[7388],{7388:(Ge,M,s)=>{s.r(M),s.d(M,{ListSettingsComponent:()=>de});var e=s(4496),p=s(3480),N=s(8824),q=s(3616),Z=s(1128),L=s(8256),A=s(8392),ee=s(2760),E=s(6052),a=s(6504),ne=s(1292),m=s(7364),te=s(5193),ie=s(7728),_e=s(6772);let oe=(()=>{class _ extends _e.A{constructor(){super("/admin/settings")}search(t={}){return this.http.get("/")}show(t){return this.http.get(`/${t}`)}value(t){return this.http.get(`/${t}/value`)}update(t,o){return"object"==typeof o&&null!=o&&(o=JSON.stringify(o)),this.http.patch(`/${t}`,{value:o})}static#e=this.\u0275fac=function(o){return new(o||_)};static#n=this.\u0275prov=e.wxM({token:_,factory:_.\u0275fac,providedIn:"root"})}return _})();var I=s(8048),c=s(5188),g=s(9308),d=s(7372),G=s(7936),Se=s(4336);function ae(_,u){if(1&_&&e.wR5(0,"tui-data-list-wrapper",4),2&_){const t=e.GaO();e.E7m("emptyContent",t.noItemsContent)("itemContent",t.itemContent)("items",t.shownItems)}}const Te=["*"];let se=(()=>{class _ extends g.A{constructor(){super(...arguments),this.items=[],this.shownItems=[],this.itemContent=t=>this.stringifyFn(t.$implicit),this.noItemsContent="No element found.",this.search="",this.stringifyFn=t=>t}ngOnChanges(t){super.ngOnChanges(t),t.items&&(this.shownItems=this.items),t.search&&this.onSearchChange(this.search)}onSearchChange(t){this.search=t,this.shownItems=this.items.filter(o=>o.toLowerCase().includes((this.search??"").toLowerCase()))}static#e=this.\u0275fac=(()=>{let t;return function(n){return(t||(t=e.otF(_)))(n||_)}})();static#n=this.\u0275cmp=e.In1({type:_,selectors:[["app-preferences-select"]],inputs:{items:"items",itemContent:"itemContent",noItemsContent:"noItemsContent",stringifyFn:"stringifyFn"},standalone:!0,features:[e.M5G([p.UF,{provide:a.Y6,useExisting:(0,e.wd)(()=>_),multi:!0}]),e.eg9,e.SYr,e.UHJ],ngContentSelectors:Te,decls:5,vars:5,consts:[[1,"mb-2",3,"tuiTextfieldSize","formControl","stringify"],["tuiTextfield","",3,"placeholder"],[3,"emptyContent","itemContent","items",4,"tuiDataList"],[3,"expanded","submit","cancel"],[3,"emptyContent","itemContent","items"]],template:function(o,n){1&o&&(e.kPM(),e.I0R(0,"tui-select",0),e._Xx(1),e.wR5(2,"input",1),e.yuY(3,ae,1,3,"tui-data-list-wrapper",2),e.C$Y(),e.I0R(4,"app-submit-expand",3),e.qCj("submit",function(){return n.emitSubmit()})("cancel",function(){return n.resetInitialValue()}),e.C$Y()),2&o&&(e.E7m("tuiTextfieldSize",n.inputSize)("formControl",n.control)("stringify",n.stringifyFn),e.yG2(2),e.E7m("placeholder",n.placeholder),e.yG2(2),e.E7m("expanded",n.somethingChanged()))},dependencies:[I.aS,I.rD,a.sl,a.ue,a.ug,c.my,c.cP,c.uO,G.b,E.q8,E.OO,Se.Ux,d.Q],encapsulation:2})}return _})();var C=s(9888);const re=["*"];let le=(()=>{class _ extends g.A{constructor(){super(...arguments),this.postfix=""}static#e=this.\u0275fac=(()=>{let t;return function(n){return(t||(t=e.otF(_)))(n||_)}})();static#n=this.\u0275cmp=e.In1({type:_,selectors:[["app-preferences-number-input"]],inputs:{mandatory:"mandatory",inputSize:"inputSize",placeholder:"placeholder",postfix:"postfix"},outputs:{submit:"submit",valueChange:"valueChange"},standalone:!0,features:[e.M5G([p.UF,{provide:a.Y6,useExisting:(0,e.wd)(()=>_),multi:!0}]),e.eg9,e.UHJ],ngContentSelectors:re,decls:4,vars:4,consts:[[1,"mb-2",3,"tuiTextfieldPostfix","formControl","tuiTextfieldSize"],["tuiTextfield",""],[3,"expanded","submit","cancel"]],template:function(o,n){1&o&&(e.kPM(),e.I0R(0,"tui-input-number",0),e._Xx(1),e.wR5(2,"input",1),e.C$Y(),e.I0R(3,"app-submit-expand",2),e.qCj("submit",function(){return n.emitSubmit()})("cancel",function(){return n.resetInitialValue()}),e.C$Y()),2&o&&(e.E7m("tuiTextfieldPostfix",n.postfix)("formControl",n.control)("tuiTextfieldSize",n.inputSize),e.yG2(3),e.E7m("expanded",n.somethingChanged()))},dependencies:[C.Q7,C.mi,C.Qj,G.b,a.sl,a.ue,a.ug,I.aS,I.rD,I.We,d.Q],encapsulation:2})}return _})();var f=s(3797);const Ie=["*"];let ue=(()=>{class _ extends g.A{static#e=this.\u0275fac=(()=>{let t;return function(n){return(t||(t=e.otF(_)))(n||_)}})();static#n=this.\u0275cmp=e.In1({type:_,selectors:[["app-preferences-text-input"]],inputs:{mandatory:"mandatory",inputSize:"inputSize",placeholder:"placeholder"},outputs:{submit:"submit",valueChange:"valueChange"},standalone:!0,features:[e.M5G([p.UF,{provide:a.Y6,useExisting:(0,e.wd)(()=>_),multi:!0}]),e.eg9,e.UHJ],ngContentSelectors:Ie,decls:4,vars:3,consts:[[1,"mb-2",3,"formControl","tuiTextfieldSize"],["tuiTextfield",""],[3,"expanded","submit","cancel"]],template:function(o,n){1&o&&(e.kPM(),e.I0R(0,"tui-input",0),e._Xx(1),e.wR5(2,"input",1),e.C$Y(),e.I0R(3,"app-submit-expand",2),e.qCj("submit",function(){return n.emitSubmit()})("cancel",function(){return n.resetInitialValue()}),e.C$Y()),2&o&&(e.E7m("formControl",n.control)("tuiTextfieldSize",n.inputSize),e.yG2(3),e.E7m("expanded",n.somethingChanged()))},dependencies:[f.CQ,f.Oo,f.cP,G.b,I.aS,I.rD,a.sl,a.ue,a.ug,d.Q],encapsulation:2})}return _})();var pe=s(4476);function Ne(_,u){1&_&&(e.SAx(0),e.aS0(1,40),e.k70())}function Ee(_,u){1&_&&(e.SAx(0),e.aS0(1,41),e.k70())}function me(_,u){1&_&&(e.SAx(0),e.aS0(1,42),e.k70())}function ce(_,u){1&_&&e.yuY(0,Ee,2,0,"ng-container")(1,me,2,0),2&_&&e.C0Y(0,"true"===u.$implicit?0:1)}function ge(_,u){1&_&&(e.OEk(0),e.wVc(1,"language")),2&_&&e.cNF(e.kDX(1,1,u.$implicit))}let de=(()=>{class _{constructor(){this.service=(0,e.uUt)(oe),this.destroy$=(0,e.uUt)(p.UF),this.notifications=(0,e.uUt)(Z.E),this._=(0,e.uUt)(pe.OY).setTitle("System settings | La Porta D'Acqua"),this.languagePipe=(0,e.uUt)(m.e),this.allLanguages=Object.keys(ne.S),this.trueFalse=["true","false"],this.form=new a.WC({available_locales:new a.Ku([]),default_language:new a.Ku(null),max_people_per_reservation:new a.Ku(null),email_contacts:new a.Ku({}),reservation_max_days_in_advance:new a.Ku(null),reservation_min_hours_in_advance:new a.Ku(null),cover_price:new a.Ku(null),instagram_landing_page_url:new a.Ku(null),reservation_min_hours_advance_cancel:new a.Ku(null),nexi_auto_refund_cancelled_reservations:new a.Ku(null)}),this.saving=(0,e.OCB)(!1),this.searching=(0,e.OCB)(!1),this.loading=(0,e.S6b)(()=>this.saving()||this.searching()),this.inputSize="l"}ngOnInit(){this.reload()}save(t,o){this.saving.set(!0),Array.isArray(o)&&(o=o.join(",")),this.service.update(t,o).pipe((0,N.U)(()=>this.saving.set(!1)),(0,N.U)(()=>this.reload())).subscribe({error:n=>{this.notifications.error((0,L.mk)(n)||A.a)}})}applyPipeFunction(t){return t.transform}reload(){this.searching.set(!0),this.service.search().pipe((0,q.a)(this.destroy$),(0,N.U)(()=>this.searching.set(!1))).subscribe({next:t=>{this.updateFormByData(t.items)},error:t=>{this.notifications.error((0,L.mk)(t)||A.a)}})}updateFormByData(t){const o={};["available_locales"].forEach(i=>{const T=t.find(l=>l.key===i);T&&Array.isArray(T.value)?o[i]=T.value:T&&"string"==typeof T.value?o[i]=T.value.split(","):T?console.warn(`Setting ${i} not found or invalid`,T.value):console.warn(`Setting ${i} not found`)}),["default_language","instagram_landing_page_url","nexi_auto_refund_cancelled_reservations"].forEach(i=>{const T=t.find(l=>l.key===i);T&&"string"==typeof T.value?o[i]=T.value:T?console.warn(`Setting ${i} not found or invalid`,T.value):console.warn(`Setting ${i} not found`)}),["max_people_per_reservation","reservation_max_days_in_advance","reservation_min_hours_in_advance","cover_price","reservation_min_hours_advance_cancel"].forEach(i=>{const T=t.find(l=>l.key===i);T&&"string"==typeof T.value&&T.value.length>0?o[i]=Number(T.value):T&&"number"==typeof T.value?o[i]=T.value:T?console.warn(`Setting ${i} not found or invalid`,T.value):console.warn(`Setting ${i} not found`)});const n=[],r=t.filter(i=>!o.hasOwnProperty(i.key)&&!n.includes(i.key));r.length>0&&((0,e.sPQ)()&&this.notifications.error(`Unmanaged settings: ${r.map(i=>i.key).join(", ")}`),console.warn(`Unmanaged settings: ${r.map(i=>i.key).join(", ")}`,r)),this.form.patchValue(o)}static#e=this.\u0275fac=function(o){return new(o||_)};static#n=this.\u0275cmp=e.In1({type:_,selectors:[["app-list-settings"]],standalone:!0,features:[e.M5G([p.UF,m.e]),e.UHJ],decls:83,vars:34,consts:()=>{let t,o,n,r,i,T,l,P,$,v,R,O,h,z,y,D,b,X,F,x,Y,w,U,j,Q,K,B,J,k,V,H,W;return t="System settings",o="These settings will be applied to the entire site and its members.",n="Default language",r="What is the default language of the system?",i="Select the default language.",T="Automatic refund for bookings canceled on time.",l="\n           If a user books and pays for the reservation, at the moment they\n          cancel the reservation before the deadline, should the payment be\n          automatically refunded? \n        ",P="Is automatic reversal active?",$="System languages",v="\n           Which languages do you want to support? The \"static\" parts like web\n          pages will not be automatically translated into additional languages,\n          but the \"dynamic\" parts such as names and menu descriptions can be\n          translated at any time by the staff. \n        ",R="Select many languages.",O="Maximum number of people per reservation",h="When a user makes a reservation, how many people can they select at most?",z="Enter the maximum number of people per single reservation.",y="Minimum deposit to cancel a reservation.",D="Specify how many hours in advance the user can cancel the booking.",b="Minimum hours in advance.",X="Maximum reservation advance",F="\n           Reservations can be made up to a limit of \n          " + "\ufffd0\ufffd" + "\n           days from today. \n        ",x="Maximum advance days for new bookings.",Y="Minimum advance for new reservations",w="\n           If set to zero, people will be able to book in real-time for the same\n          time, otherwise at least \n          " + "\ufffd0\ufffd" + "\n           hours after the current time. \n        ",U="Minimum advance hours to create new reservations.",j="Cover charge",Q="\n           If set to a number greater than zero, it will be shown where\n          necessary. Otherwise, it will be hidden. \n        ",K="Cover charge.",B="Shared link to the Instagram post",J="\n           The post in question will be visible on the homepage if set. If\n          absent, the Instagram section will not be displayed on the webpage. \n        ",k="Instagram post sharing link.",V="No element",H="Active",W="Inactive",[["noItems",""],t,[1,"text-slate-400","mb-3"],o,[3,"formGroup"],[1,"mb-4"],[1,"text-lg","font-bold"],n,[1,"text-slate-400"],r,[3,"formControlName","items","itemContent","stringifyFn","inputSize","submit"],i,T,l,["trueFalseEnabledContent",""],P,$,v,["languageItemContent",""],R,O,h,[3,"formControlName","inputSize","submit"],z,y,D,[3,"formControlName","inputSize","postfix","submit"],b,X,F,x,Y,w,U,j,Q,K,B,J,k,V,H,W]},template:function(o,n){if(1&o&&(e.yuY(0,Ne,2,0,"ng-template",null,0,e.gJz),e.I0R(2,"h1"),e.aS0(3,1),e.C$Y(),e.I0R(4,"p",2),e.aS0(5,3),e.C$Y(),e.I0R(6,"form",4)(7,"div",5)(8,"p",6),e.aS0(9,7),e.C$Y(),e.I0R(10,"p",8),e.aS0(11,9),e.C$Y(),e.I0R(12,"app-preferences-select",10),e.qCj("submit",function(i){return n.save("default_language",i)}),e.SAx(13),e.aS0(14,11),e.k70(),e.C$Y()(),e.I0R(15,"div",5)(16,"p",6),e.aS0(17,12),e.C$Y(),e.I0R(18,"p",8),e.aS0(19,13),e.C$Y(),e.yuY(20,ce,2,1,"ng-template",null,14,e.gJz),e.I0R(22,"app-preferences-select",10),e.qCj("submit",function(i){return n.save("nexi_auto_refund_cancelled_reservations",i)}),e.SAx(23),e.aS0(24,15),e.k70(),e.C$Y()(),e.I0R(25,"div",5)(26,"p",6),e.aS0(27,16),e.C$Y(),e.I0R(28,"p",8),e.aS0(29,17),e.C$Y(),e.yuY(30,ge,2,3,"ng-template",null,18,e.gJz),e.I0R(32,"app-preferences-multiple-select",10),e.qCj("submit",function(i){return n.save("available_locales",i)}),e.SAx(33),e.aS0(34,19),e.k70(),e.C$Y()(),e.I0R(35,"div",5)(36,"p",6),e.aS0(37,20),e.C$Y(),e.I0R(38,"p",8),e.aS0(39,21),e.C$Y(),e.I0R(40,"app-preferences-number-input",22),e.qCj("submit",function(i){return n.save("max_people_per_reservation",i)}),e.SAx(41),e.aS0(42,23),e.k70(),e.C$Y()(),e.I0R(43,"div",5)(44,"p",6),e.aS0(45,24),e.C$Y(),e.I0R(46,"p",8),e.aS0(47,25),e.C$Y(),e.I0R(48,"app-preferences-number-input",26),e.qCj("submit",function(i){return n.save("reservation_min_hours_advance_cancel",i)}),e.SAx(49),e.aS0(50,27),e.k70(),e.C$Y()(),e.I0R(51,"div",5)(52,"p",6),e.aS0(53,28),e.C$Y(),e.I0R(54,"p",8),e.aS0(55,29),e.C$Y(),e.I0R(56,"app-preferences-number-input",26),e.qCj("submit",function(i){return n.save("reservation_max_days_in_advance",i)}),e.SAx(57),e.aS0(58,30),e.k70(),e.C$Y()(),e.I0R(59,"div",5)(60,"p",6),e.aS0(61,31),e.C$Y(),e.I0R(62,"p",8),e.aS0(63,32),e.C$Y(),e.I0R(64,"app-preferences-number-input",26),e.qCj("submit",function(i){return n.save("reservation_min_hours_in_advance",i)}),e.SAx(65),e.aS0(66,33),e.k70(),e.C$Y()(),e.I0R(67,"div",5)(68,"p",6),e.aS0(69,34),e.C$Y(),e.I0R(70,"p",8),e.aS0(71,35),e.C$Y(),e.I0R(72,"app-preferences-number-input",26),e.qCj("submit",function(i){return n.save("cover_price",i)}),e.SAx(73),e.aS0(74,36),e.k70(),e.C$Y()(),e.I0R(75,"div",5)(76,"p",6),e.aS0(77,37),e.C$Y(),e.I0R(78,"p",8),e.aS0(79,38),e.C$Y(),e.I0R(80,"app-preferences-text-input",22),e.qCj("submit",function(i){return n.save("instagram_landing_page_url",i)}),e.SAx(81),e.aS0(82,39),e.k70(),e.C$Y()()()),2&o){const r=e.Gew(21),i=e.Gew(31);e.yG2(6),e.E7m("formGroup",n.form),e.yG2(6),e.E7m("formControlName","default_language")("items",n.allLanguages)("itemContent",i)("stringifyFn",n.applyPipeFunction(n.languagePipe))("inputSize",n.inputSize),e.yG2(10),e.E7m("formControlName","nexi_auto_refund_cancelled_reservations")("items",n.trueFalse)("itemContent",r)("stringifyFn",n.applyPipeFunction(n.languagePipe))("inputSize",n.inputSize),e.yG2(10),e.E7m("formControlName","available_locales")("items",n.allLanguages)("itemContent",i)("stringifyFn",n.applyPipeFunction(n.languagePipe))("inputSize",n.inputSize),e.yG2(8),e.E7m("formControlName","max_people_per_reservation")("inputSize",n.inputSize),e.yG2(8),e.E7m("formControlName","reservation_min_hours_advance_cancel")("inputSize",n.inputSize)("postfix","ore"),e.yG2(7),e.oBb(n.form.value.reservation_max_days_in_advance),e.Ylm(55),e.yG2(),e.E7m("formControlName","reservation_max_days_in_advance")("inputSize",n.inputSize)("postfix","giorni"),e.yG2(7),e.oBb(n.form.value.reservation_min_hours_in_advance),e.Ylm(63),e.yG2(),e.E7m("formControlName","reservation_min_hours_in_advance")("inputSize",n.inputSize)("postfix","ore"),e.yG2(8),e.E7m("formControlName","cover_price")("inputSize",n.inputSize)("postfix","\u20ac"),e.yG2(8),e.E7m("formControlName","instagram_landing_page_url")("inputSize",n.inputSize)}},dependencies:[ee.BZ,a.sl,a.sz,a.ue,a.u,a.uW,a.Wo,E.q8,m.e,te.ms,ie.M,se,le,ue],encapsulation:2,changeDetection:0})}return _})()}}]);