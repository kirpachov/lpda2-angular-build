"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[2544],{9064:(y,c,o)=>{o.d(c,{w:()=>G});var e=o(4496),C=o(6504),t=o(3480),m=o(6700),M=o(3616),S=o(6684),u=o(3797),R=o(8588),d=o(1368),E=o(9956),A=o(1292);function N(i,O){if(1&i&&(e.I0R(0,"tui-textarea",2),e.OEk(1),e.C$Y()),2&i){const n=e.GaO().$implicit,a=e.GaO();e.E7m("formControl",n.control),e.yG2(),e.oRS(" ",a.getFullLang(n.lang)," ")}}function T(i,O){if(1&i&&(e.I0R(0,"tui-input",2),e.OEk(1),e.C$Y()),2&i){const n=e.GaO().$implicit,a=e.GaO();e.E7m("formControl",n.control),e.yG2(),e.oRS(" ",a.getFullLang(n.lang)," ")}}const $=i=>({"mb-3":i});function v(i,O){if(1&i&&(e.SAx(0),e.I0R(1,"div",1),e.yuY(2,N,2,2,"tui-textarea",2)(3,T,2,2),e.wR5(4,"app-errors",3),e.C$Y(),e.k70()),2&i){const n=O.$implicit,a=O.last,g=e.GaO();e.yG2(),e.E7m("ngClass",e.S45(3,$,!a)),e.yG2(),e.C0Y(2,g.long?2:3),e.yG2(2),e.E7m("errors",n.control.errors)}}const f=["*"];let G=(()=>{class i{constructor(){this.destroy$=new t.UF,this.long=!1,this.controls=(0,e.OCB)({}),this.controlsArr=(0,e.S6b)(()=>{const n=this.controls();return Object.keys(n).map(a=>({lang:a,control:n[a]}))}),this.touched$=new m.g(!1),this.value$=new m.g({})}ngAfterViewInit(){this.addLang("it"),this.addLang("en")}ngOnInit(){}registerOnChange(n){this.value$.pipe((0,M.a)(this.destroy$)).subscribe({next:a=>n(a)})}registerOnTouched(n){this.touched$.pipe((0,S.I)(a=>!0===a)).subscribe({next:()=>n()})}writeValue(n){this.patchValue(n??{}),this.touched$.next(!1)}wasTouched(){this.touched$.next(!0)}getFullLang(n){return A.S[n]??n}controlChanged(n){this.value$.next({...this.value$.value,[n]:this.controls()[n].value})}patchValue(n){Object.keys(n).forEach(a=>this.addLang(a)),Object.keys(this.controls()).forEach(a=>{this.controls()[a].patchValue(n[a]??null)})}addLang(n){if(this.controls()[n])return;const a=new C.Ku;a.valueChanges.subscribe({next:()=>this.controlChanged(n)}),this.controls.set({...this.controls(),[n]:a})}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275cmp=e.In1({type:i,selectors:[["app-i18n-input"]],inputs:{long:"long"},standalone:!0,features:[e.M5G([{provide:C.Y6,useExisting:(0,e.wd)(()=>i),multi:!0},t.UF]),e.UHJ],ngContentSelectors:f,decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"ngClass"],[3,"formControl"],[3,"errors"]],template:function(a,g){1&a&&(e.kPM(),e._Xx(0),e.yuY(1,v,5,5,"ng-container",0)),2&a&&(e.yG2(),e.E7m("ngForOf",g.controlsArr()))},dependencies:[C.sl,C.ue,C.ug,u.CQ,u.Oo,u.cP,d.Iw,E.g,d.QF,R.Y3,R.wp,R.kd],changeDetection:0})}return i})()},2544:(y,c,o)=>{o.r(c),o.d(c,{CreateCategoryModule:()=>B});var e=o(1236),C=o(7552),t=o(4496),m=o(8212),M=o(8976),S=o(4436),u=o(1512),R=o(9956),d=o(9064),E=o(6504),A=o(3480),N=o(1712),T=o(3616),$=o(4704),v=o(6684),f=o(8824),G=o(5820),i=o(9088),O=o(9938),n=o(1128),a=o(8256),g=o(5704),I=o(8392);function U(l,z){if(1&l&&(t.I0R(0,"h1",10)(1,"span"),t.aS0(2,11),t.C$Y()(),t.I0R(3,"div",1)(4,"span",12),t.SAx(5),t.aS0(6,13),t.k70(),t.C$Y(),t.I0R(7,"a",14),t.wVc(8,"urlTo"),t.OEk(9),t.C$Y()()),2&l){const s=t.GaO();let r,_;t.yG2(7),t.E7m("routerLink",t.g7$(8,2,null==(r=s.parent())?null:r.id,"menuCategory.show")),t.yG2(2),t.cNF(null==(_=s.parent())?null:_.name)}}function L(l,z){1&l&&(t.I0R(0,"h1"),t.SAx(1),t.aS0(2,15),t.k70(),t.C$Y())}let Y=(()=>{class l{constructor(){this.service=(0,t.uUt)(N.S),this.destroy$=(0,t.uUt)(A.UF),this.router=(0,t.uUt)(e.E5),this.route=(0,t.uUt)(e.gV),this.urlTo=(0,t.uUt)(i.S),this.notifications=(0,t.uUt)(n.E),this.afterUrl=this.route.snapshot.queryParams.afterUrl,this.form=new E.WC({name:new E.Ku(null)}),this.parentId=null,this.parent=(0,t.OCB)(null),this.loading=(0,t.OCB)(!1),this.submitted=!1,this.e=this.errorsFor}ngOnInit(){this.route.parent?.parent?.params.pipe((0,T.a)(this.destroy$),(0,$.k)(s=>Number(s.category_id)),(0,v.I)(s=>"number"==typeof s&&!isNaN(s)&&s>0)).subscribe({next:s=>{this.parentId=s,this.loadParent()}})}submit(){this.submitted=!0,!this.form.invalid&&(this.loading.set(!0),this.service.create(this.formData()).pipe((0,T.a)(this.destroy$),(0,f.U)(()=>this.loading.set(!1))).subscribe({next:s=>{const r=this.afterUrl||this.urlTo.transform(s.id,"menuCategory.show");console.assert(r,`URL for menu category ${s.id} not found`),this.router.navigate([r],{relativeTo:this.route}),this.notifications.fireSnackBar("Category created.")},error:s=>{O.y.assignErrorsToForm(this.form,s),this.notifications.error((0,a.mk)(s)||I.a)}}))}formData(){const s=this.form.value,r=this.parent();return r instanceof G.Q&&(s.parent_id=r.id),s}errorsFor(s){const r=this.form.get(s);return r&&(r.dirty||r.touched||this.submitted)?r.errors:null}cancel(){this.router.navigate([this.afterUrl||".."],{relativeTo:this.route})}loadParent(s=this.parentId){s&&(this.loading.set(!0),this.service.show(s).pipe((0,T.a)(this.destroy$),(0,f.U)(()=>this.loading.set(!1))).subscribe({next:r=>{this.parent.set(r)},error:r=>{this.notifications.error((0,a.mk)(r)||I.a)}}))}static#t=this.\u0275fac=function(r){return new(r||l)};static#e=this.\u0275cmp=t.In1({type:l,selectors:[["app-create-category"]],standalone:!0,features:[t.M5G([A.UF,i.S]),t.UHJ],decls:15,vars:5,consts:()=>{let s,r,_,p,P,D;return s="Name",r="Confirm",_="Cancel",p="Create new category",P="The category will be created as a subcategory of",D="Create new menu",[[3,"formGroup","ngSubmit"],[1,"mb-3"],["formControlName","name"],s,[3,"errors"],[1,"flex"],["tuiButton","","type","submit","size","l",1,"me-2",3,"showLoader"],r,["tuiButton","","type","button","appearance","icon","size","l",3,"showLoader","click"],_,[1,"flex","items-center"],p,[1,"me-2","text-slate-400"],P,["tuiLink","",3,"routerLink"],D]},template:function(r,_){1&r&&(t.yuY(0,U,10,5)(1,L,3,0),t.I0R(2,"form",0),t.qCj("ngSubmit",function(){return _.submit()}),t.I0R(3,"div",1)(4,"app-i18n-input",2),t.SAx(5),t.aS0(6,3),t.k70(),t.C$Y(),t.wR5(7,"app-errors",4),t.C$Y(),t.I0R(8,"div",5)(9,"button",6),t.SAx(10),t.aS0(11,7),t.k70(),t.C$Y(),t.I0R(12,"button",8),t.qCj("click",function(){return _.cancel()}),t.SAx(13),t.aS0(14,9),t.k70(),t.C$Y()()()),2&r&&(t.C0Y(0,_.parent()?0:1),t.yG2(2),t.E7m("formGroup",_.form),t.yG2(5),t.E7m("errors",_.e("name")),t.yG2(2),t.E7m("showLoader",_.loading()),t.yG2(3),t.E7m("showLoader",_.loading()))},dependencies:[m.CI,m.Kw,R.g,d.w,E.sl,E.sz,E.ue,E.u,E.uW,E.Wo,M.Gy,g.W,S.a,u.w,u.C,e.ER,i.S],encapsulation:2,changeDetection:0})}return l})(),B=(()=>{class l{static#t=this.\u0275fac=function(r){return new(r||l)};static#e=this.\u0275mod=t.a4G({type:l});static#o=this.\u0275inj=t.s3X({imports:[e.qQ.forChild([(0,C.VV)(Y,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return l})()},1292:(y,c,o)=>{o.d(c,{S:()=>e});const e={it:"Italian",en:"English",es:"Spanish",fr:"French",de:"German",pt:"Portuguese",ru:"Russian",zh:"Chinese",ja:"Japanese",ar:"Arabic",hi:"Hindi",bn:"Bengali",pa:"Punjabi",ms:"Malaysian"}}}]);