"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[8544],{3888:(S,D,e)=>{e.r(D),e.d(D,{AdminDashboardComponent:()=>_t});var t=e(4496),v=e(1368),p=e(4476),f=e(1528),u=e(2540),g=e(6928),O=e(5657),C=e(112),a=e(3252),A=e(5800),$=e(7368);class M{constructor(){this.subject=new u.o(1),this.subscriptions=new g.wH}doFilter(m){this.subject.next(m)}dispose(){this.subscriptions.unsubscribe()}notEmpty(m,s){this.subscriptions.add(this.subject.subscribe(i=>{if(i[m]){const c=i[m].currentValue;null!=c&&s(c)}}))}has(m,s){this.subscriptions.add(this.subject.subscribe(i=>{i[m]&&s(i[m].currentValue)}))}notFirst(m,s){this.subscriptions.add(this.subject.subscribe(i=>{i[m]&&!i[m].isFirstChange()&&s(i[m].currentValue)}))}notFirstAndEmpty(m,s){this.subscriptions.add(this.subject.subscribe(i=>{if(i[m]&&!i[m].isFirstChange()){const c=i[m].currentValue;null!=c&&s(c)}}))}}const d=new t.UbH("NGX_ECHARTS_CONFIG");let y=(()=>{class r{constructor(s,i,c){this.el=i,this.ngZone=c,this.options=null,this.theme=null,this.initOpts=null,this.merge=null,this.autoResize=!0,this.loading=!1,this.loadingType="default",this.loadingOpts=null,this.chartInit=new t._w7,this.optionsError=new t._w7,this.chartClick=this.createLazyEvent("click"),this.chartDblClick=this.createLazyEvent("dblclick"),this.chartMouseDown=this.createLazyEvent("mousedown"),this.chartMouseMove=this.createLazyEvent("mousemove"),this.chartMouseUp=this.createLazyEvent("mouseup"),this.chartMouseOver=this.createLazyEvent("mouseover"),this.chartMouseOut=this.createLazyEvent("mouseout"),this.chartGlobalOut=this.createLazyEvent("globalout"),this.chartContextMenu=this.createLazyEvent("contextmenu"),this.chartHighlight=this.createLazyEvent("highlight"),this.chartDownplay=this.createLazyEvent("downplay"),this.chartSelectChanged=this.createLazyEvent("selectchanged"),this.chartLegendSelectChanged=this.createLazyEvent("legendselectchanged"),this.chartLegendSelected=this.createLazyEvent("legendselected"),this.chartLegendUnselected=this.createLazyEvent("legendunselected"),this.chartLegendLegendSelectAll=this.createLazyEvent("legendselectall"),this.chartLegendLegendInverseSelect=this.createLazyEvent("legendinverseselect"),this.chartLegendScroll=this.createLazyEvent("legendscroll"),this.chartDataZoom=this.createLazyEvent("datazoom"),this.chartDataRangeSelected=this.createLazyEvent("datarangeselected"),this.chartGraphRoam=this.createLazyEvent("graphroam"),this.chartGeoRoam=this.createLazyEvent("georoam"),this.chartTreeRoam=this.createLazyEvent("treeroam"),this.chartTimelineChanged=this.createLazyEvent("timelinechanged"),this.chartTimelinePlayChanged=this.createLazyEvent("timelineplaychanged"),this.chartRestore=this.createLazyEvent("restore"),this.chartDataViewChanged=this.createLazyEvent("dataviewchanged"),this.chartMagicTypeChanged=this.createLazyEvent("magictypechanged"),this.chartGeoSelectChanged=this.createLazyEvent("geoselectchanged"),this.chartGeoSelected=this.createLazyEvent("geoselected"),this.chartGeoUnselected=this.createLazyEvent("geounselected"),this.chartAxisAreaSelected=this.createLazyEvent("axisareaselected"),this.chartBrush=this.createLazyEvent("brush"),this.chartBrushEnd=this.createLazyEvent("brushend"),this.chartBrushSelected=this.createLazyEvent("brushselected"),this.chartGlobalCursorTaken=this.createLazyEvent("globalcursortaken"),this.chartRendered=this.createLazyEvent("rendered"),this.chartFinished=this.createLazyEvent("finished"),this.animationFrameID=null,this.chart$=new u.o(1),this.resize$=new O.E,this.changeFilter=new M,this.resizeObFired=!1,this.echarts=s.echarts,this.theme=s.theme||null}ngOnChanges(s){this.changeFilter.doFilter(s)}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe((0,A.U)(100,C.M,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(s=>{for(const i of s)i.target===this.el.nativeElement&&(this.resizeObFired?this.animationFrameID=window.requestAnimationFrame(()=>{this.resize$.next()}):this.resizeObFired=!0)})),this.resizeOb.observe(this.el.nativeElement)),this.changeFilter.notFirstAndEmpty("options",s=>this.onOptionsChange(s)),this.changeFilter.notFirstAndEmpty("merge",s=>this.setOption(s)),this.changeFilter.has("loading",s=>this.toggleLoading(!!s)),this.changeFilter.notFirst("theme",()=>this.refreshChart())}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.loadingSub&&this.loadingSub.unsubscribe(),this.changeFilter.dispose(),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(s){this.chart?s?this.chart.showLoading(this.loadingType,this.loadingOpts):this.chart.hideLoading():this.loadingSub=this.chart$.subscribe(i=>s?i.showLoading(this.loadingType,this.loadingOpts):i.hideLoading())}setOption(s,i){if(this.chart)try{this.chart.setOption(s,i)}catch(c){console.error(c),this.optionsError.emit(c)}}refreshChart(){var s=this;return(0,f.c)(function*(){s.dispose(),yield s.initChart()})()}createChart(){const s=this.el.nativeElement;if(window&&window.getComputedStyle){const i=window.getComputedStyle(s,null).getPropertyValue("height");(!i||"0px"===i)&&(!s.style.height||"0px"===s.style.height)&&(s.style.height="400px")}return this.ngZone.runOutsideAngular(()=>("function"==typeof this.echarts?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:c})=>c(s,this.theme,this.initOpts)))}initChart(){var s=this;return(0,f.c)(function*(){yield s.onOptionsChange(s.options),s.merge&&s.chart&&s.setOption(s.merge)})()}onOptionsChange(s){var i=this;return(0,f.c)(function*(){s&&(i.chart||(i.chart=yield i.createChart(),i.chart$.next(i.chart),i.chartInit.emit(i.chart)),i.setOption(i.options,!0))})()}createLazyEvent(s){return this.chartInit.pipe((0,$.G)(i=>new a._(c=>(i.on(s,T=>this.ngZone.run(()=>c.next(T))),()=>{this.chart&&(this.chart.isDisposed()||i.off(s))}))))}static#t=this.\u0275fac=function(i){return new(i||r)(t.GI1(d),t.GI1(t.GMv),t.GI1(t.WW2))};static#e=this.\u0275dir=t.Sc5({type:r,selectors:[["echarts"],["","echarts",""]],inputs:{options:"options",theme:"theme",initOpts:"initOpts",merge:"merge",autoResize:"autoResize",loading:"loading",loadingType:"loadingType",loadingOpts:"loadingOpts"},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartHighlight:"chartHighlight",chartDownplay:"chartDownplay",chartSelectChanged:"chartSelectChanged",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendLegendSelectAll:"chartLegendLegendSelectAll",chartLegendLegendInverseSelect:"chartLegendLegendInverseSelect",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartGraphRoam:"chartGraphRoam",chartGeoRoam:"chartGeoRoam",chartTreeRoam:"chartTreeRoam",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartGeoSelectChanged:"chartGeoSelectChanged",chartGeoSelected:"chartGeoSelected",chartGeoUnselected:"chartGeoUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartGlobalCursorTaken:"chartGlobalCursorTaken",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],standalone:!0,features:[t.SYr]})}return r})();const x=(r={})=>({provide:d,useFactory:()=>({...r,echarts:()=>e.e(8820).then(e.bind(e,8820))})});var l=e(7692);const o=()=>({});let h=(()=>{class r{constructor(){this.loading=!1}ngOnChanges(s){s.stats&&this.refresh()}onChartInit(s){this.echart=s,this.refresh()}refresh(){this.stats&&this.stats["reservations-by-hour"]&&this.echart?.setOption(this.dataLoadedUpdateChart(this.stats["reservations-by-hour"]))}dataLoadedUpdateChart(s){const i=Object.keys(s),c=Object.values(s);return{xAxis:{type:"category",data:i,name:"Date and time"},yAxis:{type:"value",name:"Book yourself"},series:[{data:c,type:"bar"}]}}static#t=this.\u0275fac=function(i){return new(i||r)};static#e=this.\u0275cmp=t.In1({type:r,selectors:[["app-reservations-by-hour-bar-chart"]],inputs:{loading:"loading",stats:"stats"},standalone:!0,features:[t.M5G([x()]),t.SYr,t.UHJ],decls:2,vars:3,consts:[[3,"showLoader"],["echarts","",3,"options","chartInit"]],template:function(i,c){1&i&&(t.I0R(0,"tui-loader",0)(1,"div",1),t.qCj("chartInit",function(B){return c.onChartInit(B)}),t.C$Y()()),2&i&&(t.E7m("showLoader",c.loading),t.yG2(),t.E7m("options",t.q4q(2,o)))},dependencies:[y,l.Sk,l.Cb],encapsulation:2,changeDetection:0})}return r})();var _=e(1512),E=e(5656),b=e(8212),G=e(1236),V=e(7048),X=e(8256),j=e(8392),Q=e(6772),J=e(964);var U=e(4704);let et=(()=>{class r extends Q.A{constructor(){super("/admin/stats")}stats(s={}){return this.http.get("",{params:s}).pipe((0,U.k)(i=>function q(r){return"object"==typeof r&&null!==r&&function Z(r){return"object"==typeof r&&null!==r&&Object.keys(r).every(m=>"string"==typeof m&&"number"==typeof r[m])}(r["reservations-by-hour"])}(i)?i:(console.warn("Invalid stats response",i),{})),(0,U.k)(i=>function tt(r){const m={...r};if(m["reservations-by-hour"]&&r["reservations-by-hour"]){m["reservations-by-hour"]={};for(const[s,i]of Object.entries(r["reservations-by-hour"]))m["reservations-by-hour"][(0,J.Q9)(s)]=i}return m}(i)))}static#t=this.\u0275fac=function(i){return new(i||r)};static#e=this.\u0275prov=t.wxM({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var nt=e(1128),it=e(3480),ot=e(3616),st=e(8824),k=e(6376),Y=e(1560),at=e(2920),K=e(400),w=e(9880),W=e(6580);let rt=(()=>{class r{constructor(){this.filters={order_by_direction:"asc",order_by_field:"datetime",date_from:K.EK.currentLocal().toString(),status:"active",payment_status:"todo",per_page:100,offset:0}}static#t=this.\u0275fac=function(i){return new(i||r)};static#e=this.\u0275cmp=t.In1({type:r,selectors:[["app-list-reservations-requiring-payment"]],standalone:!0,features:[t.UHJ],decls:6,vars:3,consts:()=>{let s;return s="\n           Unpaid bookings ( \n          " + "\ufffd0\ufffd" + "\n           ) \n        ",[[3,"expanded"],[1,"text-lg"],s,[1,"block","mb-3",3,"filters"],["list",""]]},template:function(i,c){if(1&i&&(t.I0R(0,"tui-expand",0)(1,"p",1),t.SAx(2),t.aS0(3,2),t.k70(),t.C$Y(),t.wR5(4,"app-admin-list-reservations",3,4),t.C$Y()),2&i){const T=t.Gew(5);t.E7m("expanded",T.items().length>0),t.yG2(3),t.oBb(T.items().length),t.Ylm(3),t.yG2(),t.E7m("filters",c.filters)}},dependencies:[w.kh,w.st,W.k],encapsulation:2,changeDetection:0})}return r})(),lt=(()=>{class r{constructor(){this.filters={people_more_than:8,order_by_direction:"asc",order_by_field:"datetime",date_from:K.EK.currentLocal().toString(),status:"active",per_page:100,offset:0}}static#t=this.\u0275fac=function(i){return new(i||r)};static#e=this.\u0275cmp=t.In1({type:r,selectors:[["app-list-reservations-having-groups"]],standalone:!0,features:[t.UHJ],decls:6,vars:3,consts:()=>{let s;return s="Group bookings (\n          " + "\ufffd0\ufffd" + "\n        )\n        ",[[3,"expanded"],[1,"text-lg"],s,[1,"block","mb-3",3,"filters"],["list",""]]},template:function(i,c){if(1&i&&(t.I0R(0,"tui-expand",0)(1,"p",1),t.SAx(2),t.aS0(3,2),t.k70(),t.C$Y(),t.wR5(4,"app-admin-list-reservations",3,4),t.C$Y()),2&i){const T=t.Gew(5);t.E7m("expanded",T.items().length>0),t.yG2(3),t.oBb(T.items().length),t.Ylm(3),t.yG2(),t.E7m("filters",c.filters)}},dependencies:[w.kh,w.st,W.k],encapsulation:2,changeDetection:0})}return r})();function ct(r,m){1&r&&(t.SAx(0),t.aS0(1,20),t.k70())}function dt(r,m){1&r&&(t.SAx(0),t.aS0(1,21),t.k70())}function ht(r,m){1&r&&(t.SAx(0),t.aS0(1,22),t.k70())}function ut(r,m){1&r&&(t.SAx(0),t.aS0(1,23),t.k70())}let _t=(()=>{class r{constructor(){this._=(0,t.uUt)(p.OY).setTitle("Dashboard | La Porta D'Acqua"),this.service=(0,t.uUt)(et),this.destroy$=(0,t.uUt)(it.UF),this.notifications=(0,t.uUt)(nt.E),this.datePipe=(0,t.uUt)(v.y),this.reservationsEvents=(0,t.uUt)(at.I),this.loading=(0,t.OCB)(!1),this.stats=(0,t.OCB)(null),this.today=new Date}ngOnInit(){this.loadStats(),this.reservationsEvents.listenWsChanges().subscribe({next:()=>this.loadStats()})}loadStats(){const s=this.datePipe.transform(this.today,"yyyy-MM-dd")||"",i=this.datePipe.transform(this.today,"yyyy-MM-dd")||"";this.loading.set(!0),this.service.stats({reservations_date_from:s,reservations_date_to:i}).pipe((0,ot.a)(this.destroy$),(0,st.U)(()=>this.loading.set(!1))).subscribe({next:c=>{this.stats.set(c)},error:c=>{this.notifications.error(c instanceof V.gj?(0,X.mk)(c):j.a)}})}static#t=this.\u0275fac=function(i){return new(i||r)};static#e=this.\u0275cmp=t.In1({type:r,selectors:[["app-admin-dashboard"]],standalone:!0,features:[t.UHJ],decls:52,vars:11,consts:()=>{let s,i,c,T,B,H,F,P,R,I,L;return s="La porta d'acqua - dashboard",i="Booked for today",c="Booked for this week.",T="Booked for this month.",B="Booked for this year.",H="Reservations",F="Below is the number of bookings for today.",P="\n           Number of bookings for today. Canceled or annulled bookings are\n          excluded. Both adults and children are counted. \n        ",R="Number of bookings from last Monday to next Sunday.",I="Number of bookings from the first day until the last day of the current month.",L="Number of bookings from the first day until the last day of the current year.",[["currentDayReservations",""],["currentWeekReservationsHint",""],["currentMonthReservationsHint",""],["currentYearReservationsHint",""],[1,"flex","items-center"],s,["tuiIconButton","","appearance","icon","type","button",3,"showLoader","click"],[1,"flex","flex-wrap","items-center"],[1,"col-12","md:col-6","lg:col-3","p-1"],[1,"tui-island__title",3,"tuiHint"],i,[1,"tui-island__paragraph"],c,T,B,["tuiLink","","routerLink","/admin/reservations"],[1,"text-xl"],H,F,[3,"stats","loading"],P,R,I,L]},template:function(i,c){if(1&i&&(t.yuY(0,ct,2,0,"ng-template",null,0,t.gJz)(2,dt,2,0,"ng-template",null,1,t.gJz)(4,ht,2,0,"ng-template",null,2,t.gJz)(6,ut,2,0,"ng-template",null,3,t.gJz),t.I0R(8,"div",4)(9,"h1"),t.aS0(10,5),t.C$Y(),t.I0R(11,"button",6),t.qCj("click",function(){return c.loadStats()}),t.I0R(12,"mat-icon"),t.OEk(13,"refresh"),t.C$Y()()(),t.I0R(14,"div",7)(15,"div",8)(16,"tui-island")(17,"h3",9),t.SAx(18),t.aS0(19,10),t.k70(),t.C$Y(),t.I0R(20,"p",11),t.OEk(21),t.C$Y()()(),t.I0R(22,"div",8)(23,"tui-island")(24,"h3",9),t.SAx(25),t.aS0(26,12),t.k70(),t.C$Y(),t.I0R(27,"p",11),t.OEk(28),t.C$Y()()(),t.I0R(29,"div",8)(30,"tui-island")(31,"h3",9),t.SAx(32),t.aS0(33,13),t.k70(),t.C$Y(),t.I0R(34,"p",11),t.OEk(35),t.C$Y()()(),t.I0R(36,"div",8)(37,"tui-island")(38,"h3",9),t.SAx(39),t.aS0(40,14),t.k70(),t.C$Y(),t.I0R(41,"p",11),t.OEk(42),t.C$Y()()()(),t.I0R(43,"div")(44,"a",15)(45,"span",16),t.aS0(46,17),t.C$Y()(),t.I0R(47,"p"),t.aS0(48,18),t.C$Y(),t.wR5(49,"app-reservations-by-hour-bar-chart",19)(50,"app-list-reservations-requiring-payment")(51,"app-list-reservations-having-groups"),t.C$Y()),2&i){const T=t.Gew(1),B=t.Gew(3),H=t.Gew(5),F=t.Gew(7);let P,R,I,L;t.yG2(11),t.E7m("showLoader",c.loading()),t.yG2(6),t.E7m("tuiHint",T),t.yG2(4),t.oRS(" ",null!==(P=null==(P=c.stats())||null==P["reservations-count"]||null==P["reservations-count"].current?null:P["reservations-count"].current.day)&&void 0!==P?P:"?"," "),t.yG2(3),t.E7m("tuiHint",B),t.yG2(4),t.oRS(" ",null!==(R=null==(R=c.stats())||null==R["reservations-count"]||null==R["reservations-count"].current?null:R["reservations-count"].current.week)&&void 0!==R?R:"?"," "),t.yG2(3),t.E7m("tuiHint",H),t.yG2(4),t.oRS(" ",null!==(I=null==(I=c.stats())||null==I["reservations-count"]||null==I["reservations-count"].current?null:I["reservations-count"].current.month)&&void 0!==I?I:"?"," "),t.yG2(3),t.E7m("tuiHint",F),t.yG2(4),t.oRS(" ",null!==(L=null==(L=c.stats())||null==L["reservations-count"]||null==L["reservations-count"].current?null:L["reservations-count"].current.year)&&void 0!==L?L:"?"," "),t.yG2(7),t.E7m("stats",c.stats())("loading",c.loading())}},dependencies:[v.MD,h,_.w,_.C,G.qQ,G.ER,k.k,k.C,E.WY,E.lh,E.SL,E.i6,E.IT,b.CI,b.Kw,Y.oB,Y.qL,rt,lt],encapsulation:2,changeDetection:0})}return r})()},8128:(S,D,e)=>{function t(v){if(!v)return null;const p=v.match(/filename="(.+)"/);return p?p[1]:null}e.d(D,{k:()=>t})},9772:(S,D,e)=>{e.d(D,{CU:()=>p,MJ:()=>v,ye:()=>f}),(new Date).getTimezoneOffset();const v=1;function p(u,g=v){if(!("string"==typeof u&&u.length>0&&u.match(/\d{1,2}:\d{1,2}/)))return console.error("Invalid string provided to strTimeTimezone",{string:u}),"";const C=Number(u.split(":")[0])+g;return`${C<10?"0":""}${C}:${u.split(":")[1]}`}function f(u,g=v){return p(u,-1*g)}},964:(S,D,e)=>{e.d(D,{Ez:()=>A,In:()=>y,Q1:()=>z,Q9:()=>d,QX:()=>C,Qx:()=>f,_0:()=>x,ay:()=>u,cr:()=>O,e6:()=>p,yc:()=>g});var t=e(400),v=e(9772);const p=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z$/;function f(n,l){const o=new t.uc(l.hours,l.minutes).shift({hours:-v.MJ});return new Date(Date.UTC(n.year,n.month,n.day,o.hours,o.minutes)).toISOString()}function u(n){if(!("string"==typeof n&&n.length>0&&n.match(p)))return console.error("Invalid string provided to isoStringToTuiDay",{isoString:n}),null;const l=new Date(n);return new t.EK(l.getFullYear(),l.getMonth()+1,l.getDate())}function g(n){if("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}\s{1}\d{1,2}:\d{1,2}$/)&&(n=n.split(" ")[0]),!("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}$/)))return console.error("Invalid string provided to stringToTuiDay. Expected format YYYY-MM-DD, got",{str:n}),null;const{day:l,month:o,year:h}=t.EK.parseRawDateString(n,"YMD");return new t.EK(h,o,l)}function O(n){if("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}\s{1}\d{1,2}:\d{1,2}$/)&&(n=n.split(" ")[1]),!("string"==typeof n&&n.length>0&&n.match(/^\d{1,2}:\d{1,2}$/)))return console.error("Invalid string provided to stringToTuiDay. Expected format HH:mm, got",{str:n}),null;const[l,o]=n.split(":").map(h=>Number(h));return"number"==typeof l&&l>=0&&l<=23?"number"==typeof o&&o>=0&&o<60?new t.uc(l,o):(console.error("error while parsing time in stringToTuiTime. minutes are invalid",{minutes:o}),null):(console.error("error while parsing time in stringToTuiTime. hours is invalid ",{hours:l}),null)}function C(n){if(!("string"==typeof n&&n.length>0&&n.match(p)))return console.error("Invalid string provided to isoStringToTuiTime",{isoString:n}),null;const l=new Date(n);return new t.uc(l.getHours(),l.getMinutes())}function A(n){return new Date(`1970-01-01 ${n.toString()}`).toISOString()}function d(n){const l=new Date(`${n}Z`);return`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")} ${String(l.getHours()).padStart(2,"0")}:${String(l.getMinutes()).padStart(2,"0")}`}function y(n){return function $(n){const l=new Date(`1970-01-01 ${n}`);return`${`${l.getUTCHours()}`.padStart(2,"0")}:${`${l.getUTCMinutes()}`.padStart(2,"0")}`}(n.toString())}function x(n){return new t.EK(n.getFullYear(),n.getMonth(),n.getDate())}function z(n){return new t.uc(n.getHours(),n.getMinutes())}},2264:(S,D,e)=>{e.d(D,{W:()=>v});var t=e(8400);class v extends t.w{constructor(f){super(f),this.filename=f.filename,this.status=f.status,this.key=f.key,this.original_id=f.original_id,this.tag=f.tag,this.url=f.url}}},5180:(S,D,e)=>{e.d(D,{C:()=>O});var t=e(8400);class v extends t.w{constructor(a){super(a),this.image_pixel_id=a.image_pixel_id,this.event_data=a.event_data,this.event_time=a.event_time?new Date(a.event_time):void 0}}class p extends t.w{constructor(a){super(a),this.image_id=a.image_id,this.delivered_email_id=a.delivered_email_id,this.record_type=a.record_type,this.record_id=a.record_id,this.event_type=a.event_type,this.secret=a.secret,this.events=a.events?a.events.map(A=>new v(A)):[]}}class f extends t.w{constructor(a){super(a),this.record_id=a.record_id,this.record_type=a.record_type,this.text=a.text,this.html=a.html,this.subject=a.subject,this.headers=a.headers,this.raw=a.raw,this.image_pixels=a.image_pixels?a.image_pixels.map(A=>new p(A)):[]}}class u extends t.w{constructor(a){super(a),this.hpp_url=a.hpp_url,this.value=a.value,this.status=a.status,this.reservation_id=a.reservation_id,this.preorder_type=a.preorder_type,this.external_id=a.external_id,this.other=a.other}}var g=e(9064);class O extends t.w{get people(){return(this.adults||0)+(this.children||0)}constructor(a){super(a),this.fullname=a.fullname,this.datetime=a.datetime?new Date(a.datetime):void 0,this.cancelled_at=a.cancelled_at?new Date(a.cancelled_at):void 0,this.status=a.status,this.secret=a.secret,this.adults=a.adults,this.children=a.children,this.table=a.table,this.notes=a.notes,this.email=a.email,this.phone=a.phone,this.payment=a.payment?new u(a.payment):void 0,this.delivered_emails=a.delivered_emails?a.delivered_emails.map(A=>new f(A)):[],this.table_type_id=a.table_type_id,this.table_type=a.table_type?new g.g(a.table_type):void 0}}},9064:(S,D,e)=>{e.d(D,{g:()=>p});var t=e(8400),v=e(2264);class p extends t.w{constructor(u){super(u),this.name=u.name,this.description=u.description,this.default_people_per_turn=u.default_people_per_turn,this.default_price=u.default_price,this.notes=u.notes,this.status=u.status,this.translations=u.translations,this.images=u.images?u.images.map(g=>new v.W(g)):[]}}},8304:(S,D,e)=>{e.d(D,{S:()=>a});var t=e(6012),v=e(5180),p=e(4704),f=e(3252),u=e(9144),g=e(7048),O=e(8128),C=e(4496);let a=(()=>{class A extends t.s{constructor(){super(v.C,"admin/reservations")}createPayment(M,d){return this.post(`${M}/payment`,d).pipe((0,p.k)(y=>this.mapItem(y)))}updateStatus(M,d){return this.patch(`${M}/status/${d}`,{}).pipe((0,p.k)(y=>this.mapItem(y)))}tablesSummary(M={}){return this.get("tables_summary",{params:M})}ungroupedTablesSummary(M={}){return this.get("ungrouped_tables_summary",{params:M})}deliverConfirmationEmail(M){return this.post(`${M}/deliver_confirmation_email`,{}).pipe((0,p.k)(d=>this.mapItem(d)))}refoundPayment(M){return this.post(`${M}/refund_payment`,{}).pipe((0,p.k)(d=>this.mapItem(d)))}confirmPayment(M){return this.post(`${M}/record_deferred_payment`,{}).pipe((0,p.k)(d=>this.mapItem(d)))}refreshPaymentStatus(M){return this.post(`${M}/refresh_payment_status`,{}).pipe((0,p.k)(d=>this.mapItem(d)))}export(M){return new f._(d=>{this.get("export",{responseType:"blob",observe:"response",params:M}).pipe((0,u.a)(y=>(console.error("ReservationsService.export() error:",y),d.error(y),new f._))).subscribe(y=>{if(y instanceof g.WA&&y.body){const x=(0,O.k)(y.headers?.get("Content-Disposition"))??"Prenotazioni.xlsx",z=y.headers?.get("Content-Type")??"application/octet-stream",n=window.URL.createObjectURL(new Blob([y.body],{type:z})),l=document.createElement("a");l.href=n,l.download=x,l.click(),d.complete()}})})}static#t=this.\u0275fac=function(d){return new(d||A)};static#e=this.\u0275prov=C.wxM({token:A,factory:A.\u0275fac,providedIn:"root"})}return A})()},9880:(S,D,e)=>{e.d(D,{kP:()=>M,kh:()=>z,st:()=>x});var t=e(4496),v=e(3480),p=e(4392),f=e(3120),u=e(3616),g=e(7692),O=e(1368);const C=["wrapper"];function a(n,l){if(1&n&&(t.I0R(0,"tui-loader",4),t.C_f(1,5),t.C$Y()),2&n){const o=t.GaO(2);t.E7m("overlay",!0)("showLoader",o.loading),t.yG2(),t.E7m("ngTemplateOutlet",o.content)}}function A(n,l){if(1&n&&(t.SAx(0),t._Xx(1),t.yuY(2,a,2,3,"tui-loader",3),t.k70()),2&n){const o=t.GaO();t.yG2(2),t.E7m("ngIf",o.async)("ngIfElse",o.content)}}const $=["*"];let M=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275dir=t.Sc5({type:n,selectors:[["","tuiExpandContent",""]]}),n})();let x=(()=>{class n{constructor(o,h){this.cdr=o,this.destroy$=h,this.state=0,this.async=!1,this.content=null,this.expanded=null}set expandedSetter(o){if(null!==this.expanded)return 0!==this.state?(this.expanded=o,void(this.state=3)):(this.expanded=o,void this.retrigger(this.async&&o?1:3));this.expanded=o}get overflow(){return 0!==this.state}get loading(){return!!this.expanded&&this.async&&1===this.state}get height(){const{expanded:o,state:h,contentWrapper:_}=this;return o&&2===h||!o&&3===h?0:_&&(!o&&2===h||o&&3===h)?_.nativeElement.offsetHeight:_&&o&&1===h?Math.max(_.nativeElement.offsetHeight,48):null}get contentVisible(){return this.expanded||0!==this.state}onTransitionEnd({propertyName:o}){"opacity"===o&&3===this.state&&(this.state=0)}onExpandLoaded(o){o.stopPropagation(),1===this.state&&this.retrigger(3)}retrigger(o){this.state=2,(0,f.k)(0).pipe((0,u.a)(this.destroy$)).subscribe(()=>{2===this.state&&(this.state=o,this.cdr.markForCheck())})}}return n.\u0275fac=function(o){return new(o||n)(t.GI1(t.kD9),t.GI1(v.UF,2))},n.\u0275cmp=t.In1({type:n,selectors:[["tui-expand"]],contentQueries:function(o,h,_){if(1&o&&t.szK(_,M,5,t.Yw2),2&o){let E;t.wto(E=t.Gqi())&&(h.content=E.first)}},viewQuery:function(o,h){if(1&o&&t.CC$(C,5),2&o){let _;t.wto(_=t.Gqi())&&(h.contentWrapper=_.first)}},hostVars:9,hostBindings:function(o,h){1&o&&t.qCj("transitionend.self",function(E){return h.onTransitionEnd(E)})("tui-expand-loaded",function(E){return h.onExpandLoaded(E)}),2&o&&(t.e48("aria-expanded",h.expanded),t.m4B("height",h.height,"px"),t.eAK("_expanded",h.expanded)("_overflow",h.overflow)("_loading",h.loading))},inputs:{async:"async",expandedSetter:[t.Wk5.None,"expanded","expandedSetter"]},features:[t.M5G([v.UF])],ngContentSelectors:$,decls:3,vars:3,consts:[[1,"t-wrapper"],["wrapper",""],[4,"ngIf"],["size","l",3,"overlay","showLoader",4,"ngIf","ngIfElse"],["size","l",3,"overlay","showLoader"],[3,"ngTemplateOutlet"]],template:function(o,h){1&o&&(t.kPM(),t.I0R(0,"div",0,1),t.yuY(2,A,3,2,"ng-container",2),t.C$Y()),2&o&&(t.E7m("@tuiParentAnimation",void 0)("@.disabled",h.overflow),t.yG2(2),t.E7m("ngIf",h.contentVisible))},dependencies:[g.Cb,O.u_,O.XV],styles:['[_nghost-%COMP%]{transition-property:opacity,height,visibility;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;display:block;opacity:0;transition-delay:1ms}._overflow[_nghost-%COMP%]{overflow:hidden}._expanded[_nghost-%COMP%]{opacity:1;transform:translate(0)}._loading[_nghost-%COMP%]{opacity:.99}.t-wrapper[_ngcontent-%COMP%]:before, .t-wrapper[_ngcontent-%COMP%]:after{content:"";display:table}'],data:{animation:[p.cI]},changeDetection:0}),n})(),z=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.a4G({type:n}),n.\u0275inj=t.s3X({imports:[[O.MD,g.Sk]]}),n})()},1512:(S,D,e)=>{e.d(D,{C:()=>n,w:()=>l});var t=e(4496),v=e(900),p=e(4392),f=e(4164),u=e(3480),g=e(4680),O=e(3972),C=e(5944),a=e(3412),A=e(4704),$=e(3656),M=e(1368);const d=["tuiLink",""];function y(o,h){if(1&o&&t.wR5(0,"tui-svg",3),2&o){const _=t.GaO();t.E7m("src",_.icon||"")}}function x(o,h){if(1&o&&t.wR5(0,"tui-svg",4),2&o){const _=t.GaO();t.E7m("src",_.icon||"")}}const z=["*"];let n=(()=>{class o{constructor(_,E,b){this.el=_,this.mode$=E,this.pseudo=!1,this.icon="",this.iconAlign="right",this.iconRotated=!1,this.mode=null,this.focusVisible=!1,this.focusedChange=(0,a.U)((0,v.Ax)(this.el.nativeElement,"focusin").pipe((0,A.k)(p.Ml)),(0,v.Ax)(this.el.nativeElement,"focusout").pipe((0,A.k)(p.so))),b.subscribe(G=>{this.focusVisible=G})}get nativeFocusableElement(){return this.el.nativeElement}get focused(){return(0,f.ER)(this.nativeFocusableElement)}get hasIcon(){return!!this.icon}get iconAlignLeft(){return this.hasIcon&&"left"===this.iconAlign}get iconAlignRight(){return this.hasIcon&&"right"===this.iconAlign}}return o.\u0275fac=function(_){return new(_||o)(t.GI1(t.GMv),t.GI1(C.Yx),t.GI1(u.MF))},o.\u0275cmp=t.In1({type:o,selectors:[["a","tuiLink",""],["button","tuiLink",""]],hostVars:7,hostBindings:function(_,E){1&_&&t.qCj("$.data-mode.attr",function(){return E.mode$}),2&_&&(t.e48("data-host-mode",E.mode),t.eAK("_pseudo",E.pseudo)("_icon-rotated",E.iconRotated)("_focus-visible",E.focusVisible))},inputs:{pseudo:"pseudo",icon:"icon",iconAlign:"iconAlign",iconRotated:"iconRotated",mode:"mode"},exportAs:["tuiLink"],features:[t.M5G([(0,g.NK)(o),u.MF,u.UF,O.Ir])],attrs:d,ngContentSelectors:z,decls:4,vars:2,consts:[["class","t-icon t-icon_left",3,"src",4,"ngIf"],[1,"t-content"],["class","t-icon t-icon_right",3,"src",4,"ngIf"],[1,"t-icon","t-icon_left",3,"src"],[1,"t-icon","t-icon_right",3,"src"]],template:function(_,E){1&_&&(t.kPM(),t.yuY(0,y,1,1,"tui-svg",0),t.I0R(1,"span",1),t._Xx(2),t.C$Y(),t.yuY(3,x,1,1,"tui-svg",2)),2&_&&(t.E7m("ngIf",E.iconAlignLeft),t.yG2(3),t.E7m("ngIf",E.iconAlignRight))},dependencies:[$.Wu,M.u_],styles:["[_nghost-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;border:0;background:none;font-size:inherit;line-height:inherit;text-decoration:none;transition-property:color;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;color:var(--tui-link);text-align:left;text-transform:inherit;font-weight:inherit;cursor:pointer;outline:none}[_nghost-%COMP%]:hover{color:var(--tui-link-hover)}[_nghost-%COMP%]:disabled{opacity:var(--tui-disabled-opacity);cursor:default}[data-mode=onLight][_nghost-%COMP%]{color:var(--tui-text-02)}[data-mode=onLight][_nghost-%COMP%]:hover, [data-mode=onLight]._active[_nghost-%COMP%]{color:var(--tui-text-01)}[data-mode=onLight]._pseudo[_nghost-%COMP%]{color:var(--tui-text-01)}[data-mode=onLight]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(0,0,0,.48);text-decoration-color:#0000007a}[data-mode=onLight]._pseudo[_nghost-%COMP%]:hover, [data-mode=onLight]._pseudo._active[_nghost-%COMP%]{color:var(--tui-text-03)}[data-mode=onLight][data-host-mode=negative][_nghost-%COMP%]{color:var(--tui-negative-night)}[data-mode=onLight][data-host-mode=negative][_nghost-%COMP%]:hover, [data-mode=onLight][data-host-mode=negative][_nghost-%COMP%]:active, [data-mode=onLight][data-host-mode=negative]._active[_nghost-%COMP%]{color:var(--tui-negative-night-hover)}[data-mode=onDark][_nghost-%COMP%]{color:var(--tui-text-03-night)}[data-mode=onDark][_nghost-%COMP%]:hover, [data-mode=onDark][_nghost-%COMP%]:active, [data-mode=onDark]._active[_nghost-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._pseudo[_nghost-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(255,255,255,.48);text-decoration-color:#ffffff7a}[data-mode=onDark]._pseudo[_nghost-%COMP%]:hover, [data-mode=onDark]._pseudo[_nghost-%COMP%]:active, [data-mode=onDark]._pseudo._active[_nghost-%COMP%]{color:var(--tui-text-03-night)}[data-mode=onDark][data-host-mode=positive][_nghost-%COMP%]{color:var(--tui-positive-night)}[data-mode=onDark][data-host-mode=positive][_nghost-%COMP%]:hover, [data-mode=onDark][data-host-mode=positive][_nghost-%COMP%]:active, [data-mode=onDark][data-host-mode=positive]._active[_nghost-%COMP%]{color:var(--tui-positive-night-hover)}[data-host-mode=negative][_nghost-%COMP%]{color:var(--tui-negative)}[data-host-mode=negative][_nghost-%COMP%]:hover{color:var(--tui-negative-hover)}[data-host-mode=negative]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(222,76,30,.48);text-decoration-color:#de4c1e7a}[data-host-mode=positive][_nghost-%COMP%]{color:var(--tui-positive)}[data-host-mode=positive][_nghost-%COMP%]:hover{color:var(--tui-positive-hover)}[data-host-mode=positive]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(58,169,129,.48);text-decoration-color:#3aa9817a}._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-selection)}[data-mode=onLight]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-clear);color:var(--tui-text-01)}[data-mode=onDark]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-clear-inverse);color:var(--tui-text-01-night)}[data-host-mode=positive]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-success-bg)}[data-host-mode=negative]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-error-bg)}._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{padding-bottom:.15em;-webkit-text-decoration:underline dashed rgba(51,111,238,.48);text-decoration:underline dashed rgba(51,111,238,.48);text-underline-offset:.2em;text-decoration-thickness:.7px}.t-icon[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;width:var(--tui-link-icon-size, 1.5rem);height:var(--tui-link-icon-size, 1.5rem);margin-top:-.125rem}.t-icon_left[_ngcontent-%COMP%]{margin-right:.25rem}.t-icon_right[_ngcontent-%COMP%]{margin-left:.25rem}._icon-rotated[_nghost-%COMP%]   .t-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}"],changeDetection:0}),o})(),l=(()=>{class o{}return o.\u0275fac=function(_){return new(_||o)},o.\u0275mod=t.a4G({type:o}),o.\u0275inj=t.s3X({imports:[[M.MD,$.Yt]]}),o})()},6376:(S,D,e)=>{e.d(D,{C:()=>f,k:()=>u});var t=e(4496),v=e(1368);const p=["*"];let f=(()=>{class g{constructor(){this.size="m",this.textAlign="left",this.hoverable=!1,this.transparent=!1}get sizeS(){return"s"===this.size}get sizeM(){return"m"===this.size}get sizeL(){return"l"===this.size}get textAlignLeft(){return"left"===this.textAlign}get textAlignCenter(){return"center"===this.textAlign}get textAlignRight(){return"right"===this.textAlign}}return g.\u0275fac=function(C){return new(C||g)},g.\u0275cmp=t.In1({type:g,selectors:[["tui-island"],["a","tuiIsland",""]],hostAttrs:[1,"tui-island"],hostVars:16,hostBindings:function(C,a){2&C&&t.eAK("tui-island_hoverable",a.hoverable)("tui-island_transparent",a.transparent)("tui-island_size_s",a.sizeS)("tui-island_size_m",a.sizeM)("tui-island_size_l",a.sizeL)("tui-island_text-align_left",a.textAlignLeft)("tui-island_text-align_center",a.textAlignCenter)("tui-island_text-align_right",a.textAlignRight)},inputs:{size:"size",textAlign:"textAlign",hoverable:"hoverable",transparent:"transparent"},ngContentSelectors:p,decls:1,vars:0,template:function(C,a){1&C&&(t.kPM(),t._Xx(0))},styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),g})(),u=(()=>{class g{}return g.\u0275fac=function(C){return new(C||g)},g.\u0275mod=t.a4G({type:g}),g.\u0275inj=t.s3X({imports:[[v.MD]]}),g})()}}]);