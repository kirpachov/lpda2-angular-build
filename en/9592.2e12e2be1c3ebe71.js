"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[9592],{2208:(v,N,e)=>{e.d(N,{G:()=>z});var t=e(4496),M=e(9956),s=e(6504),m=e(8212),d=e(8048),I=e(5193),T=e(3797),o=e(9888),R=e(3320),E=e(6380),C=e(2740),a=e(400),h=e(3480),_=e(4680),r=e(5e3),D=e(8304),P=e(3616),p=e(6684),g=e(9212),V=e(7368),$=e(8824),G=e(1343),U=e(1560),l=e(1368),f=e(9772),O=e(964),c=e(4592),y=e(4820),K=e(7936);const B=(S,x)=>({date:S,time:x});function F(S,x){if(1&S&&(t.I0R(0,"app-reservation-tables-summary",26)(1,"p"),t.OEk(2,"Situazione tavoli per l'orario selezionato:"),t.C$Y()()),2&S){const n=t.GaO();let u;t.E7m("filters",t.IBC(1,B,n.form.value.date,null!==(u=n.utcTime())&&void 0!==u?u:""))}}function W(S,x){if(1&S){const n=t.KQA();t.I0R(0,"button",27),t.qCj("click",function(){t.usT(n);const i=t.GaO();return i.dateOpen.set(!0),t.CGJ(i.timeOpen.set(!1))}),t.I0R(1,"span",3)(2,"span",28),t.aS0(3,29),t.C$Y(),t.I0R(4,"mat-icon"),t.OEk(5,"calendar_today"),t.C$Y()()()}}let z=(()=>{class S{set item(n){n?this.form.patchValue({date:n.datetime?new a.EK(n.datetime?.getFullYear(),n.datetime?.getMonth(),n.datetime?.getDate()):null,time:n.datetime?new a.uc(n.datetime?.getHours(),n.datetime?.getMinutes()):null,fullname:n.fullname,adults:n.adults,children:n.children,email:n.email,table:n.table,notes:n.notes,phone:n.phone}):this.form.reset()}constructor(n){this.isMobile=n,this.reservationsService=(0,t.uUt)(D.S),this.publicRes=(0,t.uUt)(y.G),this.destroy$=(0,t.uUt)(h.UF),this.datePipe=(0,t.uUt)(l.y),this.formSubmit=new t._w7,this.cancelled=new t._w7,this.validTimes=(0,t.OCB)([]),this.utcTime=(0,t.OCB)(null),this.today=a.EK.currentLocal(),this.inputSize="l",this.form=new s.WC({date:new s.Ku(null,[s.AQ.required]),time:new s.Ku(null,[s.AQ.required]),fullname:new s.Ku(null,[s.AQ.required]),adults:new s.Ku(null,[s.AQ.required,s.AQ.min(0)]),children:new s.Ku(0,[s.AQ.required,s.AQ.min(0)]),email:new s.Ku(null,[s.AQ.email]),table:new s.Ku(null),notes:new s.Ku(null),phone:new s.Ku(null)}),this.loading=!1,this.dateOpen=(0,t.OCB)(!1),this.timeOpen=(0,t.OCB)(!1),this.loadingTimes=(0,t.OCB)(!1),this.submitted=!1,this.e=this.errorsFor}ngOnInit(){this.dateOpen.set(!0),this.timeOpen.set(!1),this.form.get("date").valueChanges.pipe((0,P.a)(this.destroy$),(0,p.I)(n=>n instanceof a.EK),(0,g.y)(()=>this.dateOpen.set(!1)),(0,g.y)(()=>this.timeOpen.set(!0)),(0,g.y)(()=>this.loadingTimes.set(!0)),(0,V.G)(n=>this.publicRes.getValidTimes(n)),(0,$.U)(()=>this.loadingTimes.set(!1))).subscribe({next:n=>{const u=n.map(i=>i.valid_times).filter(i=>Array.isArray(i)&&i.length>0).flat();this.validTimes.set(u.map(i=>a.uc.fromString((0,f.CU)(i))))}}),this.form.get("time").valueChanges.pipe((0,P.a)(this.destroy$),(0,g.y)(()=>this.timeOpen.set(!1)),(0,g.y)(n=>this.utcTime.set(n?(0,f.ye)(n.toString("HH:MM")):null))).subscribe((0,G.I)())}submit(){this.submitted=!0,!this.form.invalid&&this.formSubmit.emit(this.formVal())}formVal(){const n=this.form.value;return n.datetime=(0,O.Qx)(n.date,n.time),delete n.date,delete n.time,n}errorsFor(n){const u=this.form.get(n);return u&&(u.dirty||u.touched||this.submitted)?u.errors:null}cancel(){this.cancelled.emit()}static#t=this.\u0275fac=function(u){return new(u||S)(t.GI1(_.Mv))};static#e=this.\u0275cmp=t.In1({type:S,selectors:[["app-admin-reservation-form"]],inputs:{item:"item",loading:"loading"},outputs:{formSubmit:"formSubmit",cancelled:"cancelled"},standalone:!0,features:[t.M5G([h.UF,l.y]),t.UHJ],decls:59,vars:41,consts:()=>{let n,u,i,L,j,X,Y,w,b,k,Q,J;return n="Data",u="Now",i="Name",L="Number of adults",j="No. of children",X="Email",Y="Table",w="Cell phone",b="Note",k="Confirm",Q="Cancel",J="Set date",[[3,"autocomplete","formGroup","ngSubmit"],["class","block mb-3",3,"filters"],[1,"mb-3"],[1,"flex","items-center"],[1,"me-2","grow",3,"tuiDropdownOpen","tuiAutoFocus","tuiTextfieldSize","min","formControlName"],n,["formControlName","time",1,"grow",3,"tuiDropdownOpen","tuiTextfieldSize","items"],u,["tuiButton","","appearance","icon","type","button","size","s"],[3,"errors"],[3,"tuiTextfieldSize","formControlName"],i,["tuiTextfield","","type","text",3,"autocomplete"],[1,"me-2","grow",3,"tuiTextfieldSize","formControlName"],L,[1,"ms-2","grow",3,"tuiTextfieldSize","formControlName"],j,X,Y,w,b,[1,"flex"],["tuiButton","","type","submit","size","l",1,"me-2",3,"showLoader"],k,["tuiButton","","type","button","appearance","icon","size","l",3,"showLoader","click"],Q,[1,"block","mb-3",3,"filters"],["tuiButton","","appearance","icon","type","button","size","s",3,"click"],[1,"me-1"],J]},template:function(u,i){1&u&&(t.I0R(0,"form",0),t.qCj("ngSubmit",function(){return i.submit()}),t.yuY(1,F,3,4,"app-reservation-tables-summary",1),t.I0R(2,"div",2)(3,"div",3)(4,"tui-input-date",4),t.SAx(5),t.aS0(6,5),t.k70(),t.C$Y(),t.I0R(7,"tui-input-time",6),t.SAx(8),t.aS0(9,7),t.k70(),t.C$Y()(),t.yuY(10,W,6,0,"button",8),t.wR5(11,"app-errors",9),t.C$Y(),t.I0R(12,"div",2)(13,"tui-input",10),t.SAx(14),t.aS0(15,11),t.k70(),t.wR5(16,"input",12),t.C$Y(),t.wR5(17,"app-errors",9),t.C$Y(),t.I0R(18,"div",2)(19,"div",3)(20,"tui-input-number",13),t.SAx(21),t.aS0(22,14),t.k70(),t.wR5(23,"input",12),t.C$Y(),t.I0R(24,"tui-input-number",15),t.SAx(25),t.aS0(26,16),t.k70(),t.wR5(27,"input",12),t.C$Y()()(),t.I0R(28,"div",2)(29,"tui-input",10),t.SAx(30),t.aS0(31,17),t.k70(),t.wR5(32,"input",12),t.C$Y(),t.wR5(33,"app-errors",9),t.C$Y(),t.I0R(34,"div",2)(35,"tui-input",10),t.SAx(36),t.aS0(37,18),t.k70(),t.wR5(38,"input",12),t.C$Y(),t.wR5(39,"app-errors",9),t.C$Y(),t.I0R(40,"div",2)(41,"tui-input",10),t.SAx(42),t.aS0(43,19),t.k70(),t.wR5(44,"input",12),t.C$Y(),t.wR5(45,"app-errors",9),t.C$Y(),t.I0R(46,"div",2)(47,"tui-input",10),t.SAx(48),t.aS0(49,20),t.k70(),t.wR5(50,"input",12),t.C$Y(),t.wR5(51,"app-errors",9),t.C$Y(),t.I0R(52,"div",21)(53,"button",22),t.SAx(54),t.aS0(55,23),t.k70(),t.C$Y(),t.I0R(56,"button",24),t.qCj("click",function(){return i.cancel()}),t.SAx(57),t.aS0(58,25),t.k70(),t.C$Y()()()),2&u&&(t.E7m("autocomplete","off")("formGroup",i.form),t.yG2(),t.C0Y(1,i.form.value.date&&i.utcTime()?1:-1),t.yG2(3),t.E7m("tuiDropdownOpen",i.dateOpen())("tuiAutoFocus",!0)("tuiTextfieldSize",i.inputSize)("min",i.today)("formControlName","date"),t.yG2(3),t.E7m("tuiDropdownOpen",i.timeOpen())("tuiTextfieldSize",i.inputSize)("items",i.validTimes()),t.yG2(3),t.C0Y(10,i.isMobile?10:-1),t.yG2(),t.E7m("errors",i.e("datetime")),t.yG2(2),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","fullname"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",i.e("fullname")),t.yG2(3),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","adults"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","children"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(2),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","email"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",i.e("email")),t.yG2(2),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","table"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",i.e("table")),t.yG2(2),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","phone"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",i.e("phone")),t.yG2(2),t.E7m("tuiTextfieldSize",i.inputSize)("formControlName","notes"),t.yG2(3),t.E7m("autocomplete","off"),t.yG2(),t.E7m("errors",i.e("notes")),t.yG2(2),t.E7m("showLoader",i.loading),t.yG2(3),t.E7m("showLoader",i.loading))},dependencies:[M.g,s.sl,s.sz,s.ue,s.u,s.uW,s.Wo,m.CI,m.Kw,T.CQ,T.Oo,T.cP,K.b,d.aS,d.rD,o.Q7,o.mi,o.Qj,R.K6,E.iO,E.yc,E.Ml,C.IZ,C.iw,C.gt,r.m6,r.gJ,I.ms,I.oL,U.qL,c.u],encapsulation:2})}return S})()},1676:(v,N,e)=>{e.d(N,{s:()=>C});var t=e(4496),M=e(6772),s=e(1128),m=e(7048),d=e(8256),I=e(8392),T=e(6700),o=e(4704),R=e(9212);let C=(()=>{class a extends M.A{constructor(){super("public_data"),this.notifications=(0,t.uUt)(s.E),this.data$=new T.g(null),this.messages=(0,t.OCB)(null),this.messages$=this.data$.pipe((0,o.k)(_=>"object"==typeof _&&null!==_?function E(a){if(null==a)return null;if("object"==typeof a)return a;if(!("string"==typeof a&&a.length>0))return null;try{return JSON.parse(a)}catch{}return null}(_.public_messages):null),(0,R.y)(_=>this.messages.set(_))),this.contacts=(0,t.OCB)(null),this.contacts$=this.data$.pipe((0,o.k)(_=>"object"==typeof _&&null!==_?_.contacts:null),(0,R.y)(_=>this.contacts.set(_))),this.load(),[this.contacts$,this.messages$].forEach(_=>{_.subscribe({error:r=>{console.warn("unexpected error",r)}})})}load(){this.http.get("").subscribe({next:_=>{this.data$.next(_)},error:_=>{this.notifications.error(_ instanceof m.gj?(0,d.mk)(_):I.a)}})}static#t=this.\u0275fac=function(r){return new(r||a)};static#e=this.\u0275prov=t.wxM({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()},4820:(v,N,e)=>{e.d(N,{G:()=>C});var t=e(4496),M=e(5180),s=e(6700),m=e(4704),d=e(9212),I=e(9144),T=e(6772),o=e(1676),R=e(5136),E=e(400);let C=(()=>{class a extends T.A{constructor(){super("reservations"),this.publicData=(0,t.uUt)(o.s),this.created=new s.g(null),this.publicData.data$.subscribe({next:_=>{this.created.next(_?.reservation?new M.C(_.reservation):null)}})}getValidTimes(_){let r="";return _ instanceof E.EK&&(r=`${_.year}-${(_.month+1)%13}-${_.day}`),this.get("valid_times",{params:{date:r}}).pipe((0,m.k)(D=>D.map(P=>new R.e(P))))}getValidDates(_){return this.get("valid_dates",{params:_}).pipe((0,m.k)(r=>r.map(D=>E.EK.fromLocalNativeDate(new Date(D)))))}load(_){return this.get(`${_}`).pipe((0,m.k)(r=>new M.C(r.item)))}create(_){return this.post("",_).pipe((0,m.k)(r=>new M.C(r.item)),(0,d.y)(r=>this.created.next(r)),(0,I.a)(r=>{throw this.created.next(null),r}))}resendConfirmation(_){return this.post(`${_}/resend_confirmation_email`,{})}cancel(_){return this.post(`${_}/cancel`,{})}static#t=this.\u0275fac=function(r){return new(r||a)};static#e=this.\u0275prov=t.wxM({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()},1200:(v,N,e)=>{e.d(N,{A:()=>I,m:()=>T});var t=e(4496),M=e(900),s=e(3480),m=e(800),d=e(3616);let I=(()=>{class o{constructor(E,C,a){this.el=E,this.zone=C,this.destroy$=a,this.eventName=""}ngOnInit(){(0,m.w)(this.el.nativeElement,this.eventName,{passive:!1}).pipe((0,M.Uv)(this.zone),(0,M.uy)(),(0,d.a)(this.destroy$)).subscribe()}}return o.\u0275fac=function(E){return new(E||o)(t.GI1(t.GMv),t.GI1(t.WW2),t.GI1(s.UF,2))},o.\u0275dir=t.Sc5({type:o,selectors:[["","tuiPreventDefault",""]],inputs:{eventName:[t.Wk5.None,"tuiPreventDefault","eventName"]},features:[t.M5G([s.UF])]}),o})(),T=(()=>{class o{}return o.\u0275fac=function(E){return new(E||o)},o.\u0275mod=t.a4G({type:o}),o.\u0275inj=t.s3X({}),o})()},6988:(v,N,e)=>{e.d(N,{E:()=>I,Q:()=>T});var t=e(4496),M=e(3480),s=e(3840),m=e(3120),d=e(3616);let I=(()=>{class o{constructor(E,C){this.el=E,this.destroy$=C}set tuiScrollIntoView(E){E&&(0,m.k)(0).pipe((0,d.a)(this.destroy$)).subscribe(()=>{this.el.nativeElement.dispatchEvent(new CustomEvent(s.dG,{bubbles:!0,detail:this.el.nativeElement}))})}}return o.\u0275fac=function(E){return new(E||o)(t.GI1(t.GMv),t.GI1(M.UF,2))},o.\u0275dir=t.Sc5({type:o,selectors:[["","tuiScrollIntoView",""]],inputs:{tuiScrollIntoView:"tuiScrollIntoView"},features:[t.M5G([M.UF])]}),o})(),T=(()=>{class o{}return o.\u0275fac=function(E){return new(E||o)},o.\u0275mod=t.a4G({type:o}),o.\u0275inj=t.s3X({}),o})()},5384:(v,N,e)=>{e.d(N,{E$:()=>G,YB:()=>U,wu:()=>$});var t=e(4496),M=e(6504),s=e(900),m=e(4392),d=e(2528),I=e(1800),T=e(3656),o=e(6988),R=e(5944),E=e(4336),C=e(1040),a=e(5657),h=e(3412),_=e(8960),r=e(5568),D=e(4704),P=e(4e3),p=e(1368);function g(l,f){if(1&l&&t.wR5(0,"tui-svg",3),2&l){const O=t.GaO();t.E7m("src",O.icons.check)("tuiScrollIntoView",!0)}}function V(l,f){1&l&&t.wR5(0,"span",4)}let $=(()=>{class l{constructor(O,c,y,K,B,F,W,z){this.icons=O,this.context=c,this.host=y,this.el=K,this.option=B,this.dataList=F,this.control=W,this.abstractControl=z,this.changeDetection$=new a.E,this.selected$=(0,h.U)(this.changeDetection$,this.control.valueChanges||_.k,(0,s.Ax)(this.el.nativeElement,"animationstart")).pipe((0,r.W)(null),(0,D.k)(()=>this.selected),(0,P.a)())}get matcher(){return this.host.identityMatcher||m.y}ngOnInit(){Promise.resolve().then(()=>{var O,c;(0,d.kF)(this.option.value)&&!this.option.disabled&&(null===(c=(O=this.host).checkOption)||void 0===c||c.call(O,this.option.value))})}ngDoCheck(){this.changeDetection$.next()}get value(){var O,c;return null!==(c=null===(O=this.abstractControl)||void 0===O?void 0:O.value)&&void 0!==c?c:this.control.value}get selected(){return(0,d.kF)(this.option.value)&&(0,d.kF)(this.value)&&this.matcher(this.value,this.option.value)}}return l.\u0275fac=function(O){return new(O||l)(t.GI1(R.QJ),t.GI1(C.C0),t.GI1(R.u2),t.GI1(t.GMv),t.GI1(E.sP),t.GI1(E.yi,8),t.GI1(M.eq),t.GI1(I._y,8))},l.\u0275cmp=t.In1({type:l,selectors:[["tui-select-option"]],decls:5,vars:5,consts:[[3,"ngTemplateOutlet"],["automation-id","tui-select-option__checkmark","class","t-checkmark",3,"src","tuiScrollIntoView",4,"ngIf","ngIfElse"],["dummy",""],["automation-id","tui-select-option__checkmark",1,"t-checkmark",3,"src","tuiScrollIntoView"],[1,"t-dummy"]],template:function(O,c){if(1&O&&(t.C_f(0,0),t.yuY(1,g,1,2,"tui-svg",1),t.wVc(2,"async"),t.yuY(3,V,1,0,"ng-template",null,2,t.gJz)),2&O){const y=t.Gew(4);t.E7m("ngTemplateOutlet",c.context.$implicit),t.yG2(),t.E7m("ngIf",t.kDX(2,3,c.selected$))("ngIfElse",y)}},dependencies:[T.Wu,p.XV,p.u_,o.E,p.a],styles:['@keyframes _ngcontent-%COMP%_retrigger{0%{left:1px}to{left:2px}}[_nghost-%COMP%]{display:flex;flex:1;align-items:center;max-width:100%;animation:_ngcontent-%COMP%_retrigger 1s}.t-checkmark[_ngcontent-%COMP%]{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-border-start:.25rem solid transparent;border-inline-start:.25rem solid transparent}tui-data-list[data-list-size="s"][_nghost-%COMP%]   .t-checkmark[_ngcontent-%COMP%], tui-data-list[data-list-size="s"]   [_nghost-%COMP%]   .t-checkmark[_ngcontent-%COMP%]{-webkit-margin-end:-.375rem;margin-inline-end:-.375rem}tui-data-list[data-list-size="m"][_nghost-%COMP%]   .t-checkmark[_ngcontent-%COMP%], tui-data-list[data-list-size="m"]   [_nghost-%COMP%]   .t-checkmark[_ngcontent-%COMP%]{-webkit-margin-end:-.125rem;margin-inline-end:-.125rem}.t-dummy[_ngcontent-%COMP%]{width:1.75rem}'],changeDetection:0}),l})();const G=new C.WO($);let U=(()=>{class l{}return l.\u0275fac=function(O){return new(O||l)},l.\u0275mod=t.a4G({type:l}),l.\u0275inj=t.s3X({imports:[[p.MD,T.Yt,o.Q]]}),l})()}}]);