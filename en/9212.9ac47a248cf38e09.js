"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[9212],{1592:(O,c,e)=>{e.r(c),e.d(c,{RequireResetPasswordComponent:()=>S});var t=e(4496),d=e(1368),m=e(2992),o=e(6504),a=e(4872),s=e(9212),r=e(2300),n=e(3616),i=e(3480),_=e(5e3),E=e(8016),g=e(8212),u=e(7692),D=e(8048),P=e(3797),M=e(7568),C=e(4964),v=e(4388),y=e(8256),I=e(8392),A=e(4476),T=e(7936);let S=(()=>{class f{constructor(){this.route=(0,t.uUt)(m.gV),this.auth=(0,t.uUt)(C.o),this.dialogs=(0,t.uUt)(E._k),this.router=(0,t.uUt)(m.E5),this.destroy$=(0,t.uUt)(i.UF),this.notifications=(0,t.uUt)(v.E),this._=(0,t.uUt)(A.OY).setTitle("Forgotten password | The water door"),this.form=new o.WC({email:new o.Ku(null,[o.AQ.required,o.AQ.email])}),this.submitted=!1,this.loading=!1,this.typing=!1,this.type$=this.form.valueChanges.pipe((0,a.ay)(),(0,s.y)(()=>this.typing=!0),(0,r.o)(1e3),(0,s.y)(()=>this.typing=!1)).subscribe()}ngOnInit(){this.updateEmailFromQueryParams()}submit(){this.submitted=!0,!this.form.invalid&&(this.loading=!0,this.auth.requireResetPassword(this.form.value.email).pipe((0,n.a)(this.destroy$)).subscribe({next:()=>{this.loading=!1,this.showEmailDialog()},error:l=>{this.loading=!1,this.notifications.error((0,y.mk)(l)||I.a)}}))}updateEmailFromQueryParams(){const l=this.route.snapshot.queryParams.email;l&&this.form.patchValue({email:l})}showEmailDialog(){this.dialogs.open("We have sent you an email with details on how to reset your password.",{label:"Email sent",size:"l",data:{button:"Grazie"}}).subscribe({error:l=>console.error("Dialog closed",l),complete:()=>this.router.navigate(["/auth"],{queryParams:{email:this.form.value.email}})})}static#t=this.\u0275fac=function(h){return new(h||f)};static#e=this.\u0275cmp=t.In1({type:f,selectors:[["app-require-reset-password"]],standalone:!0,features:[t.M5G([i.UF]),t.UHJ],decls:19,vars:4,consts:()=>{let l;return l="Email",[[1,"flex","justify-center","h-full"],[1,"flex","flex-col","justify-center"],[1,"flex","flex-col",3,"formGroup","ngSubmit"],[1,"mb-1"],[1,"text-slate-400"],[1,"text-slate-400","mb-3"],[1,"mb-2"],["formControlName","email",3,"tuiAutoFocus","tuiTextfieldSize"],l,["tuiTextfield","","autocomplete","email","type","text"],[1,"flex","justify-between"],["routerLink","/auth","tuiButton","","appearance","secondary","type","button",1,"me-2"],["tuiButton","","type","submit",1,"ms-2",3,"showLoader"]]},template:function(h,R){1&h&&(t.I0R(0,"div",0)(1,"div",1)(2,"form",2),t.qCj("ngSubmit",function(){return R.submit()}),t.I0R(3,"h2",3),t.OEk(4,"Reimposta la password."),t.C$Y(),t.I0R(5,"span",4),t.OEk(6,"Inserisci l'indirizzo email dell'account."),t.C$Y(),t.I0R(7,"span",5),t.OEk(8,"Ti invieremo un'email da cui potrai resettare la password."),t.C$Y(),t.I0R(9,"div",6)(10,"tui-input",7),t.SAx(11),t.aS0(12,8),t.k70(),t.wR5(13,"input",9),t.C$Y()(),t.I0R(14,"div",10)(15,"button",11),t.OEk(16,"Annulla"),t.C$Y(),t.I0R(17,"button",12),t.OEk(18,"Conferma"),t.C$Y()()()()()),2&h&&(t.yG2(2),t.E7m("formGroup",R.form),t.yG2(8),t.E7m("tuiAutoFocus",!0)("tuiTextfieldSize","l"),t.yG2(7),t.E7m("showLoader",R.loading))},dependencies:[d.MD,o.sl,o.sz,o.ue,o.u,o.uW,o.Wo,g.CI,g.Kw,P.CQ,P.Oo,P.cP,T.b,_.m6,_.gJ,u.Sk,M.eW,D.aS,D.rD,m.qQ,m.ER],styles:["[_nghost-%COMP%]{display:block;height:100%}"]})}return f})()},8256:(O,c,e)=>{function t(a,s){return a.error?.message?a.error.message:500==a.status?`${a.error.error} ${a.error.exception}`.replace(/\</gm,"").replace(/\>+/gm,""):504==a.status?"Server unreachable, check your connection and try again.":d(function o(a){if("object"==typeof a.error&&"object"==typeof a.error.details&&Array.isArray(a.error.details)&&a.error.details.length>0){const s=a.error.details.filter(r=>"object"==typeof r&&null!=r&&r instanceof Object&&Object.keys(r).length>0).filter(r=>"string"==typeof r.attribute&&r.attribute.length>0&&("string"==typeof r.message&&r.message.length>0||Array.isArray(r.message)&&r.message.length>0));if(s.length>0)return s}return[]}(a),s)}function d(a,s){if(0==a.length)return null;const r=s?.joinChar??", ",n=a.map(i=>`${i.attribute} ${i.message}`);return n.length?function m(a){return[...new Set(a)]}(n).join(r):null}e.d(c,{Yj:()=>d,mk:()=>t})},8392:(O,c,e)=>{e.d(c,{a:()=>t});const t="Something went wrong."},4872:(O,c,e)=>{e.d(c,{ay:()=>o});var t=e(4496),d=e(3252),m=e(3616);function o(r){r||((0,t.yAg)(o),r=(0,t.uUt)(t.eM9));const n=new d._(i=>r.onDestroy(i.next.bind(i)));return i=>i.pipe((0,m.a)(n))}}}]);