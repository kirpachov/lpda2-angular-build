"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[4828],{9148:(S,D,e)=>{e.r(D),e.d(D,{AdminDashboardComponent:()=>ut});var t=e(4496),v=e(1368),p=e(4476),f=e(1528),u=e(2540),g=e(6928),O=e(5657),C=e(112),o=e(3252),A=e(5800),$=e(7368);class M{constructor(){this.subject=new u.o(1),this.subscriptions=new g.wH}doFilter(m){this.subject.next(m)}dispose(){this.subscriptions.unsubscribe()}notEmpty(m,a){this.subscriptions.add(this.subject.subscribe(s=>{if(s[m]){const h=s[m].currentValue;null!=h&&a(h)}}))}has(m,a){this.subscriptions.add(this.subject.subscribe(s=>{s[m]&&a(s[m].currentValue)}))}notFirst(m,a){this.subscriptions.add(this.subject.subscribe(s=>{s[m]&&!s[m].isFirstChange()&&a(s[m].currentValue)}))}notFirstAndEmpty(m,a){this.subscriptions.add(this.subject.subscribe(s=>{if(s[m]&&!s[m].isFirstChange()){const h=s[m].currentValue;null!=h&&a(h)}}))}}const c=new t.UbH("NGX_ECHARTS_CONFIG");let y=(()=>{class r{constructor(a,s,h){this.el=s,this.ngZone=h,this.options=null,this.theme=null,this.initOpts=null,this.merge=null,this.autoResize=!0,this.loading=!1,this.loadingType="default",this.loadingOpts=null,this.chartInit=new t._w7,this.optionsError=new t._w7,this.chartClick=this.createLazyEvent("click"),this.chartDblClick=this.createLazyEvent("dblclick"),this.chartMouseDown=this.createLazyEvent("mousedown"),this.chartMouseMove=this.createLazyEvent("mousemove"),this.chartMouseUp=this.createLazyEvent("mouseup"),this.chartMouseOver=this.createLazyEvent("mouseover"),this.chartMouseOut=this.createLazyEvent("mouseout"),this.chartGlobalOut=this.createLazyEvent("globalout"),this.chartContextMenu=this.createLazyEvent("contextmenu"),this.chartHighlight=this.createLazyEvent("highlight"),this.chartDownplay=this.createLazyEvent("downplay"),this.chartSelectChanged=this.createLazyEvent("selectchanged"),this.chartLegendSelectChanged=this.createLazyEvent("legendselectchanged"),this.chartLegendSelected=this.createLazyEvent("legendselected"),this.chartLegendUnselected=this.createLazyEvent("legendunselected"),this.chartLegendLegendSelectAll=this.createLazyEvent("legendselectall"),this.chartLegendLegendInverseSelect=this.createLazyEvent("legendinverseselect"),this.chartLegendScroll=this.createLazyEvent("legendscroll"),this.chartDataZoom=this.createLazyEvent("datazoom"),this.chartDataRangeSelected=this.createLazyEvent("datarangeselected"),this.chartGraphRoam=this.createLazyEvent("graphroam"),this.chartGeoRoam=this.createLazyEvent("georoam"),this.chartTreeRoam=this.createLazyEvent("treeroam"),this.chartTimelineChanged=this.createLazyEvent("timelinechanged"),this.chartTimelinePlayChanged=this.createLazyEvent("timelineplaychanged"),this.chartRestore=this.createLazyEvent("restore"),this.chartDataViewChanged=this.createLazyEvent("dataviewchanged"),this.chartMagicTypeChanged=this.createLazyEvent("magictypechanged"),this.chartGeoSelectChanged=this.createLazyEvent("geoselectchanged"),this.chartGeoSelected=this.createLazyEvent("geoselected"),this.chartGeoUnselected=this.createLazyEvent("geounselected"),this.chartAxisAreaSelected=this.createLazyEvent("axisareaselected"),this.chartBrush=this.createLazyEvent("brush"),this.chartBrushEnd=this.createLazyEvent("brushend"),this.chartBrushSelected=this.createLazyEvent("brushselected"),this.chartGlobalCursorTaken=this.createLazyEvent("globalcursortaken"),this.chartRendered=this.createLazyEvent("rendered"),this.chartFinished=this.createLazyEvent("finished"),this.animationFrameID=null,this.chart$=new u.o(1),this.resize$=new O.E,this.changeFilter=new M,this.resizeObFired=!1,this.echarts=a.echarts,this.theme=a.theme||null}ngOnChanges(a){this.changeFilter.doFilter(a)}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe((0,A.U)(100,C.M,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(a=>{for(const s of a)s.target===this.el.nativeElement&&(this.resizeObFired?this.animationFrameID=window.requestAnimationFrame(()=>{this.resize$.next()}):this.resizeObFired=!0)})),this.resizeOb.observe(this.el.nativeElement)),this.changeFilter.notFirstAndEmpty("options",a=>this.onOptionsChange(a)),this.changeFilter.notFirstAndEmpty("merge",a=>this.setOption(a)),this.changeFilter.has("loading",a=>this.toggleLoading(!!a)),this.changeFilter.notFirst("theme",()=>this.refreshChart())}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.loadingSub&&this.loadingSub.unsubscribe(),this.changeFilter.dispose(),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(a){this.chart?a?this.chart.showLoading(this.loadingType,this.loadingOpts):this.chart.hideLoading():this.loadingSub=this.chart$.subscribe(s=>a?s.showLoading(this.loadingType,this.loadingOpts):s.hideLoading())}setOption(a,s){if(this.chart)try{this.chart.setOption(a,s)}catch(h){console.error(h),this.optionsError.emit(h)}}refreshChart(){var a=this;return(0,f.c)(function*(){a.dispose(),yield a.initChart()})()}createChart(){const a=this.el.nativeElement;if(window&&window.getComputedStyle){const s=window.getComputedStyle(a,null).getPropertyValue("height");(!s||"0px"===s)&&(!a.style.height||"0px"===a.style.height)&&(a.style.height="400px")}return this.ngZone.runOutsideAngular(()=>("function"==typeof this.echarts?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:h})=>h(a,this.theme,this.initOpts)))}initChart(){var a=this;return(0,f.c)(function*(){yield a.onOptionsChange(a.options),a.merge&&a.chart&&a.setOption(a.merge)})()}onOptionsChange(a){var s=this;return(0,f.c)(function*(){a&&(s.chart||(s.chart=yield s.createChart(),s.chart$.next(s.chart),s.chartInit.emit(s.chart)),s.setOption(s.options,!0))})()}createLazyEvent(a){return this.chartInit.pipe((0,$.G)(s=>new o._(h=>(s.on(a,T=>this.ngZone.run(()=>h.next(T))),()=>{this.chart&&(this.chart.isDisposed()||s.off(a))}))))}static#t=this.\u0275fac=function(s){return new(s||r)(t.GI1(c),t.GI1(t.GMv),t.GI1(t.WW2))};static#e=this.\u0275dir=t.Sc5({type:r,selectors:[["echarts"],["","echarts",""]],inputs:{options:"options",theme:"theme",initOpts:"initOpts",merge:"merge",autoResize:"autoResize",loading:"loading",loadingType:"loadingType",loadingOpts:"loadingOpts"},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartHighlight:"chartHighlight",chartDownplay:"chartDownplay",chartSelectChanged:"chartSelectChanged",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendLegendSelectAll:"chartLegendLegendSelectAll",chartLegendLegendInverseSelect:"chartLegendLegendInverseSelect",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartGraphRoam:"chartGraphRoam",chartGeoRoam:"chartGeoRoam",chartTreeRoam:"chartTreeRoam",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartGeoSelectChanged:"chartGeoSelectChanged",chartGeoSelected:"chartGeoSelected",chartGeoUnselected:"chartGeoUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartGlobalCursorTaken:"chartGlobalCursorTaken",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],standalone:!0,features:[t.SYr]})}return r})();const N=(r={})=>({provide:c,useFactory:()=>({...r,echarts:()=>e.e(8820).then(e.bind(e,8820))})});var l=e(7692);const i=()=>({});let d=(()=>{class r{constructor(){this.loading=!1}ngOnChanges(a){a.stats&&this.refresh()}onChartInit(a){this.echart=a,this.refresh()}refresh(){this.stats&&this.stats["reservations-by-hour"]&&this.echart?.setOption(this.dataLoadedUpdateChart(this.stats["reservations-by-hour"]))}dataLoadedUpdateChart(a){const s=Object.keys(a),h=Object.values(a);return{xAxis:{type:"category",data:s,name:"Date and time"},yAxis:{type:"value",name:"Book yourself"},series:[{data:h,type:"bar"}]}}static#t=this.\u0275fac=function(s){return new(s||r)};static#e=this.\u0275cmp=t.In1({type:r,selectors:[["app-reservations-by-hour-bar-chart"]],inputs:{loading:"loading",stats:"stats"},standalone:!0,features:[t.M5G([N()]),t.SYr,t.UHJ],decls:2,vars:3,consts:[[3,"showLoader"],["echarts","",3,"options","chartInit"]],template:function(s,h){1&s&&(t.I0R(0,"tui-loader",0)(1,"div",1),t.qCj("chartInit",function(G){return h.onChartInit(G)}),t.C$Y()()),2&s&&(t.E7m("showLoader",h.loading),t.yG2(),t.E7m("options",t.q4q(2,i)))},dependencies:[y,l.Sk,l.Cb],encapsulation:2,changeDetection:0})}return r})();var _=e(1512),E=e(5656),b=e(8212),B=e(1236),W=e(7048),Y=e(8256),j=e(8392),X=e(6772),V=e(964);var U=e(4704);let q=(()=>{class r extends X.A{constructor(){super("/admin/stats")}stats(a={}){return this.http.get("",{params:a}).pipe((0,U.k)(s=>function J(r){return"object"==typeof r&&null!==r&&function Q(r){return"object"==typeof r&&null!==r&&Object.keys(r).every(m=>"string"==typeof m&&"number"==typeof r[m])}(r["reservations-by-hour"])}(s)?s:(console.warn("Invalid stats response",s),{})),(0,U.k)(s=>function Z(r){const m={...r};if(m["reservations-by-hour"]&&r["reservations-by-hour"]){m["reservations-by-hour"]={};for(const[a,s]of Object.entries(r["reservations-by-hour"]))m["reservations-by-hour"][(0,V.Q9)(a)]=s}return m}(s)))}static#t=this.\u0275fac=function(s){return new(s||r)};static#e=this.\u0275prov=t.wxM({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var tt=e(1128),et=e(3480),nt=e(3616),it=e(8824),F=e(6376),k=e(1560),ot=e(2920),st=e(400),K=e(9880),at=e(6580);let rt=(()=>{class r{constructor(){this.filters={order_by_direction:"asc",order_by_field:"datetime",date_from:st.EK.currentLocal().toString(),status:"active",payment_status:"todo",per_page:100,offset:0}}static#t=this.\u0275fac=function(s){return new(s||r)};static#e=this.\u0275cmp=t.In1({type:r,selectors:[["app-list-reservations-requiring-payment"]],standalone:!0,features:[t.UHJ],decls:6,vars:3,consts:()=>{let a;return a="Unpaid bookings (\n          " + "\ufffd0\ufffd" + "\n        )",[[3,"expanded"],[1,"text-lg"],a,[3,"filters"],["list",""]]},template:function(s,h){if(1&s&&(t.I0R(0,"tui-expand",0)(1,"p",1),t.SAx(2),t.aS0(3,2),t.k70(),t.C$Y(),t.wR5(4,"app-admin-list-reservations",3,4),t.C$Y()),2&s){const T=t.Gew(5);t.E7m("expanded",T.items().length>0),t.yG2(3),t.oBb(T.items().length),t.Ylm(3),t.yG2(),t.E7m("filters",h.filters)}},dependencies:[K.kh,K.st,at.k],encapsulation:2,changeDetection:0})}return r})();function lt(r,m){1&r&&(t.SAx(0),t.aS0(1,20),t.k70())}function ct(r,m){1&r&&(t.SAx(0),t.aS0(1,21),t.k70())}function dt(r,m){1&r&&(t.SAx(0),t.aS0(1,22),t.k70())}function ht(r,m){1&r&&(t.SAx(0),t.aS0(1,23),t.k70())}let ut=(()=>{class r{constructor(){this._=(0,t.uUt)(p.OY).setTitle("Dashboard | La Porta D'Acqua"),this.service=(0,t.uUt)(q),this.destroy$=(0,t.uUt)(et.UF),this.notifications=(0,t.uUt)(tt.E),this.datePipe=(0,t.uUt)(v.y),this.reservationsEvents=(0,t.uUt)(ot.I),this.loading=(0,t.OCB)(!1),this.stats=(0,t.OCB)(null),this.today=new Date}ngOnInit(){this.loadStats(),this.reservationsEvents.listenWsChanges().subscribe({next:()=>this.loadStats()})}loadStats(){const a=this.datePipe.transform(this.today,"yyyy-MM-dd")||"",s=this.datePipe.transform(this.today,"yyyy-MM-dd")||"";this.loading.set(!0),this.service.stats({reservations_date_from:a,reservations_date_to:s}).pipe((0,nt.a)(this.destroy$),(0,it.U)(()=>this.loading.set(!1))).subscribe({next:h=>{this.stats.set(h)},error:h=>{this.notifications.error(h instanceof W.gj?(0,Y.mk)(h):j.a)}})}static#t=this.\u0275fac=function(s){return new(s||r)};static#e=this.\u0275cmp=t.In1({type:r,selectors:[["app-admin-dashboard"]],standalone:!0,features:[t.UHJ],decls:51,vars:11,consts:()=>{let a,s,h,T,G,w,H,P,I,R,L;return a="La porta d'acqua - dashboard",s="Booked for today",h="Booked for this week.",T="Booked for this month.",G="Booked for this year.",w="Reservations",H="Below is the number of bookings for today.",P="\n           Number of bookings for today. Canceled or annulled bookings are\n          excluded. Both adults and children are counted. \n        ",I="Number of bookings from last Monday to next Sunday.",R="Number of bookings from the first day until the last day of the current month.",L="Number of bookings from the first day until the last day of the current year.",[["currentDayReservations",""],["currentWeekReservationsHint",""],["currentMonthReservationsHint",""],["currentYearReservationsHint",""],[1,"flex","items-center"],a,["tuiIconButton","","appearance","icon","type","button",3,"showLoader","click"],[1,"flex","flex-wrap","items-center"],[1,"col-12","md:col-6","lg:col-3","p-1"],[1,"tui-island__title",3,"tuiHint"],s,[1,"tui-island__paragraph"],h,T,G,["tuiLink","","routerLink","/admin/reservations"],[1,"text-xl"],w,H,[3,"stats","loading"],P,I,R,L]},template:function(s,h){if(1&s&&(t.yuY(0,lt,2,0,"ng-template",null,0,t.gJz)(2,ct,2,0,"ng-template",null,1,t.gJz)(4,dt,2,0,"ng-template",null,2,t.gJz)(6,ht,2,0,"ng-template",null,3,t.gJz),t.I0R(8,"div",4)(9,"h1"),t.aS0(10,5),t.C$Y(),t.I0R(11,"button",6),t.qCj("click",function(){return h.loadStats()}),t.I0R(12,"mat-icon"),t.OEk(13,"refresh"),t.C$Y()()(),t.I0R(14,"div",7)(15,"div",8)(16,"tui-island")(17,"h3",9),t.SAx(18),t.aS0(19,10),t.k70(),t.C$Y(),t.I0R(20,"p",11),t.OEk(21),t.C$Y()()(),t.I0R(22,"div",8)(23,"tui-island")(24,"h3",9),t.SAx(25),t.aS0(26,12),t.k70(),t.C$Y(),t.I0R(27,"p",11),t.OEk(28),t.C$Y()()(),t.I0R(29,"div",8)(30,"tui-island")(31,"h3",9),t.SAx(32),t.aS0(33,13),t.k70(),t.C$Y(),t.I0R(34,"p",11),t.OEk(35),t.C$Y()()(),t.I0R(36,"div",8)(37,"tui-island")(38,"h3",9),t.SAx(39),t.aS0(40,14),t.k70(),t.C$Y(),t.I0R(41,"p",11),t.OEk(42),t.C$Y()()()(),t.I0R(43,"div")(44,"a",15)(45,"span",16),t.aS0(46,17),t.C$Y()(),t.I0R(47,"p"),t.aS0(48,18),t.C$Y(),t.wR5(49,"app-reservations-by-hour-bar-chart",19)(50,"app-list-reservations-requiring-payment"),t.C$Y()),2&s){const T=t.Gew(1),G=t.Gew(3),w=t.Gew(5),H=t.Gew(7);let P,I,R,L;t.yG2(11),t.E7m("showLoader",h.loading()),t.yG2(6),t.E7m("tuiHint",T),t.yG2(4),t.oRS(" ",null!==(P=null==(P=h.stats())||null==P["reservations-count"]||null==P["reservations-count"].current?null:P["reservations-count"].current.day)&&void 0!==P?P:"?"," "),t.yG2(3),t.E7m("tuiHint",G),t.yG2(4),t.oRS(" ",null!==(I=null==(I=h.stats())||null==I["reservations-count"]||null==I["reservations-count"].current?null:I["reservations-count"].current.week)&&void 0!==I?I:"?"," "),t.yG2(3),t.E7m("tuiHint",w),t.yG2(4),t.oRS(" ",null!==(R=null==(R=h.stats())||null==R["reservations-count"]||null==R["reservations-count"].current?null:R["reservations-count"].current.month)&&void 0!==R?R:"?"," "),t.yG2(3),t.E7m("tuiHint",H),t.yG2(4),t.oRS(" ",null!==(L=null==(L=h.stats())||null==L["reservations-count"]||null==L["reservations-count"].current?null:L["reservations-count"].current.year)&&void 0!==L?L:"?"," "),t.yG2(7),t.E7m("stats",h.stats())("loading",h.loading())}},dependencies:[v.MD,d,_.w,_.C,B.qQ,B.ER,F.k,F.C,E.WY,E.lh,E.SL,E.i6,E.IT,b.CI,b.Kw,k.oB,k.qL,rt],encapsulation:2,changeDetection:0})}return r})()},8128:(S,D,e)=>{function t(v){if(!v)return null;const p=v.match(/filename="(.+)"/);return p?p[1]:null}e.d(D,{k:()=>t})},9772:(S,D,e)=>{e.d(D,{CU:()=>p,MJ:()=>v,ye:()=>f}),(new Date).getTimezoneOffset();const v=1;function p(u,g=v){if(!("string"==typeof u&&u.length>0&&u.match(/\d{1,2}:\d{1,2}/)))return console.error("Invalid string provided to strTimeTimezone",{string:u}),"";const C=Number(u.split(":")[0])+g;return`${C<10?"0":""}${C}:${u.split(":")[1]}`}function f(u,g=v){return p(u,-1*g)}},964:(S,D,e)=>{e.d(D,{Ez:()=>A,In:()=>y,Q1:()=>z,Q9:()=>c,QX:()=>C,Qx:()=>f,_0:()=>N,ay:()=>u,cr:()=>O,e6:()=>p,yc:()=>g});var t=e(400),v=e(9772);const p=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z$/;function f(n,l){const i=new t.uc(l.hours,l.minutes).shift({hours:-v.MJ});return new Date(Date.UTC(n.year,n.month,n.day,i.hours,i.minutes)).toISOString()}function u(n){if(!("string"==typeof n&&n.length>0&&n.match(p)))return console.error("Invalid string provided to isoStringToTuiDay",{isoString:n}),null;const l=new Date(n);return new t.EK(l.getFullYear(),l.getMonth()+1,l.getDate())}function g(n){if("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}\s{1}\d{1,2}:\d{1,2}$/)&&(n=n.split(" ")[0]),!("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}$/)))return console.error("Invalid string provided to stringToTuiDay. Expected format YYYY-MM-DD, got",{str:n}),null;const{day:l,month:i,year:d}=t.EK.parseRawDateString(n,"YMD");return new t.EK(d,i,l)}function O(n){if("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}\s{1}\d{1,2}:\d{1,2}$/)&&(n=n.split(" ")[1]),!("string"==typeof n&&n.length>0&&n.match(/^\d{1,2}:\d{1,2}$/)))return console.error("Invalid string provided to stringToTuiDay. Expected format HH:mm, got",{str:n}),null;const[l,i]=n.split(":").map(d=>Number(d));return"number"==typeof l&&l>=0&&l<=23?"number"==typeof i&&i>=0&&i<60?new t.uc(l,i):(console.error("error while parsing time in stringToTuiTime. minutes are invalid",{minutes:i}),null):(console.error("error while parsing time in stringToTuiTime. hours is invalid ",{hours:l}),null)}function C(n){if(!("string"==typeof n&&n.length>0&&n.match(p)))return console.error("Invalid string provided to isoStringToTuiTime",{isoString:n}),null;const l=new Date(n);return new t.uc(l.getHours(),l.getMinutes())}function A(n){return new Date(`1970-01-01 ${n.toString()}`).toISOString()}function c(n){const l=new Date(`${n}Z`);return`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")} ${String(l.getHours()).padStart(2,"0")}:${String(l.getMinutes()).padStart(2,"0")}`}function y(n){return function $(n){const l=new Date(`1970-01-01 ${n}`);return`${`${l.getUTCHours()}`.padStart(2,"0")}:${`${l.getUTCMinutes()}`.padStart(2,"0")}`}(n.toString())}function N(n){return new t.EK(n.getFullYear(),n.getMonth(),n.getDate())}function z(n){return new t.uc(n.getHours(),n.getMinutes())}},2264:(S,D,e)=>{e.d(D,{W:()=>v});var t=e(8400);class v extends t.w{constructor(f){super(f),this.filename=f.filename,this.status=f.status,this.key=f.key,this.original_id=f.original_id,this.tag=f.tag,this.url=f.url}}},5180:(S,D,e)=>{e.d(D,{C:()=>O});var t=e(8400);class v extends t.w{constructor(o){super(o),this.image_pixel_id=o.image_pixel_id,this.event_data=o.event_data,this.event_time=o.event_time?new Date(o.event_time):void 0}}class p extends t.w{constructor(o){super(o),this.image_id=o.image_id,this.delivered_email_id=o.delivered_email_id,this.record_type=o.record_type,this.record_id=o.record_id,this.event_type=o.event_type,this.secret=o.secret,this.events=o.events?o.events.map(A=>new v(A)):[]}}class f extends t.w{constructor(o){super(o),this.record_id=o.record_id,this.record_type=o.record_type,this.text=o.text,this.html=o.html,this.subject=o.subject,this.headers=o.headers,this.raw=o.raw,this.image_pixels=o.image_pixels?o.image_pixels.map(A=>new p(A)):[]}}class u extends t.w{constructor(o){super(o),this.hpp_url=o.hpp_url,this.value=o.value,this.status=o.status,this.reservation_id=o.reservation_id,this.preorder_type=o.preorder_type,this.external_id=o.external_id,this.other=o.other}}var g=e(9064);class O extends t.w{get people(){return(this.adults||0)+(this.children||0)}constructor(o){super(o),this.fullname=o.fullname,this.datetime=o.datetime?new Date(o.datetime):void 0,this.cancelled_at=o.cancelled_at?new Date(o.cancelled_at):void 0,this.status=o.status,this.secret=o.secret,this.adults=o.adults,this.children=o.children,this.table=o.table,this.notes=o.notes,this.email=o.email,this.phone=o.phone,this.payment=o.payment?new u(o.payment):void 0,this.delivered_emails=o.delivered_emails?o.delivered_emails.map(A=>new f(A)):[],this.table_type_id=o.table_type_id,this.table_type=o.table_type?new g.g(o.table_type):void 0}}},9064:(S,D,e)=>{e.d(D,{g:()=>p});var t=e(8400),v=e(2264);class p extends t.w{constructor(u){super(u),this.name=u.name,this.description=u.description,this.default_people_per_turn=u.default_people_per_turn,this.default_price=u.default_price,this.notes=u.notes,this.status=u.status,this.translations=u.translations,this.images=u.images?u.images.map(g=>new v.W(g)):[]}}},8304:(S,D,e)=>{e.d(D,{S:()=>o});var t=e(6012),v=e(5180),p=e(4704),f=e(3252),u=e(9144),g=e(7048),O=e(8128),C=e(4496);let o=(()=>{class A extends t.s{constructor(){super(v.C,"admin/reservations")}createPayment(M,c){return this.post(`${M}/payment`,c).pipe((0,p.k)(y=>this.mapItem(y)))}updateStatus(M,c){return this.patch(`${M}/status/${c}`,{}).pipe((0,p.k)(y=>this.mapItem(y)))}tablesSummary(M={}){return this.get("tables_summary",{params:M})}ungroupedTablesSummary(M={}){return this.get("ungrouped_tables_summary",{params:M})}deliverConfirmationEmail(M){return this.post(`${M}/deliver_confirmation_email`,{}).pipe((0,p.k)(c=>this.mapItem(c)))}refoundPayment(M){return this.post(`${M}/refund_payment`,{}).pipe((0,p.k)(c=>this.mapItem(c)))}confirmPayment(M){return this.post(`${M}/record_deferred_payment`,{}).pipe((0,p.k)(c=>this.mapItem(c)))}refreshPaymentStatus(M){return this.post(`${M}/refresh_payment_status`,{}).pipe((0,p.k)(c=>this.mapItem(c)))}export(M){return new f._(c=>{this.get("export",{responseType:"blob",observe:"response",params:M}).pipe((0,u.a)(y=>(console.error("ReservationsService.export() error:",y),c.error(y),new f._))).subscribe(y=>{if(y instanceof g.WA&&y.body){const N=(0,O.k)(y.headers?.get("Content-Disposition"))??"Prenotazioni.xlsx",z=y.headers?.get("Content-Type")??"application/octet-stream",n=window.URL.createObjectURL(new Blob([y.body],{type:z})),l=document.createElement("a");l.href=n,l.download=N,l.click(),c.complete()}})})}static#t=this.\u0275fac=function(c){return new(c||A)};static#e=this.\u0275prov=C.wxM({token:A,factory:A.\u0275fac,providedIn:"root"})}return A})()},9880:(S,D,e)=>{e.d(D,{kP:()=>M,kh:()=>z,st:()=>N});var t=e(4496),v=e(3480),p=e(4392),f=e(3120),u=e(3616),g=e(7692),O=e(1368);const C=["wrapper"];function o(n,l){if(1&n&&(t.I0R(0,"tui-loader",4),t.C_f(1,5),t.C$Y()),2&n){const i=t.GaO(2);t.E7m("overlay",!0)("showLoader",i.loading),t.yG2(),t.E7m("ngTemplateOutlet",i.content)}}function A(n,l){if(1&n&&(t.SAx(0),t._Xx(1),t.yuY(2,o,2,3,"tui-loader",3),t.k70()),2&n){const i=t.GaO();t.yG2(2),t.E7m("ngIf",i.async)("ngIfElse",i.content)}}const $=["*"];let M=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275dir=t.Sc5({type:n,selectors:[["","tuiExpandContent",""]]}),n})();let N=(()=>{class n{constructor(i,d){this.cdr=i,this.destroy$=d,this.state=0,this.async=!1,this.content=null,this.expanded=null}set expandedSetter(i){if(null!==this.expanded)return 0!==this.state?(this.expanded=i,void(this.state=3)):(this.expanded=i,void this.retrigger(this.async&&i?1:3));this.expanded=i}get overflow(){return 0!==this.state}get loading(){return!!this.expanded&&this.async&&1===this.state}get height(){const{expanded:i,state:d,contentWrapper:_}=this;return i&&2===d||!i&&3===d?0:_&&(!i&&2===d||i&&3===d)?_.nativeElement.offsetHeight:_&&i&&1===d?Math.max(_.nativeElement.offsetHeight,48):null}get contentVisible(){return this.expanded||0!==this.state}onTransitionEnd({propertyName:i}){"opacity"===i&&3===this.state&&(this.state=0)}onExpandLoaded(i){i.stopPropagation(),1===this.state&&this.retrigger(3)}retrigger(i){this.state=2,(0,f.k)(0).pipe((0,u.a)(this.destroy$)).subscribe(()=>{2===this.state&&(this.state=i,this.cdr.markForCheck())})}}return n.\u0275fac=function(i){return new(i||n)(t.GI1(t.kD9),t.GI1(v.UF,2))},n.\u0275cmp=t.In1({type:n,selectors:[["tui-expand"]],contentQueries:function(i,d,_){if(1&i&&t.szK(_,M,5,t.Yw2),2&i){let E;t.wto(E=t.Gqi())&&(d.content=E.first)}},viewQuery:function(i,d){if(1&i&&t.CC$(C,5),2&i){let _;t.wto(_=t.Gqi())&&(d.contentWrapper=_.first)}},hostVars:9,hostBindings:function(i,d){1&i&&t.qCj("transitionend.self",function(E){return d.onTransitionEnd(E)})("tui-expand-loaded",function(E){return d.onExpandLoaded(E)}),2&i&&(t.e48("aria-expanded",d.expanded),t.m4B("height",d.height,"px"),t.eAK("_expanded",d.expanded)("_overflow",d.overflow)("_loading",d.loading))},inputs:{async:"async",expandedSetter:[t.Wk5.None,"expanded","expandedSetter"]},features:[t.M5G([v.UF])],ngContentSelectors:$,decls:3,vars:3,consts:[[1,"t-wrapper"],["wrapper",""],[4,"ngIf"],["size","l",3,"overlay","showLoader",4,"ngIf","ngIfElse"],["size","l",3,"overlay","showLoader"],[3,"ngTemplateOutlet"]],template:function(i,d){1&i&&(t.kPM(),t.I0R(0,"div",0,1),t.yuY(2,A,3,2,"ng-container",2),t.C$Y()),2&i&&(t.E7m("@tuiParentAnimation",void 0)("@.disabled",d.overflow),t.yG2(2),t.E7m("ngIf",d.contentVisible))},dependencies:[g.Cb,O.u_,O.XV],styles:['[_nghost-%COMP%]{transition-property:opacity,height,visibility;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;display:block;opacity:0;transition-delay:1ms}._overflow[_nghost-%COMP%]{overflow:hidden}._expanded[_nghost-%COMP%]{opacity:1;transform:translate(0)}._loading[_nghost-%COMP%]{opacity:.99}.t-wrapper[_ngcontent-%COMP%]:before, .t-wrapper[_ngcontent-%COMP%]:after{content:"";display:table}'],data:{animation:[p.cI]},changeDetection:0}),n})(),z=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=t.a4G({type:n}),n.\u0275inj=t.s3X({imports:[[O.MD,g.Sk]]}),n})()},1512:(S,D,e)=>{e.d(D,{C:()=>n,w:()=>l});var t=e(4496),v=e(900),p=e(4392),f=e(4164),u=e(3480),g=e(4680),O=e(3972),C=e(5944),o=e(3412),A=e(4704),$=e(3656),M=e(1368);const c=["tuiLink",""];function y(i,d){if(1&i&&t.wR5(0,"tui-svg",3),2&i){const _=t.GaO();t.E7m("src",_.icon||"")}}function N(i,d){if(1&i&&t.wR5(0,"tui-svg",4),2&i){const _=t.GaO();t.E7m("src",_.icon||"")}}const z=["*"];let n=(()=>{class i{constructor(_,E,b){this.el=_,this.mode$=E,this.pseudo=!1,this.icon="",this.iconAlign="right",this.iconRotated=!1,this.mode=null,this.focusVisible=!1,this.focusedChange=(0,o.U)((0,v.Ax)(this.el.nativeElement,"focusin").pipe((0,A.k)(p.Ml)),(0,v.Ax)(this.el.nativeElement,"focusout").pipe((0,A.k)(p.so))),b.subscribe(B=>{this.focusVisible=B})}get nativeFocusableElement(){return this.el.nativeElement}get focused(){return(0,f.ER)(this.nativeFocusableElement)}get hasIcon(){return!!this.icon}get iconAlignLeft(){return this.hasIcon&&"left"===this.iconAlign}get iconAlignRight(){return this.hasIcon&&"right"===this.iconAlign}}return i.\u0275fac=function(_){return new(_||i)(t.GI1(t.GMv),t.GI1(C.Yx),t.GI1(u.MF))},i.\u0275cmp=t.In1({type:i,selectors:[["a","tuiLink",""],["button","tuiLink",""]],hostVars:7,hostBindings:function(_,E){1&_&&t.qCj("$.data-mode.attr",function(){return E.mode$}),2&_&&(t.e48("data-host-mode",E.mode),t.eAK("_pseudo",E.pseudo)("_icon-rotated",E.iconRotated)("_focus-visible",E.focusVisible))},inputs:{pseudo:"pseudo",icon:"icon",iconAlign:"iconAlign",iconRotated:"iconRotated",mode:"mode"},exportAs:["tuiLink"],features:[t.M5G([(0,g.NK)(i),u.MF,u.UF,O.Ir])],attrs:c,ngContentSelectors:z,decls:4,vars:2,consts:[["class","t-icon t-icon_left",3,"src",4,"ngIf"],[1,"t-content"],["class","t-icon t-icon_right",3,"src",4,"ngIf"],[1,"t-icon","t-icon_left",3,"src"],[1,"t-icon","t-icon_right",3,"src"]],template:function(_,E){1&_&&(t.kPM(),t.yuY(0,y,1,1,"tui-svg",0),t.I0R(1,"span",1),t._Xx(2),t.C$Y(),t.yuY(3,N,1,1,"tui-svg",2)),2&_&&(t.E7m("ngIf",E.iconAlignLeft),t.yG2(3),t.E7m("ngIf",E.iconAlignRight))},dependencies:[$.Wu,M.u_],styles:["[_nghost-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;border:0;background:none;font-size:inherit;line-height:inherit;text-decoration:none;transition-property:color;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;color:var(--tui-link);text-align:left;text-transform:inherit;font-weight:inherit;cursor:pointer;outline:none}[_nghost-%COMP%]:hover{color:var(--tui-link-hover)}[_nghost-%COMP%]:disabled{opacity:var(--tui-disabled-opacity);cursor:default}[data-mode=onLight][_nghost-%COMP%]{color:var(--tui-text-02)}[data-mode=onLight][_nghost-%COMP%]:hover, [data-mode=onLight]._active[_nghost-%COMP%]{color:var(--tui-text-01)}[data-mode=onLight]._pseudo[_nghost-%COMP%]{color:var(--tui-text-01)}[data-mode=onLight]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(0,0,0,.48);text-decoration-color:#0000007a}[data-mode=onLight]._pseudo[_nghost-%COMP%]:hover, [data-mode=onLight]._pseudo._active[_nghost-%COMP%]{color:var(--tui-text-03)}[data-mode=onLight][data-host-mode=negative][_nghost-%COMP%]{color:var(--tui-negative-night)}[data-mode=onLight][data-host-mode=negative][_nghost-%COMP%]:hover, [data-mode=onLight][data-host-mode=negative][_nghost-%COMP%]:active, [data-mode=onLight][data-host-mode=negative]._active[_nghost-%COMP%]{color:var(--tui-negative-night-hover)}[data-mode=onDark][_nghost-%COMP%]{color:var(--tui-text-03-night)}[data-mode=onDark][_nghost-%COMP%]:hover, [data-mode=onDark][_nghost-%COMP%]:active, [data-mode=onDark]._active[_nghost-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._pseudo[_nghost-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(255,255,255,.48);text-decoration-color:#ffffff7a}[data-mode=onDark]._pseudo[_nghost-%COMP%]:hover, [data-mode=onDark]._pseudo[_nghost-%COMP%]:active, [data-mode=onDark]._pseudo._active[_nghost-%COMP%]{color:var(--tui-text-03-night)}[data-mode=onDark][data-host-mode=positive][_nghost-%COMP%]{color:var(--tui-positive-night)}[data-mode=onDark][data-host-mode=positive][_nghost-%COMP%]:hover, [data-mode=onDark][data-host-mode=positive][_nghost-%COMP%]:active, [data-mode=onDark][data-host-mode=positive]._active[_nghost-%COMP%]{color:var(--tui-positive-night-hover)}[data-host-mode=negative][_nghost-%COMP%]{color:var(--tui-negative)}[data-host-mode=negative][_nghost-%COMP%]:hover{color:var(--tui-negative-hover)}[data-host-mode=negative]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(222,76,30,.48);text-decoration-color:#de4c1e7a}[data-host-mode=positive][_nghost-%COMP%]{color:var(--tui-positive)}[data-host-mode=positive][_nghost-%COMP%]:hover{color:var(--tui-positive-hover)}[data-host-mode=positive]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(58,169,129,.48);text-decoration-color:#3aa9817a}._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-selection)}[data-mode=onLight]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-clear);color:var(--tui-text-01)}[data-mode=onDark]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-clear-inverse);color:var(--tui-text-01-night)}[data-host-mode=positive]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-success-bg)}[data-host-mode=negative]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-error-bg)}._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{padding-bottom:.15em;-webkit-text-decoration:underline dashed rgba(51,111,238,.48);text-decoration:underline dashed rgba(51,111,238,.48);text-underline-offset:.2em;text-decoration-thickness:.7px}.t-icon[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;width:var(--tui-link-icon-size, 1.5rem);height:var(--tui-link-icon-size, 1.5rem);margin-top:-.125rem}.t-icon_left[_ngcontent-%COMP%]{margin-right:.25rem}.t-icon_right[_ngcontent-%COMP%]{margin-left:.25rem}._icon-rotated[_nghost-%COMP%]   .t-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}"],changeDetection:0}),i})(),l=(()=>{class i{}return i.\u0275fac=function(_){return new(_||i)},i.\u0275mod=t.a4G({type:i}),i.\u0275inj=t.s3X({imports:[[M.MD,$.Yt]]}),i})()},6376:(S,D,e)=>{e.d(D,{C:()=>f,k:()=>u});var t=e(4496),v=e(1368);const p=["*"];let f=(()=>{class g{constructor(){this.size="m",this.textAlign="left",this.hoverable=!1,this.transparent=!1}get sizeS(){return"s"===this.size}get sizeM(){return"m"===this.size}get sizeL(){return"l"===this.size}get textAlignLeft(){return"left"===this.textAlign}get textAlignCenter(){return"center"===this.textAlign}get textAlignRight(){return"right"===this.textAlign}}return g.\u0275fac=function(C){return new(C||g)},g.\u0275cmp=t.In1({type:g,selectors:[["tui-island"],["a","tuiIsland",""]],hostAttrs:[1,"tui-island"],hostVars:16,hostBindings:function(C,o){2&C&&t.eAK("tui-island_hoverable",o.hoverable)("tui-island_transparent",o.transparent)("tui-island_size_s",o.sizeS)("tui-island_size_m",o.sizeM)("tui-island_size_l",o.sizeL)("tui-island_text-align_left",o.textAlignLeft)("tui-island_text-align_center",o.textAlignCenter)("tui-island_text-align_right",o.textAlignRight)},inputs:{size:"size",textAlign:"textAlign",hoverable:"hoverable",transparent:"transparent"},ngContentSelectors:p,decls:1,vars:0,template:function(C,o){1&C&&(t.kPM(),t._Xx(0))},styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),g})(),u=(()=>{class g{}return g.\u0275fac=function(C){return new(C||g)},g.\u0275mod=t.a4G({type:g}),g.\u0275inj=t.s3X({imports:[[v.MD]]}),g})()}}]);