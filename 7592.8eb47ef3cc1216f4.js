"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[7592],{8336:(y,R,i)=>{i.r(R),i.d(R,{DuplicateCategoryModule:()=>X});var t=i(1236),A=i(7552),e=i(4496),M=i(1712),O=i(3480),s=i(6504),n=i(9852),r=i(3616),a=i(8824),C=i(1128),l=i(5820),g=i(8256),u=i(9938),v=i(2368),I=i(9956),P=i(8976),_=i(8212),m=i(9880),o=i(1512),E=i(3580),T=i(8392),N=i(9088);let H=(()=>{class h{constructor(){this.destroy$=(0,e.uUt)(O.UF),this.router=(0,e.uUt)(t.E5),this.route=(0,e.uUt)(t.gV),this.service=(0,e.uUt)(M.S),this.notifications=(0,e.uUt)(C.E),this.submitted=!1,this.category=(0,e.OCB)(null),this.form=new s.WC({copy_dishes:new s.Ku("full",[s.AQ.required,n.S.in(["full","link","none"])]),copy_images:new s.Ku("full",[s.AQ.required,n.S.in(["full","link","none"])]),copy_children:new s.Ku("full",[s.AQ.required,n.S.in(["full","none"])]),create_as_root:new s.Ku(!1),parent:new s.Ku(null,[n.S.instanceof(l.Q)])}),this.saving=(0,e.OCB)(!1),this.loading=(0,e.S6b)(()=>this.saving()),this.e=this.getErrorsFor}ngOnInit(){this.route.parent?.parent?.params.pipe((0,r.a)(this.destroy$)).subscribe({next:c=>{this.loadCategory(c.category_id)}})}submit(){if(this.submitted=!0,this.form.invalid)return;const c=this.category()?.id;if(!c)throw new Error(`Category id invalid: ${c}`);this.saving.set(!0),this.service.copy(c,this.formValue()).pipe((0,r.a)(this.destroy$),(0,a.U)(()=>this.saving.set(!1))).subscribe({next:d=>{this.notifications.fireSnackBar("Duplicato."),this.router.navigate(["../..",d.id],{relativeTo:this.route})},error:d=>{this.manageError(d)}})}cancel(){(this.form.touched||this.form.dirty)&&!confirm("Sei sicuro di voler annullare le modifiche fatte?")||(this.notifications.fireSnackBar("Operazione annullata"),this.navigateBack())}formValue(){return{copy_dishes:this.form.value.copy_dishes,copy_images:this.form.value.copy_images,copy_children:this.form.value.copy_children,parent_id:this.form.value.create_as_root?null:this.form.value.parent?.id??null}}navigateBack(){this.router.navigate([".."],{relativeTo:this.route})}manageError(c){422==c.status?u.y.assignErrorsToForm(this.form,c):this.notifications.error((0,g.mk)(c)||T.a)}getErrorsFor(c){const d=this.form.get(c);return d&&(this.submitted||d.touched||d.dirty)?d.errors:null}loadCategory(c){c&&this.service.show(c).pipe((0,r.a)(this.destroy$)).subscribe({next:d=>{this.category.set(d)},error:d=>{this.notifications.error((0,g.mk)(d)||T.a)}})}static#e=this.\u0275fac=function(d){return new(d||h)};static#t=this.\u0275cmp=e.In1({type:h,selectors:[["app-duplicate-category"]],standalone:!0,features:[e.M5G([O.UF]),e.UHJ],decls:67,vars:33,consts:()=>{let c,d,f,S,D,G,L,U,$,Y,B,x,k,z;return c="Copia categoria",d="Creare la nuova categoria come:",f="Men\xF9 principale",S="Categoria padre della nuova categoria:",D="Copiare sotto-categorie?",G="Copia",L="Copiare piatti?",U="Copia",$="Associa esistenti",Y="Copiare immagini?",B="Copia",x="Associa esistenti",k="Conferma",z="Annulla",[[1,"flex","items-center"],c,[1,"ml-2"],["tuiLink","",3,"routerLink"],[3,"formGroup","ngSubmit"],[1,"mb-3"],d,["tuiGroup","",1,"group",3,"collapsed"],["contentAlign","right","size","l",3,"hideRadio","formControlName","item"],f,[3,"errors"],[3,"expanded"],[3,"formControlName"],S,D,["contentAlign","right","formControlName","copy_children","item","full","size","l",3,"hideRadio"],G,["contentAlign","right","formControlName","copy_children","item","none","size","l",3,"hideRadio"],L,["contentAlign","right","formControlName","copy_dishes","item","full","size","l",3,"hideRadio"],U,["contentAlign","right","formControlName","copy_dishes","item","link","size","l",3,"hideRadio"],$,["contentAlign","right","formControlName","copy_dishes","item","none","size","l",3,"hideRadio"],Y,["contentAlign","right","formControlName","copy_images","item","full","size","l",3,"hideRadio"],B,["contentAlign","right","formControlName","copy_images","item","link","size","l",3,"hideRadio"],x,["contentAlign","right","formControlName","copy_images","item","none","size","l",3,"hideRadio"],["type","submit","size","l","tuiButton","",1,"me-2",3,"appearance"],k,["type","button","size","l","tuiButton","",1,"me-2",3,"appearance","click"],z]},template:function(d,f){if(1&d&&(e.I0R(0,"div",0)(1,"h1"),e.aS0(2,1),e.C$Y(),e.I0R(3,"span",2)(4,"a",3),e.wVc(5,"urlTo"),e.OEk(6),e.C$Y()()(),e.I0R(7,"form",4),e.qCj("ngSubmit",function(){return f.submit()}),e.I0R(8,"div",5)(9,"p"),e.aS0(10,6),e.C$Y(),e.I0R(11,"div",7)(12,"tui-radio-block",8),e.SAx(13),e.aS0(14,9),e.k70(),e.C$Y(),e.I0R(15,"tui-radio-block",8),e.OEk(16," Sotto-categoria "),e.C$Y()(),e.wR5(17,"app-errors",10),e.C$Y(),e.I0R(18,"tui-expand",11)(19,"div",5)(20,"app-menu-category-select",12),e.SAx(21),e.aS0(22,13),e.k70(),e.C$Y(),e.wR5(23,"app-errors",10),e.C$Y()(),e.I0R(24,"div",5)(25,"p"),e.aS0(26,14),e.C$Y(),e.I0R(27,"div",7)(28,"tui-radio-block",15),e.SAx(29),e.aS0(30,16),e.k70(),e.C$Y(),e.I0R(31,"tui-radio-block",17),e.OEk(32," No "),e.C$Y()(),e.wR5(33,"app-errors",10),e.C$Y(),e.I0R(34,"div",5)(35,"p"),e.aS0(36,18),e.C$Y(),e.I0R(37,"div",7)(38,"tui-radio-block",19),e.SAx(39),e.aS0(40,20),e.k70(),e.C$Y(),e.I0R(41,"tui-radio-block",21),e.SAx(42),e.aS0(43,22),e.k70(),e.C$Y(),e.I0R(44,"tui-radio-block",23),e.OEk(45," No "),e.C$Y()(),e.wR5(46,"app-errors",10),e.C$Y(),e.I0R(47,"div",5)(48,"p"),e.aS0(49,24),e.C$Y(),e.I0R(50,"div",7)(51,"tui-radio-block",25),e.SAx(52),e.aS0(53,26),e.k70(),e.C$Y(),e.I0R(54,"tui-radio-block",27),e.SAx(55),e.aS0(56,28),e.k70(),e.C$Y(),e.I0R(57,"tui-radio-block",29),e.OEk(58," No "),e.C$Y()(),e.wR5(59,"app-errors",10),e.C$Y(),e.I0R(60,"div",0)(61,"button",30),e.SAx(62),e.aS0(63,31),e.k70(),e.C$Y(),e.I0R(64,"button",32),e.qCj("click",function(){return f.cancel()}),e.SAx(65),e.aS0(66,33),e.k70(),e.C$Y()()()),2&d){let S,D;e.yG2(4),e.E7m("routerLink",e.g7$(5,30,null==(S=f.category())?null:S.id,"menuCategory.show")),e.yG2(2),e.cNF(null==(D=f.category())?null:D.name),e.yG2(),e.E7m("formGroup",f.form),e.yG2(4),e.E7m("collapsed",!0),e.yG2(),e.E7m("hideRadio",!0)("formControlName","create_as_root")("item",!0),e.yG2(3),e.E7m("hideRadio",!0)("formControlName","create_as_root")("item",!1),e.yG2(2),e.E7m("errors",f.e("create_as_root")),e.yG2(),e.E7m("expanded",!f.form.value.create_as_root),e.yG2(2),e.E7m("formControlName","parent"),e.yG2(3),e.E7m("errors",f.e("parent")),e.yG2(4),e.E7m("collapsed",!0),e.yG2(),e.E7m("hideRadio",!0),e.yG2(3),e.E7m("hideRadio",!0),e.yG2(2),e.E7m("errors",f.e("copy_children")),e.yG2(4),e.E7m("collapsed",!0),e.yG2(),e.E7m("hideRadio",!0),e.yG2(3),e.E7m("hideRadio",!0),e.yG2(3),e.E7m("hideRadio",!0),e.yG2(2),e.E7m("errors",f.e("copy_dishes")),e.yG2(4),e.E7m("collapsed",!0),e.yG2(),e.E7m("hideRadio",!0),e.yG2(3),e.E7m("hideRadio",!0),e.yG2(3),e.E7m("hideRadio",!0),e.yG2(2),e.E7m("errors",f.e("copy_images")),e.yG2(2),e.E7m("appearance","primary"),e.yG2(3),e.E7m("appearance","outline")}},dependencies:[s.sl,s.sz,s.ue,s.u,s.uW,s.Wo,v.a,I.g,P.Gy,P.Ko,E.W,E.I,_.CI,_.Kw,m.kh,m.st,o.w,o.C,t.ER,N.S],changeDetection:0})}return h})(),X=(()=>{class h{static#e=this.\u0275fac=function(d){return new(d||h)};static#t=this.\u0275mod=e.a4G({type:h});static#n=this.\u0275inj=e.s3X({imports:[t.qQ.forChild([(0,A.VV)(H,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return h})()},9052:(y,R,i)=>{i.d(R,{y:()=>r});var t=i(4496),A=i(7760),e=i(6700),M=i(7368),O=i(2700),s=i(1368);function n(a,C){if(1&a&&(t.wR5(0,"img",1),t.wVc(1,"async")),2&a){const l=t.GaO();t.uQ9("max-w-[100%] h-auto min-h-[50px] md:min-h-[100px] ",l.imgClass,""),t._6D("src",t.kDX(1,5,l.imageSrc$),t.K6U),t.E7m("draggable",!1)}}let r=(()=>{class a{constructor(){this.noImage="/assets/img/no-image.jpg",this.imagesService=(0,t.uUt)(A.U),this.imgClass="block rounded",this.image$=new e.g(null),this.imageSrc$=this.image$.pipe((0,M.G)(l=>l instanceof Blob?(0,O.of)(URL.createObjectURL(l)):l&&l.id?this.imagesService.downloadUrl(l.id):(0,O.of)(this.noImage)))}set image(l){this.image$.next(l??null)}static#e=this.\u0275fac=function(g){return new(g||a)};static#t=this.\u0275cmp=t.In1({type:a,selectors:[["app-show-image"]],inputs:{imgClass:"imgClass",image:"image"},standalone:!0,features:[t.UHJ],decls:2,vars:3,consts:[[3,"draggable","class","src"],[3,"draggable","src"]],template:function(g,u){1&g&&(t.yuY(0,n,2,7,"img",0),t.wVc(1,"async")),2&g&&t.C0Y(0,t.kDX(1,1,u.imageSrc$)?0:-1)},dependencies:[s.a],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center}"],changeDetection:0})}return a})()},9852:(y,R,i)=>{i.d(R,{S:()=>O});var t=i(6504),A=i(400);const e=s=>null!=s&&""!=`${s}`;class O extends t.AQ{static formWeeklyFromTo(n,r){return a=>{if(!(a instanceof t.WC))return console.warn("formWeeklyFromTo: param is not a FormGroup",a),null;const C=a,l=C.get(n),g=C.get(r);return l&&g&&l.value instanceof A.uc&&g.value instanceof A.uc&&l.value&&g.value&&l.value.toAbsoluteMilliseconds()>=g.value.toAbsoluteMilliseconds()?{formWeeklyFromTo:!0}:null}}static canBeBlankIf(n,r,a){const C=a?.message||"La form non \xE8 valida.";return l=>{if(!(l instanceof t.WC))throw new Error("canBeBlankIf: thisIsAFormGroup is not a FormGroup");const u=l.get(n);if(!u)throw new Error("canBeBlankIf: control is blank. control name: "+n);return e(u.value)||r()?null:{[`${n}canBeBlankIf`]:C}}}static listOfEmails(n){const r=n.value;if(!r||"string"!=typeof r||!r.length)return null;const a=new RegExp("^[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,4}$","i");return r.split(/\,|\s+/gm).map(C=>C.trim()).filter(C=>C.length).forEach(C=>{if(!a.test(C))return{listOfEmails:!0}}),null}static mustBeArray(n){return Array.isArray(n.value)?null:{mustBeArray:!0}}static objectNotEmpty(n){return e(n.value)&&"object"==typeof n.value&&0===Object.keys(n.value).length&&0===Object.values(n.value).filter(a=>e(a)).length?{objectNotEmpty:!0}:null}static objectValuesAllPresent(n){return e(n.value)&&"object"==typeof n.value&&Object.values(n.value).filter(a=>e(a)).length!==Object.keys(n.value).length?{objectValuesAllPresent:!0}:null}static arrayMinLength(n){return r=>Array.isArray(r.value)&&r.value.length<n?{arrayMinLength:{requiredLength:n,actualLength:r.value?.length??0}}:null}static validateArray(n){return r=>{if(!Array.isArray(r.value))return null;const a={};for(const C of r.value){const l=n(new t.yM(C));l&&Object.assign(a,l)}return Object.keys(a).length?a:null}}static percentage(n){return e(n.value)&&(isNaN(n.value)||n.value<0||n.value>100)?{percentage:!0}:null}static phoneIT(n){const r=C=>C?null:{phoneIT:!0},a=`${n.value}`.trim().replace(/\s+/gm,"").replace(/^\+39/gm,"");return e(a)?r(!((s=a).length<9||isNaN(Number(s))||s.length>14)):r(!0);var s}static instanceof(n){return r=>!e(r.value)||r.value instanceof n?null:{instanceof:!0}}static#e=this.instanceOf=this.instanceof;static numerical(n){return e(n.value)&&isNaN(n.value)?{numerical:!0}:null}static moreThan(n){return r=>r.value<=n?{moreThan:!0}:null}static in(n){return this.inclusion(n)}static inclusion(n){return r=>e(r.value)&&!n.includes(r.value)?{inclusion:!0}:null}}},7760:(y,R,i)=>{i.d(R,{U:()=>M});var t=i(6012),A=i(2264),e=i(4496);let M=(()=>{class O extends t.s{constructor(){super(A.W,"images")}removeFromRecord(n,r){return this.patch(`${n}/remove_from_record`,{record_type:r.record_type,record_id:r.record_id})}updateRecord(n,r){return this.patch("record",{image_ids:r,record_type:n.record_type,record_id:n.record_id})}downloadUrl(n){return this.url(`${n}/download`)}static#e=this.\u0275fac=function(r){return new(r||O)};static#t=this.\u0275prov=e.wxM({token:O,factory:O.\u0275fac,providedIn:"root"})}return O})()},9880:(y,R,i)=>{i.d(R,{kP:()=>g,kh:()=>P,st:()=>I});var t=i(4496),A=i(3480),e=i(4392),M=i(3120),O=i(3616),s=i(7692),n=i(1368);const r=["wrapper"];function a(_,m){if(1&_&&(t.I0R(0,"tui-loader",4),t.C_f(1,5),t.C$Y()),2&_){const o=t.GaO(2);t.E7m("overlay",!0)("showLoader",o.loading),t.yG2(),t.E7m("ngTemplateOutlet",o.content)}}function C(_,m){if(1&_&&(t.SAx(0),t._Xx(1),t.yuY(2,a,2,3,"tui-loader",3),t.k70()),2&_){const o=t.GaO();t.yG2(2),t.E7m("ngIf",o.async)("ngIfElse",o.content)}}const l=["*"];let g=(()=>{class _{}return _.\u0275fac=function(o){return new(o||_)},_.\u0275dir=t.Sc5({type:_,selectors:[["","tuiExpandContent",""]]}),_})();let I=(()=>{class _{constructor(o,E){this.cdr=o,this.destroy$=E,this.state=0,this.async=!1,this.content=null,this.expanded=null}set expandedSetter(o){if(null!==this.expanded)return 0!==this.state?(this.expanded=o,void(this.state=3)):(this.expanded=o,void this.retrigger(this.async&&o?1:3));this.expanded=o}get overflow(){return 0!==this.state}get loading(){return!!this.expanded&&this.async&&1===this.state}get height(){const{expanded:o,state:E,contentWrapper:T}=this;return o&&2===E||!o&&3===E?0:T&&(!o&&2===E||o&&3===E)?T.nativeElement.offsetHeight:T&&o&&1===E?Math.max(T.nativeElement.offsetHeight,48):null}get contentVisible(){return this.expanded||0!==this.state}onTransitionEnd({propertyName:o}){"opacity"===o&&3===this.state&&(this.state=0)}onExpandLoaded(o){o.stopPropagation(),1===this.state&&this.retrigger(3)}retrigger(o){this.state=2,(0,M.k)(0).pipe((0,O.a)(this.destroy$)).subscribe(()=>{2===this.state&&(this.state=o,this.cdr.markForCheck())})}}return _.\u0275fac=function(o){return new(o||_)(t.GI1(t.kD9),t.GI1(A.UF,2))},_.\u0275cmp=t.In1({type:_,selectors:[["tui-expand"]],contentQueries:function(o,E,T){if(1&o&&t.szK(T,g,5,t.Yw2),2&o){let N;t.wto(N=t.Gqi())&&(E.content=N.first)}},viewQuery:function(o,E){if(1&o&&t.CC$(r,5),2&o){let T;t.wto(T=t.Gqi())&&(E.contentWrapper=T.first)}},hostVars:9,hostBindings:function(o,E){1&o&&t.qCj("transitionend.self",function(N){return E.onTransitionEnd(N)})("tui-expand-loaded",function(N){return E.onExpandLoaded(N)}),2&o&&(t.e48("aria-expanded",E.expanded),t.m4B("height",E.height,"px"),t.eAK("_expanded",E.expanded)("_overflow",E.overflow)("_loading",E.loading))},inputs:{async:"async",expandedSetter:[t.Wk5.None,"expanded","expandedSetter"]},features:[t.M5G([A.UF])],ngContentSelectors:l,decls:3,vars:3,consts:[[1,"t-wrapper"],["wrapper",""],[4,"ngIf"],["size","l",3,"overlay","showLoader",4,"ngIf","ngIfElse"],["size","l",3,"overlay","showLoader"],[3,"ngTemplateOutlet"]],template:function(o,E){1&o&&(t.kPM(),t.I0R(0,"div",0,1),t.yuY(2,C,3,2,"ng-container",2),t.C$Y()),2&o&&(t.E7m("@tuiParentAnimation",void 0)("@.disabled",E.overflow),t.yG2(2),t.E7m("ngIf",E.contentVisible))},dependencies:[s.Cb,n.u_,n.XV],styles:['[_nghost-%COMP%]{transition-property:opacity,height,visibility;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;display:block;opacity:0;transition-delay:1ms}._overflow[_nghost-%COMP%]{overflow:hidden}._expanded[_nghost-%COMP%]{opacity:1;transform:translate(0)}._loading[_nghost-%COMP%]{opacity:.99}.t-wrapper[_ngcontent-%COMP%]:before, .t-wrapper[_ngcontent-%COMP%]:after{content:"";display:table}'],data:{animation:[e.cI]},changeDetection:0}),_})(),P=(()=>{class _{}return _.\u0275fac=function(o){return new(o||_)},_.\u0275mod=t.a4G({type:_}),_.\u0275inj=t.s3X({imports:[[n.MD,s.Sk]]}),_})()}}]);