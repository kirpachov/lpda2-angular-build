"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[5872],{1920:(p,T,t)=>{t.d(T,{w:()=>n});var e=t(4496),m=t(6504),u=t(3480),M=t(6700),c=t(3616),i=t(6684),_=t(3797),a=t(8588),O=t(1368),g=t(9956),C=t(1292);function y(r,f){if(1&r&&(e.I0R(0,"tui-textarea",2),e.OEk(1),e.C$Y()),2&r){const s=e.GaO().$implicit,d=e.GaO();e.E7m("formControl",s.control),e.yG2(),e.oRS(" ",d.getFullLang(s.lang)," ")}}function I(r,f){if(1&r&&(e.I0R(0,"tui-input",2),e.OEk(1),e.C$Y()),2&r){const s=e.GaO().$implicit,d=e.GaO();e.E7m("formControl",s.control),e.yG2(),e.oRS(" ",d.getFullLang(s.lang)," ")}}const N=r=>({"mb-3":r});function R(r,f){if(1&r&&(e.SAx(0),e.I0R(1,"div",1),e.yuY(2,y,2,2,"tui-textarea",2)(3,I,2,2),e.wR5(4,"app-errors",3),e.C$Y(),e.k70()),2&r){const s=f.$implicit,d=f.last,h=e.GaO();e.yG2(),e.E7m("ngClass",e.S45(3,N,!d)),e.yG2(),e.C0Y(2,h.long?2:3),e.yG2(2),e.E7m("errors",s.control.errors)}}const v=["*"];let n=(()=>{class r{constructor(){this.destroy$=new u.UF,this.long=!1,this.controls=(0,e.OCB)({}),this.controlsArr=(0,e.S6b)(()=>{const s=this.controls();return Object.keys(s).map(d=>({lang:d,control:s[d]}))}),this.touched$=new M.g(!1),this.value$=new M.g({})}ngAfterViewInit(){this.addLang("it"),this.addLang("en")}ngOnInit(){}registerOnChange(s){this.value$.pipe((0,c.a)(this.destroy$)).subscribe({next:d=>s(d)})}registerOnTouched(s){this.touched$.pipe((0,i.I)(d=>!0===d)).subscribe({next:()=>s()})}writeValue(s){this.patchValue(s??{}),this.touched$.next(!1)}wasTouched(){this.touched$.next(!0)}getFullLang(s){return C.S[s]??s}controlChanged(s){this.value$.next({...this.value$.value,[s]:this.controls()[s].value})}patchValue(s){Object.keys(s).forEach(d=>this.addLang(d)),Object.keys(this.controls()).forEach(d=>{this.controls()[d].patchValue(s[d]??null)})}addLang(s){if(this.controls()[s])return;const d=new m.Ku;d.valueChanges.subscribe({next:()=>this.controlChanged(s)}),this.controls.set({...this.controls(),[s]:d})}static#e=this.\u0275fac=function(d){return new(d||r)};static#t=this.\u0275cmp=e.In1({type:r,selectors:[["app-i18n-input"]],inputs:{long:"long"},standalone:!0,features:[e.M5G([{provide:m.Y6,useExisting:(0,e.wd)(()=>r),multi:!0},u.UF]),e.UHJ],ngContentSelectors:v,decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"ngClass"],[3,"formControl"],[3,"errors"]],template:function(d,h){1&d&&(e.kPM(),e._Xx(0),e.yuY(1,R,5,5,"ng-container",0)),2&d&&(e.yG2(),e.E7m("ngForOf",h.controlsArr()))},dependencies:[m.sl,m.ue,m.ug,_.CQ,_.Oo,_.cP,O.Iw,g.g,O.QF,a.Y3,a.wp,a.kd],changeDetection:0})}return r})()},2192:(p,T,t)=>{t.d(T,{c:()=>z});var e=t(4496),m=t(1128),u=t(3480),M=t(7692),c=t(8212),i=t(1920),_=t(6504),a=t(1560),O=t(964),g=t(6380),C=t(9956),y=t(1368),I=t(7516),N=t(2516),R=t(7556),v=t(6732),n=t(466),r=t(5193),f=t(1673),s=t(6528),d=t(3616),h=t(8824),$=t(4704),U=t(9144),w=t(2700);const b=(S,A)=>A.id;function x(S,A){if(1&S){const o=e.KQA();e.I0R(0,"div",7)(1,"tui-checkbox-block",8),e.qCj("ngModelChange",function(){e.usT(o);const l=e.GaO().$implicit,D=e.GaO(2);return e.CGJ(D.triggerSelection(l.id))}),e.OEk(2),e.C$Y()()}if(2&S){const o=e.GaO().$implicit,E=e.GaO(2);e.yG2(),e.E7m("readOnly",E.disabled())("ngModel",E.selections().includes(o.id)),e.yG2(),e.oRS(" ",o.name," ")}}function K(S,A){1&S&&e.yuY(0,x,3,3,"div",6),2&S&&e.C0Y(0,A.$implicit.id?0:-1)}function V(S,A){if(1&S&&(e.I0R(0,"tr",2)(1,"td",3)(2,"p",4),e.OEk(3),e.wVc(4,"weekday"),e.C$Y()(),e.I0R(5,"td",3)(6,"div",5),e.c53(7,K,1,1,null,null,b),e.C$Y()()()),2&S){const o=A.$implicit,E=e.GaO();e.yG2(3),e.cNF(e.kDX(4,1,o)),e.yG2(4),e.oho(E.turnsPerDay()[o])}}let B=(()=>{class S{constructor(){this.turnsService=(0,e.uUt)(R.K),this.destroy$=(0,e.uUt)(u.UF),this.date=(0,e.uUt)(y.y),this.selectionsChanges=new e._w7,this.loading=(0,e.OCB)(!1),this.selections=(0,e.OCB)([]),this.disabled=(0,e.OCB)(!1),this.allTurns=(0,e.OCB)([]),this.turnsPerDay=(0,e.S6b)(()=>{const o=this.allTurns().filter(l=>null!=l.weekday),E={};for(const l of o){if(null==l.weekday||null==l.weekday)throw new Error("Turns must have a weekday");E[l.weekday]||=[],E[l.weekday].push(l)}return E}),this.weekdays=(0,e.S6b)(()=>Object.keys(this.turnsPerDay()).map(Number))}ngOnInit(){this.searchTurns()}writeValue(o){Array.isArray(o)||(o=[o]),o=o.filter(l=>null!=l&&null!=l);const E=[];o.forEach(l=>{l instanceof I.e&&l.id?E.push(l.id):"number"==typeof l?E.push(l):"object"==typeof l&&null!=l&&Object.keys(l).includes("id")&&"number"==typeof l.id?E.push(l.id):console.warn("invalid object provided to SelectTurnsComponent",o)}),this.selections.set(E)}registerOnChange(o){this.selectionsChanges.subscribe(o)}registerOnTouched(o){this.selectionsChanges.subscribe(o)}setDisabledState(o){this.disabled.set(o)}triggerSelection(o){this.selections.update(E=>{const l=E.indexOf(o);return-1!=l?E.splice(l,1):E.push(o),E}),this.emitChanges()}searchTurns(){this.loading.set(!0),this.turnsService.search({per_page:1e3}).pipe((0,d.a)(this.destroy$),(0,h.U)(()=>this.loading.set(!1)),(0,$.k)(o=>o.items),(0,U.a)(o=>(console.error(o),(0,w.of)([])))).subscribe({next:o=>{this.allTurns.set(o)}})}emitChanges(){this.selectionsChanges.emit(this.allTurns().filter(o=>"number"==typeof o.id&&this.selections().includes(o.id)))}static#e=this.\u0275fac=function(E){return new(E||S)};static#t=this.\u0275cmp=e.In1({type:S,selectors:[["app-select-turns"]],outputs:{selectionsChanges:"selectionsChanges"},standalone:!0,features:[e.M5G([{provide:_.Y6,multi:!0,useExisting:(0,e.wd)(()=>S)},u.UF]),e.UHJ],decls:5,vars:2,consts:[["size","xl",3,"overlay","showLoader"],[1,"tui-table"],[1,"tui-table__tr","tui-table__tr_border_none"],[1,"tui-table__td"],[1,"text-xl"],[1,"flex","flex-col"],["class","flex flex-row items-center mb-5"],[1,"flex","flex-row","items-center","mb-5"],[1,"me-1",3,"readOnly","ngModel","ngModelChange"],["class","tui-table__tr tui-table__tr_border_none"]],template:function(E,l){1&E&&(e.I0R(0,"tui-loader",0)(1,"table",1)(2,"tbody"),e.c53(3,V,9,3,"tr",9,e.oxv),e.C$Y()()()),2&E&&(e.E7m("overlay",!0)("showLoader",l.loading()),e.yG2(3),e.oho(l.weekdays()))},dependencies:[N.G,s.i,s.I,_.y,_.ue,_._G,M.Sk,M.Cb,n.GE,r.ms,f.y,c.CI,v.kR],encapsulation:2,changeDetection:0})}return S})(),z=(()=>{class S{constructor(){this.notifications=(0,e.uUt)(m.E),this.onSubmit=new e._w7,this.onCancel=new e._w7,this.loading=!1,this.submitted=(0,e.OCB)(!1),this.form=new _.WC({from_date:new _.Ku(null),to_date:new _.Ku(null),message:new _.Ku(null),turns:new _.Ku([])})}set data(o){null!=o&&null!=o?this.form.patchValue({from_date:"string"==typeof o.from_date?(0,O.yc)(o.from_date):o.from_date,to_date:"string"==typeof o.to_date?(0,O.yc)(o.to_date):o.to_date,message:o.translations?.message||{},turns:o.turns}):this.form.reset()}submitForm(){this.submitted.set(!0),!this.form.invalid&&this.onSubmit.emit(this.formatOutput())}cancelForm(){this.onCancel.emit()}formatOutput(){if(this.form.invalid)throw new Error("Form is invalid");return{from_date:this.form.value.from_date||null,to_date:this.form.value.to_date||null,translations:this.form.value.message||{},turns:this.form.value.turns??[]}}static#e=this.\u0275fac=function(E){return new(E||S)};static#t=this.\u0275cmp=e.In1({type:S,selectors:[["app-reservation-turn-message-form"]],inputs:{loading:"loading",data:"data"},outputs:{onSubmit:"onSubmit",onCancel:"onCancel"},standalone:!0,features:[e.M5G([u.UF]),e.UHJ],decls:32,vars:9,consts:()=>{let o,E,l,D,G,F,L;return o="Messaggio da mostrare",E="Visibile dal giorno",l="visibile fino al giorno",D=" Il primo e l'ultimo giorno in questione sono entrambi inclusi. Quindi, se vuoi mostrare un messaggio per un solo giorno, seleziona lo stesso giorno in entrambi i campi. ",G="Per quali turni mostrare il messaggio?",F="Conferma",L="Annulla",[[1,"block","mb-3",3,"formGroup","ngSubmit"],[1,"block","mb-3"],[3,"formControl"],o,[3,"errors"],[1,"block","mb-1"],[1,"flex","items-center"],[1,"grow","me-1"],E,[1,"grow","ms-1"],l,[1,"block","mb-3","text-slate-400"],D,[1,"text-2xl"],G,["tuiButton","","type","submit",1,"inline-block"],F,["tuiButton","","type","button","appearance","icon",1,"inline-block",3,"click"],L]},template:function(E,l){1&E&&(e.I0R(0,"form",0),e.qCj("ngSubmit",function(){return l.submitForm()}),e.I0R(1,"div",1)(2,"app-i18n-input",2),e.SAx(3),e.aS0(4,3),e.k70(),e.C$Y(),e.wR5(5,"app-errors",4),e.C$Y(),e.I0R(6,"div",5)(7,"div",6)(8,"div",7)(9,"tui-input-date",2),e.SAx(10),e.aS0(11,8),e.k70(),e.C$Y(),e.wR5(12,"app-errors",4),e.C$Y(),e.I0R(13,"div",9)(14,"tui-input-date",2),e.SAx(15),e.aS0(16,10),e.k70(),e.C$Y(),e.wR5(17,"app-errors",4),e.C$Y()()(),e.I0R(18,"span",11),e.aS0(19,12),e.C$Y(),e.I0R(20,"div",1)(21,"h3",13),e.aS0(22,14),e.C$Y(),e.wR5(23,"app-select-turns",2)(24,"app-errors",4),e.C$Y(),e.I0R(25,"div",1)(26,"button",15),e.SAx(27),e.aS0(28,16),e.k70(),e.C$Y(),e.I0R(29,"button",17),e.qCj("click",function(){return l.cancelForm()}),e.SAx(30),e.aS0(31,18),e.k70(),e.C$Y()()()),2&E&&(e.E7m("formGroup",l.form),e.yG2(2),e.E7m("formControl",l.form.controls.message),e.yG2(3),e.E7m("errors",l.form.controls.message.errors),e.yG2(4),e.E7m("formControl",l.form.controls.from_date),e.yG2(3),e.E7m("errors",l.form.controls.from_date.errors),e.yG2(2),e.E7m("formControl",l.form.controls.to_date),e.yG2(3),e.E7m("errors",l.form.controls.to_date.errors),e.yG2(6),e.E7m("formControl",l.form.controls.turns),e.yG2(),e.E7m("errors",l.form.controls.turns.errors))},dependencies:[M.Sk,i.w,_.y,_.sz,_.ue,_.u,a.oB,c.CI,c.Kw,_.sl,_.ug,_.uW,g.iO,g.yc,g.Ml,C.g,B],encapsulation:2,changeDetection:0})}return S})()},1292:(p,T,t)=>{t.d(T,{S:()=>e});const e={it:"Italiano",en:"Inglese",es:"Spagnolo",fr:"Francese",de:"Tedesco",pt:"Portoghese",ru:"Russo",zh:"Cinese",ja:"Giapponese",ar:"Arabo",hi:"Hindi",bn:"Bengalese",pa:"Punjabi",ms:"Malese"}},964:(p,T,t)=>{t.d(T,{Ez:()=>g,In:()=>N,Q1:()=>v,Q9:()=>I,QX:()=>a,Qx:()=>M,_0:()=>R,ay:()=>c,cr:()=>_,e6:()=>u,yc:()=>i});var e=t(400),m=t(9772);const u=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z$/;function M(n,r){const f=new e.uc(r.hours,r.minutes).shift({hours:-m.MJ});return new Date(Date.UTC(n.year,n.month,n.day,f.hours,f.minutes)).toISOString()}function c(n){if(!("string"==typeof n&&n.length>0&&n.match(u)))return console.error("Invalid string provided to isoStringToTuiDay",{isoString:n}),null;const r=new Date(n);return new e.EK(r.getFullYear(),r.getMonth()+1,r.getDate())}function i(n){if("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}\s{1}\d{1,2}:\d{1,2}$/)&&(n=n.split(" ")[0]),!("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}$/)))return console.error("Invalid string provided to stringToTuiDay. Expected format YYYY-MM-DD, got",{str:n}),null;const{day:r,month:f,year:s}=e.EK.parseRawDateString(n,"YMD");return new e.EK(s,f,r)}function _(n){if("string"==typeof n&&n.length>0&&n.match(/^\d{4}-\d{1,2}-\d{1,2}\s{1}\d{1,2}:\d{1,2}$/)&&(n=n.split(" ")[1]),!("string"==typeof n&&n.length>0&&n.match(/^\d{1,2}:\d{1,2}$/)))return console.error("Invalid string provided to stringToTuiDay. Expected format HH:mm, got",{str:n}),null;const[r,f]=n.split(":").map(s=>Number(s));return"number"==typeof r&&r>=0&&r<=23?"number"==typeof f&&f>=0&&f<60?new e.uc(r,f):(console.error("error while parsing time in stringToTuiTime. minutes are invalid",{minutes:f}),null):(console.error("error while parsing time in stringToTuiTime. hours is invalid ",{hours:r}),null)}function a(n){if(!("string"==typeof n&&n.length>0&&n.match(u)))return console.error("Invalid string provided to isoStringToTuiTime",{isoString:n}),null;const r=new Date(n);return new e.uc(r.getHours(),r.getMinutes())}function g(n){return new Date(`1970-01-01 ${n.toString()}`).toISOString()}function I(n){const r=new Date(`${n}Z`);return`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")} ${String(r.getHours()).padStart(2,"0")}:${String(r.getMinutes()).padStart(2,"0")}`}function N(n){return function C(n){const r=new Date(`1970-01-01 ${n}`);return`${`${r.getUTCHours()}`.padStart(2,"0")}:${`${r.getUTCMinutes()}`.padStart(2,"0")}`}(n.toString())}function R(n){return new e.EK(n.getFullYear(),n.getMonth(),n.getDate())}function v(n){return new e.uc(n.getHours(),n.getMinutes())}},1960:(p,T,t)=>{t.d(T,{u:()=>M});var e=t(8400),m=t(7516);class u extends e.w{constructor(i){super(i),this.date=i.date?new Date(i.date):void 0,this.reservation_turn_id=i.reservation_turn_id,this.group_id=i.group_id,this.reservation_turn=i.reservation_turn?new m.e(i.reservation_turn):void 0}}class M extends e.w{constructor(i){super(i),this.turns=[],this.dates=[],this.title=i.title,this.status=i.status,this.preorder_type=i.preorder_type,this.payment_value=i.payment_value,this.message=i.message,this.turns=(i.turns||[]).map(_=>new m.e(_)),this.dates=(i.dates||[]).map(_=>new u(_)),this.translations=i.translations||{},this.table_type_to_preorder_reservation_groups=i.table_type_to_preorder_reservation_groups}}},7516:(p,T,t)=>{t.d(T,{e:()=>M});var e=t(8400),m=t(9772),u=t(1960);class M extends e.w{constructor(i){super(i),this.messages=[],this.name=i.name,this.weekday=i.weekday,this.step=i.step,this.valid_times=i.valid_times,this.starts_at=i.starts_at?(0,m.CU)(i.starts_at):void 0,this.ends_at=i.ends_at?(0,m.CU)(i.ends_at):void 0,this.preorder_reservation_group=i.preorder_reservation_group?new u.u(i.preorder_reservation_group):void 0,this.messages=i.messages}}},2516:(p,T,t)=>{t.d(T,{G:()=>m});var e=t(4496);let m=(()=>{class u{constructor(){this.weekdays=["Domenica","Luned\xEC","Marted\xEC","Mercoled\xEC","Gioved\xEC","Venerd\xEC","Sabato"]}transform(c){return"number"!=typeof c&&"string"==typeof c&&(c=parseInt(c)),"number"==typeof c&&c>=0&&c<=6?this.weekdays[c]:null}static#e=this.\u0275fac=function(i){return new(i||u)};static#t=this.\u0275pipe=e.UTH({name:"weekday",type:u,pure:!0,standalone:!0})}return u})()},1260:(p,T,t)=>{t.d(T,{U:()=>i});var e=t(6012),m=t(8400),u=t(7516);class M extends m.w{constructor(a){super(a),this.message=a.message,this.from_date=a.from_date,this.to_date=a.to_date,this.translations=a.translations,this.turns=a.turns?a.turns.map(O=>new u.e(O)):[]}}var c=t(4496);let i=(()=>{class _ extends e.s{constructor(){super(M,"admin/reservation_turn_messages")}create(O){return super.create(O)}update(O,g){return super.update(O,g)}static#e=this.\u0275fac=function(g){return new(g||_)};static#t=this.\u0275prov=c.wxM({token:_,factory:_.\u0275fac,providedIn:"root"})}return _})()},7556:(p,T,t)=>{t.d(T,{K:()=>M});var e=t(6012),m=t(7516),u=t(4496);let M=(()=>{class c extends e.s{constructor(){super(m.e,"admin/reservation_turns")}static#e=this.\u0275fac=function(a){return new(a||c)};static#t=this.\u0275prov=u.wxM({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},1200:(p,T,t)=>{t.d(T,{A:()=>i,m:()=>_});var e=t(4496),m=t(900),u=t(3480),M=t(800),c=t(3616);let i=(()=>{class a{constructor(g,C,y){this.el=g,this.zone=C,this.destroy$=y,this.eventName=""}ngOnInit(){(0,M.w)(this.el.nativeElement,this.eventName,{passive:!1}).pipe((0,m.Uv)(this.zone),(0,m.uy)(),(0,c.a)(this.destroy$)).subscribe()}}return a.\u0275fac=function(g){return new(g||a)(e.GI1(e.GMv),e.GI1(e.WW2),e.GI1(u.UF,2))},a.\u0275dir=e.Sc5({type:a,selectors:[["","tuiPreventDefault",""]],inputs:{eventName:[e.Wk5.None,"tuiPreventDefault","eventName"]},features:[e.M5G([u.UF])]}),a})(),_=(()=>{class a{}return a.\u0275fac=function(g){return new(g||a)},a.\u0275mod=e.a4G({type:a}),a.\u0275inj=e.s3X({}),a})()},6988:(p,T,t)=>{t.d(T,{E:()=>i,Q:()=>_});var e=t(4496),m=t(3480),u=t(3840),M=t(3120),c=t(3616);let i=(()=>{class a{constructor(g,C){this.el=g,this.destroy$=C}set tuiScrollIntoView(g){g&&(0,M.k)(0).pipe((0,c.a)(this.destroy$)).subscribe(()=>{this.el.nativeElement.dispatchEvent(new CustomEvent(u.dG,{bubbles:!0,detail:this.el.nativeElement}))})}}return a.\u0275fac=function(g){return new(g||a)(e.GI1(e.GMv),e.GI1(m.UF,2))},a.\u0275dir=e.Sc5({type:a,selectors:[["","tuiScrollIntoView",""]],inputs:{tuiScrollIntoView:"tuiScrollIntoView"},features:[e.M5G([m.UF])]}),a})(),_=(()=>{class a{}return a.\u0275fac=function(g){return new(g||a)},a.\u0275mod=e.a4G({type:a}),a.\u0275inj=e.s3X({}),a})()},812:(p,T,t)=>{t.d(T,{m2:()=>y,mU:()=>a,qS:()=>M,w3:()=>I}),t(4392);var m=t(2528);t(3840);const M={DMY:"dd/mm/yyyy",MDY:"mm/dd/yyyy",YMD:"yyyy/mm/dd"},a=/\([#]+\)|[#\- ]/g,y=(R,v,n,r)=>{if(!v?.isSingleDay||!n)return R;const f=(0,m.Kw)(Object.entries(n).map(([d,h])=>[d,-h])),s=v.from.append(r?f:n).append({day:r?1:-1});return r?s.dayBefore(R)?R:s:R&&s.dayAfter(R)?R:s},I={HH:23,MM:59,SS:59,MS:999}}}]);