"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[4240],{9064:(M,O,t)=>{t.d(O,{w:()=>P});var e=t(4496),c=t(6504),E=t(3480),d=t(6700),a=t(3616),s=t(6684),r=t(3797),_=t(8588),f=t(1368),g=t(9956),v=t(1292);function N(R,C){if(1&R&&(e.I0R(0,"tui-textarea",2),e.OEk(1),e.C$Y()),2&R){const i=e.GaO().$implicit,u=e.GaO();e.E7m("formControl",i.control),e.yG2(),e.oRS(" ",u.getFullLang(i.lang)," ")}}function A(R,C){if(1&R&&(e.I0R(0,"tui-input",2),e.OEk(1),e.C$Y()),2&R){const i=e.GaO().$implicit,u=e.GaO();e.E7m("formControl",i.control),e.yG2(),e.oRS(" ",u.getFullLang(i.lang)," ")}}const y=R=>({"mb-3":R});function I(R,C){if(1&R&&(e.SAx(0),e.I0R(1,"div",1),e.yuY(2,N,2,2,"tui-textarea",2)(3,A,2,2),e.wR5(4,"app-errors",3),e.C$Y(),e.k70()),2&R){const i=C.$implicit,u=C.last,S=e.GaO();e.yG2(),e.E7m("ngClass",e.S45(3,y,!u)),e.yG2(),e.C0Y(2,S.long?2:3),e.yG2(2),e.E7m("errors",i.control.errors)}}const $=["*"];let P=(()=>{class R{constructor(){this.destroy$=new E.UF,this.long=!1,this.controls=(0,e.OCB)({}),this.controlsArr=(0,e.S6b)(()=>{const i=this.controls();return Object.keys(i).map(u=>({lang:u,control:i[u]}))}),this.touched$=new d.g(!1),this.value$=new d.g({})}ngAfterViewInit(){this.addLang("it"),this.addLang("en")}ngOnInit(){}registerOnChange(i){this.value$.pipe((0,a.a)(this.destroy$)).subscribe({next:u=>i(u)})}registerOnTouched(i){this.touched$.pipe((0,s.I)(u=>!0===u)).subscribe({next:()=>i()})}writeValue(i){this.patchValue(i??{}),this.touched$.next(!1)}wasTouched(){this.touched$.next(!0)}getFullLang(i){return v.S[i]??i}controlChanged(i){this.value$.next({...this.value$.value,[i]:this.controls()[i].value})}patchValue(i){Object.keys(i).forEach(u=>this.addLang(u)),Object.keys(this.controls()).forEach(u=>{this.controls()[u].patchValue(i[u]??null)})}addLang(i){if(this.controls()[i])return;const u=new c.Ku;u.valueChanges.subscribe({next:()=>this.controlChanged(i)}),this.controls.set({...this.controls(),[i]:u})}static#e=this.\u0275fac=function(u){return new(u||R)};static#t=this.\u0275cmp=e.In1({type:R,selectors:[["app-i18n-input"]],inputs:{long:"long"},standalone:!0,features:[e.M5G([{provide:c.Y6,useExisting:(0,e.wd)(()=>R),multi:!0},E.UF]),e.UHJ],ngContentSelectors:$,decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"ngClass"],[3,"formControl"],[3,"errors"]],template:function(u,S){1&u&&(e.kPM(),e._Xx(0),e.yuY(1,I,5,5,"ng-container",0)),2&u&&(e.yG2(),e.E7m("ngForOf",S.controlsArr()))},dependencies:[c.sl,c.ue,c.ug,r.CQ,r.Oo,r.cP,f.Iw,g.g,f.QF,_.Y3,_.wp,_.kd],changeDetection:0})}return R})()},2192:(M,O,t)=>{t.d(O,{c:()=>K});var e=t(4496),c=t(1128),E=t(3480),d=t(7692),a=t(8212),s=t(9064),r=t(6504),_=t(1560),f=t(964),g=t(6380),v=t(9956),N=t(1368),A=t(5136),y=t(2516),I=t(7556),$=t(6732),P=t(466),R=t(5193),C=t(1673),i=t(6528),u=t(3616),S=t(8824),F=t(4704),b=t(9144),L=t(2700);const x=(m,T)=>T.id;function w(m,T){if(1&m){const n=e.KQA();e.I0R(0,"div",7)(1,"tui-checkbox-block",8),e.qCj("ngModelChange",function(){e.usT(n);const o=e.GaO().$implicit,h=e.GaO(2);return e.CGJ(h.triggerSelection(o.id))}),e.OEk(2),e.C$Y()()}if(2&m){const n=e.GaO().$implicit,l=e.GaO(2);e.yG2(),e.E7m("readOnly",l.disabled())("ngModel",l.selections().includes(n.id)),e.yG2(),e.oRS(" ",n.name," ")}}function z(m,T){1&m&&e.yuY(0,w,3,3,"div",6),2&m&&e.C0Y(0,T.$implicit.id?0:-1)}function V(m,T){if(1&m&&(e.I0R(0,"tr",2)(1,"td",3)(2,"p",4),e.OEk(3),e.wVc(4,"weekday"),e.C$Y()(),e.I0R(5,"td",3)(6,"div",5),e.c53(7,z,1,1,null,null,x),e.C$Y()()()),2&m){const n=T.$implicit,l=e.GaO();e.yG2(3),e.cNF(e.kDX(4,1,n)),e.yG2(4),e.oho(l.turnsPerDay()[n])}}let B=(()=>{class m{constructor(){this.turnsService=(0,e.uUt)(I.K),this.destroy$=(0,e.uUt)(E.UF),this.date=(0,e.uUt)(N.y),this.selectionsChanges=new e._w7,this.loading=(0,e.OCB)(!1),this.selections=(0,e.OCB)([]),this.disabled=(0,e.OCB)(!1),this.allTurns=(0,e.OCB)([]),this.turnsPerDay=(0,e.S6b)(()=>{const n=this.allTurns().filter(o=>null!=o.weekday),l={};for(const o of n){if(null==o.weekday||null==o.weekday)throw new Error("Turns must have a weekday");l[o.weekday]||=[],l[o.weekday].push(o)}return l}),this.weekdays=(0,e.S6b)(()=>Object.keys(this.turnsPerDay()).map(Number))}ngOnInit(){this.searchTurns()}writeValue(n){Array.isArray(n)||(n=[n]),n=n.filter(o=>null!=o&&null!=o);const l=[];n.forEach(o=>{o instanceof A.e&&o.id?l.push(o.id):"number"==typeof o?l.push(o):"object"==typeof o&&null!=o&&Object.keys(o).includes("id")&&"number"==typeof o.id?l.push(o.id):console.warn("invalid object provided to SelectTurnsComponent",n)}),this.selections.set(l)}registerOnChange(n){this.selectionsChanges.subscribe(n)}registerOnTouched(n){this.selectionsChanges.subscribe(n)}setDisabledState(n){this.disabled.set(n)}triggerSelection(n){this.selections.update(l=>{const o=l.indexOf(n);return-1!=o?l.splice(o,1):l.push(n),l}),this.emitChanges()}searchTurns(){this.loading.set(!0),this.turnsService.search({per_page:1e3}).pipe((0,u.a)(this.destroy$),(0,S.U)(()=>this.loading.set(!1)),(0,F.k)(n=>n.items),(0,b.a)(n=>(console.error(n),(0,L.of)([])))).subscribe({next:n=>{this.allTurns.set(n)}})}emitChanges(){this.selectionsChanges.emit(this.allTurns().filter(n=>"number"==typeof n.id&&this.selections().includes(n.id)))}static#e=this.\u0275fac=function(l){return new(l||m)};static#t=this.\u0275cmp=e.In1({type:m,selectors:[["app-select-turns"]],outputs:{selectionsChanges:"selectionsChanges"},standalone:!0,features:[e.M5G([{provide:r.Y6,multi:!0,useExisting:(0,e.wd)(()=>m)},E.UF]),e.UHJ],decls:5,vars:2,consts:[["size","xl",3,"overlay","showLoader"],[1,"tui-table"],[1,"tui-table__tr","tui-table__tr_border_none"],[1,"tui-table__td"],[1,"text-xl"],[1,"flex","flex-col"],["class","flex flex-row items-center mb-5"],[1,"flex","flex-row","items-center","mb-5"],[1,"me-1",3,"readOnly","ngModel","ngModelChange"],["class","tui-table__tr tui-table__tr_border_none"]],template:function(l,o){1&l&&(e.I0R(0,"tui-loader",0)(1,"table",1)(2,"tbody"),e.c53(3,V,9,3,"tr",9,e.oxv),e.C$Y()()()),2&l&&(e.E7m("overlay",!0)("showLoader",o.loading()),e.yG2(3),e.oho(o.weekdays()))},dependencies:[y.G,i.i,i.I,r.y,r.ue,r._G,d.Sk,d.Cb,P.GE,R.ms,C.y,a.CI,$.kR],encapsulation:2,changeDetection:0})}return m})(),K=(()=>{class m{constructor(){this.notifications=(0,e.uUt)(c.E),this.onSubmit=new e._w7,this.onCancel=new e._w7,this.loading=!1,this.submitted=(0,e.OCB)(!1),this.form=new r.WC({from_date:new r.Ku(null),to_date:new r.Ku(null),message:new r.Ku(null),turns:new r.Ku([])})}set data(n){null!=n&&null!=n?this.form.patchValue({from_date:"string"==typeof n.from_date?(0,f.yc)(n.from_date):n.from_date,to_date:"string"==typeof n.to_date?(0,f.yc)(n.to_date):n.to_date,message:n.translations?.message||{},turns:n.turns}):this.form.reset()}submitForm(){this.submitted.set(!0),!this.form.invalid&&this.onSubmit.emit(this.formatOutput())}cancelForm(){this.onCancel.emit()}formatOutput(){if(this.form.invalid)throw new Error("Form is invalid");return{from_date:this.form.value.from_date||null,to_date:this.form.value.to_date||null,translations:this.form.value.message||{},turns:this.form.value.turns??[]}}static#e=this.\u0275fac=function(l){return new(l||m)};static#t=this.\u0275cmp=e.In1({type:m,selectors:[["app-reservation-turn-message-form"]],inputs:{loading:"loading",data:"data"},outputs:{onSubmit:"onSubmit",onCancel:"onCancel"},standalone:!0,features:[e.M5G([E.UF]),e.UHJ],decls:32,vars:9,consts:()=>{let n,l,o,h,G,U,D;return n="Messaggio da mostrare",l="Visibile dal giorno",o="visibile fino al giorno",h=" Il primo e l'ultimo giorno in questione sono entrambi inclusi. Quindi, se vuoi mostrare un messaggio per un solo giorno, seleziona lo stesso giorno in entrambi i campi. ",G="Per quali turni mostrare il messaggio?",U="Conferma",D="Annulla",[[1,"block","mb-3",3,"formGroup","ngSubmit"],[1,"block","mb-3"],[3,"formControl"],n,[3,"errors"],[1,"block","mb-1"],[1,"flex","items-center"],[1,"grow","me-1"],l,[1,"grow","ms-1"],o,[1,"block","mb-3","text-slate-400"],h,[1,"text-2xl"],G,["tuiButton","","type","submit",1,"inline-block"],U,["tuiButton","","type","button","appearance","icon",1,"inline-block",3,"click"],D]},template:function(l,o){1&l&&(e.I0R(0,"form",0),e.qCj("ngSubmit",function(){return o.submitForm()}),e.I0R(1,"div",1)(2,"app-i18n-input",2),e.SAx(3),e.aS0(4,3),e.k70(),e.C$Y(),e.wR5(5,"app-errors",4),e.C$Y(),e.I0R(6,"div",5)(7,"div",6)(8,"div",7)(9,"tui-input-date",2),e.SAx(10),e.aS0(11,8),e.k70(),e.C$Y(),e.wR5(12,"app-errors",4),e.C$Y(),e.I0R(13,"div",9)(14,"tui-input-date",2),e.SAx(15),e.aS0(16,10),e.k70(),e.C$Y(),e.wR5(17,"app-errors",4),e.C$Y()()(),e.I0R(18,"span",11),e.aS0(19,12),e.C$Y(),e.I0R(20,"div",1)(21,"h3",13),e.aS0(22,14),e.C$Y(),e.wR5(23,"app-select-turns",2)(24,"app-errors",4),e.C$Y(),e.I0R(25,"div",1)(26,"button",15),e.SAx(27),e.aS0(28,16),e.k70(),e.C$Y(),e.I0R(29,"button",17),e.qCj("click",function(){return o.cancelForm()}),e.SAx(30),e.aS0(31,18),e.k70(),e.C$Y()()()),2&l&&(e.E7m("formGroup",o.form),e.yG2(2),e.E7m("formControl",o.form.controls.message),e.yG2(3),e.E7m("errors",o.form.controls.message.errors),e.yG2(4),e.E7m("formControl",o.form.controls.from_date),e.yG2(3),e.E7m("errors",o.form.controls.from_date.errors),e.yG2(2),e.E7m("formControl",o.form.controls.to_date),e.yG2(3),e.E7m("errors",o.form.controls.to_date.errors),e.yG2(6),e.E7m("formControl",o.form.controls.turns),e.yG2(),e.E7m("errors",o.form.controls.turns.errors))},dependencies:[d.Sk,s.w,r.y,r.sz,r.ue,r.u,_.oB,a.CI,a.Kw,r.sl,r.ug,r.uW,g.iO,g.yc,g.Ml,v.g,B],encapsulation:2,changeDetection:0})}return m})()},1292:(M,O,t)=>{t.d(O,{S:()=>e});const e={it:"Italiano",en:"Inglese",es:"Spagnolo",fr:"Francese",de:"Tedesco",pt:"Portoghese",ru:"Russo",zh:"Cinese",ja:"Giapponese",ar:"Arabo",hi:"Hindi",bn:"Bengalese",pa:"Punjabi",ms:"Malese"}},9772:(M,O,t)=>{t.d(O,{CU:()=>c,ye:()=>E});const e=(new Date).getTimezoneOffset()/60;function c(d,a=e){return"string"==typeof d&&d.length>0&&d.match(/\d{1,2}:\d{1,2}/)?`${Number(d.split(":")[0])-a}:${d.split(":")[1]}`:(console.error("Invalid string provided to strTimeTimezone",{string:d}),"")}function E(d,a=e){return c(d,-1*a)}},1960:(M,O,t)=>{t.d(O,{u:()=>d});var e=t(8400),c=t(5136);class E extends e.w{constructor(s){super(s),this.date=s.date?new Date(s.date):void 0,this.reservation_turn_id=s.reservation_turn_id,this.group_id=s.group_id,this.reservation_turn=s.reservation_turn?new c.e(s.reservation_turn):void 0}}class d extends e.w{constructor(s){super(s),this.turns=[],this.dates=[],this.title=s.title,this.status=s.status,this.preorder_type=s.preorder_type,this.payment_value=s.payment_value,this.message=s.message,this.turns=(s.turns||[]).map(r=>new c.e(r)),this.dates=(s.dates||[]).map(r=>new E(r))}}},5136:(M,O,t)=>{t.d(O,{e:()=>d});var e=t(8400),c=t(9772),E=t(1960);class d extends e.w{constructor(s){super(s),this.messages=[],this.name=s.name,this.weekday=s.weekday,this.step=s.step,this.valid_times=s.valid_times,this.starts_at=s.starts_at?(0,c.CU)(s.starts_at):void 0,this.ends_at=s.ends_at?(0,c.CU)(s.ends_at):void 0,this.preorder_reservation_group=s.preorder_reservation_group?new E.u(s.preorder_reservation_group):void 0,this.messages=s.messages}}},2516:(M,O,t)=>{t.d(O,{G:()=>c});var e=t(4496);let c=(()=>{class E{constructor(){this.weekdays=["Domenica","Luned\xEC","Marted\xEC","Mercoled\xEC","Gioved\xEC","Venerd\xEC","Sabato"]}transform(a){return"number"!=typeof a&&"string"==typeof a&&(a=parseInt(a)),"number"==typeof a&&a>=0&&a<=6?this.weekdays[a]:null}static#e=this.\u0275fac=function(s){return new(s||E)};static#t=this.\u0275pipe=e.UTH({name:"weekday",type:E,pure:!0,standalone:!0})}return E})()},1260:(M,O,t)=>{t.d(O,{U:()=>s});var e=t(6012),c=t(8400),E=t(5136);class d extends c.w{constructor(_){super(_),this.message=_.message,this.from_date=_.from_date,this.to_date=_.to_date,this.translations=_.translations,this.turns=_.turns?_.turns.map(f=>new E.e(f)):[]}}var a=t(4496);let s=(()=>{class r extends e.s{constructor(){super(d,"admin/reservation_turn_messages")}create(f){return super.create(f)}update(f,g){return super.update(f,g)}static#e=this.\u0275fac=function(g){return new(g||r)};static#t=this.\u0275prov=a.wxM({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})()},7556:(M,O,t)=>{t.d(O,{K:()=>d});var e=t(6012),c=t(5136),E=t(4496);let d=(()=>{class a extends e.s{constructor(){super(c.e,"admin/reservation_turns")}static#e=this.\u0275fac=function(_){return new(_||a)};static#t=this.\u0275prov=E.wxM({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()},1200:(M,O,t)=>{t.d(O,{A:()=>s,m:()=>r});var e=t(4496),c=t(900),E=t(3480),d=t(800),a=t(3616);let s=(()=>{class _{constructor(g,v,N){this.el=g,this.zone=v,this.destroy$=N,this.eventName=""}ngOnInit(){(0,d.w)(this.el.nativeElement,this.eventName,{passive:!1}).pipe((0,c.Uv)(this.zone),(0,c.uy)(),(0,a.a)(this.destroy$)).subscribe()}}return _.\u0275fac=function(g){return new(g||_)(e.GI1(e.GMv),e.GI1(e.WW2),e.GI1(E.UF,2))},_.\u0275dir=e.Sc5({type:_,selectors:[["","tuiPreventDefault",""]],inputs:{eventName:[e.Wk5.None,"tuiPreventDefault","eventName"]},features:[e.M5G([E.UF])]}),_})(),r=(()=>{class _{}return _.\u0275fac=function(g){return new(g||_)},_.\u0275mod=e.a4G({type:_}),_.\u0275inj=e.s3X({}),_})()}}]);