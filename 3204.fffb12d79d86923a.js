"use strict";(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[3204],{864:(C,l,e)=>{e.r(l),e.d(l,{LinkDishModule:()=>M});var s=e(2100),u=e(7552),t=e(4496),_=e(4436),a=e(8212),o=e(1512),d=e(6504),i=e(3716),n=e(1712),r=e(3480),v=e(4388),E=e(3616),N=e(4704),L=e(4e3),R=e(8824),S=e(8256),A=e(9088);function $(g,y){1&g&&(t.I0R(0,"p"),t.aS0(1,10),t.C$Y(),t.I0R(2,"p"),t.aS0(3,11),t.C$Y())}const h=g=>({except_in_category:g});function f(g,y){if(1&g){const c=t.KQA();t.I0R(0,"form",12),t.qCj("ngSubmit",function(){t.usT(c);const O=t.GaO();return t.CGJ(O.submit())}),t.I0R(1,"app-dish-select",13),t.SAx(2),t.aS0(3,14),t.k70(),t.C$Y(),t.I0R(4,"div",0)(5,"button",15),t.SAx(6),t.aS0(7,16),t.k70(),t.C$Y(),t.I0R(8,"button",17),t.qCj("click",function(){t.usT(c);const O=t.GaO();return t.CGJ(O.cancel())}),t.SAx(9),t.aS0(10,18),t.k70(),t.C$Y()()()}if(2&g){const c=t.GaO();t.E7m("formGroup",c.form),t.yG2(),t.E7m("filters",t.S45(3,h,c.categoryId))("formControlName","dish")}}let m=(()=>{class g{constructor(){this.service=(0,t.uUt)(n.S),this.destroy$=(0,t.uUt)(r.UF),this.route=(0,t.uUt)(s.gV),this.router=(0,t.uUt)(s.E5),this.notifications=(0,t.uUt)(v.E),this.loading=(0,t.OCB)(!1),this.category=(0,t.OCB)(null),this.categoryId=null,this.form=new d.WC({dish:new d.Ku(null)})}ngOnInit(){this.route.parent?.parent?.params.pipe((0,E.a)(this.destroy$),(0,N.k)(c=>c.category_id),(0,L.a)()).subscribe({next:c=>{this.categoryId=c,this.loadCategory()}})}submit(){const c=this.categoryId,p=this.form.value?.dish?.id;c&&p?this.form.invalid||(this.loading.set(!0),this.service.addDish(c,p).pipe((0,E.a)(this.destroy$),(0,R.U)(()=>this.loading.set(!1))).subscribe({next:()=>{this.navigateBack(),this.notifications.fireSnackBar("Piatto aggiunto.")},error:O=>{this.notifications.error((0,S.mk)(O)||"Qualcosa \xE8 andato storto nell'aggiunta del piatto.")}})):console.error("something invalid.",{categoryId:c,dishId:p})}cancel(){(this.form.touched||this.form.dirty)&&!confirm("Sei sicuro di voler annullare questa azione?")||this.navigateBack()}navigateBack(){const c=this.route.snapshot.queryParams.afterUrl;c?this.router.navigateByUrl(c):this.router.navigate([".."],{relativeTo:this.route})}loadCategory(){this.category.set(null),this.categoryId&&this.service.show(this.categoryId).pipe((0,E.a)(this.destroy$)).subscribe({next:c=>{this.category.set(c)},error:c=>{this.notifications.error((0,S.mk)(c)||"Qualcosa \xE8 andato storto nel caricamento della categoria padre.")}})}static#t=this.\u0275fac=function(p){return new(p||g)};static#e=this.\u0275cmp=t.In1({type:g,selectors:[["app-link-dish"]],standalone:!0,features:[t.M5G([r.UF]),t.UHJ],decls:15,vars:7,consts:()=>{let c,p,O,T,D,P,k;return c="Associa piatto esistente",p="Il piatto verr\xE0 aggiunto alla categoria",O="\n          Associare un piatto esistente ti permette di tenere lo stesso identico\n          piatto presente in pi\xF9 categorie.\n        ",T="\n          Il vantaggio \xE8 che quando devi apportare una modifica al piatto, lo\n          devi fare una volta sola.\n        ",D="Piatto da associare",P="Conferma",k="Annulla",[[1,"flex","items-center"],[1,"me-2"],c,[3,"content"],[1,"mb-3"],[1,"me-2","text-slate-400"],p,["tuiLink","",3,"routerLink"],["helpMsg",""],[3,"formGroup"],O,T,[3,"formGroup","ngSubmit"],[1,"block","mb-3",3,"filters","formControlName"],D,["tuiButton","","type","submit","size","l","appearance","primary",1,"me-2"],P,["tuiButton","","type","button","size","l","appearance","outline",3,"click"],k]},template:function(p,O){if(1&p&&(t.I0R(0,"span",0)(1,"h1",1),t.SAx(2),t.aS0(3,2),t.k70(),t.C$Y(),t.wR5(4,"tui-tooltip",3),t.C$Y(),t.I0R(5,"div",4)(6,"span",5),t.SAx(7),t.aS0(8,6),t.k70(),t.C$Y(),t.I0R(9,"a",7),t.wVc(10,"urlTo"),t.OEk(11),t.C$Y()(),t.yuY(12,$,4,0,"ng-template",null,8,t.gJz)(14,f,11,5,"form",9)),2&p){const T=t.Gew(13);let D,P;t.yG2(4),t.E7m("content",T),t.yG2(5),t.E7m("routerLink",t.g7$(10,4,null==(D=O.category())?null:D.id,"menuCategory.show")),t.yG2(2),t.cNF(null==(P=O.category())?null:P.name),t.yG2(3),t.C0Y(14,O.categoryId?14:-1)}},dependencies:[_.a,_.i,d.sl,d.sz,d.ue,d.u,d.uW,d.Wo,i.i,a.CI,a.Kw,o.w,o.C,s.ER,A.S],changeDetection:0})}return g})(),M=(()=>{class g{static#t=this.\u0275fac=function(p){return new(p||g)};static#e=this.\u0275mod=t.a4G({type:g});static#i=this.\u0275inj=t.s3X({imports:[s.qQ.forChild([(0,u.VV)(m,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return g})()},4824:(C,l,e)=>{e.d(l,{o:()=>t});var s=e(8400),u=e(2264);class t extends s.w{constructor(a){super(a),this.name=a.name,this.description=a.description,this.status=a.status,this.other=a.other,this.translations={...a.translations},a.image&&(this.image=new u.W(a.image))}}},5891:(C,l,e)=>{e.d(l,{S:()=>o});var s=e(8400),u=e(2264),t=e(355),_=e(4824),a=e(532);class o extends s.w{constructor(i){super(i),this.name=i.name,this.description=i.description,this.status=i.status,this.price=i.price,this.translations=i.translations,this.images=i.images?i.images.map(n=>new u.W(n)):[],this.suggestions=i.suggestions?i.suggestions.map(n=>new o(n)):[],this.tags=i.tags?i.tags.map(n=>new t.E(n)):[],this.allergens=i.allergens?i.allergens.map(n=>new _.o(n)):[],this.ingredients=i.ingredients?i.ingredients.map(n=>new a.e(n)):[]}}},2264:(C,l,e)=>{e.d(l,{W:()=>u});var s=e(8400);class u extends s.w{constructor(_){super(_),this.filename=_.filename,this.status=_.status,this.key=_.key,this.original_id=_.original_id,this.tag=_.tag,this.url=_.url}}},532:(C,l,e)=>{e.d(l,{e:()=>t});var s=e(8400),u=e(2264);class t extends s.w{constructor(a){super(a),this.name=a.name,this.description=a.description,this.status=a.status,this.other=a.other,this.translations={...a.translations},a.image&&(this.image=new u.W(a.image))}}},5820:(C,l,e)=>{e.d(l,{Q:()=>_});var s=e(8400);class u extends s.w{constructor(o){super(o),this.public_visible=o.public_visible,this.public_from=o.public_from?new Date(o.public_from):void 0,this.public_to=o.public_to?new Date(o.public_to):void 0,this.private_visible=o.private_visible,this.daily_from=o.daily_from?new Date(o.daily_from):void 0,this.daily_to=o.daily_to?new Date(o.daily_to):void 0}}var t=e(2264);class _ extends s.w{constructor(o){super(o),this.name=o.name,this.description=o.description,this.status=o.status,this.price=o.price,this.parent_id=o.parent_id,this.index=o.index,this.secret=o.secret,this.secret_desc=o.secret_desc,this.visibility_id=o.visibility_id,this.visibility=o.visibility?new u(o.visibility):void 0,this.parent=o.parent?new _(o.parent):void 0,this.children=o.children?o.children.map(d=>new _(d)):[],this.images=o.images?o.images.map(d=>new t.W(d)):[],this.translations=o.translations}}},355:(C,l,e)=>{e.d(l,{E:()=>t});var s=e(8400),u=e(2264);class t extends s.w{constructor(a){super(a),this.name=a.name,this.description=a.description,this.status=a.status,this.other=a.other,this.translations={...a.translations},this.color=a.color,a.image&&(this.image=new u.W(a.image))}}},9088:(C,l,e)=>{e.d(l,{S:()=>t});var s=e(4496);const u={menuCategory:{show:"/admin/menu/{itemId}",duplicate:"/admin/menu/{itemId}/duplicate",export:"/admin/menu/{itemId}/export",createChild:"/admin/menu/{itemId}/create-category",linkCategory:"/admin/menu/{itemId}/link-category",createDish:"/admin/menu/{itemId}/create-dish",linkDish:"/admin/menu/{itemId}/link-dish",private:"/menu/{itemId}",public:"/menu/{itemId}"},dish:{show:"/admin/menu/{categoryId}/dish/{itemId}"}};let t=(()=>{class _{transform(o,d){const i=u[d.split(".")[0]];if(!i)throw new Error(`Resource not found: ${d} (resouce: ${d.split(".")[0]})`);const n=d.split(".")[1];if(!i[n])throw new Error(`Action not found: ${d} (action: ${n})`);if(typeof o>"u"||null===o)return null;if("number"==typeof o&&(o=o.toString()),"object"==typeof o&&null!==o&&!Array.isArray(o)){let r=i[n];if(Object.keys(o).forEach(v=>{const E=o[v];void 0!==E&&r.includes(`{${v}}`)&&(r=r.replace(`{${v}}`,E??""))}),r.includes("{{"))throw new Error(`Unresolved interpolation: ${r}`);return r}if("string"!=typeof o)throw new Error(`Invalid itemId: ${o} (type: ${typeof o})`);return i[n].replace("{itemId}",o)}static#t=this.\u0275fac=function(d){return new(d||_)};static#e=this.\u0275pipe=s.UTH({name:"urlTo",type:_,pure:!0,standalone:!0})}return _})()},8676:(C,l,e)=>{e.d(l,{k:()=>a});var s=e(6012),u=e(5891),t=e(4704),_=e(4496);let a=(()=>{class o extends s.s{constructor(){super(u.S,"admin/menu/dishes")}copy(i,n){return this.post(`${i}/copy`,n).pipe((0,t.k)(r=>this.mapItem(r)))}move(i,n){return this.patch(`${i}/move`,n).pipe((0,t.k)(r=>this.mapItem(r)))}moveIngredient(i,n,r){return this.patch(`${i}/ingredients/${n}/move`,{to_index:r}).pipe((0,t.k)(v=>this.mapItem(v)))}moveTag(i,n,r){return this.patch(`${i}/tags/${n}/move`,{to_index:r}).pipe((0,t.k)(v=>this.mapItem(v)))}moveAllergen(i,n,r){return this.patch(`${i}/allergens/${n}/move`,{to_index:r}).pipe((0,t.k)(v=>this.mapItem(v)))}updateStatus(i,n){return this.patch(`${i}/status/${n}`,{}).pipe((0,t.k)(r=>this.mapItem(r)))}addIngredient(i,n){return this.post(`${i}/ingredients/${n}`,{}).pipe((0,t.k)(r=>this.mapItem(r)))}removeIngredient(i,n){return this.delete(`${i}/ingredients/${n}`).pipe((0,t.k)(r=>this.mapItem(r)))}addTag(i,n){return this.post(`${i}/tags/${n}`,{}).pipe((0,t.k)(r=>this.mapItem(r)))}removeTag(i,n){return this.delete(`${i}/tags/${n}`).pipe((0,t.k)(r=>this.mapItem(r)))}addAllergen(i,n){return this.post(`${i}/allergens/${n}`,{}).pipe((0,t.k)(r=>this.mapItem(r)))}removeAllergen(i,n){return this.delete(`${i}/allergens/${n}`).pipe((0,t.k)(r=>this.mapItem(r)))}references(i){return this.get(`${i}/references`).pipe((0,t.k)(n=>n))}addSuggestion(i,n){return this.post(`${i}/suggestions/${n}`,{}).pipe((0,t.k)(r=>this.mapItem(r)))}removeSuggestion(i,n){return this.delete(`${i}/suggestions/${n}`).pipe((0,t.k)(r=>this.mapItem(r)))}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275prov=_.wxM({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})()},1712:(C,l,e)=>{e.d(l,{S:()=>a});var s=e(6012),u=e(5820),t=e(4704),_=e(4496);let a=(()=>{class o extends s.s{constructor(){super(u.Q,"admin/menu/categories")}addCategory(i,n,r={}){return this.post(`${i}/add_category/${n}`,r)}addDish(i,n){return this.post(`${i}/dishes/${n}`,{})}removeDish(i,n){return this.delete(`${i}/dishes/${n}`,{})}orderDishes(i,n){return this.patch(`${i}/order_dishes`,{field:n})}dashboardData(i){return this.get(`${i}/dashboard_data`)}updateVisibility(i,n){return this.patch(`${i}/visibility`,n).pipe((0,t.k)(r=>this.mapItem(r)))}copy(i,n){return this.post(`${i}/copy`,n).pipe((0,t.k)(r=>this.mapItem(r)))}move(i,n){return this.patch(`${i}/move/${n}`,{}).pipe((0,t.k)(r=>this.mapItem(r)))}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275prov=_.wxM({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})()},1512:(C,l,e)=>{e.d(l,{C:()=>A,w:()=>$});var s=e(4496),u=e(900),t=e(4392),_=e(4164),a=e(3480),o=e(4680),d=e(3972),i=e(5944),n=e(3412),r=e(4704),v=e(3656),E=e(1368);const N=["tuiLink",""];function L(h,f){if(1&h&&s.wR5(0,"tui-svg",3),2&h){const m=s.GaO();s.E7m("src",m.icon||"")}}function R(h,f){if(1&h&&s.wR5(0,"tui-svg",4),2&h){const m=s.GaO();s.E7m("src",m.icon||"")}}const S=["*"];let A=(()=>{class h{constructor(m,M,g){this.el=m,this.mode$=M,this.pseudo=!1,this.icon="",this.iconAlign="right",this.iconRotated=!1,this.mode=null,this.focusVisible=!1,this.focusedChange=(0,n.U)((0,u.Ax)(this.el.nativeElement,"focusin").pipe((0,r.k)(t.Ml)),(0,u.Ax)(this.el.nativeElement,"focusout").pipe((0,r.k)(t.so))),g.subscribe(y=>{this.focusVisible=y})}get nativeFocusableElement(){return this.el.nativeElement}get focused(){return(0,_.ER)(this.nativeFocusableElement)}get hasIcon(){return!!this.icon}get iconAlignLeft(){return this.hasIcon&&"left"===this.iconAlign}get iconAlignRight(){return this.hasIcon&&"right"===this.iconAlign}}return h.\u0275fac=function(m){return new(m||h)(s.GI1(s.GMv),s.GI1(i.Yx),s.GI1(a.MF))},h.\u0275cmp=s.In1({type:h,selectors:[["a","tuiLink",""],["button","tuiLink",""]],hostVars:7,hostBindings:function(m,M){1&m&&s.qCj("$.data-mode.attr",function(){return M.mode$}),2&m&&(s.e48("data-host-mode",M.mode),s.eAK("_pseudo",M.pseudo)("_icon-rotated",M.iconRotated)("_focus-visible",M.focusVisible))},inputs:{pseudo:"pseudo",icon:"icon",iconAlign:"iconAlign",iconRotated:"iconRotated",mode:"mode"},exportAs:["tuiLink"],features:[s.M5G([(0,o.NK)(h),a.MF,a.UF,d.Ir])],attrs:N,ngContentSelectors:S,decls:4,vars:2,consts:[["class","t-icon t-icon_left",3,"src",4,"ngIf"],[1,"t-content"],["class","t-icon t-icon_right",3,"src",4,"ngIf"],[1,"t-icon","t-icon_left",3,"src"],[1,"t-icon","t-icon_right",3,"src"]],template:function(m,M){1&m&&(s.kPM(),s.yuY(0,L,1,1,"tui-svg",0),s.I0R(1,"span",1),s._Xx(2),s.C$Y(),s.yuY(3,R,1,1,"tui-svg",2)),2&m&&(s.E7m("ngIf",M.iconAlignLeft),s.yG2(3),s.E7m("ngIf",M.iconAlignRight))},dependencies:[v.Wu,E.u_],styles:["[_nghost-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;border:0;background:none;font-size:inherit;line-height:inherit;text-decoration:none;transition-property:color;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;color:var(--tui-link);text-align:left;text-transform:inherit;font-weight:inherit;cursor:pointer;outline:none}[_nghost-%COMP%]:hover{color:var(--tui-link-hover)}[_nghost-%COMP%]:disabled{opacity:var(--tui-disabled-opacity);cursor:default}[data-mode=onLight][_nghost-%COMP%]{color:var(--tui-text-02)}[data-mode=onLight][_nghost-%COMP%]:hover, [data-mode=onLight]._active[_nghost-%COMP%]{color:var(--tui-text-01)}[data-mode=onLight]._pseudo[_nghost-%COMP%]{color:var(--tui-text-01)}[data-mode=onLight]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(0,0,0,.48);text-decoration-color:#0000007a}[data-mode=onLight]._pseudo[_nghost-%COMP%]:hover, [data-mode=onLight]._pseudo._active[_nghost-%COMP%]{color:var(--tui-text-03)}[data-mode=onLight][data-host-mode=negative][_nghost-%COMP%]{color:var(--tui-negative-night)}[data-mode=onLight][data-host-mode=negative][_nghost-%COMP%]:hover, [data-mode=onLight][data-host-mode=negative][_nghost-%COMP%]:active, [data-mode=onLight][data-host-mode=negative]._active[_nghost-%COMP%]{color:var(--tui-negative-night-hover)}[data-mode=onDark][_nghost-%COMP%]{color:var(--tui-text-03-night)}[data-mode=onDark][_nghost-%COMP%]:hover, [data-mode=onDark][_nghost-%COMP%]:active, [data-mode=onDark]._active[_nghost-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._pseudo[_nghost-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(255,255,255,.48);text-decoration-color:#ffffff7a}[data-mode=onDark]._pseudo[_nghost-%COMP%]:hover, [data-mode=onDark]._pseudo[_nghost-%COMP%]:active, [data-mode=onDark]._pseudo._active[_nghost-%COMP%]{color:var(--tui-text-03-night)}[data-mode=onDark][data-host-mode=positive][_nghost-%COMP%]{color:var(--tui-positive-night)}[data-mode=onDark][data-host-mode=positive][_nghost-%COMP%]:hover, [data-mode=onDark][data-host-mode=positive][_nghost-%COMP%]:active, [data-mode=onDark][data-host-mode=positive]._active[_nghost-%COMP%]{color:var(--tui-positive-night-hover)}[data-host-mode=negative][_nghost-%COMP%]{color:var(--tui-negative)}[data-host-mode=negative][_nghost-%COMP%]:hover{color:var(--tui-negative-hover)}[data-host-mode=negative]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(222,76,30,.48);text-decoration-color:#de4c1e7a}[data-host-mode=positive][_nghost-%COMP%]{color:var(--tui-positive)}[data-host-mode=positive][_nghost-%COMP%]:hover{color:var(--tui-positive-hover)}[data-host-mode=positive]._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{-webkit-text-decoration-color:rgba(58,169,129,.48);text-decoration-color:#3aa9817a}._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-selection)}[data-mode=onLight]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-clear);color:var(--tui-text-01)}[data-mode=onDark]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-clear-inverse);color:var(--tui-text-01-night)}[data-host-mode=positive]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-success-bg)}[data-host-mode=negative]._focus-visible[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{background:var(--tui-error-bg)}._pseudo[_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{padding-bottom:.15em;-webkit-text-decoration:underline dashed rgba(51,111,238,.48);text-decoration:underline dashed rgba(51,111,238,.48);text-underline-offset:.2em;text-decoration-thickness:.7px}.t-icon[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;width:var(--tui-link-icon-size, 1.5rem);height:var(--tui-link-icon-size, 1.5rem);margin-top:-.125rem}.t-icon_left[_ngcontent-%COMP%]{margin-right:.25rem}.t-icon_right[_ngcontent-%COMP%]{margin-left:.25rem}._icon-rotated[_nghost-%COMP%]   .t-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}"],changeDetection:0}),h})(),$=(()=>{class h{}return h.\u0275fac=function(m){return new(m||h)},h.\u0275mod=s.a4G({type:h}),h.\u0275inj=s.s3X({imports:[[E.MD,v.Yt]]}),h})()}}]);