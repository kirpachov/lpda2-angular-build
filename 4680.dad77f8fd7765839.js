(self.webpackChunklpda2=self.webpackChunklpda2||[]).push([[4680],{6648:(V,m,e)=>{"use strict";e.r(m),e.d(m,{UpdateModule:()=>F});var c=e(31236),N=e(7552),_=e(97048),t=e(54496),a=e(6504),M=e(38256),P=e(9938),y=e(48392),I=e(65324),U=e(1128),f=e(83480),h=e(35e3),S=e(58212),r=e(27692),O=e(8048),d=e(53616),G=e(54704),D=e(66684),R=e(74e3),g=e(19212),E=e(68824),$=e(84792),C=e(6264);const L=["*"];let x=(()=>{class i{constructor(){this.showLoader=!1}static#t=this.\u0275fac=function(n){return new(n||i)};static#o=this.\u0275cmp=t.In1({type:i,selectors:[["app-no-item"]],inputs:{showLoader:"showLoader"},standalone:!0,features:[t.UHJ],ngContentSelectors:L,decls:4,vars:3,consts:[[1,"block","w-100","h-100",3,"overlay","showLoader","size"],["alt","not found","src","assets/img/not-found.svg","tuiSlot","top",1,"image"]],template:function(n,s){1&n&&(t.kPM(),t.I0R(0,"tui-loader",0)(1,"tui-block-status"),t.wR5(2,"img",1),t._Xx(3),t.C$Y()()),2&n&&t.E7m("overlay",!0)("showLoader",s.showLoader)("size","xl")},dependencies:[r.Sk,r.Cb,C.eA,C.M$,C.Gu],encapsulation:2})}return i})();var T=e(53797),z=e(99956),l=e(22684);function k(i,p){if(1&i){const o=t.KQA();t.I0R(0,"p",1),t.OEk(1),t.wVc(2,"humanizeContactKey"),t.C$Y(),t.I0R(3,"form",2),t.qCj("ngSubmit",function(){t.usT(o);const s=t.GaO();return t.CGJ(s.submit())}),t.I0R(4,"div",3)(5,"tui-input",4),t.OEk(6),t.wVc(7,"humanizeContactKey"),t.C$Y(),t.wR5(8,"app-errors",5),t.C$Y(),t.wR5(9,"app-errors",5),t.I0R(10,"div",6)(11,"button",7),t.SAx(12),t.aS0(13,8),t.k70(),t.C$Y(),t.I0R(14,"button",9),t.qCj("click",function(){t.usT(o);const s=t.GaO();return t.CGJ(s.cancel())}),t.SAx(15),t.aS0(16,10),t.k70(),t.C$Y()()()}if(2&i){const o=t.GaO();let n,s;t.yG2(),t.oRS(" ",t.kDX(2,8,null==(n=o.item())?null:n.key)," "),t.yG2(2),t.E7m("formGroup",o.form),t.yG2(2),t.E7m("tuiAutoFocus",!0)("formControl",o.valueControl),t.yG2(),t.oRS(" ",t.kDX(7,10,null==(s=o.item())?null:s.key)," "),t.yG2(2),t.E7m("errors",o.valueControl.errors),t.yG2(),t.E7m("errors",o.form.errors),t.yG2(2),t.E7m("showLoader",o.loading())}}function X(i,p){1&i&&t.wR5(0,"tui-loader",11),2&i&&t.E7m("size","l")}function Y(i,p){if(1&i){const o=t.KQA();t.I0R(0,"app-no-item"),t.SAx(1),t.aS0(2,12),t.k70(),t.I0R(3,"button",9),t.qCj("click",function(){t.usT(o);const s=t.GaO();return t.CGJ(s.close())}),t.SAx(4),t.aS0(5,13),t.k70(),t.C$Y()()}}let b=(()=>{class i{constructor(){this.service=(0,t.uUt)(I.s),this.router=(0,t.uUt)(c.E5),this.route=(0,t.uUt)(c.gV),this.destroy=(0,t.uUt)(f.UF),this.notifications=(0,t.uUt)(U.E),this.item=(0,t.OCB)(null),this.key=(0,t.OCB)(null),this.downloading=(0,t.OCB)(!1),this.saving=(0,t.OCB)(!1),this.loading=(0,t.S6b)(()=>this.downloading()||this.saving()),this.valueControl=new a.Ku(null),this.form=new a.WC({value:this.valueControl}),this.formDefaultValue=this.form.value}ngOnInit(){this.route.params.pipe((0,d.a)(this.destroy),(0,G.k)(o=>o.key),(0,D.I)(o=>"string"==typeof o&&o.length>0),(0,R.a)(),(0,g.y)(o=>this.key.set(o)),(0,g.y)(()=>this.reload())).subscribe()}submit(){const o=this.key();if(this.form.invalid||!o)return;const n=this.valueControl.value||"";this.saving.set(!0),this.service.update(o,n).pipe((0,d.a)(this.destroy),(0,E.U)(()=>this.saving.set(!1))).subscribe({next:()=>this.close(),error:s=>{s instanceof _.gj?P.y.assignErrorsToForm(this.form,s):this.notifications.error()}})}cancel(){confirm(l.$localize`Sei sicuro di voler annullare? Tutte le modifiche non salvate andranno perse.`)&&this.close()}close(){this.router.navigate([".."],{relativeTo:this.route})}reload(){this.item.set(null);const o=this.key();o?(this.downloading.set(!0),this.service.show(o).pipe((0,d.a)(this.destroy),(0,E.U)(()=>this.downloading.set(!1))).subscribe({next:n=>this.itemLoaded(n),error:n=>this.notifications.error(n instanceof _.gj?(0,M.mk)(n):y.a)})):console.error("invalid key")}itemLoaded(o){this.item.set(o),o?this.form.patchValue({value:o.value??null}):this.form.reset(this.formDefaultValue)}static#t=this.\u0275fac=function(n){return new(n||i)};static#o=this.\u0275cmp=t.In1({type:i,selectors:[["app-update"]],standalone:!0,features:[t.M5G([f.UF]),t.UHJ],decls:5,vars:1,consts:()=>{let o,n,s,A,v;return o=l.$localize`Modifica contatto`,n=l.$localize`Conferma`,s=l.$localize`Annulla`,A=l.$localize`Non abbiamo trovato il contatto che cercavi :'(`,v=l.$localize`Esci`,[o,[1,"text-xl"],[3,"formGroup","ngSubmit"],[1,"block","mb-3"],[3,"tuiAutoFocus","formControl"],[3,"errors"],[1,"flex","items-center"],["type","submit","tuiButton","",1,"me-2",3,"showLoader"],n,["type","button","tuiButton","","appearance","icon",3,"click"],s,[3,"size"],A,v]},template:function(n,s){1&n&&(t.I0R(0,"h1"),t.aS0(1,0),t.C$Y(),t.yuY(2,k,17,12)(3,X,1,1)(4,Y,6,0)),2&n&&(t.yG2(2),t.C0Y(2,s.item()?2:s.loading()?3:4))},dependencies:[a.sl,a.sz,a.ue,a.u,a.ug,a.uW,S.CI,S.Kw,r.Sk,r.Cb,$.M,x,T.CQ,T.Oo,T.cP,O.aS,h.m6,h.gJ,z.g],encapsulation:2,changeDetection:0})}return i})(),F=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#o=this.\u0275mod=t.a4G({type:i});static#e=this.\u0275inj=t.s3X({imports:[c.qQ.forChild([(0,N.VV)(b,{path:"",closeable:!0,dismissible:!1,size:"l"})])]})}return i})()},22684:()=>{},30220:()=>{}}]);